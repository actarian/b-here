/**
 * @license b-here v1.0.0
 * (c) 2022 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxcomp-form"),require("rxjs"),require("rxjs/operators"),require("html2canvas")):"function"==typeof define&&define.amd?define(["rxcomp","rxcomp-form","rxjs","rxjs/operators","html2canvas"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rxcomp,t.rxcomp.form,t.rxjs,t.rxjs.operators,t.html2canvas)}(this,(function(t,e,n,i,o){"use strict";function r(t,e,n,i,o,r,s){try{var a=t[r](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function a(t){r(s,i,o,a,l,"next",t)}function l(t){r(s,i,o,a,l,"throw",t)}a(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function v(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var m=function(){function t(){}return t.merge=function(t,e){var n=this;return e&&"object"==typeof e&&Object.keys(e).forEach((function(i){var o=e[i];"object"!=typeof o||Array.isArray(o)?t[i]=o:t[i]=n.merge(t[i],o)})),t},t}(),f="undefined"!=typeof module&&module.exports,g=null!=(f?{get:function(){}}:new URLSearchParams(window.location.search)).get("debug"),b=f?null:document.querySelector("base").getAttribute("href"),w=!f&&(window&&-1!==window.location.host.indexOf("herokuapp")),y=!f&&(w||window&&("41789"===window.location.port||"5000"===window.location.port||"6443"===window.location.port||"actarian.github.io"===window.location.host)),x=!f&&(window&&-1!==["localhost","127.0.0.1","0.0.0.0"].indexOf(window.location.host.split(":")[0])),C={STATIC:y,DEVELOPMENT:x,PRODUCTION:!x},k=function(){var t=e.prototype;function e(t){t&&Object.assign(this,t)}return t.getAbsoluteUrl=function(t,e){var n=""+window.location.origin+t;return Object.keys(e).forEach((function(t){n=n.replace("$"+t,e[t])})),n},t.getPath=function(t){return this.isLocal(t)?this.href+t:t},t.isLocal=function(t){return-1===t.indexOf("://")},l(e,[{key:"STATIC",get:function(){return C.STATIC},set:function(t){C.STATIC=!0===t||"true"===t,console.log("Environment.STATIC.set",C.STATIC)}},{key:"href",get:function(){return w?this.githubDocs:b}}]),e}(),M={channelName:"BHere",flags:{production:!1,useProxy:!1,useToken:!1,selfService:!0,guidedTourRequest:!0,editor:!0,menu:!0,navmaps:!0,chat:!0,ar:!0,like:!0,hideNavInfo:!0,attendee:!0,streamer:!0,viewer:!0,smartDevice:!0,selfServiceProposition:!0,heroku:w},navs:{iconMinScale:1,iconMaxScale:1.4},url:{},languages:["it","en"],defaultLanguage:"it"},S=window.STATIC?{appKey:"8b0cae93d47a44e48e97e7fd0404be4e",channelName:"BHere",flags:{production:!1,useProxy:!0,useToken:!1,selfService:!0,guidedTourRequest:!0,editor:!0,editorAssetScreen:!0,menu:!0,menuEmbed:!0,navmaps:!0,chat:!0,ar:!0,like:!0,hideNavInfo:!0,useIframe:!0,attendee:!0,streamer:!0,viewer:!0,smartDevice:!0,selfServiceProposition:!1,navInfoAnimated:!1,navInfoImportantAnimated:!1,navMoveAnimated:!0,navMoveImportantAnimated:!0,navPointAnimated:!1,navPointImportantAnimated:!1,navTitleAnimated:!1,navTitleImportantAnimated:!1,navTransparentAnimated:!0,navTransparentImportantAnimated:!0,useTextureEnvironment:!0,usePaths:!0},navs:{iconMinScale:1,iconMaxScale:1.4},profiles:{streamer:"480p_2",publisher:"1080p_2",screen:"1080p_2"},logo:null,background:{video:"/b-here/img/background.mp4"},selfServiceAudio:null,colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room"],disabledViewItemTypes:["texture"]},assets:"/b-here/",workers:{image:"./js/workers/image.service.worker.js",prefetch:"./js/workers/prefetch.service.worker.js"},textures:{envMap:"textures/envMap/studio_small_03_2k.hdr",grid:"textures/grid/grid.jpg"},githubDocs:"https://raw.githubusercontent.com/actarian/b-here/b-here-ws-new/docs/",template:{tryInAr:"/try-in-ar.html?viewId=$viewId",modal:{configureFirewall:"/configure-firewall-modal.html",controlRequest:"/control-request-modal.html",supportRequest:"/support-request-modal.html",tryInAr:"/try-in-ar-modal.html",view:{panorama:"/panorama-modal.html","panorama-grid":"/panorama-grid-modal.html","room-3d":"/room-3d-modal.html",model:"/model-modal.html",media:"/media-modal.html"},viewItem:{nav:"/nav-modal.html",plane:"/plane-modal.html","curved-plane":"/curved-plane-modal.html",texture:"/texture-modal.html",model:"/item-model-modal.html"},navmap:"/navmap-modal.html",navmapItem:"/navmap-item-modal.html",pathAdd:"/path-add-modal.html",pathEdit:"/path-edit-modal.html",remove:"/remove-modal.html"},email:{supportRequest:"/email/support-request.html"}}}:{appKey:"8b0cae93d47a44e48e97e7fd0404be4e",channelName:"BHere",flags:{production:!0,useProxy:!1,useToken:!1,selfService:!0,guidedTourRequest:!0,editor:!1,editorAssetScreen:!1,menu:!0,menuEmbed:!1,navmaps:!1,chat:!1,ar:!0,like:!0,hideNavInfo:!0,useIframe:!0,attendee:!0,streamer:!0,viewer:!0,smartDevice:!0,selfServiceProposition:!1,navInfoAnimated:!1,navInfoImportantAnimated:!1,navMoveAnimated:!1,navMoveImportantAnimated:!1,navPointAnimated:!1,navPointImportantAnimated:!1,navTitleAnimated:!1,navTitleImportantAnimated:!1,navTransparentAnimated:!1,navTransparentImportantAnimated:!1,useTextureEnvironment:!0,usePaths:!1},navs:{iconMinScale:1,iconMaxScale:1.4},profiles:{streamer:"480p_2",publisher:"1080p_2",screen:"720p_2"},logo:null,background:{video:"/Modules/B-Here/Client/docs/img/background.mp4"},selfServiceAudio:null,colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room","room-3d","media"],disabledViewItemTypes:["texture"]},assets:"/Modules/B-Here/Client/docs/",workers:{image:"/Modules/B-Here/Client/docs/js/workers/image.service.worker.js",prefetch:"/Modules/B-Here/Client/docs/js/workers/prefetch.service.worker.js"},textures:{envMap:"textures/envMap/studio_small_03_2k.hdr",grid:"textures/grid/grid.jpg"},githubDocs:"https://raw.githubusercontent.com/actarian/b-here/b-here-ws-new/docs/",template:{tryInAr:"/template/modules/b-here/try-in-ar.cshtml?viewId=$viewId",modal:{configureFirewall:"/template/modules/b-here/configure-firewall-modal.cshtml",controlRequest:"/template/modules/b-here/control-request-modal.cshtml",supportRequest:"/template/modules/b-here/support-request-modal.cshtml",tryInAr:"/template/modules/b-here/try-in-ar-modal.cshtml",view:{panorama:"/template/modules/b-here/panorama-modal.cshtml","panorama-grid":"/template/modules/b-here/panorama-grid-modal.cshtml","room-3d":"/template/modules/b-here/room-3d-modal.cshtml",model:"/template/modules/b-here/model-modal.cshtml",media:"/template/modules/b-here/media-modal.cshtml"},viewItem:{nav:"/template/modules/b-here/nav-modal.cshtml",plane:"/template/modules/b-here/plane-modal.cshtml","curved-plane":"/template/modules/b-here/curved-plane-modal.cshtml",texture:"/template/modules/b-here/texture-modal.cshtml",model:"/template/modules/b-here/item-model-modal.cshtml"},navmap:"/template/modules/b-here/navmap-modal.cshtml",navmapItem:"/template/modules/b-here/navmap-item-modal.cshtml",pathAdd:"/template/modules/b-here/path-add-modal.cshtml",pathEdit:"/template/modules/b-here/path-edit-modal.cshtml",remove:"/template/modules/b-here/remove-modal.cshtml"},email:{supportRequest:"/template/modules/b-here/email/support-request.cshtml"}}},T=Object.assign({port:5e3,fontFamily:"Work Sans, sans-serif",colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room","room-3d","media"],disabledViewItemTypes:["texture"]},renderOrder:{panorama:0,room:10,plane:20,tile:30,model:40,banner:50,nav:60,panel:70,menu:80,debug:90,pointer:100}},M,S),E=new k(T=m.merge(T,window.bhere));console.log("environment",E);var L=function(){function t(){}return t.has=function(t){return new URLSearchParams(window.location.search).has(t)},t.get=function(t){return new URLSearchParams(window.location.search).get(t)},t.set=function(t,e){var n=new URLSearchParams(window.location.search);"string"==typeof t?n.set(t,e):n.set(t,""),this.pushParams(n)},t.delete=function(t){var e=new URLSearchParams(window.location.search);e.has(t)&&(e.delete(t),this.pushParams(e))},t.pushParams=function(t){if(window.history&&window.history.pushState){var e=document.title,n=window.location.href.split("?")[0]+"?"+t.toString();window.history.pushState(t.toString(),e,n)}},t.replace=function(t,e){var n=window.history;if(n&&n.replaceState){var i=window.location,o=document.title;if("/"===i.pathname){var r=i.origin+e+i.search;n.replaceState(n.state,o,r)}else if(-1!==i.href.indexOf(t)){var s=i.href.replace(t,e);n.replaceState(n.state,o,s)}}},t.deserialize=function(t){var e=this.get("params");return this.decode(t,e)},t.serialize=function(t,e){var n=this.deserialize(),i=this.encode(t,e,n);this.set("params",i)},t.decode=function(t,e){var n=null;if(e){var i=window.atob(e);n=JSON.parse(i)}return t&&n&&(n=n[t]),n||null},t.encode=function(t,e,n){n=n||{};"string"==typeof t?n[t]=e:n=t;var i=JSON.stringify(n);return window.btoa(i)},t}(),_=function(){function t(){}return t.patchState=function(t){t=Object.assign({},this.state,t),this.state=t},l(t,null,[{key:"state",set:function(t){this.state$.next(t)},get:function(){return this.state$.getValue()}}]),t}();c(_,"state$",new n.BehaviorSubject({}));var I={Publisher:"publisher",Attendee:"attendee",Streamer:"streamer",Viewer:"viewer",SmartDevice:"smart-device",SelfService:"self-service",Embed:"embed"},R=function(t){t&&Object.assign(this,t)},A=/^\d{9}-\d{4}-\d{13}(-\d+)?$/,P=function(){function t(e){if(this.userId=_.state.user?_.state.user.id:0,this.role=_.state.role||I.Viewer,this.timestamp=(new Date).valueOf().toString(),this.pathId=null,"string"==typeof e){if(!e.match(A))return console.warn("MeetingId","invalid meetingId",e),null;e=t.decompose(e)}"object"==typeof e&&(e.id&&(this.id=e.id),e.userId&&(this.userId=e.userId),e.role&&(this.role=e.role),e.roleIndex&&(this.roleIndex=e.roleIndex),e.timestamp&&(this.timestamp=e.timestamp),e.pathId&&(this.pathId=e.pathId))}l(t,[{key:"roleIndex",get:function(){return t.getRoleIndex(this.role)},set:function(e){if(t.getRoleIndex(this.role)!==e){var n=Object.keys(I)[e];this.role=I[n]}}}]);var e=t.prototype;return e.toString=function(){return t.compose(this.userId,this.roleIndex,this.timestamp,this.pathId)},e.toRoles=function(){var e=this.userId,n=this.timestamp,i=this.pathId;return{id:t.compose(e,t.getRoleIndex(I.Publisher),n,i),idAttendee:t.compose(e,t.getRoleIndex(I.Attendee),n,i),idStreamer:t.compose(e,t.getRoleIndex(I.Streamer),n,i),idViewer:t.compose(e,t.getRoleIndex(I.Viewer),n,i),idSmartDevice:t.compose(e,t.getRoleIndex(I.SmartDevice),n,i),idSelfService:t.compose(e,t.getRoleIndex(I.SelfService),n,i)}},t.compose=function(e,n,i,o){return t.padded(e,9)+"-"+t.padded(n,4)+"-"+i+(o?"-"+o:"")},t.decompose=function(t){var e=t.split("-");return{userId:parseInt(e[0]),roleIndex:parseInt(e[1]),timestamp:parseInt(e[2]),pathId:e[3]?parseInt(e[3]):null}},t.generateMeetingId=function(){return(new t).toRoles()},t.getRoleIndex=function(t){return Object.keys(I).reduce((function(e,n,i){return I[n]===t?i:e}),-1)},t.padded=function(t,e){var n="000000000"+t;return n.substr(n.length-e)},t}(),$=function(){function t(e){if(this.link=L.get("link")||null,this.name=L.get("name")||null,this.role=L.get("role")||null,this.viewId=L.has("viewId")?parseInt(L.get("viewId")):null,this.pathId=L.has("pathId")?parseInt(L.get("pathId")):null,this.embedViewId=L.has("embedViewId")?parseInt(L.get("embedViewId")):null,this.support=!!L.has("support")&&"true"===L.get("support"),"string"==typeof e&&(e=t.decompose(e)),"object"==typeof e){if(e.link&&(this.link=e.link),e.user){var n=t.getName(e.user);n&&(this.name=n)}e.name&&(this.name=e.name),e.role&&(this.role=e.role),e.viewId&&(this.viewId=e.viewId),e.pathId&&(this.pathId=e.pathId),e.embedViewId&&(this.embedViewId=e.embedViewId),e.support&&(this.support=e.support)}}l(t,[{key:"meetingId",get:function(){return this.link?new P(this.link):null}}]);var e=t.prototype;return e.toString=function(e){return void 0===e&&(e=!1),t.compose(this.link,this.name,e?null:this.role,this.viewId,this.pathId,this.support)},e.toUrl=function(){var e=this.toString();return t.getCurrentUrl(e)},e.toAccessCodeUrl=function(){var e=this.toString();return t.getAccessCodeUrl(e)},e.toGuidedTourUrl=function(){var e=this.toString();return t.getGuidedTourUrl(e)},e.copyToClipBoard=function(e){void 0===e&&(e=!1);var n=document.createElement("input");n.style.position="absolute",n.style.top="1000vh",document.querySelector("body").appendChild(n);var i=this.toString(!0);n.value=e?t.getAccessCodeUrl(i):t.getGuidedTourUrl(i),n.focus(),n.select(),n.setSelectionRange(0,99999),document.execCommand("copy"),n.parentNode.removeChild(n),alert("link copiato!\n "+n.value)},e.replaceUrl=function(){if("history"in window){var e=this.toString(),n=t.getCurrentUrl(e);window.history.replaceState({pageTitle:window.pageTitle},"",n)}},t.replaceWithUser=function(e){var n=new t({user:e});return n.replaceUrl(),n},t.replaceWithName=function(e){var n=new t({name:e});return n.replaceUrl(),n},t.replaceWithLink=function(e){var n=new t({link:e});return n.replaceUrl(),n},t.getCurrentUrl=function(t){return void 0===t&&(t=""),""+window.location.origin+window.location.pathname+t},t.getAccessCodeUrl=function(t){return void 0===t&&(t=""),""+window.location.origin+E.url.accessCode+t},t.getGuidedTourUrl=function(t){return void 0===t&&(t=""),""+window.location.origin+E.url.guidedTour+t},t.getName=function(t){return t&&t.firstName&&t.lastName?t.firstName+" "+t.lastName:null},t.compose=function(t,e,n,i,o,r){var s={link:t,name:e,role:n,viewId:i,pathId:o,support:r};return"?"+(s=Object.keys(s).map((function(t){return{key:t,value:s[t]}})).filter((function(t){return null!=t.value&&!1!==t.value})).map((function(t){return t.key+"="+t.value}))).join("&")},t.decompose=function(t){var e={};return t.split("?")[1].split("&").forEach((function(t){var n=t.split("=")[0],i=t.split("=")[1];e[n]=i})),e},t}(),H=function(){return(H=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},O=function(){return(O=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},B=function(t){return void 0===t&&(t={}),{arrayFormat:t.arrayFormat||"none",booleanFormat:t.booleanFormat||"none",nullFormat:t.nullFormat||"default"}},D=function(t){return encodeURIComponent(t)},U=function(t){return decodeURIComponent(t)},V=function(t,e,n){return null===e?function(t,e){return"hidden"===e.nullFormat?"":"string"===e.nullFormat?t+"=null":t}(t,n):"boolean"==typeof e?function(t,e,n){return"empty-true"===n.booleanFormat&&e?t:t+"="+("unicode"===n.booleanFormat?e?"✓":"✗":e.toString())}(t,e,n):Array.isArray(e)?function(t,e,n){var i=function(t){return"index"===t.arrayFormat?function(t,e){return t+"["+e+"]"}:"brackets"===t.arrayFormat?function(t){return t+"[]"}:function(t){return t}}(n);return e.map((function(e,n){return i(t,n)+"="+D(e)})).join("&")}(t,e,n):t+"="+D(e)},z=function(t){var e=t.indexOf("?");return-1===e?t:t.slice(e+1)},j=function(t){var e=t.indexOf("["),n=-1!==e;return{hasBrackets:n,name:n?t.slice(0,e):t}},F=function(t,e){var n=B(e);return z(t).split("&").reduce((function(t,e){var i=e.split("="),o=i[0],r=i[1],s=j(o),a=s.hasBrackets,l=s.name,c=t[l],u=function(t,e){if(void 0===t)return"empty-true"===e.booleanFormat||null;if("string"===e.booleanFormat){if("true"===t)return!0;if("false"===t)return!1}if("unicode"===e.booleanFormat){if("✓"===U(t))return!0;if("✗"===U(t))return!1}return"string"===e.nullFormat&&"null"===t?null:U(t)}(r,n);return t[l]=void 0===c?a?[u]:u:(Array.isArray(c)?c:[c]).concat(u),t}),{})},N=function(t,e){var n=B(e);return Object.keys(t).filter((function(e){return void 0!==t[e]})).map((function(e){return V(e,t[e],n)})).filter(Boolean).join("&")},G=/[^!$'()*+,;|:]/g,q=function(t){return t.replace(G,(function(t){return encodeURIComponent(t)}))},Z={default:q,uri:encodeURI,uriComponent:encodeURIComponent,none:function(t){return t},legacy:encodeURI},W={default:decodeURIComponent,uri:decodeURI,uriComponent:decodeURIComponent,none:function(t){return t},legacy:decodeURIComponent},K=function(t,e,n){var i=Z[e]||q;return n?String(t).split("/").map(i).join("/"):i(String(t))},X=function(t){return"("+(t?t.replace(/(^<|>$)/g,""):"[a-zA-Z0-9-_.~%':|=+\\*@$]+")+")"},Y=[{name:"url-parameter",pattern:/^:([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(X(t[2]))}},{name:"url-parameter-splat",pattern:/^\*([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/,regex:/([^?]*)/},{name:"url-parameter-matrix",pattern:/^;([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(";"+t[1]+"="+X(t[2]))}},{name:"query-parameter",pattern:/^(?:\?|&)(?::)?([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/},{name:"delimiter",pattern:/^(\/|\?)/,regex:function(t){return new RegExp("\\"+t[0])}},{name:"sub-delimiter",pattern:/^(!|&|-|_|\.|;)/,regex:function(t){return new RegExp(t[0])}},{name:"fragment",pattern:/^([0-9a-zA-Z]+)/,regex:function(t){return new RegExp(t[0])}}],J=function t(e,n){if(void 0===n&&(n=[]),!Y.some((function(i){var o=e.match(i.pattern);return!!o&&(n.push({type:i.name,match:o[0],val:o.slice(1,2),otherVal:o.slice(2),regex:i.regex instanceof Function?i.regex(o):i.regex}),o[0].length<e.length&&(n=t(e.substr(o[0].length),n)),!0)})))throw new Error("Could not parse path '"+e+"'");return n},Q=function(t){return null!=t},tt={urlParamsEncoding:"default"},et=function(){function t(t,e){if(!t)throw new Error("Missing path in Path constructor");this.path=t,this.options=O(O({},tt),e),this.tokens=J(t),this.hasUrlParams=this.tokens.filter((function(t){return/^url-parameter/.test(t.type)})).length>0,this.hasSpatParam=this.tokens.filter((function(t){return/splat$/.test(t.type)})).length>0,this.hasMatrixParams=this.tokens.filter((function(t){return/matrix$/.test(t.type)})).length>0,this.hasQueryParams=this.tokens.filter((function(t){return/^query-parameter/.test(t.type)})).length>0,this.spatParams=this.getParams("url-parameter-splat"),this.urlParams=this.getParams(/^url-parameter/),this.queryParams=this.getParams("query-parameter"),this.params=this.urlParams.concat(this.queryParams),this.source=this.tokens.filter((function(t){return void 0!==t.regex})).map((function(t){return t.regex.source})).join("")}return t.createPath=function(e,n){return new t(e,n)},t.prototype.isQueryParam=function(t){return-1!==this.queryParams.indexOf(t)},t.prototype.isSpatParam=function(t){return-1!==this.spatParams.indexOf(t)},t.prototype.test=function(t,e){var n=this,i=O(O({caseSensitive:!1,strictTrailingSlash:!1},this.options),e),o=function(t,e){return e||"\\/"===t?t:t.replace(/\\\/$/,"")+"(?:\\/)?"}(this.source,i.strictTrailingSlash),r=this.urlTest(t,o+(this.hasQueryParams?"(\\?.*$|$)":"$"),i.caseSensitive,i.urlParamsEncoding);if(!r||!this.hasQueryParams)return r;var s=F(t,i.queryParams);return 0===Object.keys(s).filter((function(t){return!n.isQueryParam(t)})).length?(Object.keys(s).forEach((function(t){return r[t]=s[t]})),r):null},t.prototype.partialTest=function(t,e){var n=this,i=O(O({caseSensitive:!1,delimited:!0},this.options),e),o=function(t,e){return e?/(\/)$/.test(t)?t:t+"(\\/|\\?|\\.|;|$)":t}(this.source,i.delimited),r=this.urlTest(t,o,i.caseSensitive,i.urlParamsEncoding);if(!r)return r;if(!this.hasQueryParams)return r;var s=F(t,i.queryParams);return Object.keys(s).filter((function(t){return n.isQueryParam(t)})).forEach((function(t){return function(t,e,n){void 0===n&&(n="");var i=t[e];return t[e]=void 0===i?n:Array.isArray(i)?i.concat(n):[i,n],t}(r,t,s[t])})),r},t.prototype.build=function(t,e){var n=this;void 0===t&&(t={});var i=O(O({ignoreConstraints:!1,ignoreSearch:!1,queryParams:{}},this.options),e),o=Object.keys(t).filter((function(t){return!n.isQueryParam(t)})).reduce((function(e,o){if(!Q(t[o]))return e;var r=t[o],s=n.isSpatParam(o);return"boolean"==typeof r?e[o]=r:Array.isArray(r)?e[o]=r.map((function(t){return K(t,i.urlParamsEncoding,s)})):e[o]=K(r,i.urlParamsEncoding,s),e}),{});if(this.urlParams.some((function(e){return!Q(t[e])}))){var r=this.urlParams.filter((function(e){return!Q(t[e])}));throw new Error("Cannot build path: '"+this.path+"' requires missing parameters { "+r.join(", ")+" }")}if(!i.ignoreConstraints&&!this.tokens.filter((function(t){return/^url-parameter/.test(t.type)&&!/-splat$/.test(t.type)})).every((function(t){return new RegExp("^"+X(t.otherVal[0])+"$").test(o[t.val])})))throw new Error("Some parameters of '"+this.path+"' are of invalid format");var s=this.tokens.filter((function(t){return!1===/^query-parameter/.test(t.type)})).map((function(t){return"url-parameter-matrix"===t.type?";"+t.val+"="+o[t.val[0]]:/^url-parameter/.test(t.type)?o[t.val[0]]:t.match})).join("");if(i.ignoreSearch)return s;var a=this.queryParams.filter((function(e){return-1!==Object.keys(t).indexOf(e)})).reduce((function(e,n){return e[n]=t[n],e}),{}),l=N(a,i.queryParams);return l?s+"?"+l:s},t.prototype.getParams=function(t){var e=t instanceof RegExp?function(e){return t.test(e.type)}:function(e){return e.type===t};return this.tokens.filter(e).map((function(t){return t.val[0]}))},t.prototype.urlTest=function(t,e,n,i){var o=this,r=new RegExp("^"+e,n?"":"i"),s=t.match(r);return s?this.urlParams.length?s.slice(1,this.urlParams.length+1).reduce((function(t,e,n){return t[o.urlParams[n]]=(W[i]||decodeURIComponent)(e),t}),{}):{}:null},t}(),nt=function(t){var e="";return t.reduce((function(t,n){var i,o,r,s,a=null!=(o=null===(i=n.parser)||void 0===i?void 0:i.urlParams.reduce((function(t,e){return t[e]="url",t}),{}))?o:{},l=null!=(s=null===(r=n.parser)||void 0===r?void 0:r.queryParams.reduce((function(t,e){return t[e]="query",t}),a))?s:{};return void 0!==n.name&&(t[e=e?e+"."+n.name:n.name]=l),t}),{})},it=function t(e,n,i,o,r){void 0===o&&(o={});for(var s=o.queryParamsMode,a=void 0===s?"default":s,l=o.strictTrailingSlash,c=void 0!==l&&l,u=o.strongMatching,d=void 0===u||u,h=o.caseSensitive,p=void 0!==h&&h,v=1===e.length&&""===e[0].name,m=function(e){var s,l=null,u=void 0,h=n;if("/"===r&&"/"===e.path&&(h="/"+n),e.children.length||(l=e.parser.test(h,{caseSensitive:p,strictTrailingSlash:c,queryParams:o.queryParams,urlParamsEncoding:o.urlParamsEncoding})),l||(l=e.parser.partialTest(h,{delimited:d,caseSensitive:p,queryParams:o.queryParams,urlParamsEncoding:o.urlParamsEncoding})),l){var m=e.parser.build(l,{ignoreSearch:!0,urlParamsEncoding:o.urlParamsEncoding});c||e.children.length||(m=m.replace(/\/$/,"")),u=0===h.toLowerCase().indexOf(m.toLowerCase())?h.slice(m.length):h,c||e.children.length||(u=u.replace(/^\/\?/,"?"));var f=function(t,e,n){var i=B(n);if(""===z(t))return{querystring:"",removedParams:{}};var o=t.split("&").reduce((function(t,n){var i=t[0],o=t[1],r=n.split("=")[0],s=j(r).name;return-1===e.indexOf(s)?[i.concat(n),o]:[i,o.concat(n)]}),[[],[]]),r=o[0],s=o[1];return{querystring:r.join("&"),removedParams:F(s.join("&"),i)}}((s=h.replace(m,""),s.split("?")[1]||""),e.parser.queryParams,o.queryParams).querystring;if(u=function(t){return t.split("?")[0]}(u)+(f?"?"+f:""),c||v||"/"!==u||/\/$/.test(m)||(u=""),i.segments.push(e),Object.keys(l).forEach((function(t){return i.params[t]=l[t]})),!v&&!u.length)return{value:i};if(!v&&"strict"!==a&&0===u.indexOf("?")){var g=F(u.slice(1),o.queryParams);return Object.keys(g).forEach((function(t){return i.params[t]=g[t]})),{value:i}}var b=e.getNonAbsoluteChildren();return b.length?{value:t(b,u,i,o,m)}:{value:null}}},f=0,g=e;f<g.length;f++){var b=m(g[f]);if("object"==typeof b)return b.value}return null};var ot=function(t){return function(e,n){var i,o,r,s,a,l,c=e.path.replace(/<.*?>/g,"").split("?")[0].replace(/(.+)\/$/,"$1"),u=n.path.replace(/<.*?>/g,"").split("?")[0].replace(/(.+)\/$/,"$1");if("/"===c)return 1;if("/"===u)return-1;if(null===(i=e.parser)||void 0===i?void 0:i.hasSpatParam)return 1;if(null===(o=n.parser)||void 0===o?void 0:o.hasSpatParam)return-1;var d=(c.match(/\//g)||[]).length,h=(u.match(/\//g)||[]).length;if(d<h)return 1;if(d>h)return-1;var p=null!=(s=null===(r=e.parser)||void 0===r?void 0:r.urlParams.length)?s:0,v=null!=(l=null===(a=n.parser)||void 0===a?void 0:a.urlParams.length)?l:0;if(p<v)return-1;if(p>v)return 1;var m=(c.split("/").slice(-1)[0]||"").length,f=(u.split("/").slice(-1)[0]||"").length;return m<f?1:m>f?-1:t.indexOf(e)-t.indexOf(n)}},rt=function(){function t(t,e,n,i){return void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n=[]),void 0===i&&(i={}),this.name=t,this.absolute=/^~/.test(e),this.path=this.absolute?e.slice(1):e,this.parser=this.path?new et(this.path):null,this.children=[],this.parent=i.parent,this.checkParents(),this.add(n,i.onAdd,!i.finalSort&&!1!==i.sort),i.finalSort&&this.sortDescendants(),this}return t.prototype.getParentSegments=function(t){return void 0===t&&(t=[]),this.parent&&this.parent.parser?this.parent.getParentSegments(t.concat(this.parent)):t.reverse()},t.prototype.setParent=function(t){this.parent=t,this.checkParents()},t.prototype.setPath=function(t){void 0===t&&(t=""),this.path=t,this.parser=t?new et(t):null},t.prototype.add=function(e,n,i){var o=this;if(void 0===i&&(i=!0),null==e)return this;if(e instanceof Array)return e.forEach((function(t){return o.add(t,n,i)})),this;if(!(e instanceof t||e instanceof Object))throw new Error("RouteNode.add() expects routes to be an Object or an instance of RouteNode.");if(e instanceof t)e.setParent(this),this.addRouteNode(e,i);else{if(!e.name||!e.path)throw new Error("RouteNode.add() expects routes to have a name and a path defined.");var r=new t(e.name,e.path,e.children,{finalSort:!1,onAdd:n,parent:this,sort:i}),s=r.getParentSegments([r]).map((function(t){return t.name})).join(".");n&&n(H(H({},e),{name:s})),this.addRouteNode(r,i)}return this},t.prototype.addNode=function(e,n){return this.add(new t(e,n)),this},t.prototype.getPath=function(t){var e,n=this.getSegmentsByName(t);return n?(e=n)?e.map((function(t){return t.path})).join(""):null:null},t.prototype.getNonAbsoluteChildren=function(){return this.children.filter((function(t){return!t.absolute}))},t.prototype.sortChildren=function(){var t,e;this.children.length&&(t=this.children,e=t.slice(0),t.sort(ot(e)))},t.prototype.sortDescendants=function(){this.sortChildren(),this.children.forEach((function(t){return t.sortDescendants()}))},t.prototype.buildPath=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n={});var i=this.getSegmentsByName(t);if(!i)throw new Error("[route-node][buildPath] '{routeName}' is not defined");return function(t,e,n){void 0===e&&(e={}),void 0===n&&(n={});for(var i=n.queryParamsMode,o=void 0===i?"default":i,r=n.trailingSlashMode,s=void 0===r?"default":r,a=[],l=[],c=0,u=t;c<u.length;c++){var d=u[c].parser;d&&(a.push.apply(a,d.queryParams),l.push.apply(l,d.urlParams),l.push.apply(l,d.spatParams))}if("loose"===o){var h=Object.keys(e).reduce((function(t,e){return-1===a.indexOf(e)&&-1===l.indexOf(e)?t.concat(e):t}),[]);a.push.apply(a,h)}var p=a.reduce((function(t,n){return-1!==Object.keys(e).indexOf(n)&&(t[n]=e[n]),t}),{}),v=N(p,n.queryParams),m=t.reduce((function(t,i){var o,r,s=null!=(r=null===(o=i.parser)||void 0===o?void 0:o.build(e,{ignoreSearch:!0,queryParams:n.queryParams,urlParamsEncoding:n.urlParamsEncoding}))?r:"";return i.absolute?s:t+s}),"").replace(/\/\/{1,}/g,"/"),f=m;return"always"===s?f=/\/$/.test(m)?m:m+"/":"never"===s&&"/"!==m&&(f=/\/$/.test(m)?m.slice(0,-1):m),f+(v?"?"+v:"")}(i,e,n)},t.prototype.buildState=function(t,e){void 0===e&&(e={});var n=this.getSegmentsByName(t);return n&&n.length?{name:t,params:e,meta:nt(n)}:null},t.prototype.matchPath=function(t,e){void 0===e&&(e={}),""!==t||e.strictTrailingSlash||(t="/");var n=this.getSegmentsMatchingPath(t,e);if(!n)return null;var i=n.segments;if(i[0].absolute){var o=i[0].getParentSegments();i.reverse(),i.push.apply(i,o),i.reverse()}var r=i[i.length-1].findSlashChild();return r&&i.push(r),function(t){return t&&t.segments&&t.segments.length?{name:t.segments.map((function(t){return t.name})).filter((function(t){return t})).join("."),params:t.params,meta:nt(t.segments)}:null}(n)},t.prototype.addRouteNode=function(t,e){void 0===e&&(e=!0);var n=t.name.split(".");if(1===n.length){if(-1!==this.children.map((function(t){return t.name})).indexOf(t.name))throw new Error('Alias "'+t.name+'" is already defined in route node');if(-1!==this.children.map((function(t){return t.path})).indexOf(t.path))throw new Error('Path "'+t.path+'" is already defined in route node');this.children.push(t),e&&this.sortChildren()}else{var i=this.getSegmentsByName(n.slice(0,-1).join("."));if(!i)throw new Error("Could not add route named '"+t.name+"', parent is missing.");t.name=n[n.length-1],i[i.length-1].add(t)}return this},t.prototype.checkParents=function(){if(this.absolute&&this.hasParentsParams())throw new Error("[RouteNode] A RouteNode with an abolute path cannot have parents with route parameters")},t.prototype.hasParentsParams=function(){if(this.parent&&this.parent.parser){var t=this.parent.parser;return t.hasUrlParams||t.hasSpatParam||t.hasMatrixParams||t.hasQueryParams||this.parent.hasParentsParams()}return!1},t.prototype.findAbsoluteChildren=function(){return this.children.reduce((function(t,e){return t.concat(e.absolute?e:[]).concat(e.findAbsoluteChildren())}),[])},t.prototype.findSlashChild=function(){return this.getNonAbsoluteChildren().filter((function(t){return t.parser&&/^\/(\?|$)/.test(t.parser.path)}))[0]},t.prototype.getSegmentsByName=function(t){var e=[],n=this.parser?[this]:this.children;return(this.parser?[""]:[]).concat(t.split(".")).every((function(t){var i=function(t,e){var n=e.filter((function(e){return e.name===t}));return n.length?n[0]:void 0}(t,n);return!!i&&(n=i.children,e.push(i),!0)}))?e:null},t.prototype.getSegmentsMatchingPath=function(t,e){var n=(this.parser?[this]:this.children).reduce((function(t,e){return t.concat(e,e.findAbsoluteChildren())}),[]),i=it(n,t,{segments:[],params:{}},e);return i&&1===i.segments.length&&""===i.segments[0].name?null:i},t}();var st=function(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),at=function(t){return t.split(".").reduce((function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)}),[])},lt=function(t){return t&&t.meta&&t.meta.params},ct=function(t,e){return lt(e)&&null!=e.meta.params[t]?Object.keys(e.meta.params[t]).reduce((function(t,n){return t[n]=e.params[n],t}),{}):{}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var ut=function(){return(ut=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},dt={trailingSlashMode:"default",queryParamsMode:"default",strictTrailingSlash:!1,autoCleanUp:!0,allowNotFound:!1,strongMatching:!0,rewritePathOnMatch:!0,caseSensitive:!1,urlParamsEncoding:"default"};var ht="NOT_STARTED",pt="NO_START_PATH_OR_STATE",vt="ALREADY_STARTED",mt="ROUTE_NOT_FOUND",ft="SAME_STATES",gt="CANNOT_DEACTIVATE",bt="CANNOT_ACTIVATE",wt="TRANSITION_ERR",yt="CANCELLED",xt="@@router5/UNKNOWN_ROUTE",Ct="$start",kt="$stop",Mt="$$start",St="$$cancel",Tt="$$success",Et="$$error";function Lt(t){var e=0,n=null;return t.getState=function(){return n},t.setState=function(t){n=t},t.makeState=function(n,i,o,r,s){return{name:n,params:ut(ut({},t.config.defaultParams[n]),i),path:o,meta:r?ut(ut({},r),{id:void 0===s?++e:s}):void 0}},t.makeNotFoundState=function(e,n){return t.makeState(xt,{path:e},e,{options:n})},t.areStatesEqual=function(e,n,i){if(void 0===i&&(i=!0),e.name!==n.name)return!1;var o=function(e){return t.rootNode.getSegmentsByName(e).map((function(t){return t.parser.urlParams})).reduce((function(t,e){return t.concat(e)}),[])},r=i?o(e.name):Object.keys(e.params),s=i?o(n.name):Object.keys(n.params);return r.length===s.length&&r.every((function(t){return e.params[t]===n.params[t]}))},t.areStatesDescendants=function(t,e){return!!new RegExp("^"+t.name+"\\.(.*)$").test(e.name)&&Object.keys(t.params).every((function(n){return t.params[n]===e.params[n]}))},t.forwardState=function(e,n){var i=t.config.forwardMap[e]||e;return{name:i,params:ut(ut(ut({},t.config.defaultParams[e]),t.config.defaultParams[i]),n)}},t.buildState=function(e,n){var i=t.forwardState(e,n),o=i.name,r=i.params;return t.rootNode.buildState(o,r)},t}var _t={onStart:Ct,onStop:kt,onTransitionSuccess:Tt,onTransitionStart:Mt,onTransitionError:Et,onTransitionCancel:St};function It(t){var e=[];function n(e){var n=t.executeFactory(e),i=Object.keys(_t).map((function(e){if(n[e])return t.addEventListener(_t[e],n[e])})).filter(Boolean);return function(){i.forEach((function(t){return t()})),n.teardown&&n.teardown()}}return t.getPlugins=function(){return e},t.usePlugin=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=t.map((function(t){return e.push(t),n(t)}));return function(){e=e.filter((function(e){return-1===t.indexOf(e)})),o.forEach((function(t){return t()}))}},t}function Rt(t){var e=[],n=[];return t.useMiddleware=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var r=i.map((function(i){var o=t.executeFactory(i);return e.push(i),n.push(o),function(){e=e.filter((function(t){return t!==i})),n=n.filter((function(t){return t!==o}))}}));return function(){return r.forEach((function(t){return t()}))}},t.clearMiddleware=function(){return e=[],n=[],t},t.getMiddlewareFactories=function(){return e},t.getMiddlewareFunctions=function(){return n},t}function At(t){var e={};function n(e){var n="object"==typeof e,i=n?e.next.bind(e):e,o=t.addEventListener(Tt,(function(t,e){i({route:t,previousRoute:e})}));return n?{unsubscribe:o}:o}function i(){var t;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");return n(t)}})[st]=function(){return this},t}return t.invokeEventListeners=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(e[t]||[]).forEach((function(t){return t.apply(void 0,n)}))},t.removeEventListener=function(t,n){e[t]=e[t].filter((function(t){return t!==n}))},t.addEventListener=function(n,i){return e[n]=(e[n]||[]).concat(i),function(){return t.removeEventListener(n,i)}},t.subscribe=n,t[st]=i,t["@@observable"]=i,t}function Pt(t,e,n){var i=e.isCancelled,o=e.toState,r=e.fromState,s=e.errorKey,a=void 0===s?void 0:s,l=Array.isArray(t)?t:Object.keys(t),c=function(t){return"object"==typeof t&&void 0!==t.name&&void 0!==t.params&&void 0!==t.path},u=function(t,e,n,o){var s=function(t,e){t?o(t):e&&e!==n&&c(e)?(function(t,e){return e.name!==t.name||e.params!==t.params||e.path!==t.path}(e,n)&&console.error("[router5][transition] Warning: state values (name, params, path) were changed during transition process."),o(null,function(t,e){return ut(ut(ut({},e),t),{meta:ut(ut({},e.meta),t.meta)})}(e,n))):o(null,n)},a=t.call(null,n,r,s);i()?s(null):"boolean"==typeof a?s(a?null:e):c(a)?s(null,a):a&&"function"==typeof a.then&&a.then((function(t){t instanceof Error?s({error:t},null):s(null,t)}),(function(t){t instanceof Error?(console.error(t.stack||t),s(ut(ut({},e),{promiseError:t}),null)):s("object"==typeof t?ut(ut({},e),t):e,null)}))};!function e(o,r){var s;if(i())n();else if(o)n(o);else if(l.length){var c="string"==typeof l[0],d=a&&c?((s={})[a]=l[0],s):{},h=c?t[l[0]]:l[0];l=l.slice(1),u(h,d,r,e)}else n(null,r)}(null,o)}function $t(t,e,n,i,o){var r=!1,s=!1,a=t.getOptions(),l=t.getLifecycleFunctions(),c=l[0],u=l[1],d=t.getMiddlewareFunctions(),h=function(){return r},p=function(t,e){return ut(ut({},t),e instanceof Object?e:{error:e})},v=e.name===xt,m={isCancelled:h,toState:e,fromState:n},f=function(t,e){var n,i=t.meta&&t.meta&&t.meta.options||{},o=e?at(e.name):[],r=at(t.name),s=Math.min(o.length,r.length);n=!e||i.reload?0:lt(e)||lt(t)?function(){var n,i=function(){var i=o[n],s=r[n];if(i!==s)return{value:n};var a=ct(i,t),l=ct(s,e);return Object.keys(a).length!==Object.keys(l).length?{value:n}:0===Object.keys(a).length?"continue":Object.keys(a).some((function(t){return l[t]!==a[t]}))?{value:n}:void 0};for(n=0;n<s;n+=1){var a=i();if("object"==typeof a)return a.value}return n}():0;var a=o.slice(n).reverse(),l=r.slice(n);return{intersection:e&&n>0?o[n-1]:"",toDeactivate:a,toActivate:l}}(e,n),g=f.toDeactivate,b=f.toActivate,w=!n||i.forceDeactivate?[]:function(t,e,n){Pt(g.filter((function(t){return c[t]})).reduce((function(t,e){var n;return ut(ut({},t),((n={})[e]=c[e],n))}),{}),ut(ut({},m),{errorKey:"segment"}),(function(t){return n(t?p({code:gt},t):null)}))},y=v?[]:function(t,e,n){Pt(b.filter((function(t){return u[t]})).reduce((function(t,e){var n;return ut(ut({},t),((n={})[e]=u[e],n))}),{}),ut(ut({},m),{errorKey:"segment"}),(function(t){return n(t?p({code:bt},t):null)}))},x=d.length?function(t,e,n){return Pt(d,ut({},m),(function(e,i){return n(e?p({code:wt},e):null,i||t)}))}:[];return Pt([].concat(w).concat(y).concat(x),m,(function(n,i){if(s=!0,!h()){if(!n&&a.autoCleanUp){var r=at(e.name);Object.keys(c).forEach((function(e){-1===r.indexOf(e)&&t.clearCanDeactivate(e)}))}o(n,i||e)}})),function(){r||s||(r=!0,o({code:yt},null))}}var Ht=function(){};function Ot(t){var e;function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o=e[0],r=e[e.length-1],s="function"==typeof r?r:Ht,a="object"==typeof e[1]?e[1]:{},l="object"==typeof e[2]?e[2]:{};if(t.isStarted()){var c=t.buildState(o,a);if(!c)return s(u={code:mt}),void t.invokeEventListeners(Et,null,t.getState(),u);var u,d=t.makeState(c.name,c.params,t.buildPath(c.name,c.params),{params:c.meta,options:l}),h=!!t.getState()&&t.areStatesEqual(t.getState(),d,!1);if(h&&!l.reload&&!l.force)return s(u={code:ft}),void t.invokeEventListeners(Et,d,t.getState(),u);var p=t.getState();return l.skipTransition?(s(null,d),Ht):t.transitionToState(d,p,l,(function(e,i){if(e)if(e.redirect){var o=e.redirect;n(o.name,o.params,ut(ut({},l),{force:!0,redirected:!0}),s)}else s(e);else t.invokeEventListeners(Tt,i,p,l),s(null,i)}))}s({code:ht})}return t.navigate=n,t.navigate=n,t.navigateToDefault=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o="object"==typeof e[0]?e[0]:{},r=2===e.length?e[1]:"function"==typeof e[0]?e[0]:Ht,s=t.getOptions();return s.defaultRoute?n(s.defaultRoute,s.defaultParams,o,r):function(){}},t.cancel=function(){return e&&(e("navigate"),e=null),t},t.transitionToState=function(n,i,o,r){return void 0===o&&(o={}),void 0===r&&(r=Ht),t.cancel(),t.invokeEventListeners(Mt,n,i),e=$t(t,n,i,o,(function(o,s){e=null,s=s||n,o?(o.code===yt?t.invokeEventListeners(St,n,i):t.invokeEventListeners(Et,n,i,o),r(o)):(t.setState(s),r(null,s))}))},t}var Bt=function(){};function Dt(t){var e=!1;return t.isStarted=function(){return e},t.start=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o,r,s=t.getOptions(),a=n[n.length-1],l="function"==typeof a?a:Bt,c="function"!=typeof n[0]?n[0]:void 0;if(e)return l({code:vt}),t;e=!0,t.invokeEventListeners(Ct);var u=function(e,n,i){void 0===i&&(i=!0),e||t.invokeEventListeners(Tt,n,null,{replace:!0}),e&&i&&t.invokeEventListeners(Et,n,null,e),l(e,n)};if(void 0===c&&!s.defaultRoute)return u({code:pt});if("string"==typeof c?o=c:"object"==typeof c&&(r=c),r)t.setState(r),u(null,r);else{r=void 0===o?null:t.matchPath(o);var d=function(){return t.navigateToDefault({replace:!0},l)},h=function(e){return t.navigate(e.name,e.params,{replace:!0,reload:!0,redirected:!0},l)},p=function(e){t.transitionToState(e,t.getState(),{},(function(t,e){t?t.redirect?h(t.redirect):s.defaultRoute?d():u(t,null,!1):u(null,e)}))};r?p(r):s.defaultRoute?d():s.allowNotFound?p(t.makeNotFoundState(o,{replace:!0})):u({code:mt,path:o},null)}return t},t.stop=function(){return e&&(t.setState(null),e=!1,t.invokeEventListeners(kt)),t},t}var Ut=function(t){return"function"==typeof t?t:function(){return function(){return t}}};function Vt(t){var e={},n={},i={},o={};return t.getLifecycleFactories=function(){return[e,n]},t.getLifecycleFunctions=function(){return[i,o]},t.canDeactivate=function(n,o){var r=Ut(o);return e[n]=r,i[n]=t.executeFactory(r),t},t.clearCanDeactivate=function(n){return e[n]=void 0,i[n]=void 0,t},t.canActivate=function(e,i){var r=Ut(i);return n[e]=r,o[e]=t.executeFactory(r),t},t}var zt=function(t,e,n){void 0===t&&(t=[]),void 0===e&&(e={}),void 0===n&&(n={});return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.reduce((function(t,e){return e(t)}),e)}}(function(t){return function(e){var n=ut(ut({},dt),t);return e.getOptions=function(){return n},e.setOption=function(t,i){return n[t]=i,e},e}}(e),function(t){return function(e){var n=t;return e.setDependency=function(t,i){return n[t]=i,e},e.setDependencies=function(t){return Object.keys(t).forEach((function(n){return e.setDependency(n,t[n])})),e},e.getDependencies=function(){return n},e.getInjectables=function(){return[e,e.getDependencies()]},e.executeFactory=function(t){return t.apply(void 0,e.getInjectables())},e}}(n),At,Lt,Dt,Vt,Ot,It,Rt,function(t){return function(e){e.forward=function(t,n){return e.config.forwardMap[t]=n,e};var n=t instanceof rt?t:new rt("","",t,{onAdd:i});function i(t){t.canActivate&&e.canActivate(t.name,t.canActivate),t.forwardTo&&e.forward(t.name,t.forwardTo),t.decodeParams&&(e.config.decoders[t.name]=t.decodeParams),t.encodeParams&&(e.config.encoders[t.name]=t.encodeParams),t.defaultParams&&(e.config.defaultParams[t.name]=t.defaultParams)}return e.rootNode=n,e.add=function(t,o){return n.add(t,i,!o),o&&n.sortDescendants(),e},e.addNode=function(t,i,o){return n.addNode(t,i),o&&e.canActivate(t,o),e},e.isActive=function(t,n,i,o){void 0===n&&(n={}),void 0===i&&(i=!1),void 0===o&&(o=!0);var r=e.getState();return!!r&&(i||r.name===t?e.areStatesEqual(e.makeState(t,n),r,o):e.areStatesDescendants(e.makeState(t,n),r))},e.buildPath=function(t,n){if(t===xt)return n.path;var i=ut(ut({},e.config.defaultParams[t]),n),o=e.getOptions(),r=o.trailingSlashMode,s=o.queryParamsMode,a=o.queryParams,l=e.config.encoders[t]?e.config.encoders[t](i):i;return e.rootNode.buildPath(t,l,{trailingSlashMode:r,queryParamsMode:s,queryParams:a,urlParamsEncoding:e.getOptions().urlParamsEncoding})},e.matchPath=function(t,n){var i=e.getOptions(),o=e.rootNode.matchPath(t,i);if(o){var r=o.name,s=o.params,a=o.meta,l=e.config.decoders[r]?e.config.decoders[r](s):s,c=e.forwardState(r,l),u=c.name,d=c.params,h=!1===i.rewritePathOnMatch?t:e.buildPath(u,d);return e.makeState(u,d,h,{params:a,source:n})}return null},e.setRootPath=function(t){e.rootNode.setPath(t)},e}}(t))({config:{decoders:{},encoders:{},defaultParams:{},forwardMap:{}}})},jt=function(){return(jt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Ft(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i}var Nt=function(t){return function(){return t}},Gt=function(){},qt="undefined"!=typeof window&&window.history,Zt=function(t){try{return encodeURI(decodeURI(t))}catch(e){return t}},Wt=qt?{getBase:function(){return window.location.pathname},pushState:function(t,e,n){return window.history.pushState(t,e,n)},replaceState:function(t,e,n){return window.history.replaceState(t,e,n)},addPopstateListener:function(t,e){var n=e.useHash&&!(-1===window.navigator.userAgent.indexOf("Trident"));return window.addEventListener("popstate",t),n&&window.addEventListener("hashchange",t),function(){window.removeEventListener("popstate",t),n&&window.removeEventListener("hashchange",t)}},getLocation:function(t){var e=t.useHash?window.location.hash.replace(new RegExp("^#"+t.hashPrefix),""):window.location.pathname.replace(new RegExp("^"+t.base),"");return(Zt(e)||"/")+window.location.search},getState:function(){return window.history.state},getHash:function(){return window.location.hash}}:{getBase:Nt(""),pushState:Gt,replaceState:Gt,addPopstateListener:Gt,getLocation:Nt(""),getState:Nt(null),getHash:Nt("")},Kt={forceDeactivate:!0,useHash:!1,hashPrefix:"",base:"",mergeState:!1,preserveHash:!0},Xt="popstate";function Yt(t,e){void 0===e&&(e=Wt);var n,i=jt(jt({},Kt),t),o={forceDeactivate:i.forceDeactivate,source:Xt};return function(t){var r=t.getOptions(),s=t.start;t.buildUrl=function(e,n){return(i.base||"")+(i.useHash?"#"+i.hashPrefix:"")+t.buildPath(e,n)};function a(t,n,o){var r=t?{meta:t.meta,name:t.name,params:t.params,path:t.path}:t,s=!0===i.mergeState?jt(jt({},e.getState()),r):r;o?e.replaceState(s,"",n):e.pushState(s,"",n)}function l(n){var s=t.getState(),l=!n.state||!n.state.name,c=l?t.matchPath(e.getLocation(i),Xt):t.makeState(n.state.name,n.state.params,n.state.path,jt(jt({},n.state.meta),{source:Xt}),n.state.meta.id),u=r.defaultRoute,d=r.defaultParams;c?s&&t.areStatesEqual(c,s,!1)||t.transitionToState(c,s,o,(function(e,n){if(e)if(e.redirect){var i=e.redirect,r=i.name,h=i.params;t.navigate(r,h,jt(jt({},o),{replace:!0,force:!0,redirected:!0}))}else if(e.code===gt){var p=t.buildUrl(s.name,s.params);l||a(c,p,!0)}else u&&t.navigate(u,d,jt(jt({},o),{reload:!0,replace:!0}));else t.invokeEventListeners(Tt,n,s,{replace:!0})})):u&&t.navigateToDefault(jt(jt({},o),{reload:!0,replace:!0}))}function c(){n&&(n(),n=void 0)}return t.matchUrl=function(e){return t.matchPath(function(t){var e=t.match(/^(?:http|https):\/\/(?:[0-9a-z_\-.:]+?)(?=\/)(.*)$/),n=(e?e[1]:t).match(/^(.+?)(#.+?)?(\?.+)?$/);if(!n)throw new Error("[router5] Could not parse url "+t);var o=n[1],r=n[2]||"",s=n[3]||"";return(i.useHash?r.replace(new RegExp("^#"+i.hashPrefix),""):i.base?o.replace(new RegExp("^"+i.base),""):o)+s}(e))},t.start=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return 0===n.length||"function"==typeof n[0]?s.apply(void 0,Ft([e.getLocation(i)],n)):s.apply(void 0,n),t},t.replaceHistoryState=function(n,i,o){void 0===i&&(i={}),void 0===o&&(o="");var r=t.buildState(n,i),s=t.makeState(r.name,r.params,t.buildPath(r.name,r.params),{params:r.meta}),a=t.buildUrl(n,i);t.lastKnownState=s,e.replaceState(s,o,a)},{onStart:function(){i.useHash&&!i.base&&(i.base=e.getBase()),n=e.addPopstateListener(l,i)},onStop:c,teardown:c,onTransitionSuccess:function(n,o,r){var s=e.getState(),l=s&&s.meta&&s.name&&s.params,c=o&&t.areStatesEqual(o,n,!1),u=r.replace||!l||c,d=t.buildUrl(n.name,n.params);null===o&&!1===i.useHash&&!0===i.preserveHash&&(d+=e.getHash()),a(n,d,u)},onPopState:l}}}var Jt=function(){function t(){}return t.event$=function(){var t=this,e=this.router_;return e?n.from(e).pipe(i.startWith({route:e.getState(),previousRoute:null}),i.tap((function(e){console.log("RouterService.event$",e),t.event$_.next(e)}))):n.EMPTY},t.useBrowser=function(t){t=t||[{name:"home",path:"/"},{name:"profile",path:"/profile"}],this.routes=t;var e=zt(t,{allowNotFound:!1,autoCleanUp:!0,defaultRoute:"index",defaultParams:{},queryParams:{arrayFormat:"default",nullFormat:"default",booleanFormat:"default"},queryParamsMode:"default",trailingSlashMode:"default",strictTrailingSlash:!1,caseSensitive:!1,urlParamsEncoding:"default"});this.router_=e,e.usePlugin(Yt({useHash:!1})),e.start()},t.useBrowser$=function(t){return this.useBrowser(t),this.event$()},t.setRouterLink=function(t,e,n){void 0===t&&(t="it.access"),void 0===e&&(e=null),void 0===n&&(n={reload:!0});var i=this.router_;if(i)try{i.navigate(t,e,n)}catch(t){console.log("RouterService.setRouterLink.error",t)}},t.buildPath=function(t,e){void 0===e&&(e=null);var n=null,i=this.router_;if(i)try{n=i.buildPath(t,e)}catch(t){console.log("RouterService.buildPath.error",t)}return n},t.isActive=function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!0);var o=!1,r=this.router_;if(r)try{o=r.isActive(t,e,n,i)}catch(t){console.log("RouterService.isActive.error",t)}return o},l(t,null,[{key:"router",get:function(){return this.router_}}]),t}();c(Jt,"routes",[]),c(Jt,"router_",null),c(Jt,"event$_",new n.Subject);var Qt=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onInit=function(){this.state={};var e=new $;if(e.link){var n=e.toGuidedTourUrl(),i=t.getContext(this).node;new QRious({element:i.querySelector(".qrcode"),value:n,size:256})}else Jt.setRouterLink($.getGuidedTourUrl())},n}(t.Component);Qt.meta={selector:"[access-code-component]"};var te=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.getControl=function(t){return this.group.get(t)},l(e,[{key:"group",get:function(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control}}]),e}(t.Component);function ee(t){return new e.FormGroup(function(t){return t.reduce((function(t,n,i){var o=[];if(n.required&&o.push("checkbox"===n.type?e.Validators.RequiredTrueValidator():e.Validators.RequiredValidator()),"email"===n.type&&o.push(e.Validators.EmailValidator()),"url"===n.type&&o.push(e.Validators.PatternValidator("(https?://(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|www.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|https?://(?:www.|(?!www))[a-zA-Z0-9]+.[^s]{2,}|www.[a-zA-Z0-9]+.[^s]{2,})")),null!=n.pattern&&o.push(e.Validators.PatternValidator(n.pattern)),t[n.name]=new e.FormControl(null!=n.value?n.value:null,o),"select"===n.type||"custom-select"===n.type){var r=(n.options||[]).slice();r.unshift({id:null,name:"select"}),t[n.name].options=r}return t}),{})}(t))}te.meta={selector:"[controls]",inputs:["formGroup","fields"],hosts:{host:e.FormAbstractCollectionDirective},template:'\n\t\t<div *for="let field of fields">\n\t\t\t<div *if="[\'text\', \'email\', \'url\'].indexOf(field.type) !== -1" control-text [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'select\'" control-select [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'custom-select\'" control-custom-select [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'textarea\'" control-textarea [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'checkbox\'" control-checkbox [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<input *if="field.type == \'hidden\'" [name]="field.name" [formControl]="getControl(field.name)" value="" type="text" style="display:none !important;" />\n\t\t</div>\n\t'};var ne=[["480p_1",640,480,15,500,!0],["480p_2",640,480,30,1e3,!0],["480p_3",480,480,15,400,!0],["480p_4",640,480,30,750,!0],["480p_6",480,480,30,600,!0],["480p_8",848,480,15,610,!0],["480p_9",848,480,30,930,!0],["480p_10",640,480,10,400,!0],["720p_1",1280,720,15,1130,!0],["720p_2",1280,720,30,2e3,!0],["720p_3",1280,720,30,1710,!0],["720p_5",960,720,15,910,!0],["720p_6",960,720,30,1380,!0],["1080p_1",1920,1080,15,2080,!1],["1080p_2",1920,1080,30,3e3,!1],["1080p_3",1920,1080,30,3150,!1],["1080p_5",1920,1080,60,4780,!1]].map((function(t){return{profile:t[0],resolution:{width:t[1],height:t[2]},frameRate:{min:t[3],max:t[3]},bitrate:{min:t[4],max:t[4]},compatible:t[5]}}));function ie(t){return t.role===I.Publisher||t.role===I.SmartDevice?ne.find((function(t){return t.profile===E.profiles.publisher})):ne.find((function(t){return t.profile===E.profiles.streamer}))}var oe="idle",re="checklist",se="link",ae="login",le="name",ce="device",ue="should-connect",de="connecting",he="connected",pe="agoraEvent",ve="channelMembers",me="supportRequest",fe="supportRequestAccepted",ge="supportRequestRejected",be="requestControl",we="requestControlAccepted",ye="requestControlRejected",xe="requestControlDismiss",Ce="requestControlDismissed",ke="requestPeerInfo",Me="requestPeerInfoResult",Se="requestInfo",Te="requestInfoResult",Ee="requestInfoDismiss",Le="requestInfoDismissed",_e="requestInfoRejected",Ie="remoteSilencing",Re="controlInfo",Ae="addLike",Pe="showPanel",$e="playMedia",He="zoomMedia",Oe="currentTimeMedia",Be="playModel",De="mode",Ue="navInfo",Ve="navToView",ze="navToGrid",je="navLink",Fe="navLinkClose",Ne="vrStarted",Ge="vrEnded",qe="vrState",Ze="menuToggle",We="chatMessage",Ke="chatTypingBegin",Xe="chatTypingEnd",Ye="selectItem",Je="virtual-tour",Qe="live-meeting",tn="self-service-tour",en="embed",nn="none",on=function(t){Object.assign(this,t)},rn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),sn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),an=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),ln=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),cn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),un=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),dn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(on),hn=function(){function t(){}return t.http$=function(t,e,o,r){var s=this,a=null;return n.from(fetch(e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:-1!==["POST","PUT","PATCH"].indexOf(t)?JSON.stringify(o):void 0}).then((function(t){a=t;try{var e,n=t.headers.get("content-type");return e=n&&-1!==n.indexOf("application/json")?t.json():t.text(),t.ok?e:e.then((function(t){return Promise.reject(t)}))}catch(e){return t.ok?(console.warn("HttpService.http$","Cannot parse response"),Promise.resolve()):Promise.reject(e)}}))).pipe(i.catchError((function(t){return n.throwError(s.getError(t,a))})))},t.get$=function(t,e,n){var i=this.query(e);return this.http$("GET",""+t+i,void 0,n)},t.delete$=function(t){return this.http$("DELETE",t)},t.post$=function(t,e){return this.http$("POST",t,e)},t.put$=function(t,e){return this.http$("PUT",t,e)},t.patch$=function(t,e){return this.http$("PATCH",t,e)},t.query=function(t){return""},t.getError=function(t,e){var n="object"==typeof t?t:{};return n.status||(n.status=e?e.status:0),n.statusCode||(n.statusCode=e?e.status:0),n.statusMessage||(n.statusMessage=e?e.statusText:t),n},t}(),pn=function(){function t(){}return t.setUser=function(t){this.user$.next(t)},t.me$=function(){var t=this;return hn.get$("/api/user/me").pipe(i.map((function(e){return t.mapUser(e)})),i.catchError((function(t){if(404===t.status||404===t.statusCode)return n.of(null);throw t})),i.switchMap((function(e){return t.setUser(e),t.user$})))},t.login$=function(t){var e=this;return hn.post$("/api/user/login",t).pipe(i.map((function(t){return e.mapUser(t)})),i.tap((function(t){return e.setUser(t)})))},t.logout$=function(){var t=this;return hn.get$("/api/user/logout").pipe(i.map((function(e){return t.mapUser(e)})),i.tap((function(e){return t.setUser(null)})))},t.guidedTour$=function(t){var e=this;return hn.post$("/api/user/guided-tour",t).pipe(i.map((function(t){return e.mapUser(t)})),i.tap((function(t){return e.setUser(t)})))},t.selfServiceTour$=function(t){var e=this;return hn.post$("/api/user/self-service-tour",t).pipe(i.map((function(t){return e.mapUser(t)})),i.tap((function(t){return e.setUser(t)})))},t.selfServiceSupportRequest$=function(t,e,n){var o={user:t,meetingId:e,link:n};return hn.post$("/api/user/self-service-support-request",o).pipe(i.tap((function(e){E.flags.production||fetch(E.template.email.supportRequest).then((function(t){return t.text()})).then((function(e){e=(e=e.replace("{{username}}",$.getName(t))).replace("{{href}}",n);var i=(new DOMParser).parseFromString(e,"text/html");setTimeout((function(){var t=window.open();t.document.head.innerHTML=i.querySelector("head").innerHTML,t.document.body.innerHTML=i.querySelector("body").innerHTML}),3e3)}))})))},t.resolve$=function(t,e){return"login"===e?this.login$(t):"guided-tour"===e?this.guidedTour$(t):"self-service-tour"===e?this.selfServiceTour$(t):void 0},t.log$=function(t){return hn.post$("/api/user/log",t)},t.temporaryUser$=function(t){var e=this;return void 0===t&&(t=I.Embed),n.of({id:this.uuid(),type:t,username:t,firstName:"Jhon",lastName:"Appleseed"}).pipe(i.map((function(t){return e.mapUser(t)})),i.switchMap((function(t){return e.setUser(t),e.user$})))},t.uuid=function(){return(new Date).getTime()},t.mapUser=function(t){return new R(t)},t.getMode=function(t){var e;switch(t){case I.Publisher:case I.Attendee:case I.Streamer:case I.Viewer:case I.Publisher:case I.Publisher:e=Je;break;case I.SelfService:e=tn;break;case I.SmartDevice:e=Qe;break;case I.Embed:e=en;break;default:e=nn}return e},t}();pn.user$=new n.BehaviorSubject(null);var vn=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){console.log("AccessComponent.onInit"),this.state={status:"access"}},o.onSelfServiceTourRequest=function(){this.initRequestForm(),this.state.status="self-service-tour",this.pushChanges(),y&&-1!==window.navigator.userAgent.indexOf("OculusBrowser")&&(this.test(),this.onSubmit())},o.onGuidedTourRequest=function(){this.initRequestForm(),this.state.status="guided-tour",this.pushChanges()},o.onGuidedTourAccess=function(){pn.logout$().pipe(i.first()).subscribe((function(){Jt.setRouterLink("it.guidedTour")}))},o.onLogin=function(){this.initLoginForm(),this.state.status="login",this.pushChanges()},o.initRequestForm=function(){var t=this;this.formSubscription&&this.formSubscription.unsubscribe();this.data=window.data||{roles:[{id:1,name:"Show room"},{id:2,name:"Architetto"},{id:3,name:"Interior designer"},{id:4,name:"Privato"},{id:5,name:"Altro"}]};var e=this.fields=window.fields||[{type:"text",name:"firstName",label:"access_first_name",required:!0,test:"Jhon"},{type:"text",name:"lastName",label:"access_last_name",required:!0,test:"Appleseed"},{type:"email",name:"email",label:"access_email",required:!0,test:"jhonappleseed@gmail.com"},{type:"custom-select",name:"role",label:"access_role",required:!0,options:window.data.roles,test:window.data.roles[0].id},{type:"checkbox",name:"privacy",label:"access_privacy_disclaimer",required:!0,test:!0}];e.push({type:"hidden",name:"checkField",value:"",test:""},{type:"none",name:"checkRequest",value:window.antiforgery||"",test:window.antiforgery||""});var n=this.form=ee(e);this.controls=n.controls;this.formSubscription=n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pushChanges()})),this.error=null},o.initLoginForm=function(){var t=this;this.formSubscription&&this.formSubscription.unsubscribe();var n=this.form=new e.FormGroup({username:new e.FormControl(null,e.Validators.RequiredValidator()),password:new e.FormControl(null,e.Validators.RequiredValidator()),checkRequest:window.antiforgery||"",checkField:""});this.controls=n.controls;this.formSubscription=n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pushChanges()})),this.error=null},o.test=function(){var t,e,n;"login"===this.state.status?this.form.patch({username:"publisher",password:"publisher",checkRequest:window.antiforgery||"",checkField:""}):(t=this.fields,e=this.form,n=t.reduce((function(t,e,n){return e.test&&(t[e.name]=e.test),t}),{}),e.patch(n))},o.reset=function(){this.form.reset()},o.onBack=function(){this.state.status="access",this.pushChanges()},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n=this.state.status;pn.resolve$(e,n).pipe(i.first()).subscribe((function(e){switch(n){case"guided-tour":t.state.status="guided-tour-success",t.pushChanges();break;case"self-service-tour":Jt.setRouterLink("it.selfServiceTour");break;case"login":Jt.setRouterLink("it.guidedTour")}t.form.reset()}),(function(e){console.log("AccessComponent.error",e),t.error=e,t.pushChanges()}))}else this.form.touched=!0},o.isValid=function(){var t=this.form.valid;return t},n}(t.Component);vn.meta={selector:"[access-component]",template:'\n\t\t<div class="page">\n\t\t\t\x3c!-- background --\x3e\n\t\t\t<div class="background" [class]="{ \'background--image\': (\'background.image\' | env), \'background--video\': (\'background.video\' | env) }" *if="state.status != \'connected\'">\n\t\t\t\t<img [src]="\'background.image\' | env" *if="\'background.image\' | env" />\n\t\t\t\t<video [src]="\'background.video\' | env" *if="\'background.video\' | env" oncanplay="this.muted = true; this.classList.add(\'ready\');" playsinline autoplay muted loop></video>\n\t\t\t</div>\n\t\t\t\x3c!-- access --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'access\'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'access_title\' | label"></div>\n\t\t\t\t\t\t<div *if="\'selfService\' | flag">\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onSelfServiceTourRequest($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="\'access_tour\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="\'access_or\' | label"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div *if="\'guidedTourRequest\' | flag">\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onGuidedTourRequest($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="\'access_guided_tour\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="\'access_has_meeting_id\' | label"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onGuidedTourAccess($event)">\n\t\t\t\t\t\t\t<span [innerHTML]="\'access_guided_tour_cta\' | label"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button type="button" class="btn--absolute" (click)="onLogin($event)">\n\t\t\t\t\t<span [innerHTML]="\'access_cta\' | label"></span> <svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t\x3c!-- guided-tour --\x3e\n\t\t\t<div class="ui ui--info" *if="state.status == \'self-service-tour\' || state.status == \'guided-tour\'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t\t<div class="title" *if="state.status == \'self-service-tour\'" [innerHTML]="\'access_fill_fields\' | label"></div>\n\t\t\t\t\t\t\t<div class="title" *if="state.status == \'guided-tour\'" [innerHTML]="\'access_guided_tour_request\' | label"></div>\n\t\t\t\t\t\t\t\x3c!-- controls --\x3e\n\t\t\t\t\t\t\t<div controls [formGroup]="form" [fields]="fields"></div>\n\t\t\t\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'access_take_part\' | label"></div>\n\t\t\t\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t\t\t\t<span *if="!form.submitted" [innerHTML]="\'access_send\' | label"></span>\n\t\t\t\t\t\t\t\t<span *if="form.submitted" [innerHTML]="\'access_sent\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t\t<span [innerHTML]="\'access_back\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- guided-tour success --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'guided-tour-success\'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'access_request_sent\' | label"></div>\n\t\t\t\t\t\t<div class="info" [innerHTML]="\'access_info_request\' | label"></div>\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t<span [innerHTML]="\'access_back\' | label"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- login --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'login\'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t\t<div class="title" [innerHTML]="\'access_login\' | label"></div>\n\t\t\t\t\t\t\t<input name="checkField" [formControl]="controls.checkField" value="" type="text" style="display:none !important;" />\n\t\t\t\t\t\t\t<div control-text [control]="controls.username" [label]="\'access_username\' | label"></div>\n\t\t\t\t\t\t\t<div control-password [control]="controls.password" [label]="\'access_password\' | label"></div>\n\t\t\t\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'access_cta\' | label"></div>\n\t\t\t\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t\t\t\t<span [innerHTML]="\'access_cta\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t\t<span [innerHTML]="\'access_back\' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="btn--logo" (click)="onBack($event)">\n\t\t\t\t<img [src]="\'logo\' | env" *if="\'logo\' | env" />\n\t\t\t\t<svg viewBox="0 0 270 98" *if="!(\'logo\' | env)"><use xlink:href="#b-here"></use></svg>\n\t\t\t</div>\n\t\t\t\x3c!-- credits --\x3e\n\t\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener" *if="state.status != \'connected\'">\n\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t</a>\n\t\t\t\x3c!-- language --\x3e\n\t\t\t<div class="group--language" language (set)="pushChanges()" *if="state.status != \'connected\'"></div>\n\t\t</div>\n\t'};var mn=function(){function t(){}return t.emoji$=function(){return null!=t.items_?n.of(t.items_):hn.get$(E.assets+"api/emoji/emoji.json").pipe(i.map((function(e){return t.items_=e,e})))},t}(),fn=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.items=[],mn.emoji$().pipe(i.first()).subscribe((function(e){setTimeout((function(){t.items=e,t.pushChanges()}),1)}))},n.onSelect=function(t){this.emoji.next(t)},n.onClose=function(t){this.close.next()},e}(t.Component);fn.meta={selector:"[agora-chat-emoji]",outputs:["emoji","close"]};var gn=function(){function t(){}return t.message=function(t){this.message$.next(t)},t.in=function(t){this.in$.next(t)},t.sendBack=function(t){t=Object.assign({},t,{remoteId:t.clientId}),this.in$.next(t)},t.out=function(t){this.out$.next(t)},t}();c(gn,"message$",new n.ReplaySubject(1)),c(gn,"in$",new n.ReplaySubject(1)),c(gn,"send",gn.in),c(gn,"out$",new n.ReplaySubject(1));var bn="unknown",wn="ios",yn="android",xn="windowsPhone",Cn="vrHeadset",kn=function(){function t(){}return t.getDevicePlatform=function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(t)?xn:/android/i.test(t)?yn:this.isIOS?wn:this.isVRHeadset?Cn:bn},l(t,null,[{key:"platform",get:function(){return this.platform_||(this.platform_=this.getDevicePlatform()),this.platform_}},{key:"isIOS",get:function(){return-1!==["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].indexOf(navigator.platform)||-1!==navigator.userAgent.indexOf("Mac")&&"ontouchend"in document}},{key:"isVRHeadset",get:function(){return-1!==navigator.userAgent.indexOf("VR")||-1!==navigator.userAgent.indexOf("Quest")||-1!==navigator.userAgent.indexOf("Oculus")}}]),t}(),Mn=function(){function t(){this.events={}}var e=t.prototype;return e.on=function(t,e){var n=this,i=this.events[t]=this.events[t]||[];return i.push(e),function(){n.events[t]=i.filter((function(t){return t!==e}))}},e.off=function(t,e){var n=this.events[t];n&&(this.events[t]=n.filter((function(t){return t!==e})))},e.once=function(t,e){var n=this,i=function i(o){e(o),n.off(t,i)};this.on(t,i)},e.emit=function(t,e){var n=this.events[t];n&&n.forEach((function(t){t(e)}));var i=this.events.broadcast;i&&i.forEach((function(n){n(t,e)}))},e.has=function(t){var e=this.events[t];return e&&e.length},t}(),Sn=function(){function t(){}return t.delete=function(t){this.isSessionStorageSupported()&&window.sessionStorage.removeItem(t)},t.exist=function(t){if(this.isSessionStorageSupported())return void 0!==window.sessionStorage[t]},t.get=function(t){var e=null;if(this.isSessionStorageSupported()&&void 0!==window.sessionStorage[t])try{e=JSON.parse(window.sessionStorage[t])}catch(e){console.log("SessionStorageService.get.error parsing",t,e)}return e},t.set=function(t,e){if(this.isSessionStorageSupported())try{var n=[],i=JSON.stringify(e,(function(t,e){if("object"==typeof e&&null!==e){if(-1!==n.indexOf(e))return;n.push(e)}return e}));window.sessionStorage.setItem(t,i)}catch(n){console.log("SessionStorageService.set.error serializing",t,e,n)}},t.isSessionStorageSupported=function(){if(this.supported)return!0;var t=!1;try{(t="sessionStorage"in window&&null!==window.sessionStorage)?(window.sessionStorage.setItem("test","1"),window.sessionStorage.removeItem("test")):t=!1}catch(e){t=!1}return this.supported=t,t},t}(),Tn="client",En="editor",Ln=function(){function t(){}return t.orderedRemotes$=function(){return n.combineLatest([t.remotes$,n.interval(1e3)]).pipe(i.map((function(t){var e=[];return t[0].forEach((function(t){var n=null,i=null,o=null,r=0,s=0,a=0;t.clientInfo&&(r=t.clientInfo.audioLevel=t.getAudioLevel(),s=t.clientInfo.peekAudioLevel=Math.max(t.clientInfo.audioLevel,.2),a=t.clientInfo.order,n=t.clientInfo.role||null,i=t.clientInfo.uid||null,o=t.clientInfo.screenUid||null),e.push({role:n,uid:i,screenUid:o,audioLevel:r,peekAudioLevel:s,order:a,remote:t})})),e.sort((function(t,e){var n=t.role===I.Publisher?2:t.role===I.Attendee?1:0;return(e.role===I.Publisher?2:e.role===I.Attendee?1:0)-n||e.peekAudioLevel-t.peekAudioLevel||(t.order||0)-(e.order||0)})),e.forEach((function(t,e){t.remote.clientInfo&&(t.remote.clientInfo.order=e)})),e})),i.distinctUntilChanged((function(t,e){return t.map((function(t){return t.uid+"-"+t.screenUid})).join("|")===e.map((function(t){return t.uid+"-"+t.screenUid})).join("|")})),i.map((function(t){return t.map((function(t){return t.remote}))})))},t.getEditorStreams$=function(){var t=this;return n.of(null).pipe(i.switchMap((function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&t.mode===En){var e=document.querySelector("body"),n=document.createElement("div"),i=document.createElement("video");n.setAttribute("id","stream-editor"),n.setAttribute("style","position:absolute; top: 5000px; line-height: 0;"),n.appendChild(i),e.appendChild(n),navigator.mediaDevices.getUserMedia({video:{width:800,height:450}}).then((function(e){"srcObject"in i?i.srcObject=e:i.src=window.URL.createObjectURL(e),i.oncanplay=function(){var e={getId:function(){return"editor"},clientInfo:{role:I.Publisher,uid:"editor"}},n={getId:function(){return"editor"},clientInfo:{role:I.Attendee,uid:"editor"}},i={getId:function(){return"editor"},clientInfo:{role:I.SmartDevice,uid:"editor"}};t.editorStreams$.next([e,n,n,n,n,i])},i.play()})).catch((function(t){console.log("EditorComponent.getUserMedia.error",t.name,t.message)}))}return t.editorStreams$})),i.shareReplay(1))},t.getEditorScreens$=function(){var t=this;return n.of(null).pipe(i.switchMap((function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&t.mode===En){var e=document.querySelector("body"),n=document.createElement("div"),i=document.createElement("video");n.setAttribute("id","stream-editor-screen"),n.setAttribute("style","position:absolute; top: 5000px; line-height: 0;"),n.appendChild(i),e.appendChild(n),navigator.mediaDevices.getDisplayMedia({screen:{width:800,height:450}}).then((function(e){"srcObject"in i?i.srcObject=e:i.src=window.URL.createObjectURL(e),i.oncanplay=function(){var e={getId:function(){return"editor-screen"},clientInfo:{role:I.Publisher,uid:"editor",screenUid:"editor-screen"}},n={getId:function(){return"editor-screen"},clientInfo:{role:I.Attendee,uid:"editor",screenUid:"editor-screen"}};t.editorScreens$.next([e,n])},i.play()})).catch((function(t){console.log("EditorComponent.getUserMedia.error",t.name,t.message)}))}return t.editorScreens$})),i.shareReplay(1))},t.getPublisherStreamId$=function(){var t=this,e=this.publisherStreamId;return e?n.of(e):this.streams$.pipe(i.map((function(){return t.publisherStreamId})),i.filter((function(t){return t})))},t.getRemoteById=function(e){var n=t.remotes.find((function(t){return t.getId()===e}));if(n)return n},t.remoteAdd=function(t){var e=this.remotes.slice();e.push(t),this.remotes=e},t.remoteRemove=function(t){var e=this.remotes.slice(),n=e.find((function(e){return e.getId()===t}));return n&&(n.isPlaying()&&n.stop(),e.splice(e.indexOf(n),1),this.remotes=e),n},t.remoteSetClientInfo=function(t,e){var n=this.remotes,i=n.find((function(e){return e.getId()===t}));i&&(i.clientInfo=e),this.remotes=n},l(t,null,[{key:"editorStreams",set:function(t){this.editorStreams$.next(t)},get:function(){return this.editorStreams$.getValue()}},{key:"editorScreens",set:function(t){this.editorScreens$.next(t)},get:function(){return this.editorScreens$.getValue()}},{key:"local",set:function(t){this.local$.next(t)},get:function(){return this.local$.getValue()}},{key:"screen",set:function(t){this.screen$.next(t)},get:function(){return this.screen$.getValue()}},{key:"remotes",set:function(t){this.remotes$.next(t)},get:function(){return this.remotes$.getValue()}},{key:"peers",set:function(t){this.peers$.next(t)},get:function(){return this.peers$.getValue()}},{key:"publisherStreamId",get:function(){var t=this.remotes.slice(),e=this.local;e&&t.unshift(e);var n=t.find((function(t){return t.clientInfo&&t.clientInfo.role===I.Publisher&&t.clientInfo.uid===t.getId()}));return n?n.getId():null}}]),t}();c(Ln,"mode",Tn),c(Ln,"editorStreams$",new n.BehaviorSubject(null)),c(Ln,"editorScreens$",new n.BehaviorSubject(null)),c(Ln,"local$",new n.BehaviorSubject(null)),c(Ln,"screen$",new n.BehaviorSubject(null)),c(Ln,"remotes$",new n.BehaviorSubject([])),c(Ln,"peers$",new n.BehaviorSubject([])),c(Ln,"streams$",n.combineLatest([Ln.local$,Ln.screen$,Ln.remotes$,Ln.getEditorStreams$(),Ln.getEditorScreens$()]).pipe(i.map((function(t){var e,n,i=t[0],o=t[1],r=t[2],s=t[3],a=t[4],l=r;(i&&(l=l.slice()).push(i),o&&(l=l.slice()).push(o),s)&&(e=l).push.apply(e,s);a&&(n=l).push.apply(n,a);return l})),i.shareReplay(1)));var _n=function(t){function e(n){var i;if(e.AGORA)throw"AgoraService is a singleton";c(h(i=t.call(this)||this),"previousMuteAudio_",!1),i.onStreamPublished=i.onStreamPublished.bind(h(i)),i.onStreamUnpublished=i.onStreamUnpublished.bind(h(i)),i.onStreamAdded=i.onStreamAdded.bind(h(i)),i.onStreamRemoved=i.onStreamRemoved.bind(h(i)),i.onStreamSubscribed=i.onStreamSubscribed.bind(h(i)),i.onMuteVideo=i.onMuteVideo.bind(h(i)),i.onUnmuteVideo=i.onUnmuteVideo.bind(h(i)),i.onMuteAudio=i.onMuteAudio.bind(h(i)),i.onUnmuteAudio=i.onUnmuteAudio.bind(h(i)),i.onVolumeIndicator=i.onVolumeIndicator.bind(h(i)),i.onPeerConnect=i.onPeerConnect.bind(h(i)),i.onPeerLeaved=i.onPeerLeaved.bind(h(i)),i.onConnectionStateChange=i.onConnectionStateChange.bind(h(i)),i.onTokenPrivilegeWillExpire=i.onTokenPrivilegeWillExpire.bind(h(i)),i.onTokenPrivilegeDidExpire=i.onTokenPrivilegeDidExpire.bind(h(i)),i.onMessage=i.onMessage.bind(h(i));var o=_.state;return _.patchState({devices:o.role!==I.Attendee&&n?n:{videos:[],audios:[]},quality:ie(o),membersCount:0}),i}d(e,t),e.getSingleton=function(t){if(!g)return this.AGORA||(this.AGORA=new e(t)),this.AGORA};var o=e.prototype;return o.addStreamDevice=function(t){this.removeStreamDevice();var e={deviceId:"video-stream",label:"videostream",kind:"videostream",src:t},n={deviceId:"audio-stream",label:"videostream",kind:"videostream",src:t},i=_.state.devices;i.videos.push(e),i.audios.push(n),_.patchState({devices:i})},o.removeStreamDevice=function(){var t=_.state.devices;t.videos=t.videos.filter((function(t){return"videostream"!==t.kind})),t.audios=t.audios.filter((function(t){return"videostream"!==t.kind})),_.patchState({devices:t})},o.devices$=function(){var t=_.state.devices,i=this.defaultVideos=this.defaultVideos||t.videos.slice(),o=this.defaultAudios=this.defaultAudios||t.videos.slice();return t.videos=i.slice(),t.audios=o.slice(),n.from(new Promise((function(n,i){var o=function(){e.getDevices().then((function(e){r.close();for(var o=0;o<e.length;o++){var s=e[o];"videoinput"===s.kind&&s.deviceId&&t.videos.push({label:s.label||"camera-"+t.videos.length,deviceId:s.deviceId,kind:s.kind}),"audioinput"===s.kind&&s.deviceId&&t.audios.push({label:s.label||"microphone-"+t.audios.length,deviceId:s.deviceId,kind:s.kind})}t.videos.length>0||t.audios.length>0?n(t):i(t)})).catch((function(t){i(t)}))},r=AgoraRTC.createStream({audio:!0,video:!0});r.init((function(){o()}),(function(){o()}))})))},o.connect$=function(t){var n=this,i=_.state.devices;return t&&(i.video=t.video,i.audio=t.audio),_.state.connecting||(_.patchState({status:de,connecting:!0,devices:i}),setTimeout((function(){n.createClient((function(){var t=n.getChannelNameLink();e.rtcToken$(t).subscribe((function(e){n.join(e.token,t)}))}))}),250)),_.state$},o.membersCount$=function(t){var e=this.messageClient;return n.interval(2e3).pipe(i.switchMap((function(){return n.from(e.getChannelMemberCount([t]))})),i.map((function(e){return e[t]})),i.distinctUntilChanged())},o.observeMemberCount=function(){this.unobserveMemberCount(),this.membersCountSubscription=this.membersCount$(_.state.channelNameLink).subscribe((function(t){_.patchState({membersCount:t})}))},o.unobserveMemberCount=function(){this.membersCountSubscription&&(this.membersCountSubscription.unsubscribe(),this.membersCountSubscription=null,_.patchState({membersCount:0}))},o.createClient=function(t){var e=this;this.client&&t(),AgoraRTC.Logger.setLogLevel(AgoraRTC.Logger.NONE);var n=this.client=AgoraRTC.createClient({mode:"live",codec:"h264"}),i=function(){E.flags.useProxy&&(n.startProxyServer(3),console.log("AgoraService.client.startProxyServer")),n.init(E.appKey,(function(){t()}),(function(t){e.client=null}))};this.isAudienceRole?n.setClientRole("audience",(function(t){t||i()})):i(),n.on("error",this.onError),n.on("stream-published",this.onStreamPublished),n.on("stream-unpublished",this.onStreamUnpublished),n.on("stream-added",this.onStreamAdded),n.on("stream-removed",this.onStreamRemoved),n.on("stream-subscribed",this.onStreamSubscribed),n.on("mute-video",this.onMuteVideo),n.on("unmute-video",this.onUnmuteVideo),n.on("mute-audio",this.onMuteAudio),n.on("unmute-audio",this.onUnmuteAudio),n.on("peer-online",this.onPeerConnect),n.on("peer-leave",this.onPeerLeaved),n.on("onTokenPrivilegeWillExpire",this.onTokenPrivilegeWillExpire),n.on("onTokenPrivilegeDidExpire",this.onTokenPrivilegeDidExpire),(this.messageClient=AgoraRTM.createInstance(E.appKey,{logFilter:AgoraRTM.LOG_FILTER_OFF})).setParameters({logFilter:AgoraRTM.LOG_FILTER_OFF})},o.getChannelNameLink=function(){var t=_.state.link||"",e=t.match(/(\d{9})-(\d{4})-(\d{13})/);return e&&(t=e[1]+"-"+e[3]),_.state.channelName+"-"+t},e.getUniqueUserId=function(){return(1e13*(100*(1+Math.floor(8*Math.random()))+10*(1+Math.floor(8*Math.random()))+1*(1+Math.floor(8*Math.random())))+Date.now()).toString()},o.join=function(t,n){var i=this;this.channel=null;var o=this.client,r=Sn.get("bHereClientId")||e.getUniqueUserId();o.join(t,n,r,(function(t){_.patchState({status:he,channelNameLink:n,connected:!0,uid:t}),Sn.set("bHereClientId",t),e.rtmToken$(t).subscribe((function(e){i.joinMessageChannel(e.token,t).then((function(e){i.isAudienceRole||i.autoDetectDevice().then((function(e){i.createMediaStream(t,e.video,e.audio)})),i.observeMemberCount()}),(function(t){console.log("joinMessageChannel.error",t)}))}))}),(function(t){console.log("AgoraService.join.error",t),"DYNAMIC_KEY_EXPIRED"===t&&e.rtcToken$(n).subscribe((function(t){i.join(t.token,n)}))}))},o.joinMessageChannel=function(t,e){var n,i=this;return new Promise((function(o,r){var s=i.messageClient;s.login({token:t,uid:e.toString()}).then((function(){return(n=s.createChannel(_.state.channelNameLink)).join()})).then((function(){i.channel=n,n.on("ChannelMessage",i.onMessage),i.emit("channel",n),o(e),n.getMembers().then((function(t){t=t.filter((function(t){return t!==e.toString()}));var n={type:ve,members:t};i.broadcastMessage(n)}))})).catch(r)}))},o.detectDevices=function(t){e.getDevices().then((function(e){for(var n=[],i=[],o=0;o<e.length;o++){var r=e[o];"videoinput"==r.kind&&n.push({label:r.label||"camera-"+n.length,deviceId:r.deviceId,kind:r.kind}),"audioinput"==r.kind&&i.push({label:r.label||"microphone-"+n.length,deviceId:r.deviceId,kind:r.kind})}t({videos:n,audios:i})})).catch((function(t){console.log("AgoraService.detectDevices",t)}))},o.getVideoOptions=function(t,e){return new Promise((function(n,i){if(e)if("videostream"===e.kind){var o=document.querySelector("#"+e.deviceId);o.crossOrigin="anonymous";var r=new Hls;r.attachMedia(o),r.on(Hls.Events.MEDIA_ATTACHED,(function(){r.loadSource(e.src),r.on(Hls.Events.MANIFEST_PARSED,(function(e,i){o.play().then((function(e){var i=o.captureStream();t.videoSource=i.getVideoTracks()[0],n(t)}),(function(t){console.log("AgoraService.getVideoOptions.error",t)}))}))}))}else if("videoplayer"===e.kind||"videostream"===e.kind){var s=document.querySelector("#"+e.deviceId);s.crossOrigin="anonymous";var a=s.captureStream();t.videoSource=a.getVideoTracks()[0],n(t)}else t.cameraId=e.deviceId,n(t);else n(t)}))},o.getAudioOptions=function(t,e){return new Promise((function(n,i){if(e)if("videostream"===e.kind){var o=document.querySelector("#"+e.deviceId);o.crossOrigin="anonymous";var r=new Hls;r.attachMedia(o),r.on(Hls.Events.MEDIA_ATTACHED,(function(){r.loadSource(e.src),r.on(Hls.Events.MANIFEST_PARSED,(function(e,i){r.loadLevel=i.levels.length-1,o.play().then((function(e){var i=o.captureStream();t.audioSource=i.getAudioTracks()[0],n(t)}),(function(t){console.log("AgoraService.getAudioOptions.error",t)}))}))}))}else if("videoplayer"===e.kind||"videostream"===e.kind){var s=document.querySelector("#"+e.deviceId);s.crossOrigin="anonymous";var a=s.captureStream();t.audioSource=a.getAudioTracks()[0],n(t)}else t.microphoneId=e.deviceId,n(t);else n(t)}))},o.autoDetectDevice=function(){return new Promise((function(t,n){var i=_.state;i.role===I.SmartDevice?e.getDevices().then((function(e){var n={videos:[],audios:[],video:null,audio:null};e.forEach((function(t){"videoinput"===t.kind?n.videos.push(t):"audioinput"===t.kind&&n.audios.push(t)})),n.video=n.videos[0]||null,n.audio=n.audios[0]||null,_.patchState({devices:n}),t(n)})).catch((function(t){n(t)})):t(i.devices)}))},o.createMediaStream=function(t,e,n){var i=this,o={streamID:t,video:Boolean(e),audio:Boolean(n),screen:!1};Promise.all([this.getVideoOptions(o,e),this.getAudioOptions(o,n)]).then((function(t){var e=Object.assign({},_.state.quality);i.createLocalStreamWithOptions(o,e)}))},o.createLocalStreamWithOptions=function(t,e){var n=this,i=AgoraRTC.createStream(t);e&&i.setVideoProfile(e.profile),i.init((function(){Ln.local=i,setTimeout((function(){n.publishLocalStream()}),1)}),(function(t){console.log("AgoraService.initLocalStream.init.error",t)}))},o.initLocalStream=function(){var t=this;Ln.local.init((function(){t.publishLocalStream()}),(function(t){console.log("AgoraService.initLocalStream.init.error",t)}))},o.publishLocalStream=function(){var t=this.client,e=Ln.local;t.publish(e,(function(t){console.log("AgoraService.publishLocalStream.error",e.getId(),t)})),e.clientInfo={role:_.state.role,name:_.state.name,uid:_.state.uid,screenUid:_.state.screenUid},Ln.local=e},o.unpublishLocalStream=function(){var t=this.client,e=Ln.local;e&&t.unpublish(e,(function(t){console.log("AgoraService.unpublishLocalStream.error",e.getId(),t)})),Ln.local=null},o.leaveChannel=function(){var t=this;return _.patchState({connecting:!1}),this.unpublishLocalStream(),this.unpublishScreenStream(),Ln.remotes=[],Ln.peers=[],new Promise((function(e,n){t.leaveMessageChannel().then((function(){Promise.all([t.leaveClient(),t.leaveScreenClient()]).then((function(){e()})).catch((function(t){n(t)}))})).catch((function(t){n(t)}))}))},o.leaveClient=function(){var t=this;return new Promise((function(e,n){var i=t.client;i?i.leave((function(){t.client=null,E.flags.useProxy&&(i.stopProxyServer(),console.log("AgoraService.client.stopProxyServer")),e()}),(function(t){console.log("AgoraService.leaveClient.error",t),n(t)})):e()}))},o.leaveMessageChannel=function(){var t=this;return new Promise((function(e,n){t.unobserveMemberCount();var i=t.channel;if(!i)return e();var o=t.messageClient;i.leave().then((function(){t.channel=null,o.logout().then((function(){t.messageClient=null,e()}),n)}),n)}))},o.toggleCamera=function(){var t=Ln.local;t&&t.video&&(t.userMuteVideo?(t.unmuteVideo(),_.patchState({cameraMuted:!1}),this.broadcastEvent(new ln({streamId:t.getId()}))):(t.muteVideo(),_.patchState({cameraMuted:!0}),this.broadcastEvent(new an({streamId:t.getId()}))))},o.toggleAudio=function(){var t=Ln.local;t&&t.audio&&(t.userMuteAudio?(t.unmuteAudio(),_.patchState({audioMuted:!1}),this.broadcastEvent(new un({streamId:t.getId()}))):(t.muteAudio(),_.patchState({audioMuted:!0}),this.broadcastEvent(new cn({streamId:t.getId()}))))},o.setAudio=function(t){var e=Ln.local;e&&e.audio&&(t?(this.previousMuteAudio_=e.userMuteAudio,e.userMuteAudio||(e.muteAudio(),_.patchState({audioMuted:!0}),this.broadcastEvent(new cn({streamId:e.getId()})))):e.userMuteAudio&&!this.previousMuteAudio_&&(e.unmuteAudio(),_.patchState({audioMuted:!1}),this.broadcastEvent(new un({streamId:e.getId()}))))},o.toggleMode=function(){var t=_.state.mode===Je?Qe:Je;_.patchState({mode:t}),gn.send({type:De,mode:t})},o.toggleNavInfo=function(){var t=!_.state.showNavInfo;_.patchState({showNavInfo:t}),gn.send({type:Ue,showNavInfo:t})},o.dismissControl=function(){var t=this;return new Promise((function(e,n){var i=_.state.controlling;i?t.sendRemoteControlDismiss(i).then((function(){_.patchState({controlling:!1}),e(i)})):e(!1)}))},o.requestControl=function(t){var e=this;return new Promise((function(n,i){e.sendRemoteControlRequest(t).then((function(t){_.patchState({controlling:t}),n(t)}))}))},o.toggleControl=function(t){var e=this;this.dismissSpy().then((function(){e.dismissControl().then((function(n){n!==t&&e.requestControl(t).then((function(t){}))}))}))},o.toggleSilence=function(){var t=!_.state.silencing;this.sendMessage({type:Ie,silencing:t}),_.patchState({silencing:t})},o.dismissSpy=function(){var t=this;return new Promise((function(e,n){var i=_.state.spying;i?t.sendRemoteSpyDismiss(i).then((function(){_.patchState({spying:!1}),e(i)})):e(!1)}))},o.requestSpy=function(t){var e=this;return new Promise((function(n,i){e.sendSpyRemoteRequestInfo(t).then((function(){_.patchState({spying:t}),n(t)}))}))},o.toggleSpy=function(t){var e=this;this.dismissControl().then((function(){e.dismissSpy().then((function(n){n!==t&&e.requestSpy(t).then((function(t){console.log("AgoraService.toggleSpy",t)}))}))}))},o.sendRemoteRequestPeerInfo=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:ke,messageId:e.newMessageId(),remoteId:t}).then((function(t){if(t.type===Me){if(t.clientInfo.role===I.Publisher){var i={hosted:!0};t.clientInfo.controllingId&&(i.controlling=t.clientInfo.controllingId,i.mode=t.clientInfo.mode,e.sendControlRemoteRequestInfo(t.clientInfo.controllingId)),_.patchState(i)}n(t)}}))}))},o.sendRemoteControlRequest=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:be,messageId:e.newMessageId(),controllingId:t}).then((function(e){e.type===we?n(t):e.type===ye&&n(!1)}))}))},o.sendRemoteControlDismiss=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:xe,messageId:e.newMessageId(),controllingId:t}).then((function(e){e.type===Ce?n(t):e.type===ye&&n(!1)}))}))},o.sendControlRemoteRequestInfo=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:Se,messageId:e.newMessageId(),remoteId:t}).then((function(e){e.type===Te&&(_.patchState({controlling:t}),n(e))}))}))},o.sendSpyRemoteRequestInfo=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:Se,messageId:e.newMessageId(),remoteId:t}).then((function(e){e.type===Te&&(_.patchState({spying:t}),n(e))}))}))},o.sendRemoteSpyDismiss=function(t){var e=this;return new Promise((function(n,i){e.sendMessage({type:Ee,messageId:e.newMessageId(),remoteId:t}).then((function(e){e.type===Le?n(t):e.type===_e&&n(!1)}))}))},o.newMessageId=function(){return _.state.uid+"-"+Date.now().toString()},o.navToView=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),_.state.controlling!==_.state.uid&&_.state.spying!==_.state.uid||this.sendMessage({type:Ve,viewId:t,keepOrientation:e,useLastOrientation:n})},o.getSessionStats=function(){this.client.getSessionStats((function(t){console.log("Current Session Duration: "+t.Duration),console.log("Current Session UserCount: "+t.UserCount),console.log("Current Session SendBytes: "+t.SendBytes),console.log("Current Session RecvBytes: "+t.RecvBytes),console.log("Current Session SendBitrate: "+t.SendBitrate),console.log("Current Session RecvBitrate: "+t.RecvBitrate)}))},o.getSystemStats=function(){this.client.getSystemStats((function(t){console.log("Current battery level: "+t.BatteryLevel)}))},o.sendMessage=function(t){var e=this;return new Promise((function(n,i){if(_.state.connected){switch(t.clientId=_.state.uid,t.type){case Re:case ze:case Pe:case $e:case He:case Oe:case Be:case De:case Ue:case je:case Fe:if(_.state.controlling!==_.state.uid&&_.state.spying!==_.state.uid)return}var o=function(t,i){try{var o=JSON.stringify(t);t.messageId&&e.once("message-"+t.messageId,(function(t){n(t)})),i.sendMessage({text:o}).then((function(){t.messageId||n(t)})).catch((function(t){console.log("AgoraService.sendMessage.error",t)}))}catch(t){console.log("AgoraService.sendMessage.error",t)}},r=e.channel;if(r)o(t,r);else try{e.once("channel",(function(e){o(t,e)}))}catch(t){i(t)}}}))},o.addOrUpdateChannelAttributes=function(t){var e=this.messageClient;if(e){var i={};if(t.forEach((function(t){var e=t.date.toString();i[e]=JSON.stringify(t)})),Object.keys(i).length){var o=e.addOrUpdateChannelAttributes(_.state.channelNameLink,i,{enableNotificationToChannelMembers:!1});return n.from(o)}return n.of(null)}return n.of(null)},o.getChannelAttributes=function(){var t=this.messageClient;if(t){var e=t.getChannelAttributes(_.state.channelNameLink);return n.from(e).pipe(i.map((function(t){return Object.keys(t).map((function(e){return t[e]}))})),i.map((function(t){return t.sort((function(t,e){return t.lastUpdateTs-e.lastUpdateTs})),t.map((function(t){return JSON.parse(t.value)}))})))}return n.of(null)},o.checkBroadcastMessage=function(t){switch(t.type){case xe:_.patchState({controlling:!1}),t.controllingId===_.state.uid&&this.unpublishScreenStream(),this.sendMessage({type:Ce,messageId:t.messageId});break;case Ee:_.patchState({spying:!1}),this.sendMessage({type:Le,messageId:t.messageId,remoteId:t.remoteId});break;case Te:(_.state.role===I.Publisher||_.state.controlling&&_.state.controlling!==_.state.uid)&&this.broadcastMessage(t);break;case Ie:_.state.role===I.Streamer&&this.broadcastMessage(t);break;case Re:case Pe:case $e:case He:case Oe:case Be:case De:case Ue:case Ve:case ze:case je:case Fe:(_.state.controlling&&_.state.controlling!==_.state.uid||_.state.spying&&_.state.spying!==_.state.uid)&&this.broadcastMessage(t);break;default:this.broadcastMessage(t)}},o.broadcastMessage=function(t){gn.out(t)},o.broadcastEvent=function(t){gn.out({type:pe,event:t})},o.onMessage=function(t,e){if(e!==_.state.uid){var n=JSON.parse(t.text);if(n.messageId&&this.has("message-"+n.messageId)&&this.emit("message-"+n.messageId,n),n.remoteId&&n.remoteId!==_.state.uid&&n.remoteId!==_.state.screenUid)return;if(n.type===Ne){var i=document.createElement("div");i.classList.add("player__vr"),n.container=i}this.checkBroadcastMessage(n)}},o.onError=function(t){console.log("AgoraService.onError",t)},o.onStreamPublished=function(t){var e=Ln.local;e.clientInfo={role:_.state.role,name:_.state.name,uid:_.state.uid,screenUid:_.state.screenUid},Ln.local=e},o.onStreamUnpublished=function(t){Ln.local=null},o.onStreamAdded=function(t){var e=this.client,n=t.stream;if(n){var i=n.getId();i!==_.state.uid&&i!==_.state.screenUid&&e.subscribe(n,(function(t){console.log("AgoraService.onStreamAdded.subscribe.error",t)}))}},o.onStreamRemoved=function(t){var e=t.stream.getId();e!==_.state.uid&&e!==_.state.screenUid&&this.remoteRemove(e)},o.onStreamSubscribed=function(t){this.remoteAdd(t.stream)},o.onPeerConnect=function(t){this.peerAdd(t)},o.onPeerLeaved=function(t){var e=t.uid;if(e!==_.state.uid){var n=this.remoteRemove(e);n.clientInfo&&(n.clientInfo.role===I.Publisher?_.state.role===I.SelfService?_.patchState({hosted:!0,controlling:!1,spying:!1,silencing:!1}):_.patchState({hosted:!1,controlling:!1,spying:!1,silencing:!1}):(_.state.controlling===e&&_.patchState({controlling:!1}),_.state.spying===e&&_.patchState({spying:!1})))}this.peerRemove(e)},o.peerAdd=function(t){var e={uid:t.uid},n=Ln.peers;n.push(e),Ln.peers=n,this.broadcastEvent(new rn({peer:e}))},o.peerRemove=function(t){var e=Ln.peers,n=e.find((function(e){return e.uid===t}));n&&(e.splice(e.indexOf(n),1),Ln.peers=e)},o.remoteAdd=function(t){Ln.remoteAdd(t),this.broadcastEvent(new sn({stream:t}));var e=t.getId();this.sendRemoteRequestPeerInfo(e).then((function(t){Ln.remoteSetClientInfo(e,t.clientInfo)}))},o.remoteRemove=function(t){var e=Ln.remoteRemove(t);return e&&e.clientInfo&&e.clientInfo.role===I.Publisher&&e.clientInfo.screenUid!==t&&_.patchState({hosted:!1}),e},o.onMuteVideo=function(t){this.broadcastEvent(new an({streamId:t.uid}))},o.onUnmuteVideo=function(t){this.broadcastEvent(new ln({streamId:t.uid}))},o.onMuteAudio=function(t){this.broadcastEvent(new cn({streamId:t.uid}))},o.onUnmuteAudio=function(t){this.broadcastEvent(new un({streamId:t.uid}))},o.onVolumeIndicator=function(t){var e=t.attr.map((function(t){return{streamId:t.uid,level:t.level}}));this.broadcastEvent(new dn({streams:e}))},o.onConnectionStateChange=function(t){console.log("AgoraService.onConnectionStateChange",t)},o.onTokenPrivilegeWillExpire=function(t){console.log("AgoraService.onTokenPrivilegeWillExpire");var n=this.client,i=this.getChannelNameLink();e.rtcToken$(i).subscribe((function(t){t.token&&(n.renewToken(t.token),console.log("AgoraService.onTokenPrivilegeWillExpire.renewed"))}))},o.onTokenPrivilegeDidExpire=function(t){console.log("AgoraService.onTokenPrivilegeDidExpire");var n=this.client,i=this.getChannelNameLink();e.rtcToken$(i).subscribe((function(t){t.token&&(n.renewToken(t.token),console.log("AgoraService.onTokenPrivilegeDidExpire.renewed"))}))},o.toggleScreen=function(){var t=this;Ln.screen?this.unpublishScreenStream():this.screenClient?this.createScreenStream(_.state.screenUid):this.createScreenClient((function(){var n=t.getChannelNameLink();e.rtcToken$(n).subscribe((function(e){t.screenJoin(e.token,n)}))}))},o.createScreenClient=function(t){var e=this;this.screenClient&&t();var n=this.screenClient=AgoraRTC.createClient({mode:"live",codec:"h264"});E.flags.useProxy&&(n.startProxyServer(3),console.log("AgoraService.screenClient.startProxyServer")),n.init(E.appKey,(function(){t()}),(function(t){e.screenClient=null})),n.on("error",this.onScreenError),n.on("stream-published",this.onScreenStreamPublished),n.on("stream-unpublished",this.onScreenStreamUnpublished)},o.screenJoin=function(t,n){var i=this,o=this.screenClient,r=e.getUniqueUserId();o.join(t,n,r,(function(t){_.patchState({screenUid:t}),i.createScreenStream(t)}),(function(t){console.log("AgoraService.screenJoin.error",t),"DYNAMIC_KEY_EXPIRED"===t&&e.rtcToken$(n).subscribe((function(t){i.screenJoin(t.token,n)}))}))},o.createScreenStream=function(t){var e=this,n={streamID:t,audio:!1,video:!1,screen:!0},i=AgoraRTC.createStream(n);i.setScreenProfile(E.profiles.screen),console.log("AgoraService.createScreenStream",n);var o=function(){e.unpublishScreenStream()};i.init((function(){Ln.screen=i,i.on("stopScreenSharing",o),i.muteAudio(),setTimeout((function(){e.publishScreenStream()}),1)}),(function(t){console.log("AgoraService.createScreenStream.screen.init.error",t)}))},o.publishScreenStream=function(){var t=this.screenClient,e=Ln.screen;t.publish(e,(function(t){console.log("AgoraService.publishScreenStream.error",e.getId(),t)})),e.clientInfo={role:_.state.role,name:_.state.name,uid:_.state.uid,screenUid:_.state.screenUid},Ln.screen=e},o.unpublishScreenStream=function(){var t=this.screenClient,e=Ln.screen;t&&e&&t.unpublish(e,(function(t){console.log("AgoraService.unpublishScreenStream.error",e.getId(),t)})),Ln.screen=null},o.leaveScreenClient=function(){var t=this;return new Promise((function(e,n){var i=t.screenClient;i?i.leave((function(){t.screenClient=null,E.flags.useProxy&&(i.stopProxyServer(),console.log("AgoraService.screenClient.stopProxyServer")),e()}),(function(t){console.log("AgoraService.leaveScreenClient.error",t),n(t)})):e()}))},o.onScreenError=function(t){console.log("AgoraService.onScreenError",t)},o.onScreenStreamPublished=function(t){var e=Ln.screen;e.clientInfo={role:_.state.role,name:_.state.name,uid:_.state.uid,screenUid:_.state.screenUid},Ln.screen=e},o.onScreenStreamUnpublished=function(t){Ln.screen=null},e.rtcToken$=function(t){return E.flags.useToken?hn.post$("/api/token/rtc",{channelName:t,uid:null}):n.of({token:null})},e.rtmToken$=function(t){return E.flags.useToken?hn.post$("/api/token/rtm",{uid:t}):n.of({token:null})},e.checkRtcConnection=function(){return new Promise((function(t,n){try{var i=AgoraRTC.createClient({mode:"live",codec:"h264"});E.flags.useProxy&&i.startProxyServer(3),i.init(E.appKey,(function(){e.checkRtcTryJoin(i).then((function(e){t(e)})).catch((function(t){n(t)})).finally((function(){i.leave((function(){E.flags.useProxy&&i.stopProxyServer()}),(function(){}))}))}),(function(t){n(t)}))}catch(t){n(t)}}))},e.checkRtcTryJoin=function(t){return new Promise((function(n,i){var o="checkRtcConnection";e.rtcToken$(o).subscribe((function(r){t.join(r.token,o,null,(function(t){n(t)}),(function(n){if("DYNAMIC_KEY_EXPIRED"===n)return e.checkRtcTryJoin(t);console.log("AgoraService.checkRtcConnection.error",n),i(n)}))}),(function(t){return i(t)}))}))},e.checkRtmConnection=function(t){return new Promise((function(n,i){try{var o,r=AgoraRTM.createInstance(E.appKey,{logFilter:AgoraRTM.LOG_FILTER_OFF});r.setParameters({logFilter:AgoraRTM.LOG_FILTER_OFF}),e.rtmToken$(t).subscribe((function(e){r.login({token:e.token,uid:t.toString()}).then((function(){(o=r.createChannel("checkRtcConnection")).join().then((function(){n(t),o.leave()})).catch((function(t){i(t)})).finally((function(){o.leave().then((function(){o=null,r.logout().then((function(){r=null})).catch((function(){}))})).catch((function(){}))}))})).catch((function(t){i(t)})).finally((function(){r&&r.logout().then((function(){r=null})).catch((function(){}))}))}),(function(t){return i(t)}))}catch(t){i(t)}}))},e.getDevices=function(){return new Promise((function(t,n){var i=e.devices_;if(i)t(i);else{i=e.devices_=[];var o={audio:!0,video:!0};kn.platform===wn&&(o.video={facingMode:"user"}),kn.platform===Cn&&(o.video=!1),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(o).then((function(e){navigator.mediaDevices.enumerateDevices().then((function(n){e.getTracks().forEach((function(t){t.stop()})),n.forEach((function(t){i.push(t)})),t(i)})).catch((function(t){n(t)}))})).catch((function(t){n(t)})):n("Media device not available")}}))},l(e,[{key:"isAudienceRole",get:function(){return _.state.role===I.Viewer||_.state.role===I.SelfService}}]),e}(Mn),In=function(){function t(t,e,n){this.type=We,this.clientId_=e,"string"==typeof t?(this.date=Date.now(),this.clientId=e,this.name=n,this.message=t):"object"==typeof t&&(this.date=t.date,this.clientId=t.clientId,this.name=t.name,this.message=t.message);var i=this.name.split(" ");this.shortName=i[0].substr(0,1).toUpperCase()+(i.length>1?i[1]:i[0]).substr(0,1).toUpperCase()}var e=t.prototype;return e.getPayload=function(){return{date:this.date,clientId:this.clientId,name:this.name,message:this.message}},e.getCopy=function(){return new t({date:this.date,clientId:this.clientId,name:this.name,message:this.message},this.clientId_)},l(t,[{key:"me",get:function(){return this.clientId===this.clientId_}}]),t}(),Rn=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this;this.rows=1,this.showEmoji=!1,this.demo=-1!==window.location.pathname.indexOf("b-here-layout.html");var n=this.form=new e.FormGroup({message:null});this.controls=n.controls;if(n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.checkTypings(e),t.pushChanges()})),_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){})),gn.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(e.type){case We:t.pushMessage(new In(e,_.state.uid,_.state.name));break;case Ke:t.typingBegin(e);break;case Xe:t.typingEnd(e)}})),this.messages=[],this.groupedMessages=[],this.demo){var r=o.getFakeList().map((function(t){return new In(t,_.state.uid,_.state.name)}));this.updateMessages(r.slice(0,5)),gn.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){switch(t.clientId=t.clientId||_.state.uid,t.type){case We:break;case Ke:case Xe:gn.out(t)}}))}else{var s=this.agora=_n.getSingleton();s&&s.getChannelAttributes().pipe(i.first()).subscribe((function(e){e=e.map((function(t){return new In(t,_.state.uid,_.state.name)})),t.updateMessages(e)}))}},r.onView=function(){},r.onChanges=function(){},r.onDestroy=function(){o.to&&(clearTimeout(o.to),o.to=null)},r.onSubmit=function(){var t=this.secureText(this.form.value.message),e=this.createMessage(t);this.sendMessage(e),this.form.get("message").value=null,this.demo},r.onKeyDown=function(e){"Enter"===e.key&&(e.shiftKey?(this.rows=Math.min(4,this.rows+1),this.pushChanges()):(e.preventDefault(),this.onSubmit(),this.rows=1),t.getContext(this).node.querySelector("textarea").setAttribute("rows",this.rows))},r.onToggleEmoji=function(){this.showEmoji=!this.showEmoji,this.pushChanges()},r.onSelectEmoji=function(t){this.showEmoji=!1,this.form.get("message").value=(this.form.get("message").value||"")+t.char},r.secureText=function(t){return(new DOMParser).parseFromString(t,"text/html").body.textContent||""},r.createMessage=function(t){return new In(t,_.state.uid,_.state.name)},r.sendMessage=function(t){this.pushMessage(t);var e=this.agora;e&&e.addOrUpdateChannelAttributes([t.getPayload()]).pipe(i.first()).subscribe(),gn.send(t)},r.onClose=function(t){this.close.next()},r.scrollToBottom=function(){var e=t.getContext(this).node.querySelector(".group--scrollview");e.scrollTop=e.scrollHeight},r.pushMessage=function(t){var e=this.messages?this.messages.slice():[];this.removeTyping({type:Ke,clientId:t.clientId},this.messages),e.push(t),this.updateMessages(e)},r.typingBegin=function(t){var e=this.messages?this.messages.slice():[];e.push(t),this.updateMessages(e)},r.typingEnd=function(t){var e=this.messages?this.messages.slice():[];this.removeTyping({type:Ke,clientId:t.clientId},e),this.updateMessages(e)},r.removeTyping=function(t,e,n){void 0===n&&(n=!0);var i=e.reduce((function(e,n,i){return n.type===t.type&&n.clientId===t.clientId?i:e}),-1);return-1!==i&&(e.splice(i,1),!0===n&&this.removeTyping(t,e,!0)),i},r.checkTypings=function(t){var e=t.message&&t.message.length>0;this.typings_!==e&&(this.typings_=e,e?gn.send({type:Ke}):gn.send({type:Xe}))},r.updateMessages=function(t){var e=this;this.messages=t,this.groupedMessages=[],this.pushChanges();var n=[];t.forEach((function(t){if(t.type===We){var e=n.length?n[n.length-1]:null;e&&e.clientId===t.clientId?e.message+="<p>"+t.message+"</p>":n.push(t.getCopy())}else if(t.type===Ke){var i=n.reduce((function(e,n,i){return n.clientId===t.clientId?n:e}),null);i&&(i.typing=!0)}})),this.groupedMessages=n,this.pushChanges(),setTimeout((function(){e.scrollToBottom()}),1)},r.isValid=function(){var t=this.form.valid;return t&&this.form.value.message&&this.form.value.message.length>0},r.randomMessage=function(){var t=this;o.to&&(clearTimeout(o.to),o.to=null),o.to=setTimeout((function(){var e=o.createRandomMessage();t.sendMessage(e)}),1e3*(2+6*Math.random()))},o}(t.Component);Rn.meta={selector:"[agora-chat]",outputs:["close"],template:'\n\t\t<div class="group--scrollview" [class]="\'rows--\' + rows">\n\t\t\t<div class="group--virtual" *virtual="let item of groupedMessages" [mode]="4" [width]="350" [gutter]="0" [reverse]="true">\n\t\t\t\t\x3c!-- serve un nodo figlio --\x3e\n\t\t\t\t<div class="listing__item message" [class]="{ me: item.me, typing: item.typing }">\n\t\t\t\t\t<div class="message__avatar" [title]="item.name"><span [innerHTML]="item.shortName"></span></div>\n\t\t\t\t\t<div class="message__content">\n\t\t\t\t\t\t<div [innerHTML]="item.message | message"></div>\n\t\t\t\t\t\t<div class="typing-indicator">\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="group--message" [class]="\'rows--\' + rows">\n\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.message.validators.length, \'addon\': controls.message.valid }">\n\t\t\t\t\t\x3c!-- <input type="text" class="control--text" [formControl]="controls.message" [placeholder]="\'bhere_write_a_message\' | label" /> --\x3e\n\t\t\t\t\t<button type="button" class="control--pre" (click)="onToggleEmoji()">\n\t\t\t\t\t\t<svg class="emoji" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#emoji"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<textarea class="control--text" [formControl]="controls.message" [placeholder]="\'bhere_write_a_message\' | label" rows="1" (keydown)="onKeyDown($event)"></textarea>\n\t\t\t\t\t<button type="submit" class="control--addon">\n\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#send"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t\t<div class="group--close">\n\t\t\t<button type="button" class="btn--close" [title]="\'title_close\' | label" (click)="onClose($event)">\n\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="group--emoji" [class]="\'rows--\' + rows" agora-chat-emoji (emoji)="onSelectEmoji($event)" (close)="onToggleEmoji()" *if="showEmoji">\n\t\t\t<div class="group--virtual" *virtual="let item of items" [mode]="1" [width]="40" [gutter]="10" [reverse]="true">\n\t\t\t\t\x3c!-- serve un nodo figlio --\x3e\n\t\t\t\t<div class="listing__item emoji">\n\t\t\t\t\t<button type="button" class="btn--emoji" (click)="onSelect(item)"><span [innerHTML]="item.char"></span></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--close">\n\t\t\t\t<button type="button" class="btn--close" [title]="\'title_close\' | label" (click)="onClose($event)">\n\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t'},Rn.getFakeList=function(){for(var t=[{date:161459223e4,name:"Jhon Appleseed",message:"Function-based web-enabled benchmark",clientId:"7341614597544882"},{date:161459224e4,name:"Jhon Appleseed",message:"Customizable exuding superstructure",clientId:"7341614597544882"},{date:161459225e4,name:"Gilles Pitkins",message:"Synergistic interactive archive",clientId:"cfe9ff5b-f7da-449d-bf5a-3184b5eba6ea"},{date:161459226e4,name:"Jhon Appleseed",message:"Digitized client-server initiative",clientId:"7341614597544882"},{date:161459227e4,name:"Jhon Appleseed",message:"Quality-focused tertiary open system",clientId:"7341614597544882"},{date:161459228e4,name:"Jhon Appleseed",message:"Exclusive uniform middleware",clientId:"7341614597544882"},{date:161459229e4,name:"John Pruckner",message:"Decentralized disintermediate extranet",clientId:"ae51e846-d043-41e9-bb5c-3189181e5b43"},{date:16145923e5,name:"Lamont Georgievski",message:"Enhanced static approach",clientId:"1961cd9e-93aa-4bd0-b96a-89fcbd36b257"},{date:161459231e4,name:"Jhon Appleseed",message:"Ergonomic clear-thinking info-mediaries",clientId:"7341614597544882"},{date:161459232e4,name:"Jeri Pedroni",message:"Grass-roots dynamic encryption",clientId:"13d69bba-3656-449b-8fe3-d7a87062b044"},{date:161459233e4,name:"Frederik Dechelle",message:"Compatible disintermediate policy",clientId:"9151ebe0-efa8-40b4-a341-b8fd489e9c88"},{date:161459234e4,name:"Jhon Appleseed",message:"Inverse user-facing adapter",clientId:"7341614597544882"},{date:161459235e4,name:"Jhon Appleseed",message:"Future-proofed even-keeled application",clientId:"7341614597544882"},{date:161459236e4,name:"Cassie Jonathon",message:"Profit-focused content-based budgetary management",clientId:"5b3dc6f3-2a3d-493d-aac5-66ddfce2d709"},{date:161459237e4,name:"Jhon Appleseed",message:"Managed intermediate monitoring",clientId:"7341614597544882"},{date:161459238e4,name:"Jhon Appleseed",message:"Exclusive client-server encoding",clientId:"7341614597544882"},{date:161459239e4,name:"Jhon Appleseed",message:"Cross-group system-worthy matrices",clientId:"7341614597544882"},{date:16145924e5,name:"Jhon Appleseed",message:"Upgradable encompassing benchmark",clientId:"7341614597544882"},{date:161459241e4,name:"Emelen Beevors",message:"Function-based full-range knowledge base",clientId:"c93aea47-ebd8-4e5e-88fd-52053dd35cd1"},{date:161459242e4,name:"Jhon Appleseed",message:"Synergistic system-worthy capability",clientId:"7341614597544882"}];t.length<100;)t=t.concat(t);return t},Rn.createRandomMessage=function(t){return new In({date:Date.now(),clientId:"9fe0e1b9-6a6b-418b-b916-4bbff3eeb123",name:"Herman frederick",message:"Lorem ipsum dolor"},_.state.uid,_.state.name)},Rn.randomMessage=function(t,e){Rn.to&&(clearTimeout(Rn.to),Rn.to=null),Rn.to=setTimeout((function(){var n=function(){var t=e.filter((function(t){return"7341614597544882"!==t.id})),n=t[Math.floor(t.length*Math.random())];return new In({date:Date.now(),clientId:"9fe0e1b9-6a6b-418b-b916-4bbff3eeb123",name:n.name,message:n.message},_.state.uid,_.state.name)}();t.sendMessage(n),Rn.randomMessage(t,e)}),1e3*(2+6*Math.random()))};var An=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(t.Component);An.meta={selector:"[agora-check]",inputs:["value"],template:'\n\t\t<svg *if="value == null" class="checkmark idle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t</svg>\n\t\t<svg *if="value === true" class="checkmark success" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t\t<path class="checkmark__icon" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" stroke-linecap="round"/>\n\t\t</svg>\n\t\t<svg *if="value === false" class="checkmark error" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t\t<path class="checkmark__icon" stroke-linecap="round" fill="none" d="M16 16 36 36 M36 16 16 36"/>\n\t\t</svg>\n\t'};var Pn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onClose=function(){Bn.reject()},e}(t.Component);Pn.meta={selector:"[iframe-modal]",inputs:["src"],template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="modal__content">\n\t\t\t<iframe [src]="src"></iframe>\n\t\t</div>\n\t'},Pn.chunk=function(t){return'<div class="iframe-modal" iframe-modal src="'+t+'"></div>'};var $n=function(t){this.data=t},Hn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}($n),On=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}($n),Bn=function(){function t(){}return t.open$=function(t){var e=this;return this.busy$.next(!0),(t.iframe?n.of(Pn.meta.chunk(t.iframe)):this.getTemplate$(t)).pipe(i.map((function(n){return{node:e.getNode(n),data:t.data,modal:t}})),i.tap((function(t){e.modal$.next(t),e.hasModal=!0,e.busy$.next(!1)})),i.switchMap((function(t){return e.events$})),i.tap((function(t){return e.hasModal=!1})))},t.getTemplate$=function(t){return t.src?n.from(fetch(t.src).then((function(t){return t.text()}))):t.template?n.of(t.template):EMPTY},t.getNode=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild},t.reject=function(t){this.modal$.next(null),this.events$.next(new On(t))},t.resolve=function(t){this.modal$.next(null),this.events$.next(new Hn(t))},l(t,null,[{key:"hasModal",get:function(){return this.hasModal_},set:function(t){if(this.hasModal_!==t){this.hasModal_=t;var e=document.querySelector("body");t?e.classList.add("modal-open"):e.classList.remove("modal-open")}}}]),t}();Bn.modal$=new n.Subject,Bn.events$=new n.Subject,Bn.busy$=new n.Subject;var Dn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){return e.labels_[t]||t},e.getKeys=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.transform(n.map((function(t){return t.replace("-","_")})).join("_"))},e.setLabels=function(){var t,e=m.merge(((t={browse:"Browse",cancel:"Cancel",drag_and_drop_images:"Drag And Drop your images here",error_email:"Invalid email",error_match:"Fields do not match",error_required:"Field is required",loading:"loading",remove:"Remove",required:"Required",select:"Select",select_file:"Select a file...",update:"Update",upload:"Upload",waiting_host:"waiting host",editor_image:"Image",editor_video:"Video",editor_model:"Model",editor_publisher_stream:"Publisher Stream",editor_next_attendee_stream:"Next Attendee Stream",editor_waiting_room:"Waiting Room",editor_panorama:"Panorama",editor_panorama_grid:"Panorama Grid",editor_room_3d:"Room 3D"}).editor_model="Model",t.editor_nav="Nav Tooltip",t.editor_gltf="Gltf Model",t.editor_plane="Plane",t.editor_curved_plane="Curved Plane",t.editor_texture="Texture",t),window.labels);this.labels_=e},e}(t.Pipe);Dn.setLabels(),Dn.meta={name:"label"};var Un=function(){function t(){}return t.delete=function(t){this.isLocalStorageSupported()&&window.localStorage.removeItem(t)},t.exist=function(t){if(this.isLocalStorageSupported())return void 0!==window.localStorage[t]},t.get=function(t){var e=null;if(this.isLocalStorageSupported()&&void 0!==window.localStorage[t])try{e=JSON.parse(window.localStorage[t])}catch(e){console.log("LocalStorageService.get.error parsing",t,e)}return e},t.set=function(t,e){if(this.isLocalStorageSupported())try{var n=[],i=JSON.stringify(e,(function(t,e){if("object"==typeof e&&null!==e){if(-1!==n.indexOf(e))return;n.push(e)}return e}));window.localStorage.setItem(t,i)}catch(n){console.log("LocalStorageService.set.error serializing",t,e,n)}},t.isLocalStorageSupported=function(){if(this.supported)return!0;var t=!1;try{(t="localStorage"in window&&null!==window.localStorage)?(window.localStorage.setItem("test","1"),window.localStorage.removeItem("test")):t=!1}catch(e){t=!1}return this.supported=t,t},t}(),Vn=100,zn=function(){function t(){}return t.checklist$=function(){return _.state$.pipe(i.first(),i.map((function(t){var e={shouldCheckAudio:!0,shouldCheckVideo:!0,key:"checklist_audio_video",uid:null,checklist:{browser:null,https:null,video:null,audio:null,rtc:null,rtm:null},errors:{}};return t.role===I.Viewer&&(e.shouldCheckAudio=!1,e.shouldCheckVideo=!1),kn.platform===Cn&&(e.shouldCheckAudio=!0,e.shouldCheckVideo=!1),e.key="checklist"+(e.shouldCheckAudio?"_audio":"")+(e.shouldCheckVideo?"_video":""),e})),i.switchMap((function(t){return!0===Un.get(t.key)&&Object.keys(t.checklist).forEach((function(e){t.checklist[e]=!0})),n.of(t)})))},t.isChecked=function(t){var e=Object.keys(t.checklist).reduce((function(e,n,i){var o=e&&t.checklist[n];switch(n){case"audio":return o||!t.shouldCheckAudio;case"video":return o||!t.shouldCheckVideo;default:return o}}),!0);return e},t.isChecked$=function(){var t=this;return this.checklist$().pipe(i.map((function(e){return t.isChecked(e)})))},t.checkEvent$=function(){var t=this;return this.checklist$().pipe(i.switchMap((function(e){if(!0===Object.keys(e.checklist).reduce((function(t,n,i){return t&&e.checklist[n]}),!0))return n.of(e);Un.set(e.key,!1);var o=new n.Subject,r=n.of(e).pipe(i.delay(1e3),i.switchMap((function(e){return o.next(e),t.checkBrowserEvent$(e)})),i.switchMap((function(e){return o.next(e),t.checkHttpsEvent$(e)})),i.switchMap((function(e){return o.next(e),t.checkAudioEvent$(e)})),i.switchMap((function(e){return o.next(e),t.checkVideoEvent$(e)})),i.switchMap((function(e){return o.next(e),t.checkRtcEvent$(e)})),i.switchMap((function(e){return o.next(e),t.checkRtmEvent$(e)})),i.tap((function(t){Un.set(t.key,!0)})));return n.merge(o,r)})))},t.check$=function(){var t=this;return this.checklist$().pipe(i.switchMap((function(e){return!0===Object.keys(e.checklist).reduce((function(t,n,i){return t&&e.checklist[n]}),!0)?n.of(e):(Un.set(e.key,!1),n.of(e).pipe(i.delay(1e3),i.switchMap((function(e){return t.checkBrowserEvent$(e)})),i.switchMap((function(e){return t.checkHttpsEvent$(e)})),i.switchMap((function(e){return t.checkAudioEvent$(e)})),i.switchMap((function(e){return t.checkVideoEvent$(e)})),i.switchMap((function(e){return t.checkRtcEvent$(e)})),i.switchMap((function(e){return t.checkRtmEvent$(e)})),i.tap((function(t){Un.set(t.key,!0)}))))})))},t.checkBrowser$=function(){var t=AgoraRTC.checkSystemRequirements();return n.of(t)},t.checkBrowserEvent$=function(t){var e=this;return this.checkBrowser$().pipe(i.switchMap((function(o){return t.checklist.browser=o,o?n.of(t).pipe(i.delay(Vn)):(t.errors.browser=Dn.transform("bhere_browser_error"),e.checkHttpsEvent$(t).pipe(i.switchMap((function(t){return n.throwError(t)}))))})),i.catchError((function(e){return console.log("checkBrowserEvent$.error",e),t.checklist.browser=!1,t.errors.browser=Dn.transform("bhere_browser_error"),n.throwError(t)})))},t.checkHttps$=function(){var t="https:"===window.location.protocol;return n.of(t)},t.checkHttpsEvent$=function(t){return this.checkHttps$().pipe(i.switchMap((function(e){return t.checklist.https=e,e?n.of(t).pipe(i.delay(Vn)):(t.errors.https=Dn.transform("bhere_https_error"),n.throwError(t))})),i.catchError((function(e){return console.log("checkHttpsEvent$.error",e),t.checklist.https=!1,t.errors.https=Dn.transform("bhere_https_error"),n.throwError(t)})))},t.checkAudio$=function(){return n.from(_n.getDevices()).pipe(i.map((function(t){return null!=t.find((function(t){return"audioinput"===t.kind&&t.deviceId}))})))},t.checkAudioEvent$=function(t){return t.shouldCheckAudio?this.checkAudio$().pipe(i.switchMap((function(e){return t.checklist.audio=e,e?n.of(t).pipe(i.delay(Vn)):(t.errors.audio=Dn.transform("bhere_audio_error"),n.throwError(t))})),i.catchError((function(e){return console.log("checkAudioEvent$.error",e),t.checklist.audio=!1,t.errors.audio=Dn.transform("bhere_audio_error"),n.throwError(t)}))):n.of(t)},t.checkVideo$=function(){return n.from(_n.getDevices()).pipe(i.map((function(t){return null!=t.find((function(t){return"videoinput"===t.kind&&t.deviceId}))})))},t.checkVideoEvent$=function(t){return t.shouldCheckVideo?this.checkVideo$().pipe(i.switchMap((function(e){return t.checklist.video=e,e?n.of(t).pipe(i.delay(Vn)):(t.errors.video=Dn.transform("bhere_video_error"),n.throwError(t))})),i.catchError((function(e){return console.log("checkVideoEvent$.error",e),t.checklist.video=!1,t.errors.video=Dn.transform("bhere_video_error"),n.throwError(t)}))):n.of(t)},t.checkRtc$=function(){return n.from(_n.checkRtcConnection()).pipe(i.catchError())},t.checkRtcEvent$=function(t){return this.checkRtc$().pipe(i.switchMap((function(e){return t.uid=e,t.checklist.rtc=!1!==e,e?n.of(t).pipe(i.delay(Vn)):(t.errors.rtc=Dn.transform("bhere_rtc_error"),n.throwError(t))})),i.catchError((function(e){return console.log("checkRtcEvent$.error",e),t.checklist.rtc=!1,t.errors.rtc=Dn.transform("bhere_rtc_error"),n.throwError(t)})))},t.checkRtm$=function(t){return n.from(_n.checkRtmConnection(t))},t.checkRtmEvent$=function(t){return this.checkRtm$(t.uid).pipe(i.switchMap((function(e){return t.checklist.rtm=!1!==e,e?n.of(t):(t.errors.rtm=Dn.transform("bhere_rtm_error"),n.throwError(t))})),i.catchError((function(e){return console.log("checkRtmEvent$.error",e),t.checklist.rtm=!1,t.errors.rtm=Dn.transform("bhere_rtm_error"),n.throwError(t)})))},t}(),jn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onClose=function(){Bn.resolve()},e}(t.Component);jn.meta={selector:"[agora-configure-firewall-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form" [innerHTML]="\'bhere_configure_firewall\' | label"></div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="button" class="btn--accept" (click)="onClose()">\n\t\t\t\t\t<span>Chiudi</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t'},jn.chunk=function(){return'<div class="configure-firewall-modal" agora-configure-firewall-modal></div>'};var Fn=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.platform=kn.platform,this.checklist={},this.errors={},this.state={},this.busy=!0,this.shouldCheckAudio=!1,this.shouldCheckVideo=!1,zn.checkEvent$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){console.log("AgoraChecklistService",e,e.errors),t.shouldCheckAudio=e.shouldCheckAudio,t.shouldCheckVideo=e.shouldCheckVideo,t.checklist=e.checklist,t.errors=e.errors;var n=zn.isChecked(e);n?(t.checklist.success=n,t.busy=!1,t.pushChanges(),t.state.role===I.SmartDevice&&t.onNext()):t.pushChanges()}),(function(e){t.errors=e.errors,t.checklist.error=!0,t.busy=!1,t.pushChanges()}))},n.onNext=function(){this.checked.next(this.checklist)},n.openHttps=function(){window.location.href=window.location.href.replace("http://","https://").replace(":5000",":6443")},n.showFirewallConfiguration=function(){Bn.open$({template:jn.chunk()}).pipe(i.first()).subscribe()},e}(t.Component);Fn.meta={selector:"[agora-checklist]",outputs:["checked"],template:'\n\t<div class="group--info">\n\t\t<div class="group--info__content stagger--childs">\n\t\t\t<div class="title" *if="busy" [innerHTML]="\'bhere_checklist_busy\' | label"></div>\n\t\t\t<div class="title" *if="checklist.success" [innerHTML]="\'bhere_checklist_success\' | label"></div>\n\t\t\t<div class="title" *if="checklist.error" [innerHTML]="\'bhere_checklist_error\' | label"></div>\n\t\t\t<ul class="group--checklist stagger--childs">\n\t\t\t\t<li class="checklist__item check"><span>Browser</span> <span agora-check [value]="checklist.browser"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.browser"><a class="btn--link" href="https://browsehappy.com/" target="_blank" rel="noopener" [innerHTML]="errors.browser"></a></li>\n\t\t\t\t<li class="checklist__item check"><span>Https</span> <span agora-check [value]="checklist.https"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.https"><a class="btn--link" (click)="openHttps()" [innerHTML]="errors.https"></a></li>\n\t\t\t\t<li class="checklist__item check" *if="shouldCheckAudio"><span>Audio</span> <span agora-check [value]="checklist.audio"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.audio"><span [innerHTML]="errors.audio"></span></li>\n\t\t\t\t<li class="checklist__item check" *if="shouldCheckVideo"><span>Video</span> <span agora-check [value]="checklist.video"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.video"><span [innerHTML]="errors.video"></span></li>\n\t\t\t\t<li class="checklist__item check"><span>Realtime Communication</span> <span agora-check [value]="checklist.rtc"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.rtc"><a class="btn--link" (click)="showFirewallConfiguration()" [innerHTML]="errors.rtc"></a></li>\n\t\t\t\t<li class="checklist__item check"><span>Realtime Messaging</span> <span agora-check [value]="checklist.rtm"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.rtm"><a class="btn--link" (click)="showFirewallConfiguration()" [innerHTML]="errors.rtm"></a></li>\n\t\t\t</ul>\n\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !checklist.success, ready: checklist.success }" (click)="onNext()">\n\t\t\t\t<span [innerHTML]="\'bhere_proceed\' | label"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<a [routerLink]="\'editor\' | route" class="btn--absolute" *if="(\'editor\' | flag) && !(\'heroku\' | flag) && state.role == \'publisher\'">\n\t\t<span [innerHTML]="\'bhere_editor\' | label"></span> <svg class="edit" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#edit"></use></svg>\n\t</a>\n\t'};var Nn=function(){function t(){}return t.addSource=function(t){var e=t instanceof MediaStream?t.id:t;return this.sources_[e]||(t instanceof MediaStream?this.sources_[e]=this.context.createMediaStreamSource(t.clone()):this.sources_[e]=this.context.createMediaElementSource(t)),this.sources_[e]},t.removeSource=function(t){var e=t instanceof MediaStream?t.id:t;return this.removeSourceKey(e)},t.removeSourceKey=function(t){var e;return this.sources_[t]&&(e=this.sources_[t],this.analyser&&e.disconnect(this.analyser),e.disconnect(),delete this.sources_[t]),e},t.frequency$=function(e,o){var r=this;if(void 0===o&&(o=64),o%2==1)throw o;var s=new Uint8Array(o/2);if(this.context){var a=this.analyser;if(a)a.fftSize=o,this.addSource(e).connect(a);var l=new n.BehaviorSubject(s);return t.frame$.pipe(i.withLatestFrom(l),i.map((function(t){t[0];var e=t[1];return a&&a.getByteFrequencyData(e),e})),i.tap((function(t){return l.next(t)})),i.finalize((function(){r.removeSource(e)})))}return n.of(s)},t.volume$=function(e){var o=this,r={volume:0,clipped:!1};if(this.context){var s=this.addSource(e),a=t.audioMeterCreate();s.connect(a);var l=new n.BehaviorSubject(r);return t.frame$.pipe(i.withLatestFrom(l),i.map((function(t){t[0];var e=t[1];return e.clipped=a.checkClipping(),e.volume=a.volume,e})),i.tap((function(t){return l.next(t)})),i.finalize((function(){o.removeSource(e)})))}return n.of(r)},t.audioMeterCreate=function(t,e,n){void 0===t&&(t=.98),void 0===e&&(e=.95),void 0===n&&(n=750);var i=this.context;if(i){var o=i.createScriptProcessor(512);return o.onaudioprocess=this.audioMeterProcess,o.checkClipping=this.audioMeterClip,o.dispose=this.audioMeterDispose,o.clipping=!1,o.lastClip=0,o.volume=0,o.clipLevel=t,o.averaging=e,o.clipLag=n,o.connect(i.destination),o}},t.audioMeterProcess=function(t){for(var e,n=t.inputBuffer.getChannelData(0),i=n.length,o=0,r=0;r<i;r++)e=n[r],Math.abs(e)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),o+=e*e;var s=Math.sqrt(o/i);this.volume=Math.max(s,this.volume*this.averaging)},t.audioMeterClip=function(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)},t.audioMeterDispose=function(){this.disconnect(),this.onaudioprocess=null},t.step$=function(t){return n.Observable.create((function(e){requestAnimationFrame((function(n){var i=t?(n-t.startTime)/1e3:0;e.next({startTime:n,deltaTime:i})}))})).pipe(i.map((function(t){return t.deltaTime>1/30&&(t.deltaTime=1/30),t})))},t.dispose=function(){var t=this;Object.keys(this.sources_).forEach((function(e){t.removeSourceKey(e)}));var e=this.analyser;e&&e.disconnect(),this.sources_={}},l(t,null,[{key:"context",get:function(){return!this.context_&&"AudioContext"in window&&(this.context_=new AudioContext),this.context_}},{key:"analyser",get:function(){if(!this.analyser_)try{this.analyser_=this.context.createAnalyser()}catch(t){console.log("AudioStreamService.analyser",t)}return this.analyser_}}]),t}();Nn.sources_={},Nn.frame$=n.of(void 0).pipe(i.expand((function(t){return Nn.step$(t)})),i.filter((function(t){return void 0!==t})),i.map((function(t){return t.deltaTime})),i.share());var Gn=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){this.init()},o.init=function(){if(!this.initialized_){this.initialized_=!0,this.platform=kn.platform;var e=t.getContext(this).node;this.onLoadedMetadata=this.onLoadedMetadata.bind(this),(this.preview=e.querySelector("video")).addEventListener("loadedmetadata",this.onLoadedMetadata);var n=e.querySelector(".audio");if(this.hasPreview)this.bars=new Array(32).fill(0).map((function(t){var e=document.createElement("div");return e.classList.add("bar"),n.appendChild(e),e}))}},o.onDestroy=function(){this.preview.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.hasPreview&&Nn.dispose()},o.initStream=function(){var e=this,n=this.preview;if(this.preview){var i=t.getContext(this).node;if(this.video_||this.audio_){if(i.classList.add("ready"),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var o=ie(_.state),r={video:!!this.video_&&{deviceId:this.video_,width:{ideal:o.resolution.width},height:{ideal:o.resolution.height},frameRate:{ideal:o.frameRate.min,max:o.frameRate.max}},audio:!!this.audio_&&{deviceId:this.audio_}};this.platform===wn&&(r.video.facingMode="user"),navigator.mediaDevices.getUserMedia(r).then((function(t){e.hasPreview?("srcObject"in n?n.srcObject=t:n.src=window.URL.createObjectURL(t),e.audio_&&e.analyzeData(t),e.loadingStream_=t):e.stream.next(t)})).catch((function(t){console.log("AgoraDevicePreviewComponent.initStream.error",t.name,t.message),e.stream.next(null)}))}}else i.classList.remove("ready"),this.hasPreview&&("srcObject"in n?n.srcObject=null:n.src=null,this.analyzeData(null)),this.stream.next(null)}},o.onLoadedMetadata=function(e){t.getContext(this).node.classList.add("loaded"),this.preview.play(),this.stream.next(this.loadingStream_)},o.analyzeData=function(t){var e=this;this.frequencySubscription&&this.frequencySubscription.unsubscribe(),t&&(this.frequencySubscription=Nn.frequency$(t,64).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.bars.forEach((function(e,n){var i=Math.min(100,5+t[n])/100;e.style.left=3.125*n+"%",e.style.transform="scale(1,"+i+")",e.style.opacity=i}))})))},l(n,[{key:"video",get:function(){return this.video_},set:function(t){this.video_!==t&&(this.video_=t,this.change&&(this.change.next(),this.init(),this.initStream()))}},{key:"audio",get:function(){return this.audio_},set:function(t){this.audio_!==t&&(this.audio_=t,this.change&&(this.change.next(),this.init(),this.initStream()))}},{key:"hasPreview",get:function(){return this.platform!==wn&&this.platform!==Cn}}]),n}(t.Component);Gn.meta={selector:"[agora-device-preview]",outputs:["stream","change"],inputs:["video","audio"]};var qn=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;if(this.platform=kn.platform,this.isHttps="https:"===window.location.protocol,this.state={},this.devices={videos:[],audios:[]},this.stream=null,this.form=null,this.isHttps){var e=this.agora=_n.getSingleton();_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.pushChanges()})),e&&e.devices$().subscribe((function(e){t.devices=e,t.initForm(e),t.pushChanges()}),(function(t){console.log("AgoraDeviceComponent.devices$.error",t)}))}},o.openHttps=function(t){window.location.href=window.location.href.replace("http://","https://").replace(":5000",":6443")},o.initForm=function(t){var n=this,o=this.form=new e.FormGroup({video:new e.FormControl(null,t.videos.length?e.Validators.RequiredValidator():void 0),audio:new e.FormControl(null,t.audios.length?e.Validators.RequiredValidator():void 0)}),r=this.controls=o.controls,s=t.videos.map((function(t){return{id:t.deviceId,name:t.label}}));s.length>0&&s.unshift({id:null,name:"bhere_select_video"}),r.video.options=s;var a=t.audios.map((function(t){return{id:t.deviceId,name:t.label}}));a.length>0&&a.unshift({id:null,name:"bhere_select_audio"}),r.audio.options=a,o.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){n.pushChanges()}))},o.onStreamDidChange=function(t){this.stream=null,this.pushChanges()},o.onStream=function(t){this.stream=t,this.pushChanges()},o.isValid=function(){var t=this.form.valid&&(this.stream||!this.hasPreview);return t},o.onEnter=function(t){var e=this.form.value,n=this.devices;n.video=n.videos.find((function(t){return t.deviceId===e.video})),n.audio=n.audios.find((function(t){return t.deviceId===e.audio})),this.enter.next(n)},l(n,[{key:"hasPreview",get:function(){return this.platform!==wn&&this.platform!==Cn}}]),n}(t.Component);qn.meta={selector:"[agora-device]",outputs:["enter"],template:'\n\t<div class="group--info" *if="!isHttps">\n\t\t<div class="group--info__content stagger--childs">\n\t\t\t<div class="title" [innerHTML]="\'bhere_invalid_protocol\' | label"></div>\n\t\t\t<div class="info" [innerHTML]="\'bhere_reload_in_https\' | label"></div>\n\t\t\t<button type="button" class="btn--connect" (click)="openHttps($event)">\n\t\t\t\t<span [innerHTML]="\'bhere_reload\' | label"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onEnter($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\x3c!-- PREVIEW --\x3e\n\t\t\t<div class="agora-device-preview" agora-device-preview [video]="controls.video.value" [audio]="controls.audio.value" (stream)="onStream($event)" (change)="onStreamDidChange($event)" *if="this.hasPreview">\n\t\t\t\t<video class="video" muted></video>\n\t\t\t\t<div class="audio"></div>\n\t\t\t</div>\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\x3c!-- VIDEO --\x3e\n\t\t\t\t<div control-custom-select [control]="controls.video" label="Video" *if="devices.videos.length"></div>\n\t\t\t\t\x3c!-- AUDIO --\x3e\n\t\t\t\t<div control-custom-select [control]="controls.audio" label="Audio" *if="devices.audios.length"></div>\n\t\t\t\t<div class="info" *if="!isValid()" [innerHTML]="\'bhere_select_video_audio\' | label"></div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_video_audio_connected\' | label"></div>\n\t\t\t\t<button type="submit" class="btn--connect" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t\t\t\t<span *if="!state.connecting" [innerHTML]="\'bhere_enter\' | label"></span>\n\t\t\t\t\t<span *if="state.connecting" [innerHTML]="\'bhere_connecting\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};var Zn=function(){function t(t){t&&Object.assign(this,t),this.items=this.items||[],this.originalItems=this.items.slice()}return l(t,[{key:"payload",get:function(){var t=this,e={};return Object.keys(this).forEach((function(n){-1!==View.allowedProps.indexOf(n)&&(e[n]=t[n])})),e}}]),t}();function Wn(t){return t=new Zn(t)}c(Zn,"allowedProps",["id","name","items"]);var Kn={id:null,name:"Principale",items:[]},Xn=function(){function t(){}return t.getCurrentPath$=function(t){var e=this;return void 0===t&&(t=null),this.pathGet$().pipe(i.switchMap((function(n){e.paths=n;var i=Kn;if(t){var o=n.find((function(e){return e.id===t}));o&&(i=o)}return e.path=i,e.path$})))},t.pathGet$=function(){return E.flags.usePaths?hn.get$("/api/path").pipe(i.map((function(t){return t.paths=t.paths.map((function(t){return Wn(t)})),t.paths.unshift(Kn),t.paths}))):of([])},t.addPath=function(t){var e=this.paths.slice();e.push(t),this.paths=e,this.path=t},t.editPath=function(t){var e=this.paths.slice(),n=e.reduce((function(e,n,i){return n.id===t.id?i:e}),-1);if(n>0){var i=this.path;i.id===t.id&&(i=t),e.splice(n,1,t),this.paths=e,this.path=i}},t.deletePath=function(t){var e=this.paths.slice(),n=e.indexOf(t);if(n>0){e.splice(n,1),this.paths=e;var i=this.path;i.id===t.id&&(i=e[0]),this.path=i}},t.pathCreate$=function(t){return hn.post$("/api/path",t).pipe(i.map((function(t){return Wn(t)})))},t.pathUpdate$=function(t){return hn.put$("/api/path/"+t.id,t).pipe(i.map((function(t){return Wn(t)})))},t.pathDelete$=function(t){return hn.delete$("/api/path/"+t.id)},l(t,null,[{key:"paths",set:function(t){this.paths$.next(t)},get:function(){return this.paths$.getValue()}},{key:"path",set:function(t){this.path$.next(t)},get:function(){return this.path$.getValue()}}]),t}();c(Xn,"paths$",new n.BehaviorSubject([Kn])),c(Xn,"path$",new n.BehaviorSubject(Kn));var Yn=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){return E.url[t]||"#"+t},e}(t.Pipe);Yn.meta={name:"slug"};var Jn=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.state={},this.paths=[],this.pathId=null,this.form=null,_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.pushChanges()})),E.flags.usePaths?Xn.getCurrentPath$().pipe(i.first(),i.tap(),i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.paths=Xn.paths,t.pathId=e.id||"",t.onLoad()})):this.onLoad()},o.onLoad=function(){var t=this,n=this.form=new e.FormGroup({path:this.pathId,id:new e.FormControl(null,[e.Validators.PatternValidator(A),e.Validators.RequiredValidator()]),idAttendee:null,idStreamer:null,idViewer:null,idSmartDevice:null}),o=this.controls=n.controls,r=this.paths.map((function(t){return{id:t.id||"",name:t.name}}));r.length>0&&r.unshift({id:null,name:"bhere_select_path"}),o.path.options=r,n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pathId!==e.path&&null!==e.id&&(t.pathId=e.path,t.onGenerateMeetingId()),t.pushChanges()}))},o.onGenerateMeetingId=function(t){var e=this.pathId?String(this.pathId):null;e=e&&e.length?e:null;var n=new P({pathId:e}).toRoles();this.form.patch(n)},o.onInputDidChange=function(t){var e=this;"publisher"===this.state.role&&setTimeout((function(){if(e.form.get("id").valid){var t=e.form.get("id").value,n=new P(t).toRoles();e.form.patch(n)}else e.form.get("idAttendee").reset(),e.form.get("idStreamer").reset(),e.form.get("idViewer").reset(),e.form.get("idSmartDevice").reset()}),1)},o.onCopyToClipBoard=function(t,e){void 0===e&&(e=!1),new $({link:t}).copyToClipBoard(e)},o.onNext=function(t){var e=this.controls.id.value;$.replaceWithLink(e),this.link.next(e)},o.isValid=function(){var t=this.form.valid;return t},l(n,[{key:"selfServiceTourUrl",get:function(){var t=this.form.get("path").value;return Yn.transform("selfServiceTour")+(t?"?pathId="+t:"")}}]),n}(t.Component);Jn.meta={selector:"[agora-link]",outputs:["link"],template:'\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onNext($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t<div class="stagger--childs" *if="state.role !== \'publisher\'">\n\t\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.id.validators.length, \'addon\': controls.id.valid }">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_insert_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.id" [placeholder]="\'bhere_meeting_id\' | label" />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.id.value)" *if="controls.id.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="stagger--childs" *if="state.role === \'publisher\'">\n\t\t\t\t\t\x3c!-- PATH --\x3e\n\t\t\t\t\t<div control-custom-select [control]="controls.path" [label]="\'bhere_path\' | label" *if="(\'usePaths\' | flag) && paths.length"></div>\n\t\t\t\t\t\x3c!--IDS --\x3e\n\t\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.id.validators.length, \'addon\': controls.id.valid }">\n\t\t\t\t\t\t<label><svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg> <span [innerHTML]="\'bhere_insert_meeting_id\' | label"></span></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.id" [placeholder]="\'bhere_meeting_id\' | label" (change)="onInputDidChange($event)" />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.id.value)" *if="controls.id.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'attendee\' | flag) && controls.idAttendee.valid && controls.idAttendee.value !== null">\n\t\t\t\t\t\t<label><svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg> <span [innerHTML]="\'bhere_attendee_meeting_id\' | label"></span></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idAttendee" [placeholder]="\'bhere_attendee_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idAttendee.value)" *if="controls.idAttendee.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'streamer\' | flag) && controls.idStreamer.valid && controls.idStreamer.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_streamer_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idStreamer" [placeholder]="\'bhere_streamer_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idStreamer.value)" *if="controls.idStreamer.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'viewer\' | flag) && controls.idViewer.valid && controls.idViewer.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_viewer_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idViewer" [placeholder]="\'bhere_viewer_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idViewer.value)" *if="controls.idViewer.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'smartDevice\' | flag) && controls.idSmartDevice.valid && controls.idSmartDevice.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_smart_device_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idSmartDevice" [placeholder]="\'bhere_smart_device_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idSmartDevice.value, true)" *if="controls.idSmartDevice.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="controls.id.errors.required" [innerHTML]="\'bhere_insert_meeting_id\' | label"></div>\n\t\t\t\t<div class="info" *if="controls.id.errors.pattern" [innerHTML]="\'bhere_invalid_meeting_id\' | label"></div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_take_part_meeting\' | label"></div>\n\t\t\t\t<button type="button" class="btn--generate" *if="state.role == \'publisher\'" (click)="onGenerateMeetingId($event)">\n\t\t\t\t\t<span [innerHTML]="\'bhere_generate_meeting_id\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_take_part\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<a [href]="selfServiceTourUrl" class="btn--secondary" *if="state.role === \'publisher\'">\n\t\t\t\t\t<span [innerHTML]="\'bhere_self_service\' | label"></span>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t<a [routerLink]="\'editor\' | route" class="btn--absolute" *if="(\'editor\' | flag) && !(\'heroku\' | flag) && state.role == \'publisher\'">\n\t\t<span [innerHTML]="\'bhere_editor\' | label"></span> <svg class="edit" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#edit"></use></svg>\n\t</a>\n\t'};var Qn=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this,n=this.form=new e.FormGroup({username:new e.FormControl(null,e.Validators.RequiredValidator()),password:new e.FormControl(null,e.Validators.RequiredValidator()),checkRequest:window.antiforgery||"",checkField:""});this.controls=n.controls;n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pushChanges()})),this.error=null},o.test=function(){this.form.patch({username:"publisher",password:"publisher",checkRequest:window.antiforgery||"",checkField:""})},o.reset=function(){this.form.reset()},o.onSubmit=function(){var t=this;if(this.form.valid){var e=this.form.value;this.form.submitted=!0,this.error=null,this.pushChanges(),pn.login$(e).pipe(i.first()).subscribe((function(e){_.state.role===e.type?(t.onNext(e),t.form.reset()):(t.error={friendlyMessage:Dn.transform("error_credentials")},t.pushChanges())}),(function(e){console.log("AccessComponent.error",e),t.error=e,t.pushChanges()}))}else this.form.touched=!0},o.isValid=function(){var t=this.form.valid;return t},o.onNext=function(t){$.replaceWithUser(t),this.login.next(t)},n}(t.Component);Qn.meta={selector:"[agora-login]",outputs:["login"],template:'\n\t<div class="group--info">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t<div class="title" [innerHTML]="\'bhere_login\' | label"></div>\n\t\t\t\t<input name="checkField" [formControl]="controls.checkField" value="" type="text" style="display:none !important;" />\n\t\t\t\t<div control-text [control]="controls.username" [label]="\'bhere_username\' | label"></div>\n\t\t\t\t<div control-password [control]="controls.password" [label]="\'bhere_password\' | label"></div>\n\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_cta\' | label"></div>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_cta\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};var ti=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this,n=(new $).name;this.state={};var o=this.form=new e.FormGroup({name:new e.FormControl(n,[e.Validators.PatternValidator(/^\w{2,}\s\w{2,}/),e.Validators.RequiredValidator()])});this.controls=o.controls;o.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pushChanges()})),_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.pushChanges()}))},o.isValid=function(){var t=this.form.valid;return t},o.onNext=function(t){var e=this.controls.name.value;$.replaceWithName(e),this.name.next(e)},n}(t.Component);ti.meta={selector:"[agora-name]",outputs:["name"],template:'\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onNext($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\x3c!-- NAME --\x3e\n\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.name.validators.length }">\n\t\t\t\t\t<label [innerHTML]="\'bhere_fill_fullname\' | label"></label>\n\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.name" [placeholder]="\'bhere_name_and_surname\' | label" />\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="!controls.name.valid" [innerHTML]="\'bhere_fill_name_and_surname\' | label"></div>\n\t\t\t\t<div class="info" *if="isValid()">prosegui come <span [innerHTML]="controls.name.value"></span></div>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_proceed\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};var ei=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var t=this;this.videoMuted=!1,this.audioMuted=!1,this.shouldUseResumeGesture=!1,this.state={},_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.pushChanges()})),gn.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(e.type){case pe:var n=e.event;t.streamId&&n.streamId===t.streamId&&(n instanceof an&&(t.videoMuted=!0),n instanceof ln&&(t.videoMuted=!1),n instanceof cn&&(t.audioMuted=!0),n instanceof un&&(t.audioMuted=!1));break;case Ne:t.streamId===e.clientId&&(t.vrContainer=e.container);break;case Ge:t.streamId===e.clientId&&(t.vrContainer=null)}}))},o.setMediaStream=function(t){var e=this.videoNode;"srcObject"in e?e.srcObject=t:e.src=t?window.URL.createObjectURL(t):null},o.onLoadedMetadata=function(t){this.videoNode.play().then((function(t){}),(function(t){console.log("AgoraStreamComponent.play.error",t)}))},o.onToggleControl=function(t){this.toggleControl.next(t)},o.onToggleSpy=function(t){this.toggleSpy.next(t)},l(n,[{key:"videoMuted",set:function(e){if(this.videoMuted_!==e){this.videoMuted_=e;var n=t.getContext(this).node;e?n.classList.add("video--muted"):n.classList.remove("video--muted")}}},{key:"audioMuted",set:function(e){if(this.audioMuted_!==e){this.audioMuted_=e;var n=t.getContext(this).node;e?n.classList.add("audio--muted"):n.classList.remove("audio--muted")}}},{key:"streamId",get:function(){return this.streamId_},set:function(t){this.streamId_=t}},{key:"stream",get:function(){return this.stream_},set:function(e){if(this.stream_!==e){for(var n=t.getContext(this).node,i=this.player=n.querySelector(".agora-stream__player");i.childElementCount>0;)i.removeChild(i.firstElementChild);this.stream_&&this.stream_.isPlaying()&&this.stream_.player.div.parentNode===i&&(console.log("AgoraStreamComponent stopping stream",this.stream_.getId(),"on",this.stream_.player.div.parentNode),this.stream_.stop()),this.stream_=e,e&&(this.videoMuted=e.userMuteVideo,this.audioMuted=e.userMuteAudio);var o=e?e.getId():null;if(this.streamId=o,o){var r="stream-"+o;i.setAttribute("id",r);var s=this;e.isPlaying()?i.appendChild(e.player.div):(this.shouldUseResumeGesture=!1,e.play(r,{fit:"cover"},(function(t){t&&"aborted"!==t.status&&(s.shouldUseResumeGesture=!0,s.pushChanges())})))}else i.removeAttribute("id")}}},{key:"vrContainer",set:function(t){this.vrContainer_!==t&&(this.vrContainer_=t,t?(this.stream_.vrContainer=t,this.player.appendChild(t)):this.stream_.vrContainer&&this.stream_.vrContainer.parentNode&&(this.stream_.vrContainer.parentNode.removeChild(this.stream_.vrContainer),this.stream_.vrContainer=null))}},{key:"videoNode",get:function(){var e=this.videoNode_;if(!e){var n=t.getContext(this).node.querySelector(".agora-stream__player");e=document.createElement("video"),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),e.addEventListener("loadedmetadata",this.onLoadedMetadata),n.appendChild(e),this.videoNode_=e}return e}}]),n}(t.Component);ei.meta={selector:"[agora-stream]",outputs:["toggleControl","toggleSpy"],inputs:["stream"]};var ni={WaitingRoom:{id:1,name:"waiting-room"},Panorama:{id:2,name:"panorama"},PanoramaGrid:{id:3,name:"panorama-grid"},Room3d:{id:4,name:"room-3d"},Model:{id:5,name:"model"},Media:{id:6,name:"media"}},ii={Nav:{id:1,name:"nav"},Plane:{id:2,name:"plane"},CurvedPlane:{id:3,name:"curved-plane"},Model:{id:4,name:"model"},Texture:{id:5,name:"texture"}},oi=function(){function t(t){t&&(Object.assign(this,t),this.updateIndices(t.items)),this.items=(this.items||[]).filter((function(t){return function(t){var e;switch(t.type.name){case ii.Nav.name:e=null==t.viewId||function(t){return!fi(t.title)&&!fi(t.abstract)}(t)||_.state.navigable;break;default:e=!0}return e}(t)})).map((function(t){return vi(t)})),this.tiles&&(this.tiles=this.tiles.map((function(t){return mi(t)}))),this.originalItems=this.items.slice(),this.lastOrientation={latitude:0,longitude:0}}return t.prototype.updateIndices=function(t){if(t){var e=0,n=0,i=0,o=0,r=0;t.forEach((function(t,s){if(t.index=s,t.asset)switch(t.asset.file){case"publisherStream":t.asset.index=e++;break;case"nextAttendeeStream":t.asset.index=n++;break;case"smartDeviceStream":t.asset.index=i++;break;case"publisherScreen":t.asset.index=o++;break;case"attendeeScreen":t.asset.index=r++}}))}},l(t,[{key:"payload",get:function(){var e=this,n={};return Object.keys(this).forEach((function(i){if(-1!==t.allowedProps.indexOf(i))switch(i){case"items":n[i]=e[i].map((function(t){return vi(t).payload}));break;case"tiles":n[i]=e[i].map((function(t){return mi(t).payload}));break;default:n[i]=e[i]}})),n}},{key:"pathItems",get:function(){return this.items.filter((function(t){return t.path}))}},{key:"shortType",get:function(){return this.type?this.type.split("-").map((function(t){return t.substring(0,1).toUpperCase()})).join(""):"??"}}]),t}();c(oi,"allowedProps",["id","type","name","hidden","likes","asset","items","orientation","zoom","ar","tiles","invertAxes","flipAxes"]);var ri=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e}(oi),si=function(t){function e(i){var o;return i.tiles=e.mapTiles(i.tiles,i.flipAxes,i.invertAxes,i.asset?i.asset.folder:""),(o=t.call(this,i)||this).index_=0,o.index$=new n.Subject,o.tiles.forEach((function(t,e){return t.selected=0===e})),o.tiles.length&&(o.items=o.originalItems.concat(o.tiles[0].navs),o.asset=o.tiles[0].asset),o}d(e,t),e.mapTiles=function(t,e,n,i){void 0===t&&(t=[]),void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i="");var o=e?-1:1;return t.map((function(t,e){var r=new THREE.Vector2;return(t="string"==typeof t?{id:e+1,asset:{folder:i,file:t},navs:[]}:t).asset.file.replace(/_x([-|\d]+)_y([-|\d]+)/g,(function(t,e,i){n?(r.y=parseInt(e),r.x=parseInt(i)*o):(r.x=parseInt(e),r.y=parseInt(i)*o)})),{id:t.id,type:Object.assign({},ni.PanoramaGrid),asset:t.asset,navs:t.navs||[],indices:r}}))},l(e,[{key:"index",set:function(t){this.index_!==t&&(this.index_=t,this.tiles.forEach((function(e,n){return e.selected=n===t})),this.updateCurrentItems(),this.index$.next(t))},get:function(){return this.index_}}]);var i=e.prototype;return i.updateCurrentItems=function(){this.items=this.originalItems.concat(this.tiles[this.index_].navs)},i.getTileIndex=function(t,e){return this.tiles.reduce((function(n,i,o){return i.indices.x===t&&i.indices.y===e?o:n}),-1)},i.hasTile=function(t,e){return-1!==this.getTileIndex(t,e)},i.getTile=function(t,e){var n=this.getTileIndex(t,e);if(-1!==n)return this.index=n,this.tiles[n]},e}(oi),ai=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e}(oi),li=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e}(oi),ci=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e}(oi),ui=function(){function t(t){t&&Object.assign(this,t)}return l(t,[{key:"payload",get:function(){var e=this,n={};return Object.keys(this).forEach((function(i){-1!==t.allowedProps.indexOf(i)&&(n[i]=e[i])})),!n.link||n.link.title&&n.link.href||delete n.link,n}},{key:"hasPanel",get:function(){return this.type.name===ii.Nav.name&&(this.title&&""!==this.title||this.abstract&&""!==this.abstract||this.asset||this.link)}}]),t}();c(ui,"allowedProps",["id","type","title","abstract","asset","link","viewId","hook","hookExtra","keepOrientation","important","transparent","position","rotation","scale","radius","height","arc"]);var di=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(ui),hi=function(){function t(t){t&&Object.assign(this,t),this.navs=(this.navs||[]).map((function(t){return vi(t)})),this.originalItems=this.navs.slice()}return l(t,[{key:"payload",get:function(){var e=this,n={};return Object.keys(this).forEach((function(i){if(-1!==t.allowedProps.indexOf(i))switch(i){case"navs":n[i]=e[i].map((function(t){return vi(t).payload}));break;default:n[i]=e[i]}})),n}}]),t}();function pi(t){switch(t.type.name){case ni.Panorama.name:t=new ri(t);break;case ni.PanoramaGrid.name:t=new si(t);break;case ni.Room3d.name:t=new ai(t);break;case ni.Model.name:t=new li(t);break;case ni.Media.name:t=new ci(t);break;default:t=new oi(t)}return t}function vi(t){switch(t.type.name){case ii.Nav.name:t=new di(t);break;default:t=new ui(t)}return t}function mi(t){return new hi(t)}function fi(t){return t&&t.length>0}c(hi,"allowedProps",["id","asset","navs"]);var gi=function(){function t(t){t&&Object.assign(this,t),this.items=(this.items||[]).map((function(t){return vi(t)})),this.originalItems=this.items.slice()}return l(t,[{key:"payload",get:function(){var t=this,e={};return Object.keys(this).forEach((function(n){if(-1!==View.allowedProps.indexOf(n))switch(n){case"items":e[n]=t[n].map((function(t){return vi(t).payload}));break;default:e[n]=t[n]}})),e}}]),t}();function bi(t){return t=new gi(t)}c(gi,"allowedProps",["id","name","asset","items"]);var wi=function(){function t(){}return t.navmapGet$=function(){return hn.get$("/api/navmap").pipe(i.map((function(t){return t.navmaps.map((function(t){return bi(t)})),t.navmaps})))},t.navmapCreate$=function(t){return hn.post$("/api/navmap",t).pipe(i.map((function(t){return bi(t)})))},t.navmapUpdate$=function(t){return hn.put$("/api/navmap/"+t.id,t).pipe(i.map((function(t){return bi(t)})))},t.navmapDelete$=function(t){return hn.delete$("/api/navmap/"+t.id)},t.itemCreate$=function(t,e){return hn.post$("/api/navmap/"+t.id+"/item",e).pipe(i.map((function(t){return vi(t)})))},t.itemUpdate$=function(t,e){return e=vi(e),hn.put$("/api/navmap/"+t.id+"/item/"+e.id,e.payload).pipe(i.map((function(t){return vi(t)})))},t.itemDelete$=function(t,e){return hn.delete$("/api/navmap/"+t.id+"/item/"+e.id)},l(t,null,[{key:"active",set:function(t){this.active$.next(t)},get:function(){return this.active$.getValue()}}]),t}();c(wi,"active$",new n.BehaviorSubject(!1));var yi=function(){function t(){}return t.push=function(t){return function(t){(window.dataLayer||[]).push(t),console.log("GtmService.dataLayer",t)}(t)},t}(),xi="info",Ci="alert",ki="dialog",Mi="centered",Si="bottom-right",Ti=function(t){this.toast=t},Ei=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ti),Li=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ti),_i=function(){function t(){}return t.open$=function(t){var e=this;switch(t.id=(new Date).getTime(),t.type=t.type||xi,t.position=t.position||Mi,t.type){case Ci:t.acceptMessage=t.acceptMessage||"Ok";break;case ki:t.acceptMessage=t.acceptMessage||"Accept",t.rejectMessage=t.rejectMessage||"Reject"}return this.toast$.next(t),t.type===xi&&setTimeout((function(){e.resolve(t)}),t.duration||4e3),this.events$},t.resolve=function(t){this.toast$.next(null),this.events$.next(new Ei(t))},t.reject=function(t){this.toast$.next(null),this.events$.next(new Li(t))},t}();_i.toast$=new n.Subject,_i.events$=new n.Subject;var Ii=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var e=this;this.busy_=!1;var n=t.getContext(this).node;this.modalNode=n.querySelector(".modal-outlet__modal"),Bn.modal$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.modal=t})),Bn.busy$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.busy=t}))},o.reject=function(t){Bn.reject()},l(n,[{key:"modal",get:function(){return this.modal_},set:function(e){var n=t.getContext(this).module;if(this.modal_&&this.modal_.node&&(n.remove(this.modal_.node,this),this.modalNode.removeChild(this.modal_.node)),e&&e.node){this.modal_=e,this.modalNode.appendChild(e.node);n.compile(e.node)}this.modal_=e,this.pushChanges()}},{key:"busy",get:function(){return this.busy_},set:function(t){this.busy_!==t&&(this.busy_=t,this.pushChanges())}}]),n}(t.Component);Ii.meta={selector:"[modal-outlet]",template:'\n\t<div class="modal-outlet__container" [class]="{ active: modal, busy: busy }">\n\t\t<div class="modal-outlet__background" (click)="reject($event)"></div>\n\t\t<div class="modal-outlet__modal"></div>\n\t\t\x3c!-- spinner --\x3e\n\t\t<div class="spinner spinner--contrasted" *if="busy"></div>\n\t</div>\n\t'};var Ri=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){e.prototype.onInit.call(this);var i=t.getContext(this),o=i.parentInstance,r=i.node;if(o instanceof Ii){var s=this.data=o.modal.data;if(s&&s.ar){var a=n.getUrl(s);new QRious({element:r.querySelector(".qrcode"),value:a,size:256})}}},i.onClose=function(){Bn.reject()},n.getUrl=function(t){var e=E.getAbsoluteUrl(E.template.tryInAr,{viewId:t.id});return console.log("TryInARModalComponent.getUrl",e),e},n.openInAR=function(t){var e=this.getUrl(t);window.open(e,"_blank")},n}(t.Component);Ri.meta={selector:"[try-in-ar-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Inquadra il qrcode con il cellulare o il tablet per vedere il VR.</div>\n\t\t\t\t<div class="picture">\n\t\t\t\t\t<canvas class="qrcode"></canvas>\n\t\t\t\t</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onClose()">\n\t\t\t\t\t\t<span>Chiudi</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},Ri.chunk=function(){return'<div class="try-in-ar-modal" try-in-ar-modal></div>'};var Ai=["jpeg","jpg","png","hdr"],Pi=["mp4","webm"],$i=["fbx","gltf","glb","usdz"],Hi={Image:{id:1,name:"image"},Video:{id:2,name:"video"},Model:{id:3,name:"model"},PublisherStream:{id:4,name:"publisher-stream",file:"publisherStream"},AttendeeStream:{id:5,name:"next-attendee-stream",file:"nextAttendeeStream"},PublisherScreen:{id:6,name:"publisher-screen",file:"publisherScreen"},AttendeeScreen:{id:7,name:"attendee-screen",file:"attendeeScreen"},SmartDeviceStream:{id:8,name:"smart-device-stream",file:"smartDeviceStream"}},Oi={ImageOrVideo:{id:1,name:"Image or Video",ids:[1,2]},Publisher:{id:3,name:"Publisher",ids:[4]},Attendee:{id:4,name:"Attendee",ids:[5]}};E.flags.editorAssetScreen&&(Oi.PublisherScreen={id:5,name:"PublisherScreen",ids:[6]},Oi.AttendeeScreen={id:6,name:"AttendeeScreen",ids:[7]}),Oi.SmartDevice={id:7,name:"Smart Device",ids:[8]};var Bi=[Hi.PublisherStream.name,Hi.AttendeeStream.name,Hi.PublisherScreen.name,Hi.AttendeeScreen.name,Hi.SmartDeviceStream.name];function Di(t){return t&&-1!==Bi.indexOf(t.type.name)}function Ui(t){var e;return t&&t.asset&&(e=Object.keys(Oi).find((function(e){return-1!==Oi[e].ids.indexOf(t.asset.type.id)}))),Oi[e||"ImageOrVideo"]}function Vi(t){var e,n=function(t){return Object.keys(Hi).reduce((function(e,n){var i=Hi[n];return i.id===t?i:e}),null)}((e=t,Object.keys(Oi).reduce((function(t,n){var i=Oi[n];return i.id===e?i:t}),null)).ids[0]),i=n.file;return new ji({type:n,folder:"",file:i})}function zi(t){var e=t.split(".").pop().toLowerCase();return-1!==Ai.indexOf(e)?Hi.Image:-1!==Pi.indexOf(e)?Hi.Video:-1!==$i.indexOf(e)?Hi.Model:void 0}var ji=function(){function t(t){t&&Object.assign(this,t)}return t.fromUrl=function(e){var n=e.split("/"),i=n.pop(),o=n.join("/")+"/";return new t({type:zi(i),folder:o,file:i})},l(t,[{key:"payload",get:function(){var e=this,n={};return Object.keys(this).forEach((function(i){-1!==t.allowedProps.indexOf(i)&&(n[i]=e[i])})),n}}],[{key:"defaultMediaAsset",get:function(){return{id:-1,type:{id:Hi.Image,name:"image"},folder:"/textures/grid/",file:"grid.jpg"}}}]),t}();function Fi(t){return t.type.name,t=new ji(t)}c(ji,"allowedProps",["id","type","folder","file","linkedPlayId","chromaKeyColor","autoplay","loop"]);var Ni=function(){function t(){}return t.getDefaultLanguages=function(){return E.alternates||[]},t.getDefaultLanguage=function(){return E.defaultLanguage||(this.languages?this.languages[0].lang:null)},t.setLanguage=function(t){this.selectedLanguage=t.lang},t.setLanguage$=function(t){var e=this;return n.from(fetch(t.href).then((function(t){return t.text()}))).pipe(i.tap((function(n){var i=/(window\.labels[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\n*[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\{((\{[\s\S]+?\})|[\s\S])+?\})/gm.exec(n);i&&(new Function(i[0]).call(window),Dn.setLabels());var o=/(window\.bhere[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\n*[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\{((\{[\s\S]+?\})|[\s\S])+?\})/gm.exec(n);if(o){var r={};new Function(o[0].replace("window","this")).call(r),r.bhere&&m.merge(E,r.bhere)}L.replace(e.activeLanguage.href,t.href),e.selectedLanguage=t.lang})))},t.toggleLanguages=function(){this.showLanguages=!this.showLanguages,this.pushChanges()},l(t,null,[{key:"hasLanguages",get:function(){return this.languages.length>1}},{key:"activeLanguage",get:function(){var t=this;return this.languages.find((function(e){return e.lang===t.selectedLanguage}))}}]),t}();c(Ni,"languages",Ni.getDefaultLanguages()),c(Ni,"defaultLanguage",Ni.getDefaultLanguage()),c(Ni,"selectedLanguage",Ni.defaultLanguage);var Gi={id:"waiting-room",type:{id:1,name:"waiting-room"},name:"Waiting Room",likes:0,liked:!1,asset:{type:{id:1,name:"image"},folder:"/textures/waiting-room/",file:"waiting-room.jpg"},items:[],orientation:{latitude:0,longitude:0}},qi=function(){function t(){}return t.getDataView=function(t){return this.dataViews.find((function(e){return e.id===t}))},t.getValidPathId=function(t){return t?null==this.validPathViews.find((function(e){return e.id===t}))?null:void 0:null},t.getFirstPathId=function(){var t=this.editor&&null===this.path.id?this.dataViews:this.pathViews;return t.length?t[0].id:null},t.data$=function(){var t=this;if(!this.data$_){var e=(E.flags.production?"/api/view":"./api/data.json")+"?lang="+Ni.selectedLanguage;this.data$_=hn.get$(e).pipe(i.map((function(e){e.views=e.views.map((function(t){return pi(t)})),t.data=e;var n=e.views;return t.views=n,e})),i.shareReplay(1))}return this.data$_},t.view$=function(){var t=this,e=new $,n=this.getValidPathId(e.viewId),o=this.getValidPathId(e.embedViewId)||n||this.getFirstPathId();return this.action$_.next({viewId:o}),this.action$_.pipe(i.distinctUntilChanged((function(t,e){return t.viewId===e.viewId})),i.map((function(e){var n=t.dataViews.find((function(t){return t.id===e.viewId}));return n&&(n.keepOrientation=e.keepOrientation||!1,n.useLastOrientation=e.useLastOrientation||!1),n||t.getWaitingRoom()})))},t.setDataAndPath=function(t,e){this.data=t,t.views.forEach((function(t){t.path=!e||-1===e.items.indexOf(t.id),t.items.forEach((function(t){var n=!0;e&&(t.type.name===ii.Nav.name&&(n=-1===e.items.indexOf(t.viewId)),t.path=n)}))})),this.views=t.views,this.path=e},t.hostedView$=function(e,o){var r=this;this.setDataAndPath(e,o),this.editor=!1;var s=this.getWaitingRoom();return n.combineLatest([this.view$(),this.hosted$()]).pipe(i.map((function(t){var e=t[0];return t[1]?e:s})),i.distinctUntilChanged((function(t,e){return t.id===e.id})),i.tap((function(e){if(r.view=e,e.id!==s.id){L.set("viewId",e.id);var n=t.getPrefetchAssets(e);e.prefetchAssets=n}})))},t.editorView$=function(t,e){var n=this;this.setDataAndPath(t,e),this.editor=!0;var o=this.getWaitingRoom();return this.view$().pipe(i.map((function(t){return n.view=t,t.id!==o.id&&L.set("viewId",t.id),e&&null!==e.id?L.set("pathId",e.id):L.delete("pathId"),t})))},t.hosted$=function(){return _.state$.pipe(i.map((function(t){return t.hosted})),i.distinctUntilChanged())},t.viewById$=function(t){var e=this;return this.data$().pipe(i.map((function(n){return e.views.find((function(e){return e.id===t}))})))},t.viewLike$=function(t){return t.liked?n.of(null):(t.liked=!0,E.flags.production?hn.get$("/api/view/"+t.id+"/like"):(t.likes=t.likes||0,t.likes++,n.of(t)))},t.setViewLike$=function(t){return this.viewById$(t.viewId).pipe(i.tap((function(e){e&&(e.likes=t.likes)})))},t.getWaitingRoom=function(){return this.dataViews.find((function(t){return t.type.name===ni.WaitingRoom.name}))||Gi},t.getPrefetchAssets=function(t){var e=this.views;return t.items.filter((function(t){return t.type.name===ii.Nav.name&&null!=t.viewId})).map((function(t){return e.find((function(e){return e.id===t.viewId}))})).filter((function(t){return t&&t.asset&&t.asset.type.name===Hi.Image.name})).map((function(t){return E.getPath(t.asset.folder+t.asset.file)}))},t.addView=function(t){var e=this.data,n=e.views.slice();n.push(t),e.views=n,this.views=n,this.viewId=t.id},t.deleteView=function(e){var n=this.data,i=n.views.slice(),o=i.reduce((function(t,n,i){return n.id===e.id?i:t}),-1);o>0&&(i.splice(o,1),n.paths=i),t.viewId=this.dataViews[0].id},l(t,null,[{key:"views",set:function(t){this.views$_.next(t)},get:function(){return this.views$_.getValue()}},{key:"view",set:function(t){this.view$_.next(t)},get:function(){return this.view$_.getValue()}},{key:"dataViews",get:function(){return this.data?this.data.views:[]}},{key:"validViews",get:function(){return this.data?this.data.views.filter((function(t){return t.type.name!==ni.WaitingRoom.name})):[]}},{key:"pathViews",get:function(){return this.validViews.filter((function(t){return t.path}))}},{key:"validPathViews",get:function(){return(this.editor?this.data.views:this.validViews).filter((function(t){return t.path}))}},{key:"action",set:function(t){this.action$_.next(t)},get:function(){return this.action$_.getValue()}},{key:"viewId",set:function(t){this.action$_.next({viewId:t,keepOrientation:!1,useLastOrientation:!1})},get:function(){var t=this.action$_.getValue();return t?t.viewId:null}}]),t}();c(qi,"views$_",new n.BehaviorSubject([])),c(qi,"view$_",new n.BehaviorSubject(null)),c(qi,"action$_",new n.BehaviorSubject(null));var Zi=0,Wi=function(){function t(t){t&&Object.assign(this,t)}return t.prototype.toJson=function(){return JSON.stringify(this)},t.newEvent=function(e,n,i){console.log("WebhookEvent.newEvent",e,n,i);var o=new t;o.action=e,o.data=n,o.extra="string"==typeof i?JSON.parse(i):i,o.meetingId=_.state.link,o.userSessionId=_.state.uid,o.userRole=_.state.role,o.fullName=_.state.name;var r=(new Date).getTime();return o.timestamp=r,o.id=r+"-"+ ++Zi,o},t.parseEvent=function(e){if(e&&"data"in e){var n="string"==typeof e.data?JSON.parse(e.data):e.data;return"action"in n?new t(n):null}return null},t}(),Ki=function(){function t(){}return t.internal$_=function(t){var e=this;return n.of(t).pipe(i.tap((function(t){console.log("WebhookService.internal$_.postMessage",t),window.parent&&window.parent.postMessage(t.action,t.toJson())})),i.switchMap((function(t){return e.event$_.pipe(i.filter((function(t){return t.id==t.id})),i.first())})),i.map((function(n){return console.log("WebhookService.internal$_.handleResponse_",t,n),e.handleResponse_(t,n)})),i.catchError((function(n){return e.handleError_(t,n)})))},t.send$_=function(t,e){var n=this;hn.post$(t,e).pipe(i.map((function(t){return n.handleResponse_(e,t)})),i.catchError((function(t){return n.handleError_(e,t)})))},t.send$=function(t,e,i){var o=this;if(console.log("WebhookService.send$",t,e,i),this.enabled){var r=Wi.newEvent(t,e,i),s=E.webhook.uris.map((function(t){return"internal"===t?o.internal$_(r):o.send$_(t,r)}));return n.forkJoin(s)}return n.of(n.EMPTY)},t.handleResponse_=function(t,e){console.log("WebhookService.handleResponse_",e);var n=Object.assign({},t);return n.remoteStatus=1,n.remoteResponse=e,n},t.handleError_=function(t,e){var i=Object.assign({},t);return i.remoteStatus=0,i.remoteError=e,n.of(i)},l(t,null,[{key:"enabled",get:function(){return E.webhook&&E.webhook.uris&&E.webhook.uris.length>0}}]),t}();c(Ki,"event$_",n.fromEvent(window,"message").pipe(i.map((function(t){return Wi.parseEvent(t)})),i.filter((function(t){return null!==t})),i.shareReplay(1)));var Xi=null,Yi=function(){function t(){}return t.getItems=function(){return this.items$.getValue()},t.indexOf=function(t){return this.getItems().reduce((function(e,n,i){return-1===e&&n.viewId===t.viewId&&n.itemId===t.itemId?i:e}),-1)},t.has=function(t){return-1!==this.indexOf(t)},t.add$=function(t){var e=this.getItems();return this.has(t)||(e.push(t),Un.set("wishlist",e),this.items$.next(e)),this.items$},t.remove$=function(t){var e=this.getItems(),n=this.indexOf(t);return-1!==n&&(e.splice(n,1),Un.set("wishlist",e),this.items$.next(e)),this.items$},t.toggle$=function(t){var e=this.getItems(),n=this.indexOf(t);return-1!==n?(e.splice(n,1),Un.set("wishlist",e),this.items$.next(e)):(e.push(t),Un.set("wishlist",e),this.items$.next(e)),this.items$},l(t,null,[{key:"items$",get:function(){if(!Xi){var t=Un.get("wishlist")||[];Xi=new n.BehaviorSubject(t)}return Xi}}]),t}(),Ji=function(t){this.loader=t},Qi=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ji),to=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ji),eo=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ji),no=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ji),io=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ji),oo=function(){function t(t){var e=this;this.item=t,this.toggle=this.toggle.bind(this),this.muted_=!1,this.subscription=_.state$.subscribe((function(t){return e.muted=t.volumeMuted}))}t.getLoader=function(){return t.loader||(t.loader=new THREE.TextureLoader)},t.getPath=function(t){return E.getPath(t.asset.folder+t.asset.file)},t.loadTexture=function(e,n){var i=t.getPath(e);return t.getLoader().load(i,n)},t.isVideo=function(t){return t.asset&&t.asset.file&&(-1!==t.asset.file.indexOf(".mp4")||-1!==t.asset.file.indexOf(".webm"))},t.isStream=function(t){return Di(t.asset)},t.isMutedStream=function(t){var e=!1;switch(t.asset.type.name){case Hi.PublisherStream.name:e=_.state.role===I.Publisher;break;case Hi.AttendeeStream.name:e=_.state.role===I.Attendee;break;case Hi.PublisherScreen.name:case Hi.AttendeeScreen.name:e=!0;break;case Hi.SmartDeviceStream.name:e=_.state.role===I.SmartDevice}return e},t.isPublisherStream=function(t){return t.asset&&t.asset.type.name===Hi.PublisherStream.name},t.isAttendeeStream=function(t){return t.asset&&t.asset.type.name===Hi.AttendeeStream.name},t.isSmartDeviceStream=function(t){return t.asset&&t.asset.type.name===Hi.SmartDeviceStream.name},t.isPublisherScreen=function(t){return t.asset&&t.asset.type.name===Hi.PublisherScreen.name},t.isAttendeeScreen=function(t){return t.asset&&t.asset.type.name===Hi.AttendeeScreen.name},l(t,[{key:"isVideo",get:function(){return t.isVideo(this.item)}},{key:"isStream",get:function(){return t.isStream(this.item)}},{key:"isMutedStream",get:function(){return t.isMutedStream(this.item)}},{key:"isPublisherStream",get:function(){return t.isPublisherStream(this.item)}},{key:"isAttendeeStream",get:function(){return t.isAttendeeStream(this.item)}},{key:"isSmartDeviceStream",get:function(){return t.isSmartDeviceStream(this.item)}},{key:"isPublisherScreen",get:function(){return t.isPublisherScreen(this.item)}},{key:"isAttendeeScreen",get:function(){return t.isAttendeeScreen(this.item)}},{key:"isPlayableVideo",get:function(){return this.isVideo}},{key:"isAutoplayVideo",get:function(){return this.isStream}},{key:"muted",get:function(){return this.muted_},set:function(t){this.muted_=t,this.video&&this.isVideo&&(this.video.muted=!0===t)}}]);var e=t.prototype;return e.load=function(e){var n,i=this,o=this.item;if(this.isStream&&o.streamId){var r=o.streamId,s=document.querySelector("#stream-"+r+" video");if(!s)return;var a=function t(){i.disposed||(s.removeEventListener("canplay",t),(n=i.texture=new THREE.VideoTexture(s)).minFilter=THREE.LinearFilter,n.magFilter=THREE.LinearFilter,n.mapping=THREE.UVMapping,n.format=THREE.RGBFormat,n.needsUpdate=!0,"function"==typeof e&&e(n,i))},l=this.isMutedStream;s.crossOrigin="anonymous",s.volume=l?0:1,s.muted=l,s.readyState>=s.HAVE_FUTURE_DATA?a():s.addEventListener("canplay",a)}else if(this.isVideo){var c=o.asset&&o.asset.autoplay||!1,u=o.asset&&o.asset.loop||!1,d=this.video=document.createElement("video");d.crossOrigin="anonymous",d.preload="metadata",d.volume=.8,d.muted=c,d.playsInline=!0,d.loop=u;d.oncanplay=function(){i.disposed||(d.oncanplay=null,(n=new THREE.VideoTexture(d)).minFilter=THREE.LinearFilter,n.magFilter=THREE.LinearFilter,n.mapping=THREE.UVMapping,n.format=THREE.RGBFormat,n.needsUpdate=!0,"function"==typeof e&&e(n,i),c?i.play(o.silent):d.pause())},d.ontimeupdate=function(){i.disposed||t.events$.next(new no(i))},d.onended=function(){i.disposed||u||t.events$.next(new to(i))},d.src=t.getPath(o),d.load()}else o.asset?t.loadTexture(o,(function(t){i.disposed||(t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,"function"==typeof e&&e(t,i))})):e(null,this);return this},e.play=function(e){var n=this;this.video&&(this.video.muted=this.muted_,this.video.play().then((function(){e||t.events$.next(new Qi(n))}),(function(t){console.log("MediaLoader.play.error",n.item.asset.file,t)})))},e.pause=function(e){this.video&&this.isVideo&&(this.video.muted=!0,this.video.pause(),e||t.events$.next(new to(this)))},e.toggle=function(){if(this.video&&this.isVideo)return this.video.paused?(this.video.muted=this.muted_,this.play(),!0):(this.pause(),!1)},e.dispose=function(){this.subscription.unsubscribe(),this.pause(!0),this.isVideo&&this.video&&(this.video.ontimeupdate=null,this.video.onended=null,t.events$.next(new eo(this))),this.disposed=!0,delete this.video},l(t,[{key:"progress",get:function(){return this.video?this.video.currentTime/this.video.duration:0},set:function(e){if(this.video){var n=this.video.duration*e;this.video.seekable.length>e&&this.video.currentTime!==n&&(this.video.currentTime=n,t.events$.next(new io(this)))}}}]),t}();oo.events$=new n.ReplaySubject(1);var ro=function(){function t(){}return l(t,null,[{key:"defaultGeometry",get:function(){return t.defaultGeometry_||(t.defaultGeometry_=new THREE.BoxBufferGeometry(1,1,1))}},{key:"planeGeometry",get:function(){return t.planeGeometry_||(t.planeGeometry_=new THREE.PlaneBufferGeometry(1,1,2,2))}},{key:"sphereGeometry",get:function(){return t.sphereGeometry_||(t.sphereGeometry_=new THREE.SphereBufferGeometry(3,12,12))}},{key:"panoramaGeometry",get:function(){return t.panoramaGeometry_||(t.panoramaGeometry_=new THREE.SphereBufferGeometry(101,36,36))}}]),t}(),so=(new THREE.Vector3,function(){function t(){}return t.getDistanceToCamera=function(t,e,n,i,o){void 0===o&&(o=.88);var r=2*Math.atan(Math.PI*e/360),s=i.y*t.zoom/r,a=i.x*t.zoom/r/n;return o*Math.max(s,a)},l(t,null,[{key:"origin",get:function(){var t=this.host;if(t){var e=this.origin_;e.set(0,0,0),(t.renderer.xr.isPresenting?t.renderer.xr.getCamera(t.camera):t.camera).localToWorld(e)}return this.origin_}}]),t}());c(so,"origin_",new THREE.Vector3);var ao=function(){};ao.items=[],ao.hittest=function(t,e,n){var i=this;void 0===e&&(e=!1);var o=!1;this.down!==e&&(this.down=e,this.lock=!1,o=!0);var r,s,a=this.items.filter((function(t){return t.parent&&!t.freezed})),l=t.intersectObjects(a),c={};l.forEach((function(t,e){var n=t.object;r=n.uuid,0===e&&(i.lastIntersectedObject!==n||o?(i.lastIntersectedObject=n,s=n):n.intersection&&(Math.abs(n.intersection.point.x-t.point.x)>.01||Math.abs(n.intersection.point.y-t.point.y)>.01)&&(n.intersection=t,n.emit("move",n))),c[r]=t})),0===l.length&&(this.lastIntersectedObject=null);return a.forEach((function(t){t.intersection=c[t.uuid],t.over=t===i.lastIntersectedObject||t.intersection&&!t.depthTest&&(!i.lastIntersectedObject||i.lastIntersectedObject.depthTest),t.down=e&&t.over&&!i.lock,t.down&&(i.lock=!0)})),s}.bind(ao),ao.dispose=function(t){if(t){var e=this.items.indexOf(t);-1!==e&&this.items.splice(e,1)}}.bind(ao);var lo=function(t){function e(e,n){var i;return e=e||ro.defaultGeometry,n=n||new THREE.MeshBasicMaterial({color:16711935}),(i=t.call(this,e,n)||this).freezed=!1,i}d(e,t),l(e,[{key:"freezed",get:function(){return this.freezed_},set:function(t){this.freezed_=t,this.children.filter((function(t){return t.__lookupGetter__("freezed")})).forEach((function(e){return e.freezed=t}))}}]);var n=e.prototype;return n.freeze=function(){this.freezed=!0},n.unfreeze=function(){this.freezed=!1},e}(THREE.Mesh),co=function(t){function e(e,n){var i;return e=e||ro.defaultGeometry,n=n||new THREE.MeshBasicMaterial({color:16711935}),(i=t.call(this,e,n)||this).events={},i}d(e,t);var n=e.prototype;return n.on=function(t,e){var n=this,i=this.events[t]=this.events[t]||[];return i.push(e),function(){n.events[t]=i.filter((function(t){return t!==e}))}},n.off=function(t,e){var n=this.events[t];n&&(this.events[t]=n.filter((function(t){return t!==e})))},n.emit=function(t,e){var n=this.events[t];n&&n.forEach((function(t){t(e)}));var i=this.events.broadcast;i&&i.forEach((function(n){n(t,e)}))},e}(lo),uo=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).depthTest=!0,i.over_=!1,i.down_=!1,ao.items.push(h(i)),i}return d(e,t),l(e,[{key:"isInteractiveMesh",get:function(){return!0}},{key:"over",get:function(){return this.over_},set:function(t){this.over_!=t&&(this.over_=t,t?this.emit("over",this):this.emit("out",this))}},{key:"down",get:function(){return this.down_},set:function(t){t=t&&this.over,this.down_!=t&&(this.down_=t,t?this.emit("down",this):this.emit("up",this))}}]),e}(co),ho=function(){function t(){}return t.keydown$=function(){return this.keydown$_||(this.keydown$_=n.fromEvent(window,"keydown").pipe(i.shareReplay(1))),this.keydown$_},t.keyup$=function(){return this.keyup$_||(this.keyup$_=n.fromEvent(window,"keyup").pipe(i.shareReplay(1))),this.keyup$_},t.keys$=function(){var t=this;return this.keys$_||(this.keys$_=n.merge(this.keydown$(),this.keyup$()).pipe(i.map((function(e){var n=t.keys;return"keydown"===e.type?n[e.key]=!0:delete n[e.key],t.keys})),i.startWith(this.keys),i.shareReplay(1))),this.keys$_},t.key$=function(){if(!this.key$_){var t=/\w/;this.key$_=this.keydown$().pipe(i.filter((function(e){return e.key&&e.key.match(t)})),i.map((function(t){return t.key})),i.shareReplay(1))}return this.key$_},t.typing$=function(){if(!this.typing$_){var t,e="";this.typing$_=this.key$().pipe(i.map((function(n){return t&&clearTimeout(t),e+=n,t=setTimeout((function(){e=""}),1500),e})),i.shareReplay(1))}return this.typing$_},t}();c(ho,"keys",{});var po=0,vo=function(){function t(){}return t.switchLoaders=function(){var t=this,e=Object.keys(this.items).map((function(e){return t.items[e]})),i=e.length?n.combineLatest(e):n.of(e);this.progress$.next(i)},t.getRef=function(){var t=++po;return this.items[t]=new n.BehaviorSubject({loaded:0,total:1}),this.switchLoaders(),t},t.setProgress=function(t,e,n){var i=this;void 0===n&&(n=1);var o=this.items[t];o&&o.next({loaded:e,total:n}),e>=n&&setTimeout((function(){delete i.items[t],i.switchLoaders()}),300),this.switchLoaders()},t}();c(vo,"progress",{value:0,loaded:0,total:0,count:0,title:""}),c(vo,"items",{}),c(vo,"progress$",new n.ReplaySubject(1).pipe(i.switchAll(),i.map((function(){var t=Object.keys(vo.items).map((function(t){return vo.items[t]})),e=t.reduce((function(t,e,n,i){var o=e.getValue(),r=o.loaded||0,s=o.total||1,a=r/s;return t.value+=a,t.loaded+=r,t.total+=s,t}),{value:0,loaded:0,total:0});return e.count=t.length,t.length&&(e.value/=e.count),e.title=Math.round(100*e.value)+"%",vo.progress=e,e}))));var mo,fo=0,go="complete",bo=function(){function t(){}return t.worker=function(){return this.worker_||(this.worker_=new Worker(E.workers.prefetch)),this.worker_},t.events$=function(t){if(!("Worker"in window))return n.of({type:go,data:t});var e=this.worker();e.postMessage({id:fo});var o=++fo;return e.postMessage({id:o,assets:t}),n.fromEvent(e,"message").pipe(i.map((function(t){return t.data})),i.filter((function(e){return e.assets===t})),i.tap((function(t){})),i.takeWhile((function(t){return t.type!==go}),!0),i.finalize((function(){e.postMessage({id:o})})))},t.load$=function(t){return this.events$(t).pipe(i.filter((function(t){return t.type===go})),i.map((function(t){return t.data})))},t.prefetch=function(t){this.load$(t).subscribe((function(t){console.log("PrefetchService.prefetch",t)}))},t.cancel=function(){if(!("Worker"in window))return null;var t=this.worker();return t.postMessage({id:fo}),t},t}(),wo=function(){function t(t){this.x=0,this.y=0,this.top=0,this.right=0,this.bottom=0,this.left=0,this.width=0,this.height=0,this.set(t)}t.contains=function(t,e,n){return t.top<=n&&n<=t.bottom&&t.left<=e&&e<=t.right},t.intersectRect=function(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},t.fromNode=function(e){if(e){var n=e.rect_||(e.rect_=new t);if(!e.getClientRects().length)return n;var i=e.getBoundingClientRect();return n.x=i.left,n.y=i.top,n.top=i.top,n.left=i.left,n.width=i.width,n.height=i.height,n.right=n.left+n.width,n.bottom=n.top+n.height,n.setCenter(),n}};var e=t.prototype;return e.set=function(t){t&&(Object.assign(this,t),this.right=this.left+this.width,this.bottom=this.top+this.height),this.setCenter()},e.setSize=function(t,e){this.width=t,this.height=e,this.right=this.left+this.width,this.bottom=this.top+this.height,this.setCenter()},e.setCenter=function(){var t=this.center||(this.center={});t.top=this.top+this.height/2,t.left=this.left+this.width/2,t.x=t.left,t.y=t.top},e.contains=function(e,n){return t.contains(this,e,n)},e.intersect=function(e){return t.intersectRect(this,e)},e.intersection=function(t){var e=this.intersection_||(this.intersection_={left:0,top:0,width:0,height:0,x:0,y:0,pow:{x:-1,y:-1},offset:function(t){return t=t||0,(this.top-this.rect.height/2+t)/-this.height},scroll:function(t){return t=t||0,(this.top-this.rect.height/2+t)/-this.height}});e.left=this.left,e.top=this.top,e.width=this.width,e.height=this.height,e.x=this.left+this.width/2,e.y=this.top+this.height/2,e.rect=t;var n=e.offset(0);return e.pow.y=n,e},t}(),yo=[16763904,65484,52479,13434624,13369599,16777215],xo=function(){function t(t){var e=this.clientId=t.clientId,n=this.container=t.container,i=this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1,premultipliedAlpha:!0});i.setClearColor(0,1),i.setPixelRatio(window.devicePixelRatio),i.setSize(320,240),i.toneMapping=THREE.ACESFilmicToneMapping,i.toneMappingExposure=.8,i.outputEncoding=THREE.sRGBEncoding,n.appendChild(i.domElement);var o=this.camera=new THREE.PerspectiveCamera(70,320/240,.01,1e3);o.position.set(0,0,-.5),o.target=new THREE.Vector3,o.lookAt(o.target);var r=this.scene=new THREE.Scene,s=this.light=new THREE.PointLight(16777215,1,100);s.position.set(0,2,-2),r.add(s);var a=this.head=this.addHead();r.add(a);this.remote=Ln.getRemoteById(e)}l(t,null,[{key:"headGeometry",get:function(){return this.headGeometry_||(this.headGeometry_=new THREE.SphereBufferGeometry(.2,36,24)),this.headGeometry_}}]);var e=t.prototype;return e.addHead=function(){var e=t.headGeometry,n=this.canvas=document.createElement("canvas");n.width=1024,n.height=512;this.ctx=this.canvas.getContext("2d");var i=this.map=new THREE.CanvasTexture(n);i.offset.x=-.25;var o=yo[this.clientId%yo.length],r=new THREE.MeshStandardMaterial({map:i,color:o});return this.chalk(0),new THREE.Mesh(e,r)},e.render=function(){this.tick_?++this.tick_:this.tick_=1;if(this.remote){var t=12*this.remote.getAudioLevel();this.chalk(t)}var e=this.renderer,n=this.scene,i=this.camera;e.render(n,i)},e.update=function(t){var e=t.camera;this.head.quaternion.set(e[3],e[4],e[5],e[6])},e.dispose=function(){this.subscription&&this.subscription.unsubscribe()},e.chalk=function(t){t=(t+.5*Math.PI)%(2*Math.PI);var e=30*Math.sin(t),n=10*Math.cos(t),i=256,o=this.ctx;o.fillStyle="#888888",o.fillRect(0,0,1024,512),o.fillStyle="white",o.beginPath(),o.arc(472,206,7,0,2*Math.PI),o.arc(552,206,7,0,2*Math.PI),o.closePath(),o.fill(),o.beginPath(),o.moveTo(472-n,286),o.bezierCurveTo(472-n,316,552+n,316,552+n,286),o.bezierCurveTo(552+n,i+e,472-n,i+e,472-n,286),o.closePath(),o.fill(),this.map.needsUpdate=!0},t}(),Co=THREE,ko=Co.DataTextureLoader,Mo=Co.DataUtils,So=Co.FloatType,To=Co.HalfFloatType,Eo=Co.LinearEncoding,Lo=Co.LinearFilter,_o=Co.NearestFilter,Io=Co.RGBEEncoding,Ro=Co.RGBEFormat,Ao=Co.RGBFormat,Po=Co.UnsignedByteType,$o=function(t){function e(e){var n;return(n=t.call(this,e)||this).type=Po,n}d(e,t);var n=e.prototype;return n.parse=function(t){var e=function(t,e){switch(t){case 1:console.error("THREE.RGBELoader Read Error: "+(e||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(e||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(e||""))}return-1},n=function(t,e,n){e=e||1024;for(var i=t.pos,o=-1,r=0,s="",a=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));0>(o=a.indexOf("\n"))&&r<e&&i<t.byteLength;)s+=a,r+=a.length,i+=128,a+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));return-1<o&&(!1!==n&&(t.pos+=r+o+1),s+a.slice(0,o))},i=function(t,e,n,i){var o=t[e+3],r=Math.pow(2,o-128)/255;n[i+0]=Mo.toHalfFloat(t[e+0]*r),n[i+1]=Mo.toHalfFloat(t[e+1]*r),n[i+2]=Mo.toHalfFloat(t[e+2]*r)},o=new Uint8Array(t);o.pos=0;var r,s,a,l,c,u,d=function(t){var i,o,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(i=n(t)))return e(1,"no header found");if(!(o=i.match(/^#\?(\S+)/)))return e(3,"bad initial token");for(c.valid|=1,c.programtype=o[1],c.string+=i+"\n";!1!==(i=n(t));)if(c.string+=i+"\n","#"!==i.charAt(0)){if((o=i.match(r))&&(c.gamma=parseFloat(o[1],10)),(o=i.match(s))&&(c.exposure=parseFloat(o[1],10)),(o=i.match(a))&&(c.valid|=2,c.format=o[1]),(o=i.match(l))&&(c.valid|=4,c.height=parseInt(o[1],10),c.width=parseInt(o[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=i+"\n";return 2&c.valid?4&c.valid?c:e(3,"missing image size specifier"):e(3,"missing format specifier")}(o);if(-1!==d){var h=d.width,p=d.height,v=function(t,n,i){var o=n;if(o<8||o>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(o!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");var r=new Uint8Array(4*n*i);if(!r.length)return e(4,"unable to allocate buffer space");for(var s=0,a=0,l=4*o,c=new Uint8Array(4),u=new Uint8Array(l),d=i;d>0&&a<t.byteLength;){if(a+4>t.byteLength)return e(1);if(c[0]=t[a++],c[1]=t[a++],c[2]=t[a++],c[3]=t[a++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=o)return e(3,"bad rgbe scanline format");for(var h=0,p=void 0;h<l&&a<t.byteLength;){var v=(p=t[a++])>128;if(v&&(p-=128),0===p||h+p>l)return e(3,"bad scanline data");if(v)for(var m=t[a++],f=0;f<p;f++)u[h++]=m;else u.set(t.subarray(a,a+p),h),h+=p,a+=p}for(var g=o,b=0;b<g;b++){var w=0;r[s]=u[b+w],w+=o,r[s+1]=u[b+w],w+=o,r[s+2]=u[b+w],w+=o,r[s+3]=u[b+w],s+=4}d--}return r}(o.subarray(o.pos),h,p);if(-1!==v){var m,f,g,b;switch(this.type){case Po:m=v,f=Ro,g=Po;break;case So:b=v.length/4*3;for(var w=new Float32Array(b),y=0;y<b;y++)a=w,l=3*y,c=void 0,u=void 0,c=(r=v)[(s=4*y)+3],u=Math.pow(2,c-128)/255,a[l+0]=r[s+0]*u,a[l+1]=r[s+1]*u,a[l+2]=r[s+2]*u;m=w,f=Ao,g=So;break;case To:b=v.length/4*3;for(var x=new Uint16Array(b),C=0;C<b;C++)i(v,4*C,x,3*C);m=x,f=Ao,g=To;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:h,height:p,data:m,header:d.string,gamma:d.gamma,exposure:d.exposure,format:f,type:g}}}return null},n.setDataType=function(t){return this.type=t,this},n.load=function(e,n,i,o){return t.prototype.load.call(this,e,(function(t,e){switch(t.type){case Po:t.encoding=Io,t.minFilter=_o,t.magFilter=_o,t.generateMipmaps=!1,t.flipY=!0;break;case So:case To:t.encoding=Eo,t.minFilter=Lo,t.magFilter=Lo,t.generateMipmaps=!1,t.flipY=!0}n&&n(t,e)}),i,o)},e}(ko),Ho=function(){function t(){}return l(t,null,[{key:"defaultTexture",get:function(){return t.defaultTexture_||(t.defaultTexture_=(new THREE.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDA2IDc5LjE2NDc1MywgMjAyMS8wMi8xNS0xMTo1MjoxMyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcyODFGQkE0QUMxODExRUJBQkRBQTEyMzUzMjUxRjg2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcyODFGQkE1QUMxODExRUJBQkRBQTEyMzUzMjUxRjg2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzI4MUZCQTJBQzE4MTFFQkFCREFBMTIzNTMyNTFGODYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzI4MUZCQTNBQzE4MTFFQkFCREFBMTIzNTMyNTFGODYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz55AlN+AAAAZUlEQVR42uzQAQEAAAQDMPTvfD3YIqyT1GdTzwkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAgAtWgAEAVbYDfaostxgAAAAASUVORK5CYII="))}},{key:"gridTexture",get:function(){return t.gridTexture_||(t.gridTexture_=(new THREE.TextureLoader).load(E.getPath(E.textures.grid)))}}]),t}(),Oo=function(t){function e(n){var i,o=ro.planeGeometry,r=e.getMaterial();return c(h(i=t.call(this,o,r)||this),"playing_",!1),i.material=r,i.host=n,i.colorOff=new THREE.Color(r.color.getHex()),i.colorOn=new THREE.Color("#888888"),i.addEventListener(),i}d(e,t),e.getLoader=function(){return e.loader||(e.loader=new THREE.TextureLoader)},e.getTextureOff=function(){return e.textureOff||(e.textureOff=e.getLoader().load(E.getPath("textures/ui/play-off.png")))},e.getTextureOn=function(){return e.textureOn||(e.textureOn=e.getLoader().load(E.getPath("textures/ui/play-on.png")))},e.getMaterial=function(){return new THREE.MeshBasicMaterial({map:e.getTextureOff(),color:16777215,opacity:1,transparent:!0})},l(e,[{key:"playing",get:function(){return this.playing_},set:function(t){this.playing_!==t&&(this.playing_=t,this.material.map=t?e.getTextureOn():e.getTextureOff(),this.onOut())}}]);var n=e.prototype;return n.update=function(t){var e=this.scale,n=t.scale.x/t.scale.y;e.set(.3/n,.3,1)},n.disposeMaterial=function(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())},n.dispose=function(){this.removeEventListener(),this.disposeMaterial()},n.onOver=function(){var t=this.material.color,e=this.colorOn,n=this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut}),gsap.to(n,{opacity:1,duration:.2,ease:Power2.easeInOut})},n.onOut=function(){var t=this.material.color,e=this.colorOff,n=this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut}),gsap.to(n,{opacity:this.playing?0:1,duration:.2,ease:Power2.easeInOut})},n.addEventListener=function(){this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this),this.on("over",this.onOver),this.on("out",this.onOut)},n.removeEventListener=function(){this.off("over",this.onOver),this.off("out",this.onOut)},e}(uo),Bo=function(t){function e(n){var i,o=ro.planeGeometry,r=e.getMaterial();return c(h(i=t.call(this,o,r)||this),"zoomed_",!1),i.material=r,i.host=n,i.colorOff=new THREE.Color(r.color.getHex()),i.colorOn=new THREE.Color("#888888"),i.object=new THREE.Object3D,i.addEventListener(),i}d(e,t),e.getLoader=function(){return e.loader||(e.loader=new THREE.TextureLoader)},e.getTextureOff=function(){return e.textureOff||(e.textureOff=e.getLoader().load(E.getPath("textures/ui/zoom-off.png")))},e.getTextureOn=function(){return e.textureOn||(e.textureOn=e.getLoader().load(E.getPath("textures/ui/zoom-on.png")))},e.getMaterial=function(){return new THREE.MeshBasicMaterial({map:e.getTextureOff(),color:16777215,opacity:1,transparent:!0})},l(e,[{key:"zoomed",get:function(){return this.zoomed_},set:function(t){this.zoomed_!==t&&(this.zoomed_=t,this.material.map=t?e.getTextureOn():e.getTextureOff())}}]);var n=e.prototype;return n.disposeMaterial=function(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())},n.dispose=function(){this.removeEventListener(),this.disposeMaterial()},n.onOver=function(){var t=this.material.color,e=this.colorOn;this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut})},n.onOut=function(){var t=this.material.color,e=this.colorOff;this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut})},n.onToggle=function(){this.emit("zoomed",!this.zoomed)},n.addEventListener=function(){this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this),this.onToggle=this.onToggle.bind(this),this.on("over",this.onOver),this.on("out",this.onOut),this.on("down",this.onToggle)},n.removeEventListener=function(){this.off("over",this.onOver),this.off("out",this.onOut),this.off("down",this.onToggle)},e}(uo),Do="\nvarying vec2 vUvShader;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\tvUvShader = uv;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",Uo="\n#define USE_MAP\n#define threshold 0.55\n#define padding 0.05\n\nvarying vec2 vUvShader;\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// uniform sampler2D map;\nuniform sampler2D playMap;\nuniform vec2 mapResolution;\nuniform vec2 playMapResolution;\nuniform float mapTween;\nuniform float playMapTween;\nuniform vec3 playMapColor;\nuniform vec3 chromaKeyColor;\nuniform bool isVideo;\n\nvoid main() {\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4(vec3(1.0), opacity);\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t// main\n\tvec4 mapRgba = texture2D(map, vUvShader);\n\tvec4 chromaKey = vec4(chromaKeyColor, 1.0);\n    vec3 chromaKeyDiff = mapRgba.rgb - chromaKey.rgb;\n    float chromaKeyValue = smoothstep(threshold - padding, threshold + padding, dot(chromaKeyDiff, chromaKeyDiff));\n\tmapRgba = mapTexelToLinear(mapRgba);\n\t/*\n\tif (isVideo) {\n\t\tvec4 playMapRgba = texture2D(playMap, vUvShader);\n\t\tplayMapRgba = mapTexelToLinear(playMapRgba);\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2) + (playMapRgba.rgb * mapTween * playMapRgba.a), opacity * chromaKeyValue);\n\t} else {\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity * chromaKeyValue);\n\t}\n\t*/\n\t// diffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity * chromaKeyValue);\n\tdiffuseColor = vec4(mapRgba.rgb, opacity * chromaKeyValue);\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapRgba = texture2D(lightMap, vUv2);\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear(lightMapRgba).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3(1.0);\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Vo=function(t){function e(n,i,o,r){var s,a=e.getMaterialByItem(n);c(h(s=t.call(this,o,a)||this),"zoomed_",!1),s.item=n,s.view=i,s.items=i.items,s.host=r,s.uniforms=e.getUniformsByItem(n),s.object=new THREE.Object3D,s.tempPosition=new THREE.Vector3,s.tempRotation=new THREE.Vector3,n.silent=s.isAutoplayLoop;s.mediaLoader=new oo(n);return s.onOver=s.onOver.bind(h(s)),s.onOut=s.onOut.bind(h(s)),s.onToggle=s.onToggle.bind(h(s)),s.onZoomed=s.onZoomed.bind(h(s)),s.addPlayBtn(),s.addZoomBtn(),s.userData.render=function(t,e){s.render(h(s),t,e)},s}d(e,t),e.getMaterial=function(t){return new THREE.ShaderMaterial({depthTest:!0,depthWrite:!0,transparent:!0,vertexShader:Do,fragmentShader:t?Uo:"\n#define USE_MAP\n\nvarying vec2 vUvShader;\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// uniform sampler2D map;\nuniform sampler2D playMap;\nuniform vec2 mapResolution;\nuniform vec2 playMapResolution;\nuniform float mapTween;\nuniform float playMapTween;\nuniform vec3 playMapColor;\nuniform bool isVideo;\n\nvoid main() {\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4(vec3(1.0), opacity);\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t// main\n\tvec4 mapRgba = texture2D(map, vUvShader);\n\tmapRgba = mapTexelToLinear(mapRgba);\n\tif (isVideo) {\n\t\tvec4 playMapRgba = texture2D(playMap, vUvShader);\n\t\tplayMapRgba = mapTexelToLinear(playMapRgba);\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2) + (playMapRgba.rgb * mapTween * playMapRgba.a), opacity);\n\t} else {\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity);\n\t}\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapRgba = texture2D(lightMap, vUv2);\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear(lightMapRgba).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3(1.0);\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",uniforms:{map:{type:"t",value:Ho.defaultTexture},mapResolution:{value:new THREE.Vector2},mapTween:{value:1},color:{value:new THREE.Color("#FFFFFF")},playMap:{type:"t",value:Ho.defaultTexture},playMapResolution:{value:new THREE.Vector2},playMapTween:{value:0},playMapColor:{value:new THREE.Color("#000000")},opacity:{value:0},isVideo:{value:!1}},extensions:{fragDepth:!0}})},e.getChromaKeyMaterial=function(t){void 0===t&&(t=[0,1,0]);var e=new THREE.ShaderMaterial({depthTest:!0,depthWrite:!0,transparent:!0,vertexShader:Do,fragmentShader:Uo,uniforms:{map:{type:"t",value:null},mapResolution:{value:new THREE.Vector2},mapTween:{value:1},color:{value:new THREE.Color("#FFFFFF")},chromaKeyColor:{value:new THREE.Color(t[0],t[1],t[2])},playMap:{type:"t",value:Ho.defaultTexture},playMapResolution:{value:new THREE.Vector2},playMapTween:{value:0},playMapColor:{value:new THREE.Color("#000000")},opacity:{value:0},isVideo:{value:!1}},extensions:{fragDepth:!0}});return e.map=!0,e},e.isPublisherStream=function(t){return t.clientInfo&&t.clientInfo.role===I.Publisher&&t.clientInfo.uid===t.getId()},e.isAttendeeStream=function(t){return t.clientInfo&&t.clientInfo.role===I.Attendee&&t.clientInfo.uid===t.getId()},e.isSmartDeviceStream=function(t){return t.clientInfo&&t.clientInfo.role===I.SmartDevice&&t.clientInfo.uid===t.getId()},e.isPublisherScreen=function(t){return t.clientInfo&&t.clientInfo.role===I.Publisher&&t.clientInfo.screenUid===t.getId()},e.isAttendeeScreen=function(t){return t.clientInfo&&t.clientInfo.role===I.Attendee&&t.clientInfo.screenUid===t.getId()},e.getTypeMatcher=function(t){var e;switch(t.name){case Hi.PublisherStream.name:e=this.isPublisherStream;break;case Hi.AttendeeStream.name:e=this.isAttendeeStream;break;case Hi.SmartDeviceStream.name:e=this.isSmartDeviceStream;break;case Hi.PublisherScreen.name:e=this.isPublisherScreen;break;case Hi.AttendeeScreen.name:e=this.isAttendeeScreen;break;default:e=function(t){return!1}}return e},e.getStreamId$=function(t){var e=this;if(!t.asset)return n.of(null);var o=t.asset.type,r=t.asset.file;return Di(t.asset)?Ln.streams$.pipe(i.map((function(n){var i,r=0,s=e.getTypeMatcher(o);return n.forEach((function(e){s(e)&&(r===t.asset.index&&(i=e),r++)})),i?i.getId():null}))):n.of(r)},e.getMaterialByItem=function(t){return t.asset&&t.asset.chromaKeyColor?e.getChromaKeyMaterial(t.asset.chromaKeyColor):(t.asset,new THREE.MeshBasicMaterial({color:8947848}))},e.getUniformsByItem=function(t){var e=null;return t.asset&&(e={mapTween:1,playMapTween:0,opacity:0}),e},l(e,[{key:"editing",get:function(){return this.editing_},set:function(t){this.editing_!==t&&(this.editing_=t,this.zoomed="media"===this.view.type.name||!t&&this.zoomed)}}]);var o=e.prototype;return o.load=function(t){var e=this;if(this.playBtn&&this.remove(this.playBtn),this.zoomBtn&&this.remove(this.zoomBtn),!this.item.asset)return this.onAppear(),void("function"==typeof t&&t(this));var n=this.material;this.mediaLoader.load((function(i){var o=e.mediaLoader;o&&(i&&(i.encoding=THREE.sRGBEncoding,n.map=i,n.uniforms&&(n.uniforms.map.value=i,n.uniforms.mapResolution.value=new THREE.Vector2(i.image.width||i.image.videoWidth,i.image.height||i.image.videoHeight),o.isPlayableVideo&&e.makePlayMap(i,(function(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,n.uniforms.playMap.value=t,n.uniforms.playMapResolution.value=new THREE.Vector2(t.image.width,t.image.height),n.needsUpdate=!0})))),n.needsUpdate=!0,e.onAppear(),o.isPlayableVideo&&e.playBtn&&(n.uniforms&&(n.uniforms.isVideo.value=!0),e.on("over",e.onOver),e.on("out",e.onOut),e.on("down",e.onToggle),e.add(e.playBtn)),e.zoomBtn&&e.add(e.zoomBtn),"function"==typeof t&&t(e))}))},o.makePlayMap=function(t,e){var n=t.image.width||t.image.videoWidth,i=t.image.height||t.image.videoHeight,o=n/i,r=document.createElement("canvas");r.width=n,r.height=i;var s=r.getContext("2d");s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high";var a=new Image;a.onload=function(){var t,l,c=a.width/a.height;o>c?l=(t=.32*i)/c:t=(l=.32*n)*c,s.drawImage(a,n/2-t/2,i/2-l/2,t,l);var u=new THREE.CanvasTexture(r);"function"==typeof e&&e(u)},a.crossOrigin="anonymous",a.src=E.getPath("textures/ui/play.png")},o.events$=function(){var t=this,e=this.item,n=this.items;return e.asset&&e.asset.linkedPlayId&&this.freeze(),oo.events$.pipe(i.filter((function(t){return t.loader.item&&t.loader.item.id===e.id})),i.map((function(i){(i instanceof Qi?(t.playing=!0,t.isAutoplayLoop||(t.playBtn&&(t.playBtn.playing=!0),t.emit("playing",!0)),t.onOut()):i instanceof to?(t.playing=!1,t.playBtn&&(t.playBtn.playing=!1),t.emit("playing",!1),t.onOut()):i instanceof io&&t.emit("currentTime",i.loader.video.currentTime),e.asset&&e.asset.linkedPlayId)&&(n.find((function(t){return t.asset&&-1!==i.src.indexOf(t.asset.file)&&i.id===e.asset.linkedPlayId}))&&(i instanceof Qi?t.play():i instanceof to&&t.pause()));return i})))},o.onAppear=function(){var t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,opacity:1,ease:Power2.easeInOut,onUpdate:function(){e.uniforms.opacity.value=t.opacity}}),this.zoomed="media"===this.view.type.name||!this.editing&&this.zoomed},o.onDisappear=function(){var t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,opacity:0,ease:Power2.easeInOut,onUpdate:function(){e.uniforms.opacity.value=t.opacity}})},o.onOver=function(){var t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,mapTween:this.playing?0:1,playMapTween:1,opacity:1,ease:Power2.easeInOut,overwrite:!0,onUpdate:function(){e.uniforms.mapTween.value=t.mapTween,e.uniforms.playMapTween.value=t.playMapTween,e.uniforms.opacity.value=t.opacity}}),this.playBtn&&this.playBtn.onOver()},o.onOut=function(){var t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,mapTween:this.playing?0:1,playMapTween:0,opacity:1,ease:Power2.easeInOut,overwrite:!0,onUpdate:function(){e.uniforms.mapTween.value=t.mapTween,e.uniforms.playMapTween.value=t.playMapTween,e.uniforms.opacity.value=t.opacity}}),this.playBtn&&this.playBtn.onOut()},o.onToggle=function(){this.playing=this.mediaLoader.toggle(),this.playBtn&&(this.playBtn.playing=this.playing),this.emit("playing",this.playing),this.onOut()},o.play=function(){this.mediaLoader.play()},o.pause=function(){this.mediaLoader.pause()},o.setPlayingState=function(t){this.playing!==t&&(this.playing=t,t?this.mediaLoader.play():this.mediaLoader.pause(),this.onOut(),this.playBtn&&(this.playBtn.playing=t))},o.setZoomedState=function(t){this.zoomed=t},o.setCurrentTime=function(t){this.mediaLoader.video&&(this.mediaLoader.video.currentTime=t)},o.disposeMaterial=function(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())},o.disposeMediaLoader=function(){var t=this.mediaLoader;t&&(t.isPlayableVideo&&(this.off("over",this.onOver),this.off("out",this.onOut),this.off("down",this.onToggle)),t.dispose(),this.mediaLoader=null)},o.dispose=function(){this.removePlayBtn(),this.removeZoomBtn(),this.disposeMediaLoader()},o.addPlayBtn=function(){if(this.removePlayBtn(),!this.isAutoplayLoop){var t=this.playBtn=new Oo(this.host);t.on("over",this.onOver),t.on("out",this.onOut),t.on("down",this.onToggle),t.position.z=.01}},o.removePlayBtn=function(){this.playBtn&&(this.remove(this.playBtn),this.playBtn.off("over",this.onOver),this.playBtn.off("out",this.onOut),this.playBtn.off("down",this.onToggle),this.playBtn.dispose(),delete this.playBtn)},o.onZoomed=function(t){this.zoomed=t,this.emit("zoomed",t)},o.addZoomBtn=function(){(this.removeZoomBtn(),"media"===this.view.type.name||this.item.asset&&this.item.asset.chromaKeyColor)||(this.zoomBtn=new Bo(this.host)).on("zoomed",this.onZoomed)},o.removeZoomBtn=function(){this.zoomBtn&&(this.remove(this.zoomBtn),this.zoomBtn.off("zoomed",this.onZoomed),this.zoomBtn.dispose(),this.zoomBtn=null,delete this.zoomBtn)},o.updateByItem=function(t){this.disposeMaterial(),this.disposeMediaLoader(),this.material=e.getMaterialByItem(t),this.uniforms=e.getUniformsByItem(t),this.addPlayBtn(),this.addZoomBtn(),t.silent=this.isAutoplayLoop,this.mediaLoader=new oo(t)},o.updateFromItem=function(t){t.position&&this.position.fromArray(t.position),t.rotation&&this.rotation.fromArray(t.rotation),t.scale&&this.scale.fromArray(t.scale),this.playBtn&&this.playBtn.update(this),this.updateZoom()},o.updateZoom=function(){if(this.originalPosition=this.position.clone(),this.originalScale=this.scale.clone(),this.originalQuaternion=this.quaternion.clone(),this.object.position.copy(this.originalPosition),this.object.scale.copy(this.originalScale),this.object.quaternion.copy(this.originalQuaternion),this.zoomBtn){var t=this.zoomBtn.scale,e=this.zoomBtn.position,n=this.scale.x/this.scale.y,i=.1;t.set(i/n,i,1),e.x=.5-i/n/2,e.y=-.45,e.z=.01}},o.render=function(t,e){if(!this.editing){var n=this.object;this.zoomed&&!this.host.renderer.xr.isPresenting&&this.updateObjectMatrix(),this.position.copy(n.position),this.scale.copy(n.scale),this.quaternion.copy(n.quaternion)}},o.updateObjectMatrix=function(){var t=this.object,e=this.host;if(this.zoomed){var n,i=this.originalScale,o=e.camera,r=o.fov,s=o.aspect,a=this.tempPosition,l=this.tempRotation;n=.01;var c=e.renderer.xr;if(c.isPresenting){var u=(o=c.getCamera(o)).projectionMatrix.elements,d=u[0],h=u[5];s=h/d;r=2*Math.atan(1/h)*57.29577951308232,n=1}t.scale.copy(i).multiplyScalar(n);var p=so.getDistanceToCamera(o,r,s,t.scale);o.getWorldDirection(l),l.multiplyScalar(p),a.set(0,0,0),o.localToWorld(a),a.add(l),t.position.copy(a),t.lookAt(so.origin),c.isPresenting&&(t.position.y-=t.scale.y/2)}},l(e,[{key:"isAutoplayLoop",get:function(){return"media"!==this.view.type.name&&this.item.asset&&this.item.asset.autoplay&&this.item.asset.loop}},{key:"zoomed",get:function(){return this.zoomed_},set:function(t){this.zoomed_!==t&&(this.zoomed_=t,t?(this.renderOrder=E.renderOrder.panel+5,this.material.depthTest=!0):(this.renderOrder=0,this.material.depthTest=!0,this.object.position.copy(this.originalPosition),this.object.scale.copy(this.originalScale),this.object.quaternion.copy(this.originalQuaternion)),this.material.needsUpdate=!0,this.updateObjectMatrix(),this.zoomBtn&&(this.zoomBtn.zoomed=t))}}]),e}(uo),zo=function(){this.x=0,this.y=0},jo=function(t){t&&Object.assign(this,t)},Fo=function(t){function e(e){var n;return(n=t.call(this,e)||this).distance=new zo,n.strength=new zo,n.speed=new zo,n}return d(e,t),e}(jo),No=function(t){function e(e){var n;return(n=t.call(this,e)||this).distance=new zo,n.strength=new zo,n.speed=new zo,n}return d(e,t),e}(jo),Go=function(t){function e(e){return t.call(this,e)||this}return d(e,t),e}(jo),qo=function(){function t(){}return t.getPosition=function(t,e){return t instanceof MouseEvent?e?(e.x=t.clientX,e.y=t.clientY):e={x:t.clientX,y:t.clientY}:window.TouchEvent&&t instanceof TouchEvent&&t.touches.length>0&&(e?(e.x=t.touches[0].pageX,e.y=t.touches[0].pageY):e={x:t.touches[0].pageX,y:t.touches[0].pageY}),e},t.down$=function(t,e){var o,r=this;return n.merge(n.fromEvent(t,"mousedown").pipe(i.filter((function(t){return 0===t.button}))),n.fromEvent(t,"touchstart")).pipe(i.map((function(n){if((o=o||new Fo).node=t,o.target=n.target,o.originalEvent=n,o.down=r.getPosition(n,o.down),o.down)return o.distance=new zo,o.strength=new zo,o.speed=new zo,e.next(o),o})),i.filter((function(t){return void 0!==t})))},t.move$=function(t,e,o,r){var s,a=this;return n.fromEvent(document,r.originalEvent instanceof MouseEvent?"mousemove":"touchmove").pipe(i.startWith(r),i.map((function(n){if((s=s||new No).node=t,s.target=n.target,s.originalEvent=n,s.position=a.getPosition(n,s.position),void 0!==r.down&&void 0!==s.position)return s.distance.x=s.position.x-r.down.x,s.distance.y=s.position.y-r.down.y,s.strength.x=s.distance.x/window.innerWidth*2,s.strength.y=s.distance.y/window.innerHeight*2,s.speed.x=r.speed.x+.1*(s.strength.x-r.strength.x),s.speed.y=r.speed.y+.1*(s.strength.y-r.strength.y),r.distance.x=s.distance.x,r.distance.y=s.distance.y,r.speed.x=s.speed.x,r.speed.y=s.speed.y,r.strength.x=s.strength.x,r.strength.y=s.strength.y,e.next(s),s})))},t.dismissEvent=function(t,e,n,i){return mo=mo||new Go,e.next(mo),n.next(),i&&Math.abs(i.distance.x)>10&&(t.preventDefault(),t.stopImmediatePropagation()),mo},t.up$=function(t,e,o,r){var s=this;return n.fromEvent(document,r.originalEvent instanceof MouseEvent?"mouseup":"touchend").pipe(i.map((function(t){return s.dismissEvent(t,e,o,r)})))},t.observe$=function(e){var o=this;e=e||document;var r=t.events$=new n.ReplaySubject(1),s=t.dismiss$=new n.Subject;return this.down$(e,r).pipe(i.switchMap((function(a){return t.downEvent=a,n.merge(o.move$(e,r,s,a),o.up$(e,r,s,a)).pipe(i.takeUntil(s))})),i.switchMap((function(){return r})))},t}(),Zo="panorama",Wo="model",Ko=function(){},Xo=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ko),Yo=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ko),Jo=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(Ko),Qo=new Jo,tr=new Xo,er=new Yo,nr=function(){var t=e.prototype;function e(t){this.mode_=e.mode=Zo,this.dolly_=70,this.zoom_=70,this.longitude=0,this.latitude=0,this.direction=1,this.radius=101,this.position=new THREE.Vector3,this.inertia=new THREE.Vector2,this.rotation=new THREE.Euler(0,0,0,"XYZ"),this.target=new THREE.Vector3,this.updatePosition=new THREE.Vector3,this.updateTarget=new THREE.Vector3,this.camera=t,this.setLongitudeLatitude(0,0),this.events$=new n.ReplaySubject(1)}return t.getDollyValue=function(){return 1-(this.dolly_-15)/60-.5},t.getZoomValue=function(){return 2-(this.zoom_-15)/60},l(e,[{key:"dolly",get:function(){return this.dolly_},set:function(t){var e=THREE.Math.clamp(t,15,75);this.dolly_!==e&&(this.dolly_=e,this.markAsDirty())}},{key:"zoom",get:function(){return this.zoom_},set:function(t){var e=THREE.Math.clamp(t,15,75);this.zoom_!==e&&(this.zoom_=e,this.markAsDirty())}},{key:"mode",get:function(){return this.mode_},set:function(t){this.mode_!==t&&(this.mode_=t,e.mode=t,this.markAsDirty())}},{key:"controlled",get:function(){return _.state.controlling&&_.state.controlling!==_.state.uid}},{key:"controlling",get:function(){return _.state.controlling&&_.state.controlling===_.state.uid}},{key:"silencing",get:function(){return _.state.silencing}},{key:"silenced",get:function(){return _.state.silencing&&_.state.role===I.Streamer}},{key:"spyed",get:function(){return _.state.spying&&_.state.spying===_.state.uid}},{key:"spying",get:function(){return _.state.spying&&_.state.spying!==_.state.uid}},{key:"isMediaView",get:function(){return qi.view&&qi.view.type.name===ni.Media.name}},{key:"locked",get:function(){return this.controlled||this.spying||this.isMediaView}}]),t.setOrientation=function(t){t&&(this.setLongitudeLatitude(t.longitude,t.latitude),this.markAsDirty())},t.getOrientation=function(){return{latitude:this.latitude,longitude:this.longitude}},t.setLongitudeLatitude=function(t,e){e=Math.max(-80,Math.min(80,e)),this.longitude=(t<0?360+t:t)%360,this.latitude=e;var n=THREE.Math.degToRad(90-e),i=THREE.Math.degToRad(t);this.phi=n,this.theta=i},t.observe$=function(t){var e,o,r=this;return n.combineLatest([ho.keys$(),qo.observe$(t)]).pipe(i.filter((function(t){return!r.locked})),i.map((function(t){var n=t[0],i=t[1];if(i instanceof Fo)e=r.latitude,o=r.longitude;else if(i instanceof No)if(n.Shift)r.events$.next(tr);else if(n.Control)r.events$.next(er);else{var s=r.mode_===Wo?-1:1;r.setLongitudeLatitude(o-.1*i.distance.x*s,e+.1*i.distance.y)}return i})),i.filter((function(t){return t instanceof No})),i.startWith({latitude:this.latitude,longitude:this.longitude}),i.tap((function(t){return r.markAsDirty()})),i.switchMap((function(t){return r.events$})))},t.walk=function(t,e){var n,i=this;switch(this.mode_){case Wo:n=3;break;default:n=this.radius}var o=new THREE.Vector2(t.x,t.y).normalize().multiplyScalar(n),r=Math.atan2(o.y,o.x),s=THREE.MathUtils.radToDeg(r);s=(s<0?360+s:s)%360;var a=this.latitude,l=this.longitude,c=s-l;c=Math.abs(c)>180?c-c/Math.abs(c)*360:c;var u=0-a;u=Math.abs(u)>90?u-u/Math.abs(u)*90:u;var d={tween:0};gsap.to(d,{duration:.7,tween:1,delay:0,ease:Power2.easeInOut,onUpdate:function(){i.setLongitudeLatitude(l+c*d.tween,a+u*d.tween),i.position.set(t.x*d.tween,0,t.y*d.tween),i.markAsDirty()},onComplete:function(){"function"==typeof e&&e(s,0)}})},t.walkComplete=function(t,e){this.setLongitudeLatitude(t,e),this.position.set(0,0,0),this.markAsDirty()},t.lookAt=function(t){if(t){var e,n=t.position.clone();switch(n=this.camera.parent.worldToLocal(n),this.mode_){case Wo:e=3;break;default:e=this.radius}var i=new THREE.Vector3(n.x,n.z,n.y).normalize().multiplyScalar(e),o=Math.atan2(i.y,i.x),r=Math.acos(i.z/e),s=THREE.MathUtils.radToDeg(o);s=(s<0?360+s:s)%360;var a=90-THREE.MathUtils.radToDeg(r);a=Math.max(-80,Math.min(80,a)),this.setLongitudeLatitude(s,a),this.markAsDirty()}},t.setVRCamera=function(t){if(t){var e=this.radius,n=new THREE.Vector3(0,0,-e),i=new THREE.Quaternion(t[3],t[4],t[5],t[6]);n.applyQuaternion(i);var o=new THREE.Vector3(n.x,n.z,n.y).normalize().multiplyScalar(e),r=Math.atan2(o.y,o.x),s=Math.acos(o.z/e),a=THREE.MathUtils.radToDeg(r);a=(a<0?360+a:a)%360;var l=90-THREE.MathUtils.radToDeg(s);l=Math.max(-80,Math.min(80,l)),this.setLongitudeLatitude(a,l),this.markAsDirty()}},t.render=function(){_.state.hosted||(this.longitude+=.025,this.isDirty=!0),this.isDirty&&(this.isDirty=!1,this.update())},t.markAsDirty=function(){this.isDirty=!0},t.update=function(){var t,e=this.updatePosition,n=this.updateTarget,i=this.getZoomValue(),o=(this.getDollyValue(),THREE.MathUtils.degToRad(90-this.latitude)),r=THREE.MathUtils.degToRad(this.longitude),s=this.camera,a=s.parent;switch(this.mode_){case Wo:t=3,e.copy(this.position),n.x=this.position.x+t*Math.sin(o)*Math.cos(r),n.y=this.position.y+t*Math.cos(o),n.z=this.position.z+t*Math.sin(o)*Math.sin(r),n=a.worldToLocal(n),s.target.copy(e),s.position.copy(n);break;default:t=this.radius,n.x=this.position.x+t*Math.sin(o)*Math.cos(r),n.y=this.position.y+t*Math.cos(o),n.z=this.position.z+t*Math.sin(o)*Math.sin(r),e.copy(this.position),n=a.worldToLocal(n),s.target.copy(n),s.position.copy(e)}s.zoom=i,s.lookAt(s.target),s.updateProjectionMatrix(),qi.view&&(qi.view.lastOrientation.longitude=this.longitude,qi.view.lastOrientation.latitude=this.latitude),this.events$.next(Qo)},e}();nr.orbitMoveEvent=Qo;var ir=0,or="progress",rr="complete",sr=function(){function t(){}return t.worker=function(){return this.worker_||(this.worker_=new Worker(E.workers.image)),this.worker_},t.events$=function(t,e){if(!("Worker"in window)||this.isBlob(t)||this.isCors(t))return n.of({type:rr,data:t});var o=++ir,r=this.worker();return r.postMessage({src:t,id:o,size:e}),n.fromEvent(r,"message").pipe(i.map((function(t){return t.data})),i.filter((function(e){return e.src===t})),i.auditTime(100),i.map((function(t){if(t.type===rr&&t.data instanceof Blob){var e=URL.createObjectURL(t.data);t.data=e}return t})),i.takeWhile((function(t){return t.type!==rr}),!0),i.finalize((function(){r.postMessage({id:o})})))},t.load$=function(t,e){return this.events$(t,e).pipe(i.filter((function(t){return t.type===rr})),i.map((function(t){return t.data})))},t.isCors=function(t){return!1},t.isBlob=function(t){return 0===t.indexOf("blob:")},t}(),ar=function(){function t(){}return t.load=function(t,e,n){if(oo.events$.next(new eo(this)),this.video=null,t)return t.type.name===Hi.PublisherStream.name?this.loadPublisherStreamBackground(e,n):-1!==t.file.indexOf(".mp4")||-1!==t.file.indexOf(".webm")?this.loadVideoBackground(E.getPath(t.folder),t.file,e,n):-1!==t.file.indexOf(".m3u8")?this.loadHlslVideoBackground(t.file,e,n):-1!==t.file.indexOf(".hdr")?this.loadRgbeBackground(E.getPath(t.folder),t.file,e,n):this.loadBackgroundImageService(E.getPath(t.folder),t.file,e,n)},t.loadBackground=function(t,e,n,i){var o=vo.getRef(),r=new THREE.TextureLoader;return r.setPath(t).load(e,(function(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.format=THREE.RGBFormat,t.needsUpdate=!0,"function"==typeof i&&i(t),vo.setProgress(o,1)}),(function(t){vo.setProgress(o,t.loaded,t.total)})),r},t.loadBackgroundImageService=function(t,e,o,r){var s=vo.getRef(),a=new Image;sr.events$(t+e).pipe(i.tap((function(t){t.type===or&&vo.setProgress(s,t.data.loaded,t.data.total)})),i.filter((function(t){return t.type===rr})),i.switchMap((function(t){var e=n.fromEvent(a,"load");return a.crossOrigin="anonymous",a.src=t.data,e})),i.takeWhile((function(t){return t.type!==rr}),!0)).subscribe((function(t){var e=new THREE.Texture(a);e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.mapping=THREE.UVMapping,e.format=THREE.RGBFormat,e.needsUpdate=!0,"function"==typeof r&&(r(e),URL.revokeObjectURL(t.data)),vo.setProgress(s,1)}))},t.loadRgbeBackground=function(t,e,n,i){var o=vo.getRef(),r=new $o;return r.setDataType(THREE.UnsignedByteType).setPath(t).load(e,(function(t){"function"==typeof i&&i(t,!0),vo.setProgress(o,1)}),(function(t){vo.setProgress(o,t.loaded,t.total)})),r},t.loadHlslVideoBackground=function(t,e,n){var i=vo.getRef(),o=document.createElement("video");if(o.oncanplay=function(){!function(){o.oncanplay=null;var t=new THREE.VideoTexture(o);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.format=THREE.RGBFormat,t.needsUpdate=!0,"function"==typeof n&&n(t),vo.setProgress(i,1)}()},Hls.isSupported()){var r=new Hls;r.attachMedia(o),r.on(Hls.Events.MEDIA_ATTACHED,(function(){r.loadSource(t),r.on(Hls.Events.MANIFEST_PARSED,(function(t,e){o.play()}))}))}},t.play=function(t){var e=this,n=this.video;n&&(n.muted=this.muted_,n.play().then((function(){t||oo.events$.next(new Qi(e))}),(function(t){console.log("PanoramaLoader.play.error",n.src,t)})))},t.pause=function(t){var e=this.video;e&&(e.muted=!0,e.pause(),t||oo.events$.next(new to(this)))},t.loadVideoBackground=function(t,e,n,i){var o=this,r=vo.getRef();this.video=!0;var s=this.video;s.oncanplay=function(){s.oncanplay=null;var t=new THREE.VideoTexture(s);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.format=THREE.RGBFormat,t.needsUpdate=!0,"function"==typeof i&&i(t),vo.setProgress(r,1),o.play()},s.ontimeupdate=function(){oo.events$.next(new no(o))},s.onended=function(){},s.crossOrigin="anonymous",s.src=t+e,s.load()},t.loadPublisherStreamBackground=function(t,e){var n=this;Ln.getPublisherStreamId$().pipe(i.first()).subscribe((function(t){return function(t){var i=document.querySelector("#stream-"+t+" video");if(i){var o=function(){var t=n.texture=new THREE.VideoTexture(i);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.format=THREE.RGBFormat,t.needsUpdate=!0,"function"==typeof e&&e(t)};i.crossOrigin="anonymous",i.readyState>=i.HAVE_FUTURE_DATA?o():i.oncanplay=function(){o()}}}(t)}))},l(t,null,[{key:"video",get:function(){return this.video_},set:function(t){if(this.video_&&(this.video_.muted=!0,this.video_.pause(),this.video_.parentNode&&this.video_.parentNode.removeChild(this.video_),this.video_=null),t){var e=this.video_=document.createElement("video");e.loop=!0,e.playsInline=!0,e.crossOrigin="anonymous"}}},{key:"muted",get:function(){return this.muted_},set:function(t){this.muted_=t,this.video&&(this.video.muted=!0===t)}},{key:"cubeRenderTarget",set:function(t){this.cubeRenderTarget_&&(this.cubeRenderTarget_.texture.dispose(),this.cubeRenderTarget_.dispose()),this.cubeRenderTarget_=t}},{key:"texture",set:function(t){this.texture_&&this.texture_.dispose(),this.texture_=t}},{key:"progress",get:function(){var t=this.video;return t?t.currentTime/t.duration:0},set:function(t){var e=this.video;if(e){var n=e.duration*t;e.seekable.length>t&&e.currentTime!==n&&(e.currentTime=n,oo.events$.next(new io(this)))}}}]),t}(),lr=function(){function t(t){this.muted_=!1,this.subscription=_.state$.subscribe((function(t){return ar.muted=t.volumeMuted})),this.tween=0,this.create(t)}var e=t.prototype;return e.create=function(t){var e=this;this.renderer=t,this.onCubeMapDispose=this.onCubeMapDispose.bind(this);var n=new THREE.BoxGeometry(202,202,202),i=this.getBlackMaterial(),o=new uo(n,i);o.userData={render:function(t,n,i,r,s){o.matrixWorld.copyPosition(s.matrixWorld);var a=e.cubeMap,l=e.texture;a&&l&&l.isVideoTexture&&e.updateCubeMapEquirectangularTexture(a,i,l)}},o.name="[panorama]",this.mesh=o},e.getBlackMaterial=function(){return new THREE.MeshBasicMaterial({name:"PanoramaStandardMaterial",color:0,side:THREE.BackSide,depthTest:!1,depthWrite:!1,fog:!1})},e.getShaderMaterial=function(t){var e=new THREE.ShaderMaterial({name:"PanoramaCubeMaterial",uniforms:this.cloneUniforms(THREE.ShaderLib.cube.uniforms),vertexShader:THREE.ShaderLib.cube.vertexShader,fragmentShader:THREE.ShaderLib.cube.fragmentShader,side:THREE.BackSide,depthTest:!1,depthWrite:!1,fog:!1});t.mapping=THREE.EquirectangularReflectionMapping;var n=this.toCubeMap(t,this.renderer);return e.map=n,e.uniforms.envMap.value=n,e.uniforms.flipEnvMap.value=n.isCubeTexture&&n._needsFlipEnvMap?-1:1,e.needsUpdate=!0,this.mesh.geometry.deleteAttribute("normal"),this.mesh.geometry.deleteAttribute("uv"),Object.defineProperty(e,"envMap",{get:function(){return this.uniforms.envMap.value},configurable:!0}),e},e.makeEnvMap=function(t){var e=this.mesh.material;if(e.uniforms){t.mapping=THREE.EquirectangularReflectionMapping;var n=this.toCubeMap(t,this.renderer);e.map=n,e.uniforms.envMap.value=n,e.uniforms.flipEnvMap.value=n.isCubeTexture&&n._needsFlipEnvMap?-1:1,e.needsUpdate=!0}else e.dispose(),e=this.getShaderMaterial(t),this.mesh.material=e},e.toCubeMap=function(t,e){this.cubeMap&&this.cubeMap.dispose();var n=t.image,i=n.height||n.videoHeight,o=new THREE.WebGLCubeRenderTarget(i/2,{generateMipmaps:!0,minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,mapping:THREE.CubeUVReflectionMapping,format:THREE.RGBFormat});return o.addEventListener("dispose",this.onCubeMapDispose),this.setCubeMapEquirectangularTexture(o,t),this.updateCubeMapEquirectangularTexture(o,e,t),this.cubeMap=o,this.texture=t,this.mapTextureMapping(o.texture,t.mapping)},e.setCubeMapEquirectangularTexture=function(t,e){t.texture.type=e.type,t.texture.format=THREE.RGBFormat,t.texture.encoding=THREE.sRGBEncoding,t.texture.generateMipmaps=e.generateMipmaps,t.texture.minFilter=e.minFilter,t.texture.magFilter=e.magFilter,t.texture.needsUpdate=!0;var n={tEquirect:{value:null}},i="\n\t\t\t\t\tvarying vec3 vWorldDirection;\n\t\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\t\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\t\t\t\t\t}\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\t\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t\t#include <project_vertex>\n\t\t\t\t\t}\n\t\t\t\t",o="\n\t\t\t\t\tuniform sampler2D tEquirect;\n\t\t\t\t\tvarying vec3 vWorldDirection;\n\t\t\t\t\t#include <common>\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\t\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\t\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t\t\t\t\t}\n\t\t\t\t",r=new THREE.BoxGeometry(5,5,5),s=new THREE.ShaderMaterial({name:"CubemapFromEquirect",uniforms:this.cloneUniforms(n),vertexShader:i,fragmentShader:o,side:THREE.BackSide,blending:THREE.NoBlending});s.uniforms.tEquirect.value=e;var a=new THREE.Mesh(r,s),l=new THREE.CubeCamera(1,10,t);return t.camera=l,t.mesh=a,t},e.updateCubeMapEquirectangularTexture=function(t,e,n){var i=n.minFilter;n.minFilter===THREE.LinearMipmapLinearFilter&&(n.minFilter=THREE.LinearFilter),t.camera.update(e,t.mesh),n.minFilter=i},e.cloneUniforms=function(t){var e={};for(var n in t)for(var i in e[n]={},t[n]){var o=t[n][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?e[n][i]=o.clone():Array.isArray(o)?e[n][i]=o.slice():e[n][i]=o}return e},e.mapTextureMapping=function(t,e){return e===THREE.EquirectangularReflectionMapping?t.mapping=THREE.CubeReflectionMapping:e===THREE.EquirectangularRefractionMapping&&(t.mapping=THREE.CubeRefractionMapping),t},e.onCubeMapDispose=function(){var t=this.cubeMap;t&&(t.removeEventListener("dispose",this.onCubeMapDispose),t.texture.dispose(),t.mesh.geometry.dispose(),t.mesh.material.dispose(),void 0!==t&&(this.cubeMap=null))},e.change=function(t,e,n,i){var o=t instanceof si?t.tiles[t.index_]:t,r=this.mesh.material;this.load(o,e,(function(e){"function"==typeof i&&i(t),r.uniforms&&r.uniforms.uTween&&(r.uniforms.uTween.value=1,r.needsUpdate=!0),"function"==typeof n&&n(e)}))},e.crossfade=function(t,e,n){var i=this.mesh.material;this.load(t,e,(function(t){i.uniforms&&i.uniforms.uTween&&(i.uniforms.uTween.value=1,i.needsUpdate=!0),"function"==typeof n&&n(t)}))},e.load=function(t,e,n){var i=this,o=t.type.name===ni.Media.name?ji.defaultMediaAsset:t.asset;o&&(o.type.name!==Hi.Model.name?(this.currentAsset=o.folder+o.file,ar.load(o,e,(function(t,e){if(o.folder+o.file===i.currentAsset){var r=i.makeEnvMap(t);"function"==typeof n&&n(r)}else t.dispose()}))):"function"==typeof n&&n(null))},e.dispose=function(){this.subscription.unsubscribe(),this.cubeMap&&this.cubeMap.dispose()},t}(),cr=4/3,ur=[16777215,16763904,65484,52479,13434624,13369599],dr=function(){var t=e.prototype;function e(){var t=e.geometry,n=new THREE.MeshBasicMaterial({color:16777215});this.plane=new THREE.Mesh(t,n)}return t.setRemote=function(t,e,n){var i=this;this.remote=t;var o,r,s,a,l,c,u;n<4?(r=0,s=e,c=0,u=(l=(a=.12*(o=1))/cr)/2-n*l/2,this.plane.position.set(c,u+l*e,.005)):(o=.5,r=e%2,s=Math.floor(e/2),c=-(a=.12*o)/2,u=(l=a/cr)/2-Math.ceil(n/2)*l/2,this.plane.position.set(c+r*a,u+s*l,.005)),this.plane.scale.set(o,o,o),"number"==typeof t?this.plane.material.color.set(ur[e%ur.length]):t.texture?(this.plane.material.map=t.texture,this.plane.material.needsUpdate=!0):this.addStreamTexture(t.getId(),(function(e){t.texture=e,i.plane.material.map=e,i.plane.material.needsUpdate=!0}))},t.addStreamTexture=function(t,e){var n="#stream-"+t,i=document.querySelector(n+" video");if(i){var o=function(){var t=new THREE.VideoTexture(i);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.format=THREE.RGBFormat,t.encoding=THREE.sRGBEncoding,t.needsUpdate=!0,"function"==typeof e&&e(t)};i.crossOrigin="anonymous",i.readyState>=i.HAVE_FUTURE_DATA?o():i.oncanplay=function(){o()}}},l(e,null,[{key:"geometry",get:function(){return new THREE.PlaneBufferGeometry(.12,.09,2,2)}}]),e}(),hr=function(){function t(){var t=this,e=this.mesh=new THREE.Group,n=this.phone=this.create();e.add(n);this.streams=[];Ln.remotes$.subscribe((function(e){t.remotes=e}))}return l(t,[{key:"remotes",set:function(t){var e=this;t.forEach((function(n,i){var o=e.streams[i];o||(o=new dr),o.setRemote(n,i,t.length),e.phone.add(o.plane),e.streams[i]=o}));for(var n=t.length;n<this.streams.length;n++)this.phone.remove(this.streams[n].plane);this.streams.length=t.length}}]),t.prototype.create=function(){var t=new THREE.BoxBufferGeometry(.12,.27,.005,2,2,1),e=new THREE.MeshStandardMaterial({color:0,transparent:!0,opacity:.6}),n=new THREE.Mesh(t,e);return n.rotation.set(-Math.PI/4,0,0),n},t}(),pr=function(){function t(t){void 0===t&&(t="#ffffff");this.position=new THREE.Vector3;var e=ro.planeGeometry,n=(new THREE.TextureLoader).load(E.getPath("textures/ui/nav-point.png")),i=new THREE.MeshBasicMaterial({color:new THREE.Color(t),depthTest:!1,depthWrite:!1,map:n,transparent:!0,opacity:.9}),o=this.mesh=new THREE.Mesh(e,i);o.renderOrder=E.renderOrder.pointer,o.position.set(-1e5,-1e5,-1e5)}var e=t.prototype;return e.update=function(t){if(ao.lastIntersectedObject){var e=this.position;e.copy(ao.lastIntersectedObject.intersection.point),e.multiplyScalar(.99);var n=this.mesh;n.position.set(e.x,e.y,e.z),e.sub(t.position);var i=e.length()/80;n.scale.set(i,i,i),n.lookAt(so.origin)}},e.setPosition=function(t,e,n,i){var o=this.position;o.set(t,e,n).multiplyScalar(80);var r=this.mesh;r.position.copy(o),o.sub(i.position);var s=o.length()/80;r.scale.set(s,s,s),r.lookAt(so.origin)},t}(),vr=function(){function t(){this.gravity=new THREE.Vector3(0,-9.8,0),this.controllerPosition=new THREE.Vector3,this.controllerDirection=new THREE.Vector3,this.currentPosition=new THREE.Vector3,this.targetPosition=new THREE.Vector3;var t=new THREE.BufferGeometry,e=this.vertices=new Float32Array(33);e.fill(0);var n=new Float32Array(33);n.fill(.5),t.setAttribute("position",new THREE.BufferAttribute(e,3)),t.setAttribute("color",new THREE.BufferAttribute(n,3));var i=new THREE.LineBasicMaterial({vertexColors:!0,blending:THREE.AdditiveBlending}),o=(this.line=new THREE.Line(t,i),(new THREE.TextureLoader).load(E.getPath("textures/ui/nav-point.png")));(this.target=new THREE.Mesh(new THREE.PlaneBufferGeometry(.3,.3,1,1),new THREE.MeshBasicMaterial({map:o,blending:THREE.AdditiveBlending,color:5592405,transparent:!0}))).rotation.x=-Math.PI/2}var e=t.prototype;return e.addToController=function(t,e){this.currentController=t,t.add(this.line),e.add(this.target)},e.removeFromController=function(t,e,n,i,o){var r=this.currentController;if(r===t){var s=this.gravity,a=this.currentPosition,l=this.controllerPosition,c=this.controllerDirection;n.xr.getCamera(i).getWorldPosition(a),a.y=0,r.getWorldPosition(l),r.getWorldDirection(c),c.multiplyScalar(6);var u=(-c.y+Math.sqrt(Math.pow(c.y,2)-2*l.y*s.y))/s.y,d=this.getPositionT(this.targetPosition,u,l,c,s);d.addScaledVector(a,-1),o.position.add(d),this.currentController=null,r.remove(this.line),e.remove(this.target)}},e.update=function(){var t=this.currentController;if(t){var e=this.gravity,n=this.controllerPosition,i=this.controllerDirection,o=this.targetPosition;t.getWorldPosition(n),t.getWorldDirection(i),i.multiplyScalar(6);for(var r=(-i.y+Math.sqrt(Math.pow(i.y,2)-2*n.y*e.y))/e.y,s=o.set(0,0,0),a=1;a<=10;a++)this.getPositionT(s,a*r/10,n,i,e),t.worldToLocal(s),s.toArray(this.vertices,3*a);this.line.geometry.attributes.position.needsUpdate=!0,this.getPositionT(this.target.position,.98*r,n,i,e)}},e.getPositionT=function(t,e,n,i,o){return t.copy(n),t.addScaledVector(i,e),t.addScaledVector(o,.5*Math.pow(e,2)),t},t}(),mr="waiting",fr="enabled",gr="ended",br="started",wr="disabled",yr="needs-https",xr="unavailable",Cr=function(){function t(){var e=this;if(t.service_)throw"VRService is a singleton class!";var i=this.state_={camera:{position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3,array:new Array(10).fill(0)}};this.onSessionStarted=this.onSessionStarted.bind(this),this.onSessionEnded=this.onSessionEnded.bind(this),this.status$=new n.BehaviorSubject(mr),this.session$=new n.Subject,this.state$=new n.BehaviorSubject(i),this.currentSession=null,"xr"in navigator?navigator.xr.isSessionSupported("immersive-vr").then((function(t){t?e.status$.next(fr):e.status$.next(wr)})):!1===window.isSecureContext?this.status$.next(yr):this.status$.next(xr)}t.getService=function(){return this.service_||(this.service_=new t),this.service_},l(t,[{key:"status",get:function(){return this.status$.getValue()}},{key:"state",get:function(){return this.state$.getValue()}}]);var e=t.prototype;return e.onSessionStarted=function(t){t.addEventListener("end",this.onSessionEnded),this.currentSession=t,this.session$.next(t),this.status$.next(br)},e.onSessionEnded=function(){this.currentSession.removeEventListener("end",this.onSessionEnded),this.currentSession=null,this.session$.next(null),this.status$.next(gr)},e.toggleVR=function(t){if(null===this.currentSession){navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}).then(this.onSessionStarted)}else this.currentSession.end()},e.isDisabled=function(){switch(this.status$.getValue()){case mr:case wr:case yr:case xr:return!0;default:return!1}},e.getLabel=function(){var t;switch(this.status$.getValue()){case mr:t="Waiting VR";break;case fr:case gr:t="Enter VR";break;case br:t="Exit VR";break;case wr:t="VR Disabled";break;case yr:t="VR Needs Https";break;case xr:t="VR Unavailable"}return t},e.updateState=function(t){if(this.status===br){t.renderer,t.scene;var e=t.camera,n=this.state_;e.matrixWorld.decompose(n.camera.position,n.camera.quaternion,n.camera.scale),n.camera.array[0]=n.camera.position.x,n.camera.array[1]=n.camera.position.y,n.camera.array[2]=n.camera.position.z,n.camera.array[3]=n.camera.quaternion.x,n.camera.array[4]=n.camera.quaternion.y,n.camera.array[5]=n.camera.quaternion.z,n.camera.array[6]=n.camera.quaternion.w,n.camera.array[7]=n.camera.scale.x,n.camera.array[8]=n.camera.scale.y,n.camera.array[9]=n.camera.scale.z,this.state$.next(n)}},t}(),kr=function(t){function e(e){var n;return(n=t.call(this)||this).gamepad=e,n.buttons={},n.axes={},n}d(e,t);var n=e.prototype;return n.update=function(){this.updateButtons(),this.updateAxes()},n.updateButtons=function(){var t=this;this.gamepad.buttons.forEach((function(e,n){var i=e.pressed,o=t.buttons[n]||(t.buttons[n]=new Mr(n,t));o.pressed!==i&&(o.pressed=i,i?t.emit("press",o):void 0!==status&&t.emit("release",o))}))},n.updateAxes=function(){for(var t=this.gamepad.axes,e=0;e<t.length;e+=2){var n=Math.floor(e/2),i=this.axes[n]||(this.axes[n]=new Sr(n,this)),o=t[e],r=t[e+1];if(i.x!==o||i.y!==r){if(i.x=o,i.y=r,Math.abs(o)>Math.abs(r)){var s=o<-.85,a=o>.85;i.left!==s&&(i.left=s,this.emit(s?"left":"none",i)),i.right!==a&&(i.right=a,this.emit(a?"right":"none",i))}else{var l=r<-.85,c=r>.85;i.up!==l&&(i.up=l,this.emit(l?"up":"none",i)),i.down!==c&&(i.down=c,this.emit(c?"down":"none",i))}this.emit("axis",i)}}},n.feedback=function(t,e){void 0===t&&(t=.1),void 0===e&&(e=50);var n=this.gamepad.hapticActuators;return n&&n.length?n[0].pulse(t,e):Promise.reject()},e}(function(){function t(){this.events={}}var e=t.prototype;return e.on=function(t,e){var n=this,i=this.events[t]=this.events[t]||[];return i.push(e),function(){n.events[t]=i.filter((function(t){return t!==e}))}},e.off=function(t,e){var n=this.events[t];n&&(this.events[t]=n.filter((function(t){return t!==e})))},e.emit=function(t,e){var n=this.events[t];n&&n.forEach((function(t){t(e)}));var i=this.events.broadcast;i&&i.forEach((function(n){n(t,e)}))},t}()),Mr=function(t,e){this.index=t,this.gamepad=e,this.pressed=!1},Sr=function(t){function e(e,n){var i;return(i=t.call(this)||this).index=e,i.gamepad=n,i.left=i.right=i.up=i.down=!1,i}return d(e,t),e}(THREE.Vector2),Tr=THREE,Er=Tr.AnimationClip,Lr=Tr.Bone,_r=Tr.Box3,Ir=Tr.BufferAttribute,Rr=Tr.BufferGeometry,Ar=Tr.CanvasTexture,Pr=Tr.ClampToEdgeWrapping,$r=Tr.Color,Hr=Tr.DirectionalLight,Or=Tr.DoubleSide,Br=Tr.FileLoader,Dr=Tr.FrontSide,Ur=Tr.Group,Vr=Tr.ImageBitmapLoader,zr=Tr.InterleavedBuffer,jr=Tr.InterleavedBufferAttribute,Fr=Tr.Interpolant,Nr=Tr.InterpolateDiscrete,Gr=Tr.InterpolateLinear,qr=Tr.Line,Zr=Tr.LineBasicMaterial,Wr=Tr.LineLoop,Kr=Tr.LineSegments,Xr=Tr.LinearFilter,Yr=Tr.LinearMipmapLinearFilter,Jr=Tr.LinearMipmapNearestFilter,Qr=Tr.Loader,ts=Tr.LoaderUtils,es=Tr.Material,ns=Tr.MathUtils,is=Tr.Matrix4,os=Tr.Mesh,rs=Tr.MeshBasicMaterial,ss=Tr.MeshPhysicalMaterial,as=Tr.MeshStandardMaterial,ls=Tr.MirroredRepeatWrapping,cs=Tr.NearestFilter,us=Tr.NearestMipmapLinearFilter,ds=Tr.NearestMipmapNearestFilter,hs=Tr.NumberKeyframeTrack,ps=Tr.Object3D,vs=Tr.OrthographicCamera,ms=Tr.PerspectiveCamera,fs=Tr.PointLight,gs=Tr.Points,bs=Tr.PointsMaterial,ws=Tr.PropertyBinding,ys=Tr.QuaternionKeyframeTrack,xs=Tr.RGBFormat,Cs=Tr.RepeatWrapping,ks=Tr.Skeleton,Ms=Tr.SkinnedMesh,Ss=Tr.Sphere,Ts=Tr.SpotLight,Es=Tr.TangentSpaceNormalMap,Ls=Tr.TextureLoader,_s=Tr.TriangleFanDrawMode,Is=Tr.TriangleStripDrawMode,Rs=Tr.Vector2,As=Tr.Vector3,Ps=Tr.VectorKeyframeTrack,$s=Tr.sRGBEncoding,Hs=function(t){function e(e){var n;return(n=t.call(this,e)||this).dracoLoader=null,n.ktx2Loader=null,n.meshoptDecoder=null,n.pluginCallbacks=[],n.register((function(t){return new Vs(t)})),n.register((function(t){return new js(t)})),n.register((function(t){return new Fs(t)})),n.register((function(t){return new zs(t)})),n.register((function(t){return new Ds(t)})),n.register((function(t){return new Ns(t)})),n}d(e,t);var n=e.prototype;return n.load=function(t,e,n,i){var o,r=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:ts.extractUrlBase(t),this.manager.itemStart(t);var s=function(e){i?i(e):console.error(e),r.manager.itemError(t),r.manager.itemEnd(t)},a=new Br(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){try{r.parse(n,o,(function(n){e(n),r.manager.itemEnd(t)}),s)}catch(t){s(t)}}),n,s)},n.setDRACOLoader=function(t){return this.dracoLoader=t,this},n.setDDSLoader=function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},n.setKTX2Loader=function(t){return this.ktx2Loader=t,this},n.setMeshoptDecoder=function(t){return this.meshoptDecoder=t,this},n.register=function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},n.unregister=function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},n.parse=function(t,e,n,i){var o,r={},s={};if("string"==typeof t)o=t;else if(ts.decodeText(new Uint8Array(t,0,4))===Gs){try{r[Bs.KHR_BINARY_GLTF]=new Ws(t)}catch(t){return void(i&&i(t))}o=r[Bs.KHR_BINARY_GLTF].content}else o=ts.decodeText(new Uint8Array(t));var a=JSON.parse(o);if(void 0===a.asset||a.asset.version[0]<2)i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new Ma(a,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(var c=0;c<this.pluginCallbacks.length;c++){var u=this.pluginCallbacks[c](l);s[u.name]=u,r[u.name]=!0}if(a.extensionsUsed)for(var d=0;d<a.extensionsUsed.length;++d){var h=a.extensionsUsed[d],p=a.extensionsRequired||[];switch(h){case Bs.KHR_MATERIALS_UNLIT:r[h]=new Us;break;case Bs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:r[h]=new Js;break;case Bs.KHR_DRACO_MESH_COMPRESSION:r[h]=new Ks(a,this.dracoLoader);break;case Bs.KHR_TEXTURE_TRANSFORM:r[h]=new Xs;break;case Bs.KHR_MESH_QUANTIZATION:r[h]=new Qs;break;default:p.indexOf(h)>=0&&void 0===s[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(r),l.setPlugins(s),l.parse(n,i)}},e}(Qr);function Os(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}var Bs={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},Ds=function(){function t(t){this.parser=t,this.name=Bs.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}var e=t.prototype;return e._markDefs=function(){for(var t=this.parser,e=this.parser.json.nodes||[],n=0,i=e.length;n<i;n++){var o=e[n];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&t._addNodeRef(this.cache,o.extensions[this.name].light)}},e._loadLight=function(t){var e=this.parser,n="light:"+t,i=e.cache.get(n);if(i)return i;var o,r=e.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[t],a=new $r(16777215);void 0!==s.color&&a.fromArray(s.color);var l=void 0!==s.range?s.range:0;switch(s.type){case"directional":(o=new Hr(a)).target.position.set(0,0,-1),o.add(o.target);break;case"point":(o=new fs(a)).distance=l;break;case"spot":(o=new Ts(a)).distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,o.angle=s.spot.outerConeAngle,o.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return o.position.set(0,0,0),o.decay=2,void 0!==s.intensity&&(o.intensity=s.intensity),o.name=e.createUniqueName(s.name||"light_"+t),i=Promise.resolve(o),e.cache.add(n,i),i},e.createNodeAttachment=function(t){var e=this,n=this.parser,i=n.json.nodes[t],o=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(t){return n._getNodeRef(e.cache,o,t)}))},t}(),Us=function(){function t(){this.name=Bs.KHR_MATERIALS_UNLIT}var e=t.prototype;return e.getMaterialType=function(){return rs},e.extendParams=function(t,e,n){var i=[];t.color=new $r(1,1,1),t.opacity=1;var o=e.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var r=o.baseColorFactor;t.color.fromArray(r),t.opacity=r[3]}void 0!==o.baseColorTexture&&i.push(n.assignTexture(t,"map",o.baseColorTexture))}return Promise.all(i)},t}(),Vs=function(){function t(t){this.parser=t,this.name=Bs.KHR_MATERIALS_CLEARCOAT}var e=t.prototype;return e.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ss:null},e.extendMaterialParams=function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var o=[],r=i.extensions[this.name];if(void 0!==r.clearcoatFactor&&(e.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&o.push(n.assignTexture(e,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(e.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&o.push(n.assignTexture(e,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(o.push(n.assignTexture(e,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){var s=r.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new Rs(s,-s)}return Promise.all(o)},t}(),zs=function(){function t(t){this.parser=t,this.name=Bs.KHR_MATERIALS_TRANSMISSION}var e=t.prototype;return e.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ss:null},e.extendMaterialParams=function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var o=[],r=i.extensions[this.name];return void 0!==r.transmissionFactor&&(e.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&o.push(n.assignTexture(e,"transmissionMap",r.transmissionTexture)),Promise.all(o)},t}(),js=function(){function t(t){this.parser=t,this.name=Bs.KHR_TEXTURE_BASISU}return t.prototype.loadTexture=function(t){var e=this.parser,n=e.json,i=n.textures[t];if(!i.extensions||!i.extensions[this.name])return null;var o=i.extensions[this.name],r=n.images[o.source],s=e.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,r,s)},t}(),Fs=function(){function t(t){this.parser=t,this.name=Bs.EXT_TEXTURE_WEBP,this.isSupported=null}var e=t.prototype;return e.loadTexture=function(t){var e=this.name,n=this.parser,i=n.json,o=i.textures[t];if(!o.extensions||!o.extensions[e])return null;var r=o.extensions[e],s=i.images[r.source],a=n.textureLoader;if(s.uri){var l=n.options.manager.getHandler(s.uri);null!==l&&(a=l)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(t,s,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))},e.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported},t}(),Ns=function(){function t(t){this.name=Bs.EXT_MESHOPT_COMPRESSION,this.parser=t}return t.prototype.loadBufferView=function(t){var e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){var i=n.extensions[this.name],o=this.parser.getDependency("buffer",i.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,r.ready]).then((function(t){var e=i.byteOffset||0,n=i.byteLength||0,o=i.count,s=i.byteStride,a=new ArrayBuffer(o*s),l=new Uint8Array(t[0],e,n);return r.decodeGltfBuffer(new Uint8Array(a),o,s,l,i.mode,i.filter),a}))}return null},t}(),Gs="glTF",qs=1313821514,Zs=5130562,Ws=function(t){this.name=Bs.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,12);if(this.header={magic:ts.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Gs)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,i=new DataView(t,12),o=0;o<n;){var r=i.getUint32(o,!0);o+=4;var s=i.getUint32(o,!0);if(o+=4,s===qs){var a=new Uint8Array(t,12+o,r);this.content=ts.decodeText(a)}else if(s===Zs){var l=12+o;this.body=t.slice(l,l+r)}o+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")},Ks=function(){function t(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Bs.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}return t.prototype.decodePrimitive=function(t,e){var n=this.json,i=this.dracoLoader,o=t.extensions[this.name].bufferView,r=t.extensions[this.name].attributes,s={},a={},l={};for(var c in r){var u=ha[c]||c.toLowerCase();s[u]=r[c]}for(var d in t.attributes){var h=ha[d]||d.toLowerCase();if(void 0!==r[d]){var p=n.accessors[t.attributes[d]],v=la[p.componentType];l[h]=v,a[h]=!0===p.normalized}}return e.getDependency("bufferView",o).then((function(t){return new Promise((function(e){i.decodeDracoFile(t,(function(t){for(var n in t.attributes){var i=t.attributes[n],o=a[n];void 0!==o&&(i.normalized=o)}e(t)}),s,l)}))}))},t}(),Xs=function(){function t(){this.name=Bs.KHR_TEXTURE_TRANSFORM}return t.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},t}(),Ys=function(t){function e(e){var n;(n=t.call(this)||this).isGLTFSpecularGlossinessMaterial=!0;var i=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),o=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),l={specular:{value:(new $r).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return n._extraUniforms=l,n.onBeforeCompile=function(t){for(var e in l)t.uniforms[e]=l[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",i).replace("#include <metalnessmap_pars_fragment>",o).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",a)},Object.defineProperties(h(n),{specular:{get:function(){return l.specular.value},set:function(t){l.specular.value=t}},specularMap:{get:function(){return l.specularMap.value},set:function(t){l.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return l.glossiness.value},set:function(t){l.glossiness.value=t}},glossinessMap:{get:function(){return l.glossinessMap.value},set:function(t){l.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete n.metalness,delete n.roughness,delete n.metalnessMap,delete n.roughnessMap,n.setValues(e),n}return d(e,t),e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},e}(as),Js=function(){function t(){this.name=Bs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}var e=t.prototype;return e.getMaterialType=function(){return Ys},e.extendParams=function(t,e,n){var i=e.extensions[this.name];t.color=new $r(1,1,1),t.opacity=1;var o=[];if(Array.isArray(i.diffuseFactor)){var r=i.diffuseFactor;t.color.fromArray(r),t.opacity=r[3]}if(void 0!==i.diffuseTexture&&o.push(n.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new $r(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new $r(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var s=i.specularGlossinessTexture;o.push(n.assignTexture(t,"glossinessMap",s)),o.push(n.assignTexture(t,"specularMap",s))}return Promise.all(o)},e.createMaterial=function(t){var e=new Ys(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=Es,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e},t}(),Qs=function(){this.name=Bs.KHR_MESH_QUANTIZATION},ta=function(t){function e(e,n,i,o){return t.call(this,e,n,i,o)||this}return d(e,t),e.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,o=t*i*3+i,r=0;r!==i;r++)e[r]=n[o+r];return e},e}(Fr);ta.prototype.beforeStart_=ta.prototype.copySampleValue_,ta.prototype.afterEnd_=ta.prototype.copySampleValue_,ta.prototype.interpolate_=function(t,e,n,i){for(var o=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=2*s,l=3*s,c=i-e,u=(n-e)/c,d=u*u,h=d*u,p=t*l,v=p-l,m=-2*h+3*d,f=h-d,g=1-m,b=f-d+u,w=0;w!==s;w++){var y=r[v+w+s],x=r[v+w+a]*c,C=r[p+w+s],k=r[p+w]*c;o[w]=g*y+b*x+m*C+f*k}return o};var ea=0,na=1,ia=2,oa=3,ra=4,sa=5,aa=6,la={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ca={9728:cs,9729:Xr,9984:ds,9985:Jr,9986:us,9987:Yr},ua={33071:Pr,33648:ls,10497:Cs},da={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ha={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},pa={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},va={CUBICSPLINE:void 0,LINEAR:Gr,STEP:Nr},ma="OPAQUE",fa="MASK",ga="BLEND";function ba(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function wa(t,e,n){for(var i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function ya(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function xa(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var o=e.extras.targetNames;if(t.morphTargetInfluences.length===o.length){t.morphTargetDictionary={};for(var r=0,s=o.length;r<s;r++)t.morphTargetDictionary[o[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ca(t){for(var e="",n=Object.keys(t).sort(),i=0,o=n.length;i<o;i++)e+=n[i]+":"+t[n[i]]+";";return e}function ka(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var Ma=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new Os,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new Vr(this.options.manager):this.textureLoader=new Ls(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Br(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}var e=t.prototype;return e.setExtensions=function(t){this.extensions=t},e.setPlugins=function(t){this.plugins=t},e.parse=function(t,e){var n=this,i=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){var r={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}};wa(o,r,i),ya(r,i),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(r)}))).then((function(){t(r)}))})).catch(e)},e._markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],i=0,o=e.length;i<o;i++)for(var r=e[i].joints,s=0,a=r.length;s<a;s++)t[r[s]].isBone=!0;for(var l=0,c=t.length;l<c;l++){var u=t[l];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(n[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},e._addNodeRef=function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)},e._getNodeRef=function(t,e,n){if(t.refs[e]<=1)return n;var i=n.clone();return i.name+="_instance_"+t.uses[e]++,i},e._invokeOne=function(t){var e=Object.values(this.plugins);e.push(this);for(var n=0;n<e.length;n++){var i=t(e[n]);if(i)return i}return null},e._invokeAll=function(t){var e=Object.values(this.plugins);e.unshift(this);for(var n=[],i=0;i<e.length;i++){var o=t(e[i]);o&&n.push(o)}return n},e.getDependency=function(t,e){var n=t+":"+e,i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":i=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i},e.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,i=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(i.map((function(e,i){return n.getDependency(t,i)}))),this.cache.add(t,e)}return e},e.loadBuffer=function(t){var e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[Bs.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(t,o){n.load(ba(e.uri,i.path),t,void 0,(function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))},e.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){var n=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+n)}))},e.loadAccessor=function(t){var e=this,n=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var o=[];return void 0!==i.bufferView?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),void 0!==i.sparse&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then((function(t){var o,r,s=t[0],a=da[i.type],l=la[i.componentType],c=l.BYTES_PER_ELEMENT,u=c*a,d=i.byteOffset||0,h=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,p=!0===i.normalized;if(h&&h!==u){var v=Math.floor(d/h),m="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+v+":"+i.count,f=e.cache.get(m);f||(o=new l(s,v*h,i.count*h/c),f=new zr(o,h/c),e.cache.add(m,f)),r=new jr(f,a,d%h/c,p)}else o=null===s?new l(i.count*a):new l(s,d,i.count*a),r=new Ir(o,a,p);if(void 0!==i.sparse){var g=da.SCALAR,b=la[i.sparse.indices.componentType],w=i.sparse.indices.byteOffset||0,y=i.sparse.values.byteOffset||0,x=new b(t[1],w,i.sparse.count*g),C=new l(t[2],y,i.sparse.count*a);null!==s&&(r=new Ir(r.array.slice(),r.itemSize,r.normalized));for(var k=0,M=x.length;k<M;k++){var S=x[k];if(r.setX(S,C[k*a]),a>=2&&r.setY(S,C[k*a+1]),a>=3&&r.setZ(S,C[k*a+2]),a>=4&&r.setW(S,C[k*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return r}))},e.loadTexture=function(t){var e=this.json,n=this.options,i=e.textures[t],o=e.images[i.source],r=this.textureLoader;if(o.uri){var s=n.manager.getHandler(o.uri);null!==s&&(r=s)}return this.loadTextureImage(t,o,r)},e.loadTextureImage=function(t,e,n){var i=this,o=this.json,r=this.options,s=o.textures[t],a=self.URL||self.webkitURL,l=e.uri,c=!1,u=!0;if("image/jpeg"===e.mimeType&&(u=!1),void 0!==e.bufferView)l=i.getDependency("bufferView",e.bufferView).then((function(t){if("image/png"===e.mimeType){var n=new DataView(t,25,1).getUint8(0,!1);u=6===n||4===n||3===n}c=!0;var i=new Blob([t],{type:e.mimeType});return l=a.createObjectURL(i)}));else if(void 0===e.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");return Promise.resolve(l).then((function(t){return new Promise((function(e,i){var o=e;!0===n.isImageBitmapLoader&&(o=function(t){e(new Ar(t))}),n.load(ba(t,r.path),o,void 0,i)}))})).then((function(e){!0===c&&a.revokeObjectURL(l),e.flipY=!1,s.name&&(e.name=s.name),u||(e.format=xs);var n=(o.samplers||{})[s.sampler]||{};return e.magFilter=ca[n.magFilter]||Xr,e.minFilter=ca[n.minFilter]||Yr,e.wrapS=ua[n.wrapS]||Cs,e.wrapT=ua[n.wrapT]||Cs,i.associations.set(e,{type:"textures",index:t}),e}))},e.assignTexture=function(t,e,n){var i=this;return this.getDependency("texture",n.index).then((function(o){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),i.extensions[Bs.KHR_TEXTURE_TRANSFORM]){var r=void 0!==n.extensions?n.extensions[Bs.KHR_TEXTURE_TRANSFORM]:void 0;if(r){var s=i.associations.get(o);o=i.extensions[Bs.KHR_TEXTURE_TRANSFORM].extendTexture(o,r),i.associations.set(o,s)}}t[e]=o}))},e.assignFinalMaterial=function(t){var e=t.geometry,n=t.material,i=void 0!==e.attributes.tangent,o=void 0!==e.attributes.color,r=void 0===e.attributes.normal,s=!0===t.isSkinnedMesh,a=Object.keys(e.morphAttributes).length>0,l=a&&void 0!==e.morphAttributes.normal;if(t.isPoints){var c="PointsMaterial:"+n.uuid,u=this.cache.get(c);u||(u=new bs,es.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(t.isLine){var d="LineBasicMaterial:"+n.uuid,h=this.cache.get(d);h||(h=new Zr,es.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(d,h)),n=h}if(i||o||r||s||a){var p="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),s&&(p+="skinning:"),i&&(p+="vertex-tangents:"),o&&(p+="vertex-colors:"),r&&(p+="flat-shading:"),a&&(p+="morph-targets:"),l&&(p+="morph-normals:");var v=this.cache.get(p);v||(v=n.clone(),s&&(v.skinning=!0),o&&(v.vertexColors=!0),r&&(v.flatShading=!0),a&&(v.morphTargets=!0),l&&(v.morphNormals=!0),i&&(v.vertexTangents=!0,v.normalScale&&(v.normalScale.y*=-1),v.clearcoatNormalScale&&(v.clearcoatNormalScale.y*=-1)),this.cache.add(p,v),this.associations.set(v,this.associations.get(n))),n=v}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n},e.getMaterialType=function(){return as},e.loadMaterial=function(t){var e,n=this,i=this.json,o=this.extensions,r=i.materials[t],s={},a=r.extensions||{},l=[];if(a[Bs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=o[Bs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=c.getMaterialType(),l.push(c.extendParams(s,r,n))}else if(a[Bs.KHR_MATERIALS_UNLIT]){var u=o[Bs.KHR_MATERIALS_UNLIT];e=u.getMaterialType(),l.push(u.extendParams(s,r,n))}else{var d=r.pbrMetallicRoughness||{};if(s.color=new $r(1,1,1),s.opacity=1,Array.isArray(d.baseColorFactor)){var h=d.baseColorFactor;s.color.fromArray(h),s.opacity=h[3]}void 0!==d.baseColorTexture&&l.push(n.assignTexture(s,"map",d.baseColorTexture)),s.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,s.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(l.push(n.assignTexture(s,"metalnessMap",d.metallicRoughnessTexture)),l.push(n.assignTexture(s,"roughnessMap",d.metallicRoughnessTexture))),e=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,s)}))))}!0===r.doubleSided&&(s.side=Or);var p=r.alphaMode||ma;return p===ga?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,p===fa&&(s.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&e!==rs&&(l.push(n.assignTexture(s,"normalMap",r.normalTexture)),s.normalScale=new Rs(1,-1),void 0!==r.normalTexture.scale&&s.normalScale.set(r.normalTexture.scale,-r.normalTexture.scale)),void 0!==r.occlusionTexture&&e!==rs&&(l.push(n.assignTexture(s,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(s.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&e!==rs&&(s.emissive=(new $r).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&e!==rs&&l.push(n.assignTexture(s,"emissiveMap",r.emissiveTexture)),Promise.all(l).then((function(){var i;return i=e===Ys?o[Bs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new e(s),r.name&&(i.name=r.name),i.map&&(i.map.encoding=$s),i.emissiveMap&&(i.emissiveMap.encoding=$s),ya(i,r),n.associations.set(i,{type:"materials",index:t}),r.extensions&&wa(o,i,r),i}))},e.createUniqueName=function(t){for(var e=ws.sanitizeNodeName(t||""),n=e,i=1;this.nodeNamesUsed[n];++i)n=e+"_"+i;return this.nodeNamesUsed[n]=!0,n},e.loadGeometries=function(t){var e=this,n=this.extensions,i=this.primitiveCache;function o(t){return n[Bs.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return Ta(n,t,e)}))}for(var r,s,a=[],l=0,c=t.length;l<c;l++){var u=t[l],d=(s=void 0,(s=(r=u).extensions&&r.extensions[Bs.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+Ca(s.attributes):r.indices+":"+Ca(r.attributes)+":"+r.mode),h=i[d];if(h)a.push(h.promise);else{var p=void 0;p=u.extensions&&u.extensions[Bs.KHR_DRACO_MESH_COMPRESSION]?o(u):Ta(new Rr,u,e),i[d]={primitive:u,promise:p},a.push(p)}}return Promise.all(a)},e.loadMesh=function(t){for(var e,n=this,i=this.json,o=this.extensions,r=i.meshes[t],s=r.primitives,a=[],l=0,c=s.length;l<c;l++){var u=void 0===s[l].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new as({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Dr})),e.DefaultMaterial):this.getDependency("material",s[l].material);a.push(u)}return a.push(n.loadGeometries(s)),Promise.all(a).then((function(e){for(var i=e.slice(0,e.length-1),a=e[e.length-1],l=[],c=0,u=a.length;c<u;c++){var d=a[c],h=s[c],p=void 0,v=i[c];if(h.mode===ra||h.mode===sa||h.mode===aa||void 0===h.mode)!0!==(p=!0===r.isSkinnedMesh?new Ms(d,v):new os(d,v)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),h.mode===sa?p.geometry=Ea(p.geometry,Is):h.mode===aa&&(p.geometry=Ea(p.geometry,_s));else if(h.mode===na)p=new Kr(d,v);else if(h.mode===oa)p=new qr(d,v);else if(h.mode===ia)p=new Wr(d,v);else{if(h.mode!==ea)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);p=new gs(d,v)}Object.keys(p.geometry.morphAttributes).length>0&&xa(p,r),p.name=n.createUniqueName(r.name||"mesh_"+t),ya(p,r),h.extensions&&wa(o,p,h),n.assignFinalMaterial(p),l.push(p)}if(1===l.length)return l[0];for(var m=new Ur,f=0,g=l.length;f<g;f++)m.add(l[f]);return m}))},e.loadCamera=function(t){var e,n=this.json.cameras[t],i=n[n.type];if(i)return"perspective"===n.type?e=new ms(ns.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(e=new vs(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),ya(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},e.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))},e.loadAnimation=function(t){for(var e=this.json.animations[t],n=[],i=[],o=[],r=[],s=[],a=0,l=e.channels.length;a<l;a++){var c=e.channels[a],u=e.samplers[c.sampler],d=c.target,h=void 0!==d.node?d.node:d.id,p=void 0!==e.parameters?e.parameters[u.input]:u.input,v=void 0!==e.parameters?e.parameters[u.output]:u.output;n.push(this.getDependency("node",h)),i.push(this.getDependency("accessor",p)),o.push(this.getDependency("accessor",v)),r.push(u),s.push(d)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(o),Promise.all(r),Promise.all(s)]).then((function(n){for(var i=n[0],o=n[1],r=n[2],s=n[3],a=n[4],l=[],c=function(t,e){var n=i[t],c=o[t],u=r[t],d=s[t],h=a[t];if(void 0===n)return"continue";n.updateMatrix(),n.matrixAutoUpdate=!0;var p=void 0;switch(pa[h.path]){case pa.weights:p=hs;break;case pa.rotation:p=ys;break;case pa.position:case pa.scale:default:p=Ps}var v=n.name?n.name:n.uuid,m=void 0!==d.interpolation?va[d.interpolation]:Gr,f=[];pa[h.path]===pa.weights?n.traverse((function(t){!0===t.isMesh&&t.morphTargetInfluences&&f.push(t.name?t.name:t.uuid)})):f.push(v);var g=u.array;if(u.normalized){for(var b=ka(g.constructor),w=new Float32Array(g.length),y=0,x=g.length;y<x;y++)w[y]=g[y]*b;g=w}for(var C=0,k=f.length;C<k;C++){var M=new p(f[C]+"."+pa[h.path],c.array,g,m);"CUBICSPLINE"===d.interpolation&&(M.createInterpolant=function(t){return new ta(this.times,this.values,this.getValueSize()/3,t)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(M)}},u=0,d=i.length;u<d;u++)c(u);var h=e.name?e.name:"animation_"+t;return new Er(h,void 0,l)}))},e.createNodeMesh=function(t){var e=this.json,n=this,i=e.nodes[t];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(t){var e=n._getNodeRef(n.meshCache,i.mesh,t);return void 0!==i.weights&&e.traverse((function(t){if(t.isMesh)for(var e=0,n=i.weights.length;e<n;e++)t.morphTargetInfluences[e]=i.weights[e]})),e}))},e.loadNode=function(t){var e,n,i=this.json,o=this.extensions,r=this,s=i.nodes[t],a=s.name?r.createUniqueName(s.name):"";return(e=[],n=r._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)})),n&&e.push(n),void 0!==s.camera&&e.push(r.getDependency("camera",s.camera).then((function(t){return r._getNodeRef(r.cameraCache,s.camera,t)}))),r._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)).then((function(e){var n;if((n=!0===s.isBone?new Lr:e.length>1?new Ur:1===e.length?e[0]:new ps)!==e[0])for(var i=0,l=e.length;i<l;i++)n.add(e[i]);if(s.name&&(n.userData.name=s.name,n.name=a),ya(n,s),s.extensions&&wa(o,n,s),void 0!==s.matrix){var c=new is;c.fromArray(s.matrix),n.applyMatrix4(c)}else void 0!==s.translation&&n.position.fromArray(s.translation),void 0!==s.rotation&&n.quaternion.fromArray(s.rotation),void 0!==s.scale&&n.scale.fromArray(s.scale);return r.associations.set(n,{type:"nodes",index:t}),n}))},e.loadScene=function(t){var e=this.json,n=this.extensions,i=this.json.scenes[t],o=new Ur;i.name&&(o.name=this.createUniqueName(i.name)),ya(o,i),i.extensions&&wa(n,o,i);for(var r=i.nodes||[],s=[],a=0,l=r.length;a<l;a++)s.push(Sa(r[a],o,e,this));return Promise.all(s).then((function(){return o}))},t}();function Sa(t,e,n,i){var o=n.nodes[t];return i.getDependency("node",t).then((function(t){return void 0===o.skin?t:i.getDependency("skin",o.skin).then((function(t){for(var n=[],o=0,r=(e=t).joints.length;o<r;o++)n.push(i.getDependency("node",e.joints[o]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(t.isMesh){for(var i=[],o=[],r=0,s=n.length;r<s;r++){var a=n[r];if(a){i.push(a);var l=new is;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*r),o.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[r])}t.bind(new ks(i,o),t.matrixWorld)}})),t}));var e})).then((function(t){e.add(t);var r=[];if(o.children)for(var s=o.children,a=0,l=s.length;a<l;a++){var c=s[a];r.push(Sa(c,t,n,i))}return Promise.all(r)}))}function Ta(t,e,n){var i=e.attributes,o=[];function r(e,i){return n.getDependency("accessor",e).then((function(e){t.setAttribute(i,e)}))}for(var s in i){var a=ha[s]||s.toLowerCase();a in t.attributes||o.push(r(i[s],a))}if(void 0!==e.indices&&!t.index){var l=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));o.push(l)}return ya(t,e),function(t,e,n){var i=e.attributes,o=new _r;if(void 0!==i.POSITION){var r=n.json.accessors[i.POSITION],s=r.min,a=r.max;if(void 0!==s&&void 0!==a){if(o.set(new As(s[0],s[1],s[2]),new As(a[0],a[1],a[2])),r.normalized){var l=ka(la[r.componentType]);o.min.multiplyScalar(l),o.max.multiplyScalar(l)}var c=e.targets;if(void 0!==c){for(var u=new As,d=new As,h=0,p=c.length;h<p;h++){var v=c[h];if(void 0!==v.POSITION){var m=n.json.accessors[v.POSITION],f=m.min,g=m.max;if(void 0!==f&&void 0!==g){if(d.setX(Math.max(Math.abs(f[0]),Math.abs(g[0]))),d.setY(Math.max(Math.abs(f[1]),Math.abs(g[1]))),d.setZ(Math.max(Math.abs(f[2]),Math.abs(g[2]))),m.normalized){var b=ka(la[m.componentType]);d.multiplyScalar(b)}u.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(u)}t.boundingBox=o;var w=new Ss;o.getCenter(w.center),w.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=w}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(o).then((function(){return void 0!==e.targets?function(t,e,n){for(var i=!1,o=!1,r=0,s=e.length;r<s;r++){var a=e[r];if(void 0!==a.POSITION&&(i=!0),void 0!==a.NORMAL&&(o=!0),i&&o)break}if(!i&&!o)return Promise.resolve(t);for(var l=[],c=[],u=0,d=e.length;u<d;u++){var h=e[u];if(i){var p=void 0!==h.POSITION?n.getDependency("accessor",h.POSITION):t.attributes.position;l.push(p)}if(o){var v=void 0!==h.NORMAL?n.getDependency("accessor",h.NORMAL):t.attributes.normal;c.push(v)}}return Promise.all([Promise.all(l),Promise.all(c)]).then((function(e){var n=e[0],r=e[1];return i&&(t.morphAttributes.position=n),o&&(t.morphAttributes.normal=r),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function Ea(t,e){var n=t.getIndex();if(null===n){var i=[],o=t.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var r=0;r<o.count;r++)i.push(r);t.setIndex(i),n=t.getIndex()}var s=n.count-2,a=[];if(e===_s)for(var l=1;l<=s;l++)a.push(n.getX(0)),a.push(n.getX(l)),a.push(n.getX(l+1));else for(var c=0;c<s;c++)c%2==0?(a.push(n.getX(c)),a.push(n.getX(c+1)),a.push(n.getX(c+2))):(a.push(n.getX(c+2)),a.push(n.getX(c+1)),a.push(n.getX(c)));a.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var u=t.clone();return u.setIndex(a),u}var La={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})},_a={xAxis:0,yAxis:0,button:0,state:La.ComponentState.DEFAULT};function Ia(t){return Ra.apply(this,arguments)}function Ra(){return(Ra=s(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if((n=t.sent).ok){t.next=7;break}throw new Error(n.statusText);case 7:return t.abrupt("return",n.json());case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Aa(t){return Pa.apply(this,arguments)}function Pa(){return(Pa=s(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("No basePath supplied");case 2:return"profilesList.json",t.next=5,Ia(e+"/profilesList.json");case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $a(){return($a=s(regeneratorRuntime.mark((function t(e,n,i,o){var r,s,a,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=null),void 0===o&&(o=!0),e){t.next=4;break}throw new Error("No xrInputSource supplied");case 4:if(n){t.next=6;break}throw new Error("No basePath supplied");case 6:return t.next=8,Aa(n);case 8:if(r=t.sent,e.profiles.some((function(t){var e=r[t];return e&&(s={profileId:t,profilePath:n+"/"+e.path,deprecated:!!e.deprecated}),!!s})),s){t.next=17;break}if(i){t.next=13;break}throw new Error("No matching profile name found");case 13:if(a=r[i]){t.next=16;break}throw new Error('No matching profile name found and default profile "'+i+'" missing.');case 16:s={profileId:i,profilePath:n+"/"+a.path,deprecated:!!a.deprecated};case 17:return t.next=19,Ia(s.profilePath);case 19:if(l=t.sent,!o){t.next=25;break}if(u="any"===e.handedness?l.layouts[Object.keys(l.layouts)[0]]:l.layouts[e.handedness]){t.next=24;break}throw new Error("No matching handedness, "+e.handedness+", in profile "+s.profileId);case 24:u.assetPath&&(c=s.profilePath.replace("profile.json",u.assetPath));case 25:return t.abrupt("return",{profile:l,assetPath:c});case 26:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ha=function(){function t(t){this.componentProperty=t.componentProperty,this.states=t.states,this.valueNodeName=t.valueNodeName,this.valueNodeProperty=t.valueNodeProperty,this.valueNodeProperty===La.VisualResponseProperty.TRANSFORM&&(this.minNodeName=t.minNodeName,this.maxNodeName=t.maxNodeName),this.value=0,this.updateFromComponent(_a)}return t.prototype.updateFromComponent=function(t){var e=t.xAxis,n=t.yAxis,i=t.button,o=t.state,r=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=t,i=e;if(Math.sqrt(t*t+e*e)>1){var o=Math.atan2(e,t);n=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*n+.5,normalizedYAxis:.5*i+.5}}(e,n),s=r.normalizedXAxis,a=r.normalizedYAxis;switch(this.componentProperty){case La.ComponentProperty.X_AXIS:this.value=this.states.includes(o)?s:.5;break;case La.ComponentProperty.Y_AXIS:this.value=this.states.includes(o)?a:.5;break;case La.ComponentProperty.BUTTON:this.value=this.states.includes(o)?i:0;break;case La.ComponentProperty.STATE:this.valueNodeProperty===La.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(o):this.value=this.states.includes(o)?1:0;break;default:throw new Error("Unexpected visualResponse componentProperty "+this.componentProperty)}},t}(),Oa=function(){function t(t,e){var n=this;if(!(t&&e&&e.visualResponses&&e.gamepadIndices&&0!==Object.keys(e.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=t,this.type=e.type,this.rootNodeName=e.rootNodeName,this.touchPointNodeName=e.touchPointNodeName,this.visualResponses={},Object.keys(e.visualResponses).forEach((function(t){var i=new Ha(e.visualResponses[t]);n.visualResponses[t]=i})),this.gamepadIndices=Object.assign({},e.gamepadIndices),this.values={state:La.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}return t.prototype.updateFromGamepad=function(t){var e=this;if(this.values.state=La.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&t.buttons.length>this.gamepadIndices.button){var n=t.buttons[this.gamepadIndices.button];this.values.button=n.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,n.pressed||1===this.values.button?this.values.state=La.ComponentState.PRESSED:(n.touched||this.values.button>La.ButtonTouchThreshold)&&(this.values.state=La.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&t.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=t.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===La.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>La.AxisTouchThreshold&&(this.values.state=La.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&t.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=t.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===La.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>La.AxisTouchThreshold&&(this.values.state=La.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((function(t){t.updateFromComponent(e.values)}))},l(t,[{key:"data",get:function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:this.id},this.values)}}]),t}(),Ba=function(){function t(t,e,n){var i=this;if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No profile supplied");this.xrInputSource=t,this.assetUrl=n,this.id=e.profileId,this.layoutDescription=e.layouts[t.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((function(t){var e=i.layoutDescription.components[t];i.components[t]=new Oa(t,e)})),this.updateFromGamepad()}return t.prototype.updateFromGamepad=function(){var t=this;Object.values(this.components).forEach((function(e){e.updateFromGamepad(t.xrInputSource.gamepad)}))},l(t,[{key:"gripSpace",get:function(){return this.xrInputSource.gripSpace}},{key:"targetRaySpace",get:function(){return this.xrInputSource.targetRaySpace}},{key:"data",get:function(){var t=[];return Object.values(this.components).forEach((function(e){t.push(e.data)})),t}}]),t}(),Da=function(t){function e(){var e;return(e=t.call(this)||this).motionController=null,e.envMap=null,e}d(e,t);var n=e.prototype;return n.setEnvironmentMap=function(t){var e=this;return this.envMap==t||(this.envMap=t,this.traverse((function(t){t.isMesh&&(t.material.envMap=e.envMap,t.material.needsUpdate=!0)}))),this},n.updateMatrixWorld=function(e){t.prototype.updateMatrixWorld.call(this,e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((function(t){Object.values(t.visualResponses).forEach((function(t){var e=t.valueNode,n=t.minNode,i=t.maxNode,o=t.value,r=t.valueNodeProperty;e&&(r===La.VisualResponseProperty.VISIBILITY?e.visible=o:r===La.VisualResponseProperty.TRANSFORM&&(e.quaternion.slerpQuaternions(n.quaternion,i.quaternion,o),e.position.lerpVectors(n.position,i.position,o)))}))})))},e}(THREE.Object3D);function Ua(t,e){!function(t,e){Object.values(t.components).forEach((function(t){var n=t.type,i=t.touchPointNodeName,o=t.visualResponses;if(n===La.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(i),t.touchPointNode){var r=new THREE.SphereGeometry(.001),s=new THREE.MeshBasicMaterial({color:255}),a=new THREE.Mesh(r,s);t.touchPointNode.add(a)}else console.warn("Could not find touch dot, "+t.touchPointNodeName+", in touchpad component "+t.id);Object.values(o).forEach((function(t){var n=t.valueNodeName,i=t.minNodeName,o=t.maxNodeName;if(t.valueNodeProperty===La.VisualResponseProperty.TRANSFORM){if(t.minNode=e.getObjectByName(i),t.maxNode=e.getObjectByName(o),!t.minNode)return void console.warn("Could not find "+i+" in the model");if(!t.maxNode)return void console.warn("Could not find "+o+" in the model")}t.valueNode=e.getObjectByName(n),t.valueNode||console.warn("Could not find "+n+" in the model")}))}))}(t.motionController,e),t.envMap&&e.traverse((function(e){e.isMesh&&(e.material.envMap=t.envMap,e.material.needsUpdate=!0)})),t.add(e)}var Va=function(){function t(t){void 0===t&&(t=null),this.gltfLoader=t,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new Hs)}return t.prototype.createControllerModel=function(t){var e=this,n=new Da,i=null;return t.addEventListener("connected",(function(t){var o=t.data;"tracked-pointer"===o.targetRayMode&&o.gamepad&&function(t,e,n,i){return $a.apply(this,arguments)}(o,e.path,"generic-trigger").then((function(t){var r=t.profile,s=t.assetPath;n.motionController=new Ba(o,r,s);var a=e._assetCache[n.motionController.assetUrl];if(a)i=a.scene.clone(),Ua(n,i);else{if(!e.gltfLoader)throw new Error("GLTFLoader not set.");e.gltfLoader.setPath(""),e.gltfLoader.load(n.motionController.assetUrl,(function(t){e._assetCache[n.motionController.assetUrl]=t,i=t.scene.clone(),Ua(n,i)}),null,(function(){throw new Error("Asset "+n.motionController.assetUrl+" missing or malformed.")}))}})).catch((function(t){console.warn(t)}))})),t.addEventListener("disconnected",(function(){n.motionController=null,n.remove(i),i=null})),n},t}(),za=new THREE.Vector3,ja=new THREE.Vector3(0,-1,0),Fa={type:Re,orientation:{latitude:0,longitude:0},zoom:1,cameraGroup:{position:[0,0,0],rotation:[0,0,0]},pointer:[0,0,0]},Na=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var t=this;so.host=this,this.defaultTexture=Ho.gridTexture,this.index=0,this.error_=null,this.loading=null,this.waiting=null,this.avatars={},this.createScene(),this.setView(),this.addListeners(),this.animate(),ho.keys$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.keys=e}))},r.onDestroy=function(){this.removeListeners(),this.renderer.setAnimationLoop((function(){}))},r.createScene=function(){var e=this,n=t.getContext(this).node;this.size={left:0,top:0,width:0,height:0,aspect:0},this.mouse=new THREE.Vector2,this.controllerMatrix_=new THREE.Matrix4,this.controllerWorldPosition_=new THREE.Vector3,this.controllerWorldDirection_=new THREE.Vector3;var o=this.container=n,r=(this.info=n.querySelector(".world__info"),this.worldRect=wo.fromNode(o),this.cameraRect=new wo,this.cameraGroup=new THREE.Group),s=this.camera=new THREE.PerspectiveCamera(70,o.offsetWidth/o.offsetHeight,.01,1e3);s.target=new THREE.Vector3,r.add(s);this.orbitService=new nr(s);var a=this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1,premultipliedAlpha:!0,logarithmicDepthBuffer:!0});a.setClearColor(0,1),a.setPixelRatio(window.devicePixelRatio),a.setSize(o.offsetWidth,o.offsetHeight),a.xr.enabled=!0,a.outputEncoding=THREE.sRGBEncoding,a.toneMapping=THREE.NoToneMapping,a.toneMappingExposure=1,o.childElementCount>0?o.insertBefore(a.domElement,o.children[0]):o.appendChild(a.domElement),(this.raycaster=new THREE.Raycaster).setFromCamera(this.mouse,s);var l=this.scene=new THREE.Scene;l.add(r),E.flags.useTextureEnvironment&&this.addEnvironment();var c=this.objects=new THREE.Group;c.name="[objects]",l.add(c);var u=this.panorama=new lr(a);this.panoramaIntersectObjects=[u.mesh],this.intersectObjects=this.panoramaIntersectObjects,c.add(u.mesh);this.indicator=new pr,this.pointer=new pr("#ff4332");var d=this.ambient=new THREE.AmbientLight(16777215,1);c.add(d);var h=this.direct=new THREE.DirectionalLight(16777215,1);h.position.set(-40,-40,-40),h.target.position.set(0,0,0),c.add(h),this.addControllers(),this.resize(),vo.progress$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){var n=0===t.count,i=e.view_;i.items&&i.items.forEach((function(t){t.visible=n}))}))},r.addEnvironment=function(){var t=this,e=E.textures.envMap.split("/"),n=e.pop(),i=e.join("/")+"/",o=-1!==n.indexOf(".hdr");(o?new $o:new THREE.TextureLoader).setPath(E.getPath(i)).load(n,(function(e){o&&e?(e.mapping=THREE.EquirectangularReflectionMapping,t.scene.environment=e):t.setBackground(e)}))},r.addOffCanvasScene=function(t){var e=new xo(t);this.avatars[t.clientId]=e},r.removeOffCanvasScene=function(t){this.avatars[t.clientId];delete this.avatars[t.clientId]},r.updateOffCanvasScene=function(t){var e=this.avatars[t.clientId];e&&e.update(t)},r.setBackground=function(t){var e=t||this.defaultTexture;e.mapping=THREE.EquirectangularReflectionMapping,e.encoding=THREE.sRGBEncoding,this.scene.environment=e},r.setView=function(){var e=this;if(this.renderer&&this.panorama){var n=this.view_;if(n){null!=_.state.zoomedId&&_.patchState({zoomedId:null}),this.views&&this.views.forEach((function(t){return delete t.onUpdateAsset}));var i=this.requestInfoResult;i&&n instanceof si&&void 0!==i.gridIndex&&(n.index_=i.gridIndex),n.ready=!1,this.cameraGroup.position.set(0,0,0),this.cameraGroup.rotation.set(0,0,0),n.type.name===ni.Room3d.name?(this.renderer.setClearColor(0,1),this.objects.remove(this.panorama.mesh),this.ambient.visible=!1,this.direct.visible=!1):(this.renderer.setClearColor(0,1),this.objects.add(this.panorama.mesh),this.ambient.visible=!0,this.direct.visible=!0),this.pushChanges(),bo.cancel(),this.panorama.change(n,this.renderer,(function(i){E.flags.useTextureEnvironment||e.setBackground(i),n.ready=!0,n.onUpdateAsset=function(){e.onViewAssetDidChange()},t.getContext(e)&&e.pushChanges()}),(function(t){e.setViewOrientation(t),bo.prefetch(t.prefetchAssets)}))}}},r.onViewAssetDidChange=function(){var t=this;this.panorama&&this.panorama.crossfade(this.view,this.renderer,(function(e){E.flags.useTextureEnvironment||t.setBackground(e)}))},r.setViewOrientation=function(t){var e,n=this.requestInfoResult;(this.requestInfoResult=null,this.orbitService)&&(this.orbitService.mode=t.type.name,this.renderer.xr.isPresenting||(n?(e=n.orientation,this.orbitService.setOrientation(e),this.orbitService.zoom=n.zoom,this.camera.updateProjectionMatrix()):t.keepOrientation||(e=t.useLastOrientation?t.lastOrientation:t.orientation,this.orbitService.setOrientation(e),this.orbitService.zoom=t.zoom,this.camera.updateProjectionMatrix())))},r.addControllers=function(){var t=this.controllerGroup=new THREE.Group;this.teleport=new vr;this.controllers=[],this.controllerModelFactory=new Va,this.addController(0),this.addController(1),this.cameraGroup.add(t)},r.addController=function(t){var e=this,n=_.state.live,i=this.renderer,o=this.controllerGroup,r=i.xr.getController(t),s=this.controllerModelFactory,a=this.teleport,l=this.scene,c=this.camera,u=this.cameraGroup;r.name="[controller"+(t+1)+"]",o.add(r);var d=function(t){switch(t.index){case 0:case 1:break;case 4:gn.send({type:Ze})}},h=function(t){e.onModelUp()},p=function(t){e.cameraGroup.rotation.y+=Math.PI/180*45},v=function(t){e.cameraGroup.rotation.y-=Math.PI/180*45},m=function(t){e.onModelDistance(t.y)};r.userData.update=function(){},r.addEventListener("selectstart",(function(t){r.userData.isSelecting=!0,function(t){e.controller=t}(r)})),r.addEventListener("selectend",(function(t){r.userData.isSelecting=!1})),r.addEventListener("connected",(function(a){if(r.add(e.buildController(a.data)),n&&"left"===a.data.handedness){var l=e.phone=new hr;r.add(l.mesh)}if(!n||"right"===a.data.handedness){var c=i.xr.getControllerGrip(t);c.name="[controller-grip"+(t+1)+"]";var u=s.createControllerModel(c);r.userData.model=u,c.add(u),o.add(c)}var f=new kr(a.data.gamepad);f.on("press",d),f.on("release",h),f.on("left",p),f.on("right",v),f.on("axis",m),r.userData.gamepad=f,r.userData.update=function(){f.update()}})),r.addEventListener("disconnected",(function(e){for(;r.children.length;)r.remove(r.children[0]);for(var n=i.xr.getControllerGrip(t);n.children.length;)n.remove(n.children[0]);o.remove(n),r.userData.update=function(){};var s=r.userData.gamepad;s&&(s.off("press",d),s.off("release",h),s.off("left",p),s.off("right",v),s.off("axis",m),delete r.userData.gamepad),a.removeFromController(r,l,i,c,u)})),r.addEventListener("squeezestart",(function(t){e.view&&e.view.type.name===ni.Room3d.name&&(a.addToController(r,l),e.indicator.mesh.visible=!1,r.children[0].visible=!1)})),r.addEventListener("squeezeend",(function(t){a.removeFromController(r,l,i,c,u),e.indicator.mesh.visible=!0,r.children[0].visible=!0})),this.controllers.push(r)},r.buildController=function(t){var e,n;switch(t.targetRayMode){case"tracked-pointer":return(e=new THREE.BufferGeometry).setAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,-1],3)),e.setAttribute("color",new THREE.Float32BufferAttribute([.5,.5,.5,0,0,0],3)),n=new THREE.LineBasicMaterial({vertexColors:!0,blending:THREE.AdditiveBlending}),new THREE.Line(e,n);case"gaze":return e=new THREE.RingBufferGeometry(.02,.04,32).translate(0,0,-1),n=new THREE.MeshBasicMaterial({opacity:.5,transparent:!0}),new THREE.Mesh(e,n)}},r.onModelDown=function(t){var e=this.controller;if(e&&this.renderer.xr.isPresenting){var n=this.tempTarget=t.mesh,i=(this.tempParent=n.parent,new THREE.Vector3);n.localToWorld(i),e.worldToLocal(i),e.add(n),n.position.copy(i)}},r.onModelDistance=function(t){var e=this.controller,n=this.tempTarget;if(e&&n&&this.renderer.xr.isPresenting){var i=new THREE.Vector3;i=i.copy(n.position);var o=Math.max(1,Math.min(8,i.distanceTo(za)+.02*t));i.normalize(),i=i.multiplyScalar(o),n.position.copy(i)}},r.onModelUp=function(){var t=this.tempTarget,e=this.tempParent;if(t&&e){var n=new THREE.Vector3;t.localToWorld(n),e.worldToLocal(n),e.add(t),t.position.copy(n),this.tempTarget=null,this.tempParent=null}},r.updateRaycasterXR=function(t,e){if(t)return this.controllerMatrix_.identity().extractRotation(t.matrixWorld),e.ray.origin.setFromMatrixPosition(t.matrixWorld),e.ray.direction.set(0,0,-1).applyMatrix4(this.controllerMatrix_),e},r.repos=function(t,e){var n=this.worldRect;t.scale.set(.8,.8,.8);var i=(e.x+e.width/2-n.width/2)/n.width*2*this.camera.aspect,o=(e.y+e.height/2-n.height/2)/n.height*2*this.camera.aspect;t.position.set(i,-o,0)},r.render=function(t){try{var e=this.renderer,n=this.scene,i=this.camera,o=this.avatars,r=e.xr.isPresenting;if(!r&&_.state.mode===Qe)return;r?(gsap.ticker.tick(),this.controllers.forEach((function(t){return t.userData.update()})),this.teleport.update()):this.navWithKeys(),this.orbitService.render();var s=performance.now(),a=this.tick_?++this.tick_:this.tick_=1;n.traverse((function(t){var o=t.userData.render;"function"==typeof o&&o(s,a,e,n,i)})),Object.keys(o).forEach((function(t){o[t].render()})),this.vrService.updateState(this),this.raycasterXRHitTest(),e.render(n,i)}catch(t){this.error=t}},r.navWithKeys=function(){if(this.view&&this.view.type.name===ni.Room3d.name&&this.view.mesh&&!this.locked&&!Bn.hasModal){this.intersectObjects=this.view.intersectObjects;var t=this.velocity||(this.velocity=new THREE.Vector3),e=this.direction||(this.direction=new THREE.Vector3),n=this.camera,i=.1;if(this.keys.w||this.keys.ArrowUp)n.getWorldDirection(e),e.multiplyScalar(i),t.copy(e);else if(this.keys.s||this.keys.ArrowDown)n.getWorldDirection(e),e.multiplyScalar(-.1),t.copy(e);else if(this.keys.d||this.keys.ArrowRight){n.getWorldDirection(e),e.multiplyScalar(i);var o=this.axisY||(this.direction=new THREE.Vector3(0,1,0)),r=-Math.PI/2;e.applyAxisAngle(o,r),t.copy(e)}else if(this.keys.a||this.keys.ArrowLeft){n.getWorldDirection(e),e.multiplyScalar(-.1);var s=this.axisY||(this.direction=new THREE.Vector3(0,1,0)),a=-Math.PI/2;e.applyAxisAngle(s,a),t.copy(e)}if(t.manhattanLength()>1e-5){e.copy(this.cameraGroup.position),e.add(t),e.y=0;var l=this.raycaster;l.set(e,ja),l.intersectObjects(this.view.navIntersectObjects).length&&(this.cameraGroup.position.add(t),this.cameraGroup.position.y=0,this.orbitService.markAsDirty()),t.lerp(za,.1)}else t.set(0,0,0)}else this.intersectObjects=this.panoramaIntersectObjects},r.animate=function(){this.renderer.setAnimationLoop(this.render)},r.resize=function(){try{var t=this.container,e=this.renderer,n=this.camera,i=this.size,o=t.getBoundingClientRect();if(i.left=Math.floor(o.left),i.top=Math.floor(o.top),i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),i.aspect=i.width/i.height,this.worldRect.setSize(i.width,i.height),!e.xr.isPresenting&&(e.setSize(i.width,i.height),n)){n.aspect=i.width/i.height;var r=n.fov*Math.PI/180,s=Math.abs(n.position.z*Math.tan(r/2)*2),a=this.cameraRect;a.width=s*n.aspect,a.height=s,n.updateProjectionMatrix()}}catch(t){this.error=t}},r.updateRaycasterMouse=function(t){var e=this.size.width/2,n=this.size.height/2;this.mouse.x=(t.clientX-this.size.left-e)/e,this.mouse.y=-(t.clientY-this.size.top-n)/n;var i=this.raycaster;return i.setFromCamera(this.mouse,this.camera),i},r.raycasterXRHitTest=function(){if(this.renderer.xr.isPresenting&&!this.locked){var t=this.updateRaycasterXR(this.controller,this.raycaster);if(t){ao.hittest(t,this.controller.userData.isSelecting);this.indicator.update(this.renderer.xr.getCamera(this.camera))}}},r.raycasterDesktopHitTest=function(t){var e=this.updateRaycasterMouse(t);if(!this.lockedOrXR)if(this.dragItem){if("function"==typeof this.dragItem.onDragMove){var n=e.intersectObjects(this.intersectObjects);if(n.length){var i=n[0],o=this.intersectionPoint||(this.intersectionPoint=new THREE.Vector3),r=this.intersectionNormal||(this.intersectionNormal=new THREE.Vector3),s=o.copy(i.point),a=r.copy(i.face.normal);this.dragItem.onDragMove(s,a,this.intersectObjects===this.panoramaIntersectObjects)}}}else if(this.resizeItem);else{ao.hittest(e);this.controlEvent$.next(Fa)}},r.onMouseDown=function(t){try{if(this.locked)return;if(0!==t.button)return;var e=this.updateRaycasterMouse(t);ao.hittest(e,!0);if(this.editor||g)if(this.keys.Shift||this.keys.Control);else{this.select.next({item:null});var n=e.intersectObjects(this.intersectObjects);if(n.length){var i=n[0],o=this.intersectionPoint||(this.intersectionPoint=new THREE.Vector3),r=this.intersectionNormal||(this.intersectionNormal=new THREE.Vector3),s=o.copy(i.point),a=r.copy(i.face.normal);this.viewHit.next({position:s,normal:a,spherical:this.intersectObjects===this.panoramaIntersectObjects})}}}catch(t){this.error=t}},r.onMouseMove=function(t){try{this.raycasterDesktopHitTest(t)}catch(t){this.error=t}},r.onMouseUp=function(t){try{if(this.lockedOrXR)return;this.dragItem&&"function"==typeof this.dragItem.onDragEnd&&(this.dragItem.onDragEnd(),this.dragEnd.next(this.dragItem)),this.dragItem=null,this.resizeItem&&"function"==typeof this.resizeItem.onResizeEnd&&(this.resizeItem.onResizeEnd(),this.resizeEnd.next(this.resizeItem)),this.resizeItem=null;var e=this.updateRaycasterMouse(t);ao.hittest(e,!1);this.checkSelectedItem()}catch(t){this.error=t}},r.onMouseWheel=function(t){try{if(this.lockedOrXR)return;var e=t.deltaY*(void 0!==t.wheelDeltaY?1:37),n=this.orbitService;gsap.to(n,{duration:.5,zoom:n.zoom+.1*e,ease:Power4.easeOut,overwrite:!0})}catch(t){this.error=t}},r.onOrientationDidChange=function(){this.controlEvent$.next(Fa)},r.checkSelectedItem=function(){if(this.view){var t=this.view.items.find((function(t){return t.selected}));t&&t.mesh&&"model"!==this.view.type.name&&this.orbitService.lookAt(t.mesh)}},r.onVRStarted=function(){this.objects.position.y=1.3,this.scene.add(this.indicator.mesh),gn.send({type:Ne})},r.onVREnded=function(){this.objects.position.y=0,this.cameraGroup.rotation.y=0,this.cameraGroup.position.y=0,this.scene.remove(this.indicator.mesh),this.orbitService.markAsDirty(),gn.send({type:Ge})},r.onVRStateDidChange=function(t){gn.send({type:qe,camera:t.camera.array})},r.onMenuNav=function(t){this.menu=void 0,this.navTo.next({viewId:t.id})},r.onMenuToggle=function(t){this.locked||(this.menu=t,this.view.items.forEach((function(t){return t.showPanel=!1})),this.pushChanges())},r.onNavOver=function(t){this.menu||(this.view.items.forEach((function(t){return t.showPanel=!1})),t.item.to&&clearTimeout(t.item.to),t.item.showPanel=t.shouldShowPanel(),this.pushChanges(),gn.send({type:Pe,itemId:t.item.showPanel?t.item.id:null}))},r.onNavOut=function(t){var e=this;t.item.to=setTimeout((function(){t.item.showPanel=!1,e.pushChanges()}),4e3),this.pushChanges()},r.onNavDown=function(t){t.item.showPanel=!1,this.locked||(this.editor&&this.keys.Shift?(this.dragItem=t,this.select.next(t)):this.editor&&this.keys.Control?(this.resizeItem=t,this.select.next(t)):this.navTo.next(t.item))},r.onNavLink=function(t){this.locked||(E.flags.useIframe?(gn.send({type:je,itemId:t.id}),this.navLink.next(t)):window.open(t.link.href,"_blank"))},r.onPanelDown=function(t){this.locked||(E.flags.useIframe?(gn.send({type:je,itemId:t.id}),this.navLink.next(t)):window.open(t.link.href,"_blank"))},r.onObjectDown=function(t){this.lockedOrXR||(this.editor&&this.keys.Shift?(this.dragItem=t,this.select.next(t)):this.editor&&this.keys.Control&&(this.resizeItem=t,this.select.next(t)))},r.onPlayMedia=function(t){gn.send({type:$e,itemId:t.itemId,playing:t.playing})},r.onZoomMedia=function(t){t.zoomed&&this.view.items.forEach((function(e){e.mesh instanceof Vo&&e.id!==t.itemId&&e.mesh.setZoomedState(!1)})),this.view.items.forEach((function(t){return t.showPanel=!1})),_.patchState({zoomedId:t.zoomed?t.itemId:null}),gn.send({type:He,itemId:t.itemId,zoomed:t.zoomed})},r.onCurrentTimeMedia=function(t){gn.send({type:Oe,itemId:t.itemId,currentTime:t.currentTime})},r.onPlayModel=function(t){gn.send({type:Be,itemId:t.itemId,actionIndex:t.actionIndex})},r.onGridMove=function(t){var e=this;this.view.items=[],this.pushChanges(),this.orbitService.walk(t.position,(function(n,i){var o=e.view.getTile(t.indices.x,t.indices.y);o&&e.panorama.crossfade(o,e.renderer,(function(t){E.flags.useTextureEnvironment||e.setBackground(t),e.orbitService.walkComplete(n,i),e.view.updateCurrentItems(),e.pushChanges()}))}))},r.onGridNav=function(t){this.locked||(gn.send({type:ze,viewId:this.view.id,gridIndex:t}),this.pushChanges())},r.control$=function(){var t=this;return this.controlEvent$.pipe(i.filter((function(){return t.controlling||t.spyed||t.editor})),i.auditTime(40),i.tap((function(e){e.orientation.latitude=t.orbitService.latitude,e.orientation.longitude=t.orbitService.longitude,e.zoom=t.orbitService.zoom,e.cameraGroup={position:t.cameraGroup.position.toArray(),rotation:t.cameraGroup.rotation.toArray()};var n=t.raycaster.intersectObjects(t.intersectObjects),i=n.length?n[0].point.normalize():null;i&&(e.pointer[0]=i.x,e.pointer[1]=i.y,e.pointer[2]=i.z),gn.send(e)})))},r.addListeners=function(){var t=this;this.controlEvent$=new n.ReplaySubject(1),this.control$().pipe(i.takeUntil(this.unsubscribe$)).subscribe();var e=this.vrService=Cr.getService();e.session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.renderer.xr.setSession(e),e?t.onVRStarted():t.onVREnded()})),e.state$.pipe(i.takeUntil(this.unsubscribe$),i.auditTime(Math.floor(1e3/15))).subscribe((function(e){t.onVRStateDidChange(e)})),this.orbitService.observe$(this.container).pipe(i.shareReplay(1)).pipe(i.filter((function(t){return t instanceof Jo})),i.auditTime(Math.floor(1e3/15))).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.onOrientationDidChange()})),gn.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(e.type){case Se:e.type=Te,e.viewId=t.view.id,e.orientation=t.orbitService.getOrientation(),e.zoom=t.orbitService.zoom,e.cameraGroup={position:t.cameraGroup.position.toArray(),rotation:t.cameraGroup.rotation.toArray()},t.view instanceof si&&(e.gridIndex=t.view.index),gn.sendBack(e),_.state.role!==I.Publisher&&_.patchState({spying:e.remoteId});break;case Te:qi.viewId!==e.viewId?(qi.viewId=e.viewId,t.requestInfoResult=e):(t.renderer.xr.isPresenting||(t.orbitService.setOrientation(e.orientation),t.orbitService.zoom=e.zoom,t.cameraGroup.position.set(e.cameraGroup.position[0],e.cameraGroup.position[1],e.cameraGroup.position[2]),t.cameraGroup.rotation.set(e.cameraGroup.rotation[0],e.cameraGroup.rotation[1],e.cameraGroup.rotation[2])),t.view instanceof si&&e.gridIndex&&(t.view.index=e.gridIndex),t.view&&t.view.ready||(t.requestInfoResult=e));break;case Pe:t.menu&&t.menu.removeMenu(),t.view.items.forEach((function(t){return t.showPanel=t.id===e.itemId})),t.pushChanges();break;case je:var n=t.view.items.find((function(t){return t.id===e.itemId}));n&&t.navLink.next(n);break;case Fe:t.view.items.find((function(t){return t.id===e.itemId}))&&Bn.resolve();break;case $e:var i=t.view.items.find((function(t){return t.id===e.itemId}));i&&i.mesh instanceof Vo&&i.mesh.setPlayingState(e.playing);break;case He:t.view.items.forEach((function(t){t.mesh instanceof Vo&&(t.id===e.itemId?t.mesh.setZoomedState(e.zoomed):t.mesh.setZoomedState(!1))})),_.patchState({zoomedId:e.zoomed?e.itemId:null});break;case Oe:var o=t.view.items.find((function(t){return t.id===e.itemId}));o&&o.mesh instanceof Vo&&o.mesh.setCurrentTime(e.currentTime);break;case Be:var r=t.view.items.find((function(t){return t.id===e.itemId}));r&&r.onMessage(e);break;case ze:t.view.id===e.viewId&&(t.view.index=e.gridIndex);break;case Ne:t.addOffCanvasScene(e);break;case Ge:t.removeOffCanvasScene(e);break;case qe:t.updateOffCanvasScene(e),_.state.spying!==e.clientId&&_.state.controlling!==e.clientId||t.orbitService.setVRCamera(e.camera);break;case Re:t.renderer.xr.isPresenting||(t.orbitService.setOrientation(e.orientation),t.orbitService.zoom=e.zoom,t.cameraGroup.position.set(e.cameraGroup.position[0],e.cameraGroup.position[1],e.cameraGroup.position[2]),t.cameraGroup.rotation.set(e.cameraGroup.rotation[0],e.cameraGroup.rotation[1],e.cameraGroup.rotation[2])),t.pointer.setPosition(e.pointer[0],e.pointer[1],e.pointer[2],t.camera)}})),gn.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(e.type){case Ye:t.checkSelectedItem()}})),_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.showPointer=t.locked})),this.resize=this.resize.bind(this),this.render=this.render.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this),window.addEventListener("resize",this.resize,!1),this.container.addEventListener("wheel",this.onMouseWheel,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1),this.container.addEventListener("mouseup",this.onMouseUp,!1),document.addEventListener("mousemove",this.onMouseMove,!1)},r.removeListeners=function(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("resize",this.resize,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("wheel",this.onMouseWheel,!1),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("mouseup",this.onMouseUp,!1)},l(o,[{key:"error",get:function(){return this.error_},set:function(t){this.error_!==t&&(this.error_=t,this.pushChanges())}},{key:"view",get:function(){return this.view_},set:function(t){this.view_!==t&&(this.view_=t,this.setView())}},{key:"debugging",get:function(){return g}},{key:"controlled",get:function(){return _.state.controlling&&_.state.controlling!==_.state.uid}},{key:"controlling",get:function(){return _.state.controlling&&_.state.controlling===_.state.uid}},{key:"silencing",get:function(){return _.state.silencing}},{key:"silenced",get:function(){return _.state.silencing&&_.state.role===I.Streamer}},{key:"spyed",get:function(){return _.state.spying&&_.state.spying===_.state.uid}},{key:"spying",get:function(){return _.state.spying&&_.state.spying!==_.state.uid}},{key:"locked",get:function(){return this.controlled||this.spying}},{key:"lockedOrXR",get:function(){return this.locked||this.renderer.xr.isPresenting}},{key:"showMenu",get:function(){return _.state.hosted&&_.state.navigable&&("embed"!==_.state.mode||E.flags.menuEmbed)}},{key:"showPointer",get:function(){return null!=this.pointer.mesh.parent},set:function(t){this.showPointer!==t&&(t?this.scene.add(this.pointer.mesh):this.scene.remove(this.pointer.mesh))}},{key:"menu",set:function(t){this.menu_!==t&&(this.menu_=t,this.scene.traverse((function(e){(e instanceof Vo||e instanceof Oo)&&(e.freezed=null!=t)})))},get:function(){return this.menu_}}]),o}(t.Component);Na.meta={selector:"[world]",inputs:["view","views","editor"],outputs:["navTo","navLink","viewHit","dragEnd","resizeEnd","select"],template:'\n\t<div class="world__view" *if="view">\n\t\t<div class="grid" model-grid *if="view.type.name === \'panorama-grid\'" [view]="view" (move)="onGridMove($event)" (nav)="onGridNav($event)"></div>\n\t\t<div *if="view.ready">\n\t\t\t<div model-room [view]="view" *if="view.type.name === \'room-3d\'"></div>\n\t\t\t<div class="world__item" *for="let item of view.pathItems; let index = index;">\n\t\t\t\t<div model-nav [item]="item" [view]="view" (over)="onNavOver($event)" (out)="onNavOut($event)" (down)="onNavDown($event)" (link)="onNavLink($event)" *if="item.type.name == \'nav\'"></div>\n\t\t\t\t<div model-plane [item]="item" [view]="view" (play)="onPlayMedia($event)" (zoom)="onZoomMedia($event)" (currentTime)="onCurrentTimeMedia($event)" *if="item.type.name == \'plane\'"></div>\n\t\t\t\t<div model-curved-plane [item]="item" [view]="view" (play)="onPlayMedia($event)" (zoom)="onZoomMedia($event)" (currentTime)="onCurrentTimeMedia($event)" *if="item.type.name == \'curved-plane\'"></div>\n\t\t\t\t<div class="model-viewer__item" model-model [item]="item" [view]="view" (down)="onModelDown($event)" (play)="onPlayModel($event)" *if="item.type.name == \'model\'"></div>\n\t\t\t\t<div class="panel" [class]="{ \'panel--lg\': item.asset != null }" model-panel [item]="item" (down)="onPanelDown($event)" *if="item.showPanel">\n\t\t\t\t\t<div class="panel__title" [innerHTML]="item.title"></div>\n\t\t\t\t\t<div class="panel__abstract" [innerHTML]="item.abstract"></div>\n\t\t\t\t\t<img class="panel__picture" [src]="item.asset | asset" *if="item.asset">\n\t\t\t\t\t<a class="panel__link" [href]="item.link.href" target="_blank" rel="noopener" *if="item.link" [innerHTML]="item.link.title"></a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="progress-indicator" model-progress [view]="view">\n\t\t<div class="inner"></div>\n\t</div>\n\t<div model-menu [views]="views" (nav)="onMenuNav($event)" (toggle)="onMenuToggle($event)" *if="showMenu">\n\t\t<div class="btn--menu" (mousedown)="onToggle($event)">\n\t\t\t<svg class="menu-light" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#menu-light"></use></svg>\n\t\t\t<div class="btn--menu__spinner"></div>\n\t\t\t<svg class="bullets" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#menu"></use></svg>\n\t\t\t<svg class="progress" width="50" height="50" viewBox="0 0 50 50">\n\t\t\t\t<circle id="circle" r="23" cx="25" cy="25" fill="transparent"></circle>\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n\t<div model-debug *if="debugging"></div>\n\t<div class="world__info" *if="error" [innerHTML]="error"></div>\n\t'};var Ga=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){var t=this;if(!this.host)throw"ModelComponent host is undefined";this.scale=new THREE.Vector3(1,1,1),this.position=new THREE.Vector3;var e=this.group=new THREE.Group;e.name=this.getName(),e.userData.render=function(e,n){t.render(t,e,n)},this.getContainer().add(e),this.onCreate((function(e,n){return t.onMount(e,n)}),(function(e,n){return t.onDismount(e,n)}))},i.onDestroy=function(){var t=this.group;this.getContainer().remove(t),delete t.userData.render,this.disposeObject(t),this.group=null},i.getContainer=function(){return this.host.objects},i.getName=function(t){return this.constructor.meta.selector+"-"+this.rxcompId+(t?"-"+t:"")},i.onCreate=function(t,e){var n=new THREE.MeshStandardMaterial({color:new THREE.Color("#ffcc00"),roughness:.4,metalness:.01,flatShading:!0,transparent:!0,opacity:.9}),i=new THREE.Mesh(ro.defaultGeometry,n);return"function"==typeof t&&t(i),i},i.onMount=function(t,e){var n=this;this.mesh&&this.onDismount(this.mesh),t.name=this.getName("mesh"),this.mesh=t,e&&(e.mesh=t,Object.defineProperty(e,"visible",{get:function(){return t.visible},set:function(t){n.setVisible(t)},configurable:!0}),e.onUpdate=function(){n.onUpdate(e,t)},e.onUpdateAsset=function(){n.onUpdateAsset(e,t)},e.onMessage=function(t){n.onMessage(t)}),this.group&&this.group.add(t)},i.onDismount=function(t,e){this.group.remove(t),"function"==typeof t.dispose&&t.dispose(),this.disposeObject(t),this.mesh=null,e&&(delete e.mesh,delete e.onUpdate,delete e.onUpdateAsset,delete e.onMessage)},i.disposeObject=function(t){t.traverse((function(t){(t.isInteractiveMesh||t.isInteractiveSprite)&&ao.dispose(t),t.isMesh?(t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose(),t.geometry.dispose()):t.isSprite&&(t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose())}))},i.calculateScaleAndPosition=function(){var e=t.getContext(this).node;this.host.repos(this,e.getBoundingClientRect())},i.render=function(t,e){},i.setVisible=function(t){this.mesh&&(this.mesh.visible=t)},i.getScroll=function(t){return this.intersection.scroll(t)},i.getTween=function(t){var e=Math.min(0,this.intersection.offset(t))+1;return e=Math.max(0,e),e-=1},i.onUpdate=function(t,e){},i.onUpdateAsset=function(t,e){},i.onMessage=function(t){},l(n,[{key:"renderOrder",set:function(t){this.group.renderOrder=t}}]),n}(t.Component);Ga.meta={selector:"[model]",hosts:{host:Na},inputs:["item"]};var qa=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){t.prototype.onInit.call(this),this.RADIUS=100},n.onDestroy=function(){this.editing=!1,t.prototype.onDestroy.call(this)},n.setHelper=function(t){t?(this.helper||(this.helper=new THREE.BoxHelper(this.mesh,65280)),this.host.scene.add(this.helper)):this.helper&&this.host.scene.remove(this.helper)},n.updateHelper=function(){this.helper&&this.helper.setFromObject(this.mesh)},l(e,[{key:"editing",get:function(){return this.editing_},set:function(t){this.editing_!==t&&(this.editing_=t,this.setHelper(t))}}]),e}(Ga);qa.meta={selector:"[model-editable]",hosts:{host:Na},inputs:["item"]};var Za="none",Wa="move",Ka="info",Xa="point",Ya="title",Ja="transparent",Qa="wishlist",tl=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return c(h(e=t.call.apply(t,[this].concat(i))||this),"hidden_",!1),e}d(e,t),e.getLoader=function(){return e.loader||(e.loader=new THREE.TextureLoader)},e.getTexturePoint=function(){return e.texturePoint||(e.texturePoint=e.getLoader().load(E.getPath("textures/ui/nav-point.png")))},e.getTexturePointImportant=function(){return e.texturePointImportant||(e.texturePointImportant=e.getLoader().load(E.getPath("textures/ui/nav-point-important.png")))},e.getTextureMove=function(){return e.textureMove||(e.textureMove=e.getLoader().load(E.getPath("textures/ui/nav-more.png")))},e.getTextureMoveImportant=function(){return e.textureMoveImportant||(e.textureMoveImportant=e.getLoader().load(E.getPath("textures/ui/nav-more-important.png")))},e.getTextureInfo=function(){return e.textureInfo||(e.textureInfo=e.getLoader().load(E.getPath("textures/ui/nav-info.png")))},e.getTextureInfoImportant=function(){return e.textureInfoImportant||(e.textureInfoImportant=e.getLoader().load(E.getPath("textures/ui/nav-info-important.png")))},e.getTextureWishlist=function(){return e.textureWishlist||(e.textureWishlist=e.getLoader().load(E.getPath("textures/ui/nav-wishlist-off.png")))},e.getTextureWishlistAdded=function(){return e.textureWishlistAdded||(e.textureWishlistAdded=e.getLoader().load(E.getPath("textures/ui/nav-wishlist-on.png")))},e.getTexture=function(t,e){var n;switch(t){case Wa:n=e.important?this.getTextureMoveImportant():this.getTextureMove();break;case Ka:n=e.important?this.getTextureInfoImportant():this.getTextureInfo();break;case Xa:case Ya:n=e.important?this.getTexturePointImportant():this.getTexturePoint();break;case Qa:n=e.added?this.getTextureWishlistAdded():this.getTextureWishlist()}return n.disposable=!1,n.encoding=THREE.sRGBEncoding,n},e.getTitleTexture=function(t,e){var n;if(e===Ya){var i=t.title,o=document.createElement("canvas");o.width=512,o.height=32;var r=o.getContext("2d");r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.font="24px "+E.fontFamily;var s=r.measureText(i).width+8,a=(s=Math.pow(2,Math.ceil(Math.log(s)/Math.log(2))))/2;o.width=s,r.font="24px "+E.fontFamily,r.textAlign="center",r.textBaseline="middle",r.strokeStyle="rgba(0, 0, 0, 0.5)",r.lineWidth=6,r.lineJoin="round",r.miterLimit=2,r.strokeText(i,a,16),r.fillStyle="white",r.fillText(i,a,16),n=new THREE.CanvasTexture(o)}return n},e.getNavMode=function(t,e){var n=Za;return t.hook&&"ToggleWishlist"===t.hook?n=Qa:t.transparent?n=Ja:t.viewId!==e.id?(n=Wa,this.isValidText(t.title)&&(n=Ya),(this.isValidText(t.abstract)||t.asset&&t.asset.id||t.link&&t.link.href)&&(n=Xa)):(this.isValidText(t.title)||this.isValidText(t.abstract)||t.asset&&t.asset.id||t.link&&t.link.href)&&(n=Ka),n},e.hasNavInfo=function(t){var e=this;return null!=t.items.find((function(n){return e.getNavMode(n,t)===Ka}))},e.isValidText=function(t){return t&&t.length>0};var n=e.prototype;return n.shouldShowPanel=function(){return!this.editing&&this.mode!==Wa&&this.mode!==Ya&&this.mode!==Qa&&(this.mode!==Ja||e.isValidText(this.item.title))},n.updateVisibility=function(t){this.mesh&&(this.mesh.visible=t),this.sphere&&(this.sphere.freezed=!t),!t&&this.item&&(this.item.showPanel=!1)},n.setVisible=function(t){this.mesh&&(this.mesh.visible=t&&!this.hidden_)},n.onInit=function(){t.prototype.onInit.call(this)},n.onChanges=function(){var t=this.view,n=this.item;(this.mode=e.getNavMode(n,this.view))===Qa&&(n.added=Yi.has({viewId:t.id,itemId:n.id}),this.onCreateSprites(this.mesh,1)),this.editing=n.selected,this.hidden=this.isHidden},n.onCreate=function(t,n){var i=this,o=this.view,r=this.item,s=this.mode=e.getNavMode(r,this.view);if(s!==Za){s===Qa&&(r.added=Yi.has({viewId:o.id,itemId:r.id}));var a=this.isAnimated,l=new THREE.Group;if(s===Ja){var c=this.editor?.1:0;l.position.fromArray(r.position),l.rotation.fromArray(r.rotation),l.scale.fromArray(r.scale);var u=ro.planeGeometry,d=this.plane=new uo(u,new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,opacity:c,color:new THREE.Color(E.colors.menuOverBackground)}));if(d.name="[nav] "+r.id,d.depthTest=!1,l.add(d),a){var h={pow:0};gsap.to(h,{pow:1,duration:.6,delay:.5+.1*r.index,ease:Power2.easeOut,repeat:-1,yoyo:!0,onUpdate:function(){d.material.opacity=.3*h.pow}})}d.on("over",(function(){a||(d.material.opacity=.2),i.over.next(i)})),d.on("out",(function(){a||(d.material.opacity=c),i.out.next(i)})),d.on("down",(function(){a||(d.material.opacity=.3),i.down.next(i),!i.editor&&!i.shouldShowPanel()&&i.item.link&&i.item.link.href&&(i.shouldNavToLink=i.item.link.href)})),d.on("up",(function(){a||(d.material.opacity=c),null!=i.shouldNavToLink&&(i.shouldNavToLink=null,i.link.next(i.item))}))}else{var p=new THREE.Vector3(r.position[0],r.position[1],r.position[2]),v=new THREE.Vector3(r.position[0],r.position[1],r.position[2]).normalize();p.distanceToSquared(v)<1e-4&&p.multiplyScalar(e.RADIUS),l.position.copy(p),this.onCreateSprites(l);var m=ro.sphereGeometry,f=this.sphere=new uo(m,new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,opacity:0,color:65535}));f.name="[nav] "+r.id,f.depthTest=!1,l.add(f);var g={pow:0};gsap.to(g,{pow:1,duration:.7,delay:.5+.1*r.index,ease:Power2.easeInOut,overwrite:!0,onUpdate:function(){i.materials.forEach((function(t){t.opacity=g.pow}))},onComplete:function(){if(a){var t=i.icon;g.pow=0,gsap.to(g,{pow:1,duration:.6,delay:.5+.1*r.index,ease:Power2.easeOut,repeat:-1,yoyo:!0,onUpdate:function(){var e=i.iconMinScale+g.pow*(i.iconMaxScale-i.iconMinScale);t.scale.set(e,e,e),t.material.opacity=g.pow}})}}}),f.on("over",(function(){if(i.over.next(i),!a){var t=i.icon,e={scale:t.scale.x};gsap.to(e,{duration:.35,scale:i.iconMaxScale,delay:0,ease:Power2.easeOut,overwrite:!0,onUpdate:function(){t.scale.set(e.scale,e.scale,e.scale)}})}})),f.on("out",(function(){if(i.out.next(i),!a){var t=i.icon,e={scale:t.scale.x};gsap.to(e,{duration:.35,scale:i.iconMinScale,delay:0,ease:Power2.easeOut,overwrite:!0,onUpdate:function(){t.scale.set(e.scale,e.scale,e.scale)}})}})),f.on("down",(function(){i.down.next(i)}))}"function"==typeof t&&t(l,r)}},n.onCreateSprites=function(t,n){void 0===n&&(n=0),this.onRemoveSprite(this.icon),this.onRemoveSprite(this.title);var i=this.item,o=this.mode=e.getNavMode(i,this.view);if(o!==Za)if(o===Ja)this.materials=[];else{var r,s=e.getTexture(o,i),a=new THREE.SpriteMaterial({map:s,depthTest:!1,depthWrite:!1,transparent:!0,sizeAttenuation:!1,opacity:n}),l=[a],c=this.iconMinScale,u=this.icon=new THREE.Sprite(a);u.renderOrder=E.renderOrder.nav,u.scale.set(c,c,c),t.add(u);var d=e.getTitleTexture(i,o);if(d){r=new THREE.SpriteMaterial({depthTest:!1,depthWrite:!1,transparent:!0,map:d,sizeAttenuation:!1,opacity:n});var h=d.image,p=this.title=new THREE.Sprite(r);p.scale.set(c*h.width/h.height,c,c),p.position.set(0,-3.5,0),t.add(p),l.push(r)}this.materials=l}},n.onRemoveSprite=function(t){t&&(t.parent&&t.parent.remove(t),t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose())},n.onDestroy=function(){ao.dispose(this.sphere),t.prototype.onDestroy.call(this)},n.onUpdate=function(t,e){this.item=t,this.onCreateSprites(e,1),this.mode===Ja?(t.position&&e.position.fromArray(t.position),t.rotation&&e.rotation.fromArray(t.rotation),t.scale&&e.scale.fromArray(t.scale)):(e.position.fromArray(t.position),e.rotation.set(0,0,0),e.scale.set(1,1,1)),this.updateHelper()},n.onDragMove=function(t,n,i){var o=this.item,r=this.mesh;this.editing=!0,o.showPanel=!1,this.mode===Ja?i?(t.normalize().multiplyScalar(e.RADIUS),r.position.set(t.x,t.y,t.z),r.lookAt(so.origin)):(r.position.set(0,0,0),r.lookAt(n),r.position.set(t.x,t.y,t.z),r.position.add(n.multiplyScalar(.01))):i?(t.normalize().multiplyScalar(e.RADIUS),r.position.set(t.x,t.y,t.z)):(r.position.set(t.x,t.y,t.z),r.position.add(n.multiplyScalar(.01))),this.updateHelper()},n.onDragEnd=function(){var t=this.item,e=this.mesh;this.mode===Ja?(t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray()):t.position=e.position.toArray(),this.editing=!1},l(e,[{key:"hidden",get:function(){return this.hidden_},set:function(t){this.hidden_!==t&&(this.hidden_=t,this.updateVisibility(!t))}},{key:"isHidden",get:function(){return null!=_.state.zoomedId||E.flags.hideNavInfo&&!this.editor&&!_.state.showNavInfo&&!(this.host.renderer.xr.isPresenting||_.state.role===I.SelfService||_.state.role===I.Embed)&&this.mode===Ka}},{key:"isAnimated",get:function(){var t=!1,e=this.mode,n=this.item.important;switch(e){case Ka:t=n?E.flags.navInfoImportantAnimated:E.flags.navInfoAnimated;break;case Wa:t=n?E.flags.navMoveImportantAnimated:E.flags.navMoveAnimated;break;case Xa:t=n?E.flags.navPointImportantAnimated:E.flags.navPointAnimated;break;case Ya:t=n?E.flags.navTitleImportantAnimated:E.flags.navTitleAnimated;break;case Ja:t=n?E.flags.navTransparentImportantAnimated:E.flags.navTransparentAnimated}return t}},{key:"iconMinScale",get:function(){return.03*(E.navs.iconMinScale||1)}},{key:"iconMaxScale",get:function(){return.03*(E.navs.iconMaxScale||1.5)}}]),e}(qa);tl.RADIUS=100,tl.meta={selector:"[model-nav]",hosts:{host:Na},outputs:["over","out","down","link"],inputs:["item","view","editor"]};var el=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this;console.log("onInit"),t.getContext(this).node.classList.remove("hidden"),this.platform=kn.platform,this.state={},this.hosted=null,this.view=null,this.previousView=null,this.form=null,this.local=null,this.screen=null,this.remoteScreen_=null,this.navmaps=[],this.navmap=null,this.hasScreenViewItem=!1,this.remotes=[],(this.vrService=Cr.getService()).status$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.pushChanges()})),this.resolveUser()},r.getName=function(t){return _.state.name||$.getName(t)},r.getLinkRole=function(){var t=null;if(window.location.pathname===E.url.selfServiceTour)return t=I.SelfService;var e=(L.get("link")||"").match(/\d{9}-(\d{4})-\d{13}/);if(e){var n=parseInt(e[1]);t=Object.keys(I).reduce((function(t,e,i){return i===n?I[e]:t}),null)}return t},r.resolveUser=function(){var t=this;this.isEmbed?pn.temporaryUser$(I.Embed).pipe(i.first()).subscribe((function(e){t.initWithUser(e)})):pn.me$().pipe(i.first()).subscribe((function(e){t.initWithUser(e)}))},r.userGuard=function(t){var e=this.getLinkRole();!t||e&&t.type!==e?this.initWithUser({type:e}):this.initWithUser(t)},r.userGuardRedirect=function(t){var e=this.getLinkRole();!t||e&&e!==t.type?e===I.Publisher||e===I.Attendee?Jt.setRouterLink("it.access"):this.initWithUser({type:e}):this.initWithUser(t)},r.setNextStatus=function(){var t=oe,e=_.state;return e.role===I.SmartDevice&&(e.name=e.name||"Smart Device"),t=e.checklist?e.link?e.user.id||e.role!==I.Publisher&&e.role!==I.Attendee?e.name?e.role!==I.Viewer&&e.role!==I.SmartDevice?ce:ue:le:ae:se:re,_.patchState({status:t}),t},r.getPathId=function(){var t=L.get("pathId")||null;if(t)return console.log("AgoraComponent.getPathId",t),parseInt(t);var e=L.get("link")||null;e&&(t=new P(e).pathId);return console.log("AgoraComponent.getPathId",t),t},r.initWithUser=function(t){var e=this,n=L.get("link")||null,o=this.getPathId(),r=this.getLinkRole()||(t?t.type:null);switch(r){case I.SelfService:if(!t||t.type!==I.SelfService&&t.type!==I.Publisher)return void Jt.setRouterLink("it.access");t=Object.assign({},t,{type:I.SelfService});break;default:r!==(t=t||{type:r}).type&&(t={type:r})}var s=pn.getMode(r),a=L.get("name")||(t.firstName&&t.lastName?t.firstName+" "+t.lastName:null),l=r===I.Publisher,c=r!==I.SelfService&&r!==I.Embed&&!g,u=this.isNavigable,d={user:t,role:r,mode:s,name:a,checklist:null,pathId:o,link:n,channelName:E.channelName,uid:null,status:oe,connecting:!1,connected:!1,controlling:!1,spying:!1,silencing:!1,hosted:l,live:c,navigable:u,cameraMuted:!1,audioMuted:!1,showNavInfo:!0};_.state=d,_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.state=t,e.hosted=t.hosted,e.pushChanges(),e.locked?document.body.classList.add("locked"):document.body.classList.remove("locked")})),this.initAgora()},r.viewObserver$=function(){var t=this;return qi.data$().pipe(i.switchMap((function(t){return console.log("AgoraComponent.viewObserver$","pathId",_.state.pathId),Xn.getCurrentPath$(_.state.pathId).pipe(i.switchMap((function(e){return qi.hostedView$(t,e)})))})),i.map((function(e){return t.agora&&t.agora.navToView(e.id,e.keepOrientation,e.useLastOrientation),t.previousView=t.view,t.view=e,t.setNavmap(e),t.hasScreenViewItem=null!=e.items.find((function(t){return oo.isPublisherScreen(t)||oo.isAttendeeScreen(t)})),t.pushChanges(),e})))},r.load=function(t){this.loadNavmaps(),this.viewObserver$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){"function"==typeof t&&(t(),t=null)}))},r.loadNavmaps=function(){var t=this;E.flags.navmaps&&wi.navmapGet$().pipe(i.first()).subscribe((function(e){t.navmaps=e}))},r.setNavmap=function(t){var e=(this.navmaps||[]).find((function(e){return null!=(e.items||[]).find((function(e){return e.viewId===t.id}))}))||null;this.navmap=e},r.toggleNavmap=function(){_.patchState({showNavmap:!_.state.showNavmap})},r.onNavmapItem=function(t){_.patchState({showNavmap:!1}),this.onNavTo(t)},r.loadAndConnect=function(t){var e=this;this.load((function(){e.connect(t)}))},r.initAgora=function(){var t=this;this.state.role===I.SelfService||this.state.role===I.Embed||g?(this.load((function(){_.patchState({status:he,hosted:!0})})),this.checkSelfServiceProposition(),this.checkSelfServiceAudio()):zn.isChecked$().pipe(i.first()).subscribe((function(e){_.patchState({checklist:e}),t.agora=_n.getSingleton();t.getLinkRole(),t.setNextStatus()})),Ln.local$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.local=e,t.pushChanges()})),Ln.screen$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.screen===t.remoteScreen&&(t.remoteScreen=null),t.screen=e,t.remoteScreen=e||t.remoteScreen,t.pushChanges()})),Ln.orderedRemotes$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.remotes=[],t.remoteScreen=t.screen,e.forEach((function(e){e.clientInfo&&e.clientInfo.screenUid===e.getId()?t.remoteScreen=e:t.remotes.push(e)})),t.pushChanges()})),gn.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(e.type){case ve:if(t.isSelfServiceSupport)e.members.length>0?(_i.open$({message:Dn.transform("bhere_support_request_sent"),type:Ci,position:Si}),gn.send({type:me})):_i.open$({message:Dn.transform("bhere_support_request_leaved"),type:Ci,position:Si});break;case me:t.isSelfServiceProposition&&t.openSupportRequestDialog(e.clientInfo);break;case ke:e.type=Me,e.clientInfo={role:_.state.role,name:_.state.name,uid:_.state.uid,screenUid:_.state.screenUid,controllingId:_.state.controlling,mode:_.state.mode},gn.sendBack(e);break;case fe:_i.open$({message:Dn.transform("bhere_support_request_accepted"),type:Ci,position:Si});break;case ge:_i.open$({message:Dn.transform("bhere_support_request_rejected"),type:Ci,position:Si});break;case be:e.type=we,gn.sendBack(e),_.patchState({controlling:e.controllingId}),t.agora&&t.agora.sendControlRemoteRequestInfo(e.controllingId);break;case Ie:_.patchState({silencing:e.silencing}),t.setAudio(e.silencing);break;case Ve:t.onRemoteNavTo(e);break;case De:_.patchState({mode:e.mode}),window.dispatchEvent(new Event("resize"));break;case Ue:t.hidePanels(),_.patchState({showNavInfo:e.showNavInfo});break;case Ae:qi.setViewLike$(e).pipe(i.first()).subscribe((function(e){return t.showLove(e)}));break;case We:_.state.chat||_.patchState({chatDirty:!0})}})),gn.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.agora&&t.agora.sendMessage(e)})),this.fullscreen$().pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.agora&&_.state.status===ue&&this.loadAndConnect()},r.onChecked=function(t){_.patchState({checklist:!0}),this.setNextStatus()},r.onLink=function(t){var e=new P(t).pathId,n=this.getLinkRole(),i=pn.getMode(n),o=_.state.user;n!==I.Publisher&&n!==I.Attendee||o.id&&o.type===n?_.state.name?n===I.Viewer||n===I.SmartDevice?(_.patchState({link:t,pathId:e,role:n,mode:i}),this.loadAndConnect()):_.patchState({link:t,pathId:e,role:n,mode:i,status:ce}):_.patchState({link:t,pathId:e,role:n,mode:i,status:le}):_.patchState({link:t,pathId:e,role:n,mode:i,status:ae})},r.onLogin=function(t){var e=this.getName(t);e?_.patchState({user:t,name:e,status:ce}):_.patchState({user:t,status:le})},r.onName=function(t){_.state.role===I.Viewer||_.state.role===I.SmartDevice?(_.patchState({name:t}),this.loadAndConnect()):_.patchState({name:t,status:ce})},r.onEnter=function(t){this.loadAndConnect(t)},r.connect=function(t){if(this.agora.connect$(t).pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.state.role===I.SelfService)yi.push({action:"b-here-tour",userType:this.state.role});else if(this.state.role===I.Embed)yi.push({action:"b-here-embed",userType:this.state.role});else{var e=this.state.link.replace(/-\d+-/,"-"),n={meetingId:this.state.link,sharedMeetingId:e,fullName:this.state.name,userType:this.state.role};pn.log$(n).pipe(i.first()).subscribe(),yi.push({action:"b-here-meeting",meetingId:this.state.link,sharedMeetingId:e,userType:this.state.role})}},r.disconnect=function(){this.agora?this.agora.leaveChannel().then((function(){window.location.reload()}),console.log):this.patchState({connecting:!1,connected:!1})},r.onNavTo=function(t){var e=t.viewId,n=this.pathViews.find((function(t){return t.id===e}));n&&(qi.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation},this.onHandleHook(n,t))},r.onNavLink=function(t){Bn.open$({iframe:t.link.href}).pipe(i.first()).subscribe((function(e){gn.send({type:Fe,itemId:t.id})}))},r.onRemoteNavTo=function(t){var e=t.viewId,n=t.gridIndex;if(e&&qi.viewId!==e){var i=this.pathViews.find((function(t){return t.id===e}));i&&(qi.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation},null!=n&&i instanceof si&&(i.index=n))}},r.onHandleHook=function(t,e){var n=this;switch(e.hook){case"ToggleWishlist":var o={viewId:t.id,itemId:e.id};Yi.toggle$(o).pipe(i.switchMap((function(t){return o.added=Yi.has(o),Ki.send$(e.hook,o,e.extra)})),i.first()).subscribe((function(t){console.log("AgoraComponent.onHandleHook",t),e.added=o.added,n.pushChanges()}))}},r.patchState=function(t){this.state=Object.assign({},this.state,t),this.pushChanges()},r.toggleCamera=function(){this.agora?this.agora.toggleCamera():this.patchState({cameraMuted:!this.state.cameraMuted})},r.toggleAudio=function(){this.agora?this.agora.toggleAudio():this.patchState({audioMuted:!this.state.audioMuted})},r.setAudio=function(t){this.agora?this.agora.setAudio(t):this.patchState({audioMuted:t})},r.toggleScreen=function(){this.agora?this.agora.toggleScreen():this.patchState({screen:!this.state.screen}),window.dispatchEvent(new Event("resize"))},r.toggleVolume=function(){var t=!this.state.volumeMuted;_.patchState({volumeMuted:t});var e=this.selfServiceAudio;e&&(e.volume=t?0:.5)},r.toggleMode=function(){if(this.agora&&_.state.role===I.Publisher)this.agora.toggleMode();else{var t=this.state.mode===Je?Qe:Je;_.patchState({mode:t})}window.dispatchEvent(new Event("resize"))},r.toggleFullScreen=function(){var e=t.getContext(this).node;!this.state.fullScreen?e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},r.fullscreen$=function(){return n.fromEvent(document,"fullscreenchange").pipe(i.tap((function(t){var e=null!=document.fullscreenElement;_.patchState({fullScreen:e})})))},r.toggleChat=function(){_.patchState({chat:!_.state.chat,chatDirty:!1}),window.dispatchEvent(new Event("resize"))},r.onChatClose=function(){_.patchState({chat:!1}),window.dispatchEvent(new Event("resize"))},r.toggleNavInfo=function(){this.hidePanels(),this.agora?this.agora.toggleNavInfo():this.patchState({showNavInfo:!this.state.showNavInfo})},r.onBack=function(){this.previousView&&this.view&&this.previousView.id!==this.view.id&&(qi.action={viewId:this.previousView.id,useLastOrientation:!0})},r.hidePanels=function(){this.view.items.forEach((function(t){return t.showPanel=!1}))},r.onToggleControl=function(t){if(this.agora)this.agora.toggleControl(t);else{var e=this.state.controlling===t?null:t;this.patchState({controlling:e,spying:!1})}},r.onToggleSilence=function(){this.agora?this.agora.toggleSilence():this.patchState({silencing:!this.state.silencing})},r.onToggleSpy=function(t){if(this.agora)this.agora.toggleSpy(t);else{var e=this.state.spying===t?null:t;this.patchState({spying:e,controlling:!1})}},r.addLike=function(){var t=this;qi.viewLike$(this.view).pipe(i.first()).subscribe((function(e){e&&(t.view.liked=!0,t.showLove(e),gn.send({type:Ae,viewId:t.view.id,likes:t.view.likes}))}))},r.showLove=function(t){var e=this;if(t&&this.view.id===t.id){var n=this.view.showLove;this.view.likes=t.likes,this.view.showLove=!0,this.pushChanges(),n||setTimeout((function(){e.view.showLove=!1,e.pushChanges()}),3100)}},r.tryInAr=function(){this.platform===wn||this.platform===yn?Ri.openInAR(this.view):Bn.open$({template:Ri.chunk(),data:this.view}).pipe(i.first()).subscribe((function(t){}))},r.checkSelfServiceProposition=function(){var t=this;this.isSelfServiceProposition&&zn.check$().pipe(i.first()).subscribe((function(e){var n=new P({pathId:_.state.pathId}).toRoles(),o=new $({link:n.id,support:!0}).toGuidedTourUrl();pn.selfServiceSupportRequest$(_.state.user,n.id,o).pipe(i.first()).subscribe((function(e){var i=t.getName(_.state.user);_.patchState({checklist:!0,link:n.idSelfService,name:i}),t.agora=_n.getSingleton(),t.connect()}))}),(function(t){console.log("AgoraComponent.initAgora.isSelfServiceProposition.error",t,name)}))},r.checkSelfServiceAudio=function(){if(_.state.role===I.SelfService&&E.selfServiceAudio){var e=document.createElement("audio");e.setAttribute("playsinline","true"),e.setAttribute("autoplay","true"),e.setAttribute("loop","true"),e.volume=.5,e.src=E.selfServiceAudio,t.getContext(this).node.parentNode.appendChild(e),this.selfServiceAudio=e,oo.events$.pipe(i.tap((function(t){t instanceof Qi?e.pause():(t instanceof to||t instanceof eo)&&e.play()})),i.takeUntil(this.unsubscribe$)).subscribe()}},r.openSupportRequestDialog=function(t){_i.open$({message:Dn.transform("bhere_support_request_dialog"),acceptMessage:Dn.transform("bhere_support_request_dialog_accept"),rejectMessage:Dn.transform("bhere_support_request_dialog_reject"),type:ki,position:Si}).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){if(t instanceof Ei){gn.send({type:fe});var e=_.state.name,n=new P(_.state.link);n.role=I.Streamer;var i=new $({link:n.toString(),name:e}).toGuidedTourUrl();setTimeout((function(){window.location.href=i}),1e3)}else gn.send({type:ge})}))},l(o,[{key:"meetingUrl",get:function(){return this.meetingUrl_||(this.meetingUrl_=new $),this.meetingUrl_}},{key:"isVirtualTourUser",get:function(){return-1!==[I.Publisher,I.Attendee,I.Streamer,I.Viewer].indexOf(_.state.role)}},{key:"isEmbed",get:function(){return-1!==window.location.href.indexOf(E.url.embed)}},{key:"isNavigable",get:function(){return null==this.meetingUrl.embedViewId}},{key:"isBackButtonVisible",get:function(){return this.view&&(this.view.type.name===ni.Media.name||this.view.type.name===ni.Model.name)}},{key:"isSelfServiceProposition",get:function(){return _.state.role===I.SelfService&&E.flags.selfServiceProposition}},{key:"isSelfServiceSupport",get:function(){return _.state.role===I.Publisher&&E.flags.selfServiceProposition&&this.meetingUrl.support}},{key:"showNavInfoToggler",get:function(){return E.flags.hideNavInfo&&this.state.mode!==Qe&&this.view&&tl.hasNavInfo(this.view)}},{key:"uiClass",get:function(){var t={};return t[this.state.role]=!0,t.chat=this.state.chat,t.remotes=this.state.mode===Qe,t.remoteScreen=null!=this.remoteScreen&&!this.hasScreenViewItem,t.locked=this.locked,t}},{key:"remoteClass",get:function(){return"group--remote--"+Math.min(9,this.remotes.length)}},{key:"controlled",get:function(){return _.state.controlling&&_.state.controlling!==_.state.uid}},{key:"controlling",get:function(){return _.state.controlling&&_.state.controlling===_.state.uid}},{key:"silencing",get:function(){return _.state.silencing}},{key:"silenced",get:function(){return _.state.silencing&&_.state.role===I.Streamer}},{key:"spyed",get:function(){return _.state.spying&&_.state.spying===_.state.uid}},{key:"spying",get:function(){return _.state.spying&&_.state.spying!==_.state.uid}},{key:"locked",get:function(){return this.controlled||this.spying}},{key:"remoteScreen",get:function(){return this.remoteScreen_},set:function(t){this.remoteScreen_!==t&&(this.remoteScreen_=t,setTimeout((function(){window.dispatchEvent(new Event("resize"))}),1))}},{key:"pathViews",get:function(){return qi.pathViews}}]),o}(t.Component);el.meta={selector:"[agora-component]",template:'\n\t<div class="page">\n\t\t\x3c!-- background --\x3e\n\t\t<div class="background" [class]="{ \'background--image\': (\'background.image\' | env), \'background--video\': (\'background.video\' | env) }" *if="state.status != \'connected\'">\n\t\t\t<img [src]="\'background.image\' | env" *if="\'background.image\' | env" />\n\t\t\t<video [src]="\'background.video\' | env" *if="\'background.video\' | env" oncanplay="this.muted = true; this.classList.add(\'ready\');" playsinline autoplay muted loop></video>\n\t\t</div>\n\t\t\x3c!-- Status Checklist --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'checklist\'" [agora-checklist] (checked)="onChecked($event)"></div>\n\t\t\x3c!-- Status Link --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'link\'" [agora-link] (link)="onLink($event)"></div>\n\t\t\x3c!-- Status Login --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'login\'" [agora-login] (login)="onLogin($event)"></div>\n\t\t\x3c!-- Status Name --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == \'name\' || (state.status == \'disconnected\' && state.role === \'viewer\')" [agora-name] (name)="onName($event)"></div>\n\t\t\x3c!-- Status Device --\x3e\n\t\t<div class="ui ui--info" *if="state.status == \'device\' || (state.status == \'disconnected\' && state.role !== \'viewer\')" [agora-device] (enter)="onEnter($event)"></div>\n\t\t\n\x3c!-- Virtual Tour --\x3e\n<div class="ui virtual-tour" [class]="uiClass" *if="state.status == \'connected\' && isVirtualTourUser">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t\n\x3c!-- remote sidebar --\x3e\n<div class="group--remote" [class]="remoteClass" *if="state.live">\n\t<div class="agora-stream" (toggleControl)="onToggleControl($event)" (toggleSpy)="onToggleSpy($event)" agora-stream [stream]="remote" type="remote" *for="let remote of remotes">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info" [class]="{ spyed: state.spying == streamId, controlling: state.controlling == streamId }">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t<button type="button" class="btn--control" [title]="\'title_control\' | label" (click)="onToggleControl(streamId)" *if="state.role === \'publisher\'">\n\t\t\t\t<svg class="control" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="btn--spy" [title]="\'title_spy\' | label" (click)="onToggleSpy(streamId)" *if="state.role === \'publisher\'">\n\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#spy"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<div class="group--members" *if="state.mode == \'virtual-tour\'">\n\t\t<div class="members">\n\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t\t</div>\n\t\t<div class="credits">\n\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n\x3c!-- remote screen --\x3e\n<div class="group--remote-screen" *if="remoteScreen">\n\t<div class="agora-stream" agora-stream [stream]="remoteScreen" type="remote">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t</div>\n\t</div>\n</div>\n\n\t<div class="group--header">\n\t\t\n\x3c!-- service --\x3e\n<div class="group--service">\n\t<button type="button" class="btn--back" [title]="\'title_back\' | label" (click)="onBack($event)" *if="isBackButtonVisible">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t</button>\n\t<button type="button" class="btn--view-mode" [title]="\'title_view_mode\' | label" (click)="toggleMode($event)" *if="state.mode != \'embed\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'virtual-tour\'"><use xlink:href="#live-meeting"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'live-meeting\'"><use xlink:href="#virtual-tour"></use></svg>\n\t</button>\n\t<button type="button" class="btn--volume" [title]="\'title_volume\' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--fullscreen" [title]="\'title_fullscreen\' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--navmap" [title]="\'title_navmap\' | label" [class]="{ active: state.showNavmap }" (click)="toggleNavmap($event)" *if="navmap && state.mode != \'live-meeting\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navmap"></use></svg>\n\t</button>\n</div>\n\n\t\t\n\x3c!-- local streams --\x3e\n<div class="group--local" [class]="{ publisher: state.role == \'publisher\', viewer: state.role == \'viewer\' }" *if="state.live">\n\t<button type="button" class="btn--silence" [title]="\'title_silence\' | label" [class]="{ active: state.silencing }" (click)="onToggleSilence()" *if="state.role === \'publisher\'">\n\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t</button>\n\t<button type="button" class="btn--control" [title]="\'title_control\' | label" [class]="{ active: state.controlling == state.uid }" (click)="onToggleControl(state.uid)" *if="state.role == \'publisher\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t</button>\n\t<div class="agora-stream" *if="!local"></div>\n\t<div class="agora-stream" agora-stream [stream]="local" type="local" *if="local">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t</div>\n\t</div>\n\t<div class="agora-stream agora-stream--screen" agora-stream [stream]="screen" type="local" *if="screen && hasScreenViewItem">\n\t\t<div class="agora-stream__player"></div>\n\t</div>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t\n\x3c!-- controls --\x3e\n<div class="group--controls" *if="state.live">\n\t<div class="group--actions">\n\t\t<button type="button" class="btn--call" [title]="\'title_disconnect\' | label" (click)="disconnect()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--cam" [title]="\'title_mute_camera\' | label" [class]="{ muted: state.cameraMuted, disabled: !local }" (click)="toggleCamera()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--mic" [title]="\'title_mute_mic\' | label" [class]="{ muted: state.audioMuted, disabled: !local || silenced }" (click)="toggleAudio()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--screen" [title]="\'title_share_screen\' | label" [class]="{ active: screen }" (click)="toggleScreen()" *if="state.role == \'publisher\' || state.role == \'attendee\' || controlling">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#screen"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--chat" [title]="\'title_chat\' | label" [class]="{ active: state.chatDirty }" (click)="toggleChat()" *if="(\'chat\' | flag)">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#chat"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--navinfo" [title]="\'title_navinfo\' | label" [class]="{ active: state.showNavInfo }" (click)="toggleNavInfo()" *if="showNavInfoToggler">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navinfo"></use></svg>\n\t\t</button>\n\t</div>\n</div>\n\n\t\t\n\x3c!-- media --\x3e\n<div class="group--media" media-player>\n\t<button type="button" class="btn--play" [title]="\'title_play\' | label" (click)="onPlay()" *if="!playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#play"></use></svg>\n\t</button>\n\t<button type="button" class="btn--pause" [title]="\'title_pause\' | label" (click)="onPause()" *if="playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pause"></use></svg>\n\t</button>\n\t<div class="track" (click)="onTrack($event)">\n\t\t<div class="track__progress" [style]="{ transform: \'scale(\' + this.progress + \', 1)\'}"></div>\n\t</div>\n</div>\n\n\t\t\n\x3c!-- ar-vr --\x3e\n<div class="group--ar-vr">\n\t<button type="button" class="btn--ar" [title]="\'title_ar\' | label" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t</button>\n\t<button type="button" class="btn--vr" [title]="\'title_vr\' | label" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t</button>\n</div>\n\n\t\t\n\x3c!-- like --\x3e\n<div class="group--heart" *if="view && (\'like\' | flag)">\n\t<svg class="love" [class]="{ active: view.showLove }" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t<button type="button" class="btn--heart" [class]="{ active: view.showLove }" (click)="addLike($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t\t<span class="badge" [innerHTML]="view.likes" *if="view.likes"></span>\n\t</button>\n</div>\n<div class="group--spacer" *if="!view || !(\'like\' | flag)"></div>\n\n\t</div>\n\t\n\x3c!-- members --\x3e\n<div class="group--members" *if="state.mode == \'live-meeting\'">\n\t<div class="members">\n\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t</div>\n\t<div class="credits">\n\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t</div>\n</div>\n\n\t\n\x3c!-- chat --\x3e\n<div class="group--chat" *if="state.chat" agora-chat (close)="onChatClose()"></div>\n\n\t\n\x3c!-- lock --\x3e\n<div class="ui__lock" [class]="{ spying: spying }" *if="locked || controlling"></div>\n\n\t\n\x3c!-- navmap --\x3e\n<div class="group--navmap" *if="navmap && state.showNavmap && state.mode != \'live-meeting\'">\n\t<img draggable="false" [src]="navmap.asset | asset" *if="navmap.asset" />\n\t<div class="navmap__item" [style]="{ left: item.position[0] * 100 + \'%\', top: item.position[1] * 100 + \'%\' }" (click)="onNavmapItem(item)" *for="let item of navmap.items">\n\t\t<img draggable="false" [src]="\'textures/ui/nav-point.png\' | asset" />\n\t\t<div class="title" [innerHTML]="item.title"></div>\n\t</div>\n</div>\n\n</div>\n\n\t\t\n\x3c!-- Smart Device --\x3e\n<div class="ui remotes" [class]="uiClass" *if="state.status == \'connected\' && state.role == \'smart-device\'">\n\t<div class="ui__body"></div>\n\t\x3c!-- remote sidebar --\x3e\n\t<div class="group--remote" [class]="\'group--remote--\' + remotes.length" *if="state.live">\n\t\t<div class="agora-stream" (toggleSpy)="onToggleSpy($event)" agora-stream [stream]="remote" type="remote" *for="let remote of remotes">\n\t\t\t<div class="agora-stream__player"></div>\n\t\t\t<div class="agora-stream__info">\n\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\x3c!-- remote screen --\x3e\n\t<div class="group--remote-screen" *if="remoteScreen && !hasScreenViewItem">\n\t\t<div class="agora-stream" agora-stream [stream]="remoteScreen" type="remote">\n\t\t\t<div class="agora-stream__player"></div>\n\t\t\t<div class="agora-stream__info">\n\t\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="group--header">\n\t\t\n\x3c!-- local streams --\x3e\n<div class="group--local" [class]="{ publisher: state.role == \'publisher\', viewer: state.role == \'viewer\' }" *if="state.live">\n\t<div class="agora-stream" agora-stream [stream]="local" type="local" *if="local">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t</div>\n\t</div>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t\n\x3c!-- controls --\x3e\n<div class="group--controls" *if="state.live">\n\t<div class="group--actions">\n\t\t<button type="button" class="btn--call" [title]="\'title_disconnect\' | label" (click)="disconnect()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--cam" [title]="\'title_mute_camera\' | label" [class]="{ muted: state.cameraMuted, disabled: !local }" (click)="toggleCamera()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--mic" [title]="\'title_mute_mic\' | label" [class]="{ muted: state.audioMuted, disabled: !local || silenced }" (click)="toggleAudio()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic"></use></svg>\n\t\t</button>\n\t</div>\n</div>\n\n\t</div>\n\t\n\x3c!-- members --\x3e\n<div class="group--members">\n\t<div class="members">\n\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t</div>\n\t<div class="credits">\n\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t</div>\n</div>\n\n</div>\n\n\t\t\n\x3c!-- Self Service Tour --\x3e\n<div class="ui" [class]="uiClass" *if="state.status == \'connected\' && state.mode == \'self-service-tour\'">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t<div class="group--header">\n\t\t\n\x3c!-- service --\x3e\n<div class="group--service">\n\t<button type="button" class="btn--back" [title]="\'title_back\' | label" (click)="onBack($event)" *if="isBackButtonVisible">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t</button>\n\t<button type="button" class="btn--view-mode" [title]="\'title_view_mode\' | label" (click)="toggleMode($event)" *if="state.mode != \'embed\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'virtual-tour\'"><use xlink:href="#live-meeting"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'live-meeting\'"><use xlink:href="#virtual-tour"></use></svg>\n\t</button>\n\t<button type="button" class="btn--volume" [title]="\'title_volume\' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--fullscreen" [title]="\'title_fullscreen\' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--navmap" [title]="\'title_navmap\' | label" [class]="{ active: state.showNavmap }" (click)="toggleNavmap($event)" *if="navmap && state.mode != \'live-meeting\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navmap"></use></svg>\n\t</button>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t<div class="group--spacer"></div>\n\t\t\n\x3c!-- media --\x3e\n<div class="group--media" media-player>\n\t<button type="button" class="btn--play" [title]="\'title_play\' | label" (click)="onPlay()" *if="!playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#play"></use></svg>\n\t</button>\n\t<button type="button" class="btn--pause" [title]="\'title_pause\' | label" (click)="onPause()" *if="playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pause"></use></svg>\n\t</button>\n\t<div class="track" (click)="onTrack($event)">\n\t\t<div class="track__progress" [style]="{ transform: \'scale(\' + this.progress + \', 1)\'}"></div>\n\t</div>\n</div>\n\n\t\t\n\x3c!-- ar-vr --\x3e\n<div class="group--ar-vr">\n\t<button type="button" class="btn--ar" [title]="\'title_ar\' | label" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t</button>\n\t<button type="button" class="btn--vr" [title]="\'title_vr\' | label" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t</button>\n</div>\n\n\t\t\n\x3c!-- like --\x3e\n<div class="group--heart" *if="view && (\'like\' | flag)">\n\t<svg class="love" [class]="{ active: view.showLove }" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t<button type="button" class="btn--heart" [class]="{ active: view.showLove }" (click)="addLike($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t\t<span class="badge" [innerHTML]="view.likes" *if="view.likes"></span>\n\t</button>\n</div>\n<div class="group--spacer" *if="!view || !(\'like\' | flag)"></div>\n\n\t</div>\n\t\n\x3c!-- navmap --\x3e\n<div class="group--navmap" *if="navmap && state.showNavmap && state.mode != \'live-meeting\'">\n\t<img draggable="false" [src]="navmap.asset | asset" *if="navmap.asset" />\n\t<div class="navmap__item" [style]="{ left: item.position[0] * 100 + \'%\', top: item.position[1] * 100 + \'%\' }" (click)="onNavmapItem(item)" *for="let item of navmap.items">\n\t\t<img draggable="false" [src]="\'textures/ui/nav-point.png\' | asset" />\n\t\t<div class="title" [innerHTML]="item.title"></div>\n\t</div>\n</div>\n\n</div>\n\n\t\t\n\x3c!-- Embed --\x3e\n<div class="ui" [class]="uiClass" *if="state.status == \'connected\' && state.mode == \'embed\'">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t<div class="group--header">\n\t\t\n\x3c!-- service --\x3e\n<div class="group--service">\n\t<button type="button" class="btn--back" [title]="\'title_back\' | label" (click)="onBack($event)" *if="isBackButtonVisible">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t</button>\n\t<button type="button" class="btn--view-mode" [title]="\'title_view_mode\' | label" (click)="toggleMode($event)" *if="state.mode != \'embed\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'virtual-tour\'"><use xlink:href="#live-meeting"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'live-meeting\'"><use xlink:href="#virtual-tour"></use></svg>\n\t</button>\n\t<button type="button" class="btn--volume" [title]="\'title_volume\' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--fullscreen" [title]="\'title_fullscreen\' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--navmap" [title]="\'title_navmap\' | label" [class]="{ active: state.showNavmap }" (click)="toggleNavmap($event)" *if="navmap && state.mode != \'live-meeting\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navmap"></use></svg>\n\t</button>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t<div class="group--spacer"></div>\n\t\t\n\x3c!-- media --\x3e\n<div class="group--media" media-player>\n\t<button type="button" class="btn--play" [title]="\'title_play\' | label" (click)="onPlay()" *if="!playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#play"></use></svg>\n\t</button>\n\t<button type="button" class="btn--pause" [title]="\'title_pause\' | label" (click)="onPause()" *if="playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pause"></use></svg>\n\t</button>\n\t<div class="track" (click)="onTrack($event)">\n\t\t<div class="track__progress" [style]="{ transform: \'scale(\' + this.progress + \', 1)\'}"></div>\n\t</div>\n</div>\n\n\t\t\n\x3c!-- ar-vr --\x3e\n<div class="group--ar-vr">\n\t<button type="button" class="btn--ar" [title]="\'title_ar\' | label" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t</button>\n\t<button type="button" class="btn--vr" [title]="\'title_vr\' | label" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t</button>\n</div>\n\n\t\t\n\x3c!-- like --\x3e\n<div class="group--heart" *if="view && (\'like\' | flag)">\n\t<svg class="love" [class]="{ active: view.showLove }" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t<button type="button" class="btn--heart" [class]="{ active: view.showLove }" (click)="addLike($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t\t<span class="badge" [innerHTML]="view.likes" *if="view.likes"></span>\n\t</button>\n</div>\n<div class="group--spacer" *if="!view || !(\'like\' | flag)"></div>\n\n\t</div>\n</div>\n\n\t\t\n\x3c!-- logo --\x3e\n<a class="btn--logo" [routerLink]="\'index\' | route" *if="state.status != \'connected\'">\n\t<img [src]="\'logo\' | env" *if="\'logo\' | env" />\n\t<svg viewBox="0 0 270 98" *if="!(\'logo\' | env)"><use xlink:href="#b-here"></use></svg>\n</a>\n\n\t\t\n\x3c!-- credits --\x3e\n<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener" *if="state.status != \'connected\'">\n\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n</a>\n\n\t\t\n\x3c!-- language --\x3e\n<div class="group--language" language (set)="pushChanges()" *if="state.status != \'connected\'"></div>\n\n\t</div>\n\t'};var nl=function(){function t(){}return t.assetCreate$=function(t){return hn.post$("/api/asset",t).pipe(i.map((function(t){return Fi(t)})))},t.assetUpdate$=function(t){return hn.put$("/api/asset/"+t.id,t).pipe(i.map((function(t){return Fi(t)})))},t.assetDelete$=function(t){return t&&t.id?hn.delete$("/api/asset/"+t.id).pipe(i.map((function(){return null}))):n.of(null)},t.localizedAssetCreate$=function(t,e){return hn.post$("/api/"+t+"/asset",e).pipe(i.map((function(t){return Fi(t)})))},t.localizedAssetUpdate$=function(t,e){return hn.put$("/api/"+t+"/asset/"+e.id,e).pipe(i.map((function(t){return Fi(t)})))},t.upload$=function(t){var e=new FormData;t.forEach((function(t){return e.append("file",t,t.name)}));var o=new XMLHttpRequest,r=n.merge(n.fromEvent(o.upload,"loadstart"),n.fromEvent(o.upload,"progress"),n.fromEvent(o.upload,"load"),n.fromEvent(o,"readystatechange")).pipe(i.map((function(t){switch(t.type){case"readystatechange":return 4===o.readyState?JSON.parse(o.responseText):null;default:return null}})),i.filter((function(t){return null!==t})));return o.open("POST","/api/upload/",!0),o.send(e),r},t.createOrUpdateAsset$=function(e,n){var i=e[0],o=ji.fromUrl(i.url);return n.value&&n.value.id?(o.id=n.value.id,t.assetUpdate$(o)):t.assetCreate$(o)},t.createOrUpdateLocalizedAsset$=function(e,n,i){var o=e[0],r=ji.fromUrl(o.url);return n.value&&n.value.id?(r.id=n.value.id,t.localizedAssetUpdate$(i,r)):t.localizedAssetCreate$(i,r)},t.assetDidChange=function(t,e){var n=null,i=null,o=null,r=null;return t&&(n=t.id,i=t.file),e&&(o=e.id,r=e.file),n!==o||i!==r},t}(),il=function(){function t(){}return t.data$=function(){return this.data$_||(this.data$_=hn.get$("/api/view").pipe(i.map((function(t){return t.views=t.views.map((function(t){return pi(t)})),t})),i.shareReplay(1))),this.data$_},t.viewIdOptions$=function(){return this.data$().pipe(i.map((function(t){var e=t.views.map((function(t){return{id:t.id,name:t.name}}));return e.unshift({id:null,name:"select"}),e})))},t.viewCreate$=function(t){return hn.post$("/api/view",t).pipe(i.map((function(t){return pi(t)})))},t.viewUpdate$=function(t){return hn.put$("/api/view/"+t.id,t.payload).pipe(i.map((function(t){return pi(t)})))},t.viewDelete$=function(t){return hn.delete$("/api/view/"+t.id)},t.getTile=function(t){var e;return t.type.name===ni.PanoramaGrid.name&&(e=t.tiles[t.index]),e},t.inferItemCreate$=function(t,e){var n=this.getTile(t);return n?this.tileItemCreate$(t,n,e):this.itemCreate$(t,e)},t.inferItemUpdate$=function(t,e){var n=this.getTile(t);return n?this.tileItemUpdate$(t,n,e):this.itemUpdate$(t,e)},t.inferItemDelete$=function(t,e){var n=this.getTile(t);return n?this.tileItemDelete$(t,n,e):this.itemDelete$(t,e)},t.inferItemUpdateResult$=function(t,e){var n,i=this.getTile(t);(n=i?i.navs.find((function(t){return t.id===e.id})):t.items.find((function(t){return t.id===e.id})))&&Object.assign(n,e)},t.inferItemDeleteResult$=function(t,e){var n,i=this.getTile(t);if(n=i?i.navs:t.items){var o=n.indexOf(e);-1!==o&&n.splice(o,1),i&&t.updateCurrentItems()}},t.itemCreate$=function(t,e){return hn.post$("/api/view/"+t.id+"/item",e).pipe(i.map((function(t){return vi(t)})))},t.itemUpdate$=function(t,e){return hn.put$("/api/view/"+t.id+"/item/"+e.id,e.payload).pipe(i.map((function(t){return vi(t)})))},t.itemDelete$=function(t,e){return hn.delete$("/api/view/"+t.id+"/item/"+e.id)},t.tileItemCreate$=function(t,e,n){return hn.post$("/api/view/"+t.id+"/tile/"+e.id+"/item",n).pipe(i.map((function(t){return vi(t)})))},t.tileItemUpdate$=function(t,e,n){return hn.put$("/api/view/"+t.id+"/tile/"+e.id+"/item/"+n.id,n.payload).pipe(i.map((function(t){return vi(t)})))},t.tileItemDelete$=function(t,e,n){return hn.delete$("/api/view/"+t.id+"/tile/"+e.id+"/item/"+n.id)},t}(),ol=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this,n=this.object,i=this.form=new e.FormGroup({type:ii.CurvedPlane,position:new e.FormControl(n.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(n.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([1,1,1],e.RequiredValidator()),radius:new e.FormControl(35,e.RequiredValidator()),height:new e.FormControl(20,e.RequiredValidator()),arc:new e.FormControl(90,e.RequiredValidator()),asset:null});this.controls=i.controls,i.changes$.subscribe((function(e){t.pushChanges()}))},r.onSubmit=function(){if(this.form.valid){var t=Object.assign({},this.form.value);il.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(t){return console.log("CurvedPlaneModalComponent.onSubmit.error",t)}))}else this.form.touched=!0},r.onClose=function(){Bn.reject()},l(o,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"view",get:function(){var t=null,e=this.data;return e&&(t=e.view),t}},{key:"object",get:function(){var t=new THREE.Object3D,e=this.data;if(e){var n=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(n.normalize().multiplyScalar(20),t.position.copy(n),t.lookAt(so.origin)):(t.lookAt(i),t.position.set(n.x,n.y,n.z),t.position.add(i.multiplyScalar(.01)))}return t}}]),o}(t.Component);ol.meta={selector:"[curved-plane-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Curved Plane.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t\x3c!-- <div control-text [control]="controls.title" label="Title"></div> --\x3e\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.radius" label="Radius" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.height" label="Height" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.arc" label="Arc" [precision]="0" [disabled]="true"></div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ol.chunk=function(){return'<div class="curved-plane-modal" curved-plane-modal></div>'};var rl=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this,n=this.object,i=this.form=new e.FormGroup({type:ii.Model,position:new e.FormControl(n.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl([0,0,0],e.RequiredValidator()),scale:new e.FormControl([1,1,1],e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=i.controls,i.changes$.subscribe((function(e){t.pushChanges()}))},r.onSubmit=function(){if(this.form.valid){var t=Object.assign({},this.form.value);il.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(t){return console.log("ItemModelModalComponent.onSubmit.error",t)}))}else this.form.touched=!0},r.onClose=function(){Bn.reject()},l(o,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"view",get:function(){var t=null,e=this.data;return e&&(t=e.view),t}},{key:"object",get:function(){var t=new THREE.Object3D,e=this.data;if(e){var n=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(n.normalize().multiplyScalar(4),t.position.copy(n),t.lookAt(so.origin)):(t.lookAt(i),t.position.set(n.x,n.y,n.z),t.position.add(i.multiplyScalar(.01)))}return t}}]),o}(t.Component);rl.meta={selector:"[item-model-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Model Item.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},rl.chunk=function(){return'<div class="item-model-modal" item-model-modal></div>'};var sl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({type:ni.Media,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={type:e.type,name:e.name,asset:e.asset,orientation:{latitude:0,longitude:0},zoom:75};return il.viewCreate$(n).pipe(i.switchMap((function(t){var n={type:ii.Plane,position:[20,0,0],rotation:[0,-Math.PI/2,0],scale:[12,6.75,1],asset:e.asset};return il.itemCreate$(t,n).pipe(i.map((function(e){return t.items=[e],t})))})),i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("MediaModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);sl.meta={selector:"[media-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Media.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},sl.chunk=function(){return'<div class="media-modal" media-modal></div>'};var al=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({type:ni.Model,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator()),model:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={type:e.type,name:e.name,asset:e.asset,orientation:{latitude:0,longitude:0},zoom:75};return il.viewCreate$(n).pipe(i.switchMap((function(t){var n={type:ii.Model,asset:e.model};return il.itemCreate$(t,n).pipe(i.map((function(e){return t.items=[e],t})))})),i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("ModelModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);al.meta={selector:"[model-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Model View.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.model" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},al.chunk=function(){return'<div class="model-modal" model-modal></div>'};var ll=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this,n=this.object;this.error=null,this.useHooks=Ki.enabled;var o=this.form=new e.FormGroup({type:ii.Nav,title:null,abstract:null,viewId:null,hook:null,hookExtra:null,keepOrientation:!1,important:!1,transparent:!1,position:new e.FormControl(n.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(n.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([20,5,1],e.RequiredValidator()),asset:null,link:new e.FormGroup({title:new e.FormControl(null),href:new e.FormControl(null),target:"_blank"})});if(this.controls=o.controls,Ki.enabled){var r=E.webhook.methods.map((function(t){return{id:t,name:t}}));r.unshift({id:null,name:"select"}),this.controls.hook.options=r}o.changes$.subscribe((function(e){t.pushChanges()})),il.viewIdOptions$().pipe(i.first()).subscribe((function(e){t.controls.viewId.options=e,t.pushChanges()}))},r.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=Object.assign({},this.form.value);e.viewId=e.viewId?parseInt(e.viewId):this.view.id,!e.link||e.link.title&&e.link.href||(e.link=null),il.inferItemCreate$(this.view,e).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("NavModalComponent.onSubmit.error",e),t.error=e,t.form.submitted=!1}))}else this.form.touched=!0},r.onViewIdDidChange=function(t){if(null!=t){var e=this.controls.viewId.options,n=e.find((function(e){return e.id===t}));if(null!=n){var i=n.name,o=this.form.value.title;o&&!e.find((function(t){return t.name===o}))||this.form.patch({title:i})}}},r.onClose=function(){Bn.reject()},l(o,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"view",get:function(){var t=null,e=this.data;return e&&(t=e.view),t}},{key:"position",get:function(){var t=null,e=this.data;return e&&(t=e.hit.position),t}},{key:"object",get:function(){var t=new THREE.Object3D,e=this.data;if(e){var n=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(n.normalize().multiplyScalar(tl.RADIUS),t.position.copy(n),t.lookAt(so.origin)):(t.lookAt(i),t.position.set(n.x,n.y,n.z),t.position.add(i.multiplyScalar(.01)))}return t}}]),o}(t.Component);ll.meta={selector:"[nav-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Nav.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView" (change)="onViewIdDidChange($event)"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.keepOrientation" label="Keep Orientation"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.important" label="Important"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.transparent" label="Transparent"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3" [disabled]="true"></div>\n\t\t\t\t\t\t<div *if="controls.transparent.value == true">\n\t\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png, image/jpeg"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.link.controls.title" label="Link Title"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.link.controls.href" label="Link Url"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.hook" label="Hook" *if="useHooks"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.hookExtra" label="Hook Extra" *if="useHooks"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ll.chunk=function(){return'<div class="nav-modal" nav-modal></div>'};var cl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({type:ni.PanoramaGrid,name:new e.FormControl(null,e.RequiredValidator()),assets:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value.assets,n=si.mapTiles(e.map((function(t){return{asset:t,navs:[]}})),!1,!0);n.sort((function(t,e){return 1e4*t.indices.x+t.indices.y-(1e4*e.indices.x+e.indices.y)}));var o=n[0].asset,r={type:this.form.value.type,name:this.form.value.name,asset:o,tiles:n,invertAxes:!0,flipAxes:!1,orientation:{latitude:0,longitude:0},zoom:75};il.viewCreate$(r).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("PanoramaGridModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}else this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);cl.meta={selector:"[panorama-grid-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Panorama Grid.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-assets [control]="controls.assets" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},cl.chunk=function(){return'<div class="panorama-grid-modal" panorama-grid-modal></div>'};var ul=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({type:ni.Panorama,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={type:e.type,name:e.name,asset:e.asset,orientation:{latitude:0,longitude:0},zoom:75};return il.viewCreate$(n).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("PanoramaModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);ul.meta={selector:"[panorama-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Panorama.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--\n\t\t\t\t\t<div class="group--form group--form--fixed">\n\t\t\t\t\t\t<code [innerHTML]="form.value | json"></code>\n\t\t\t\t\t\t<button type="button" class="btn--test" (click)="test()"><span>test</span></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t--\x3e\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ul.chunk=function(){return'<div class="panorama-modal" panorama-modal></div>'};var dl=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var n=this,i=t.getContext(this).parentInstance;i instanceof Ii&&(this.data=i.modal.data),this.error=null;var o=this.form=new e.FormGroup({name:new e.FormControl(null,e.RequiredValidator())});this.controls=o.controls,o.changes$.subscribe((function(t){n.pushChanges()}))},r.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e={name:this.form.value.name,items:this.data?this.data.item.items:[]};return Xn.pathCreate$(e).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("PathAddModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},r.onClose=function(){Bn.reject()},o}(t.Component);dl.meta={selector:"[path-add-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Add Path.</div>\n\t\t\t\t<div class="description">Aggiungi un percorso</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},dl.chunk=function(){return'<div class="panorama-modal" path-add-modal></div>'};var hl=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var n=this;this.item=null,this.views=null;var i=t.getContext(this).parentInstance;if(i instanceof Ii){var o=i.modal.data;o&&(this.item=o.item?o.item:null,this.views=this.parseViews(o.views,this.item))}this.error=null;var r=this.form=new e.FormGroup({name:new e.FormControl(this.item?this.item.name:null,e.RequiredValidator())});this.controls=r.controls,r.changes$.subscribe((function(t){n.pushChanges()}))},r.parseViews=function(t,e){return t&&e?t.map((function(t){return{id:t.id,name:t.name,type:t.type,active:-1===e.items.indexOf(t.id)}})):[]},r.onToggleView=function(t){t.active=!t.active,this.pushChanges()},r.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={id:this.item.id,name:e.name,items:this.views.filter((function(t){return!t.active})).map((function(t){return t.id}))};return Xn.pathUpdate$(n).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("PathEditModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},r.onSelectAll=function(){this.views.forEach((function(t){return t.active=!0})),this.pushChanges()},r.onSelectNone=function(){this.views.forEach((function(t){return t.active=!1})),this.pushChanges()},r.onClose=function(){Bn.reject()},o}(t.Component);hl.meta={selector:"[path-edit-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Edit Path <span *if="item">&ldquo;<span [innerHTML]="item.title || item.name"></span>&rdquo;</span>.</div>\n\t\t\t\t<div class="description">Modifica il percorso</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul class="nav--flag" *if="views">\n\t\t\t\t\t\t<li class="nav__item" *for="let view of views">\n\t\t\t\t\t\t\t<button type="button" class="btn--flag" [class]="{ active: view.active }" [title]="view.name" (click)="onToggleView(view)">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class="name" [innerHTML]="view.name"></span>\n\t\t\t\t\t\t\t\t<span class="flag">\n\t\t\t\t\t\t\t\t\t<svg class="check" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#check"></use></svg>\n\t\t\t\t\t\t\t\t\t<svg class="close" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<div class="group--options">\n\t\t\t\t\t\t\t<button type="button" class="btn--link" (click)="onSelectAll()">\n\t\t\t\t\t\t\t\t<span>Select all</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--link" (click)="onSelectNone()">\n\t\t\t\t\t\t\t\t<span>Select none</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Save</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},hl.chunk=function(){return'<div class="path-edit-modal" path-edit-modal></div>'};var pl=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this,n=this.object,i=this.form=new e.FormGroup({type:ii.Plane,position:new e.FormControl(n.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(n.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([12,6.75,1],e.RequiredValidator()),asset:null});this.controls=i.controls,i.changes$.subscribe((function(e){t.pushChanges()}))},r.onSubmit=function(){if(this.form.valid){var t=Object.assign({},this.form.value);console.log("PlaneModalComponent.onSubmit",this.view,t),il.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((function(t){console.log("PlaneModalComponent.onSubmit.success",t),Bn.resolve(t)}),(function(t){return console.log("PlaneModalComponent.onSubmit.error",t)}))}else this.form.touched=!0},r.onClose=function(){Bn.reject()},l(o,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"view",get:function(){var t=null,e=this.data;return e&&(t=e.view),t}},{key:"object",get:function(){var t=new THREE.Object3D,e=this.data;if(e){var n=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(n.normalize().multiplyScalar(20),t.position.copy(n),t.lookAt(so.origin)):(t.lookAt(i),t.position.set(n.x,n.y,n.z),t.position.add(i.multiplyScalar(.01)))}return t}}]),o}(t.Component);pl.meta={selector:"[plane-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Plane.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t\x3c!-- <div control-text [control]="controls.title" label="Title"></div> --\x3e\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},pl.chunk=function(){return'<div class="plane-modal" plane-modal></div>'};var vl=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onRemove=function(){Bn.resolve()},i.onCancel=function(){Bn.reject()},i.onClose=function(){Bn.reject()},l(n,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"item",get:function(){var t=null,e=this.data;return e&&(t=e.item),t}}]),n}(t.Component);vl.meta={selector:"[remove-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Remove <span *if="item">&ldquo;<span [innerHTML]="item.title || item.name"></span>&rdquo;</span>.</div>\n\t\t\t\t<div class="abstract">are you sure?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t\t<span>Remove</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onCancel($event)">\n\t\t\t\t\t\t<span>Cancel</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},vl.chunk=function(){return'<div class="remove-modal" remove-modal></div>'};var ml=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({type:ni.Room3d,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={type:e.type,name:e.name,asset:e.asset,orientation:{latitude:0,longitude:0},zoom:75};return il.viewCreate$(n).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("Room3DModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);ml.meta={selector:"[room-3d-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Room 3D View.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.model" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ml.chunk=function(){return'<div class="room-3d-modal" room-3d-modal></div>'};var fl={menu:[{id:"menu",title:"editor_menu",active:!0},{id:"navmaps",title:"editor_navmaps",active:!0}],current:null,active:!1},gl=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this;t.getContext(this).node.classList.remove("hidden"),this.settings=this.getSettings(),this.aside=!1,this.state={},this.view=null,this.paths=null,this.path=null,this.form=null,this.local=null,this.remotes=[],this.viewHit=new n.Subject,(this.vrService=Cr.getService()).status$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.pushChanges()})),this.resolveUser()},r.resolveUser=function(){var t=this;pn.me$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){e&&e.type===I.Publisher?(t.user=e,t.initState()):Jt.setRouterLink("it.access")}))},r.initState=function(){var t=this,e=this.user,n={user:e,role:e.type,name:e.firstName&&e.lastName?e.firstName+" "+e.lastName:null,mode:Je,link:null,channelName:E.channelName,uid:null,status:he,connecting:!1,connected:!0,controlling:!1,spying:!1,silencing:!1,hosted:!0,live:!1,navigable:!0,cameraMuted:!1,audioMuted:!1,showNavInfo:!0};_.state=n,_.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.state=e,t.hosted=e.hosted,t.pushChanges()})),this.viewObserver$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){})),Ln.mode=En},r.viewObserver$=function(){var t=this;return il.data$().pipe(i.switchMap((function(e){var n=L.has("pathId")?parseInt(L.get("pathId")):null;return Xn.getCurrentPath$(n).pipe(i.switchMap((function(n){return t.paths=Xn.paths,t.path=n,qi.editorView$(e,n)})))})),i.tap((function(e){t.view=null,t.pushChanges()})),i.delay(1),i.tap((function(e){t.view=e,t.pushChanges()})))},r.onAddPath=function(){Bn.open$({template:dl.chunk()}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&Xn.addPath(t.data)}))},r.onEditPath=function(t){Bn.open$({template:hl.chunk(),data:{item:t,views:qi.validViews}}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&Xn.editPath(t.data)}))},r.onDuplicatePath=function(t){Bn.open$({template:dl.chunk(),data:{item:t}}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&Xn.addPath(t.data)}))},r.onDeletePath=function(t){Bn.open$({template:vl.chunk(),data:{item:t}}).pipe(i.first()).subscribe((function(e){e instanceof Hn&&Xn.pathDelete$(t).pipe(i.first()).subscribe((function(e){Xn.deletePath(t)}))}))},r.onSelectPath=function(t){Xn.path=t},r.isPathSelected=function(t){return Xn.path.id===t.id},r.onNavTo=function(t){var e=t.viewId;qi.pathViews.find((function(t){return t.id===e}))&&(qi.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation})},r.onNavLink=function(t){Bn.open$({iframe:t.link.href}).pipe(i.first()).subscribe((function(e){gn.send({type:Fe,itemId:t.id})}))},r.patchState=function(t){this.state=Object.assign({},this.state,t),this.pushChanges()},r.tryInAr=function(){Bn.open$({template:Ri.chunk(),data:this.view}).pipe(i.first()).subscribe((function(t){}))},r.replaceUrl=function(){if("history"in window){var t=new URLSearchParams(window.location.search),e=t.get("debug")||null,n=t.get("editor")||null,i=t.get("role")||null,o=t.get("link")||null,r=t.get("name")||null,s=""+window.location.origin+window.location.pathname+"?link="+o+(r?"&name="+r:"")+(i?"&role="+i:"")+(e?"&debug":"")+(n?"&editor":"");window.history.replaceState({pageTitle:window.pageTitle},"",s)}},r.onToggleAside=function(){this.aside=!this.aside,this.pushChanges(),window.dispatchEvent(new Event("resize"))},r.getSettings=function(){var t=Object.assign({},fl);return t.menu=t.menu.filter((function(t){return E.flags[t.id]})),t.current=t.menu.length?t.menu[0].id:null,t},r.onToggleSettings=function(){var t=this.settings;t.active=!t.active,this.pushChanges()},r.onSelectSetting=function(t){this.settings.current=t.id,this.pushChanges()},r.onViewHit=function(t){this.viewHit.next(t)},r.onViewHitted=function(t){this.viewHitSubscription&&(this.viewHitSubscription.unsubscribe(),this.viewHitSubscription=null),"function"==typeof t&&(this.viewHitSubscription=this.viewHit.pipe(i.first()).subscribe((function(e){return t(e)})))},r.onDragEnd=function(t){var e=this;il.inferItemUpdate$(this.view,t.item).pipe(i.first()).subscribe((function(t){e.pushChanges()}),(function(t){return console.log("EditorComponent.onDragEnd.inferItemUpdate$.error",t)}))},r.onResizeEnd=function(t){},r.onWorldSelect=function(t){var e;this.view&&(this.view.items.forEach((function(t){return t.showPanel=!1})),this.view.items.forEach((function(n){n.selected=n===t.item,e=n.selected?n:e})),this.view.selected=!e,this.pushChanges(),e&&(this.aside=!0,this.pushChanges(),window.dispatchEvent(new Event("resize"))))},r.onOpenModal=function(t,e){var n=this,o=null;switch(t.type){case"view":switch(t.value){case ni.Panorama.name:o=ul.chunk();break;case ni.PanoramaGrid.name:o=cl.chunk();break;case ni.Model.name:o=al.chunk();break;case ni.Room3d.name:o=ml.chunk();break;case ni.Media.name:o=sl.chunk()}break;case"viewItem":switch(t.value){case ii.Nav.name:o=ll.chunk();break;case ii.Plane.name:o=pl.chunk();break;case ii.CurvedPlane.name:o=ol.chunk();break;case ii.Model.name:o=rl.chunk()}}o&&Bn.open$({template:o,data:e}).pipe(i.first()).subscribe((function(e){if(e instanceof Hn)switch(t.type){case"view":switch(t.value){case ni.Panorama.name:case ni.PanoramaGrid.name:case ni.Model.name:case ni.Room3d.name:case ni.Media.name:qi.addView(e.data)}break;case"viewItem":switch(t.value){case ii.Nav.name:case ii.Plane.name:case ii.CurvedPlane.name:case ii.Model.name:var i=Object.assign({},e.data),o=il.getTile(n.view);if(o){var r=o.navs||[];r.push(i),o.navs=r,n.view.updateCurrentItems()}else{i.path=!0;var s=n.view.items||[];s.push(i),n.view.items=s}n.pushChanges()}}n.pushChanges()}))},r.onAsideSelect=function(t){var e=this;if(t.value)switch(t.value){case ii.Nav.name:case ii.Plane.name:case ii.CurvedPlane.name:this.onViewHitted((function(n){e.onOpenModal(t,{view:e.view,hit:n})})),_i.open$({message:"Click a point on the view"});break;case ii.Model.name:if("viewItem"===t.type){if(this.view.type.name===ni.Model.name)return;this.onViewHitted((function(n){e.onOpenModal(t,{view:e.view,hit:n})})),_i.open$({message:"Click a point on the view"})}else this.onOpenModal(t,{view:this.view});break;default:this.onOpenModal(t,{view:this.view})}else if(t.view&&(t.item||null===t.item))t.view.selected=!1,t.view.items.forEach((function(e){return e.selected=e===t.item})),gn.send({type:Ye}),this.pushChanges();else if(t.view&&(t.tile||null===t.tile))t.view.selected=!1,t.view.tiles.forEach((function(e){return e.selected=e===t.tile})),gn.send({type:Ye}),this.pushChanges();else if(t.view||null===t.view){this.view.selected=this.view===t.view,this.view.items.forEach((function(t){return t.selected=!1}));var n=il.getTile(this.view);n&&this.view.tiles.forEach((function(t){return t.selected=t===n})),gn.send({type:Ye}),this.pushChanges()}},r.onAsideUpdate=function(t){if(t.item&&t.view)this.pushChanges();else if(t.tile&&t.view);else if(t.view)if(qi.viewId!==t.view.id)qi.viewId=t.view.id;else{var e=nl.assetDidChange(this.view.asset,t.view.asset);Object.assign(this.view,t.view),e&&"function"==typeof this.view.onUpdateAsset&&this.view.onUpdateAsset(),this.pushChanges()}},r.onAsideDelete=function(t){var e=this;t.item&&t.view?il.inferItemDelete$(t.view,t.item).pipe(i.first()).subscribe((function(n){il.inferItemDeleteResult$(t.view,t.item),e.pushChanges()}),(function(t){return console.log("EditorComponent.onAsideDelete.inferItemDelete$.error",t)})):t.view&&il.viewDelete$(t.view).pipe(i.first()).subscribe((function(e){qi.deleteView(t.view)}),(function(t){return console.log("EditorComponent.onAsideDelete.viewDelete$.error",t)}))},l(o,[{key:"dataViews",get:function(){return qi.dataViews}},{key:"pathViews",get:function(){return qi.pathViews}}]),o}(t.Component);gl.meta={selector:"[editor-component]",template:'\n\t<div class="page page--editor">\n\t\t<div class="ui" [class]="{ open: aside }" *if="dataViews.length">\n\t\t\t<div class="ui__navbar">\n\t\t\t\t<div class="btn--settings" [class]="{ active: settings.active }" (click)="onToggleSettings($event)" *if="settings.menu.length > 0">\n\t\t\t\t\t<svg class="settings" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#settings-full"></use></svg>\n\t\t\t\t</div>\n\t\t\t\t<div class="headline" *if="view">\n\t\t\t\t\t<div class="headline__id" [innerHTML]="view.id"></div>\n\t\t\t\t\t<div class="headline__icon">\n\t\t\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="headline__name" [innerHTML]="view.name"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="group--path" *if="(\'usePaths\' | flag) && path">\n\t\t\t\t\t<div class="group--path__select">\n\t\t\t\t\t\t<div class="group--form--select" [dropdown]="\'path\'">\n\t\t\t\t\t\t\t<label>Percorso</label>\n\t\t\t\t\t\t\t<span class="control--custom-select" [innerHTML]="path.name"></span>\n\t\t\t\t\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="dropdown dropdown-item" [dropdown-item]="\'path\'">\n\t\t\t\t\t\t\t<div class="category">Percorso</div>\n\t\t\t\t\t\t\t<ul class="nav--dropdown">\n\t\t\t\t\t\t\t\t<li [class]="{ active: isPathSelected(item) }" *for="let item of paths">\n\t\t\t\t\t\t\t\t\t<span [innerHTML]="item.name" (click)="onSelectPath(item)"></span>\n\t\t\t\t\t\t\t\t\t<div class="check">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#check"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--flags" (click)="onEditPath(item)" title="Edit" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#flags"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--duplicate" (click)="onDuplicatePath(item)" title="Duplicate" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#duplicate"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--trash" (click)="onDeletePath(item)" title="Delete" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#trash"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t<div class="btn--mode" (click)="onAddPath()">Aggiungi un percorso</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="btn--edit" [class]="{ active: aside }" (click)="onToggleAside($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#edit"></use></svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui__body">\n\t\t\t\t<div class="world" world [view]="view" [views]="pathViews" [editor]="true" (navTo)="onNavTo($event)" (viewHit)="onViewHit($event)" (dragEnd)="onDragEnd($event)" (select)="onWorldSelect($event)">\n\t\t\t\t\t<div class="world__view" *if="view">\n\t\t\t\t\t\t<div class="grid" model-grid *if="view.type.name === \'panorama-grid\'" [view]="view" (move)="onGridMove($event)" (nav)="onGridNav($event)"></div>\n\t\t\t\t\t\t<div *if="view.ready">\n\t\t\t\t\t\t\t<div model-room [view]="view" *if="view.type.name === \'room-3d\'"></div>\n\t\t\t\t\t\t\t<div class="world__item" *for="let item of view.pathItems; let index = index;">\n\t\t\t\t\t\t\t\t<div model-nav [item]="item" [view]="view" [editor]="true" (over)="onNavOver($event)" (out)="onNavOut($event)" (down)="onNavDown($event)" *if="item.type.name == \'nav\'"></div>\n\t\t\t\t\t\t\t\t<div model-plane [item]="item" [view]="view" (zoom)="onZoomMedia($event)" (down)="onObjectDown($event)" *if="item.type.name == \'plane\'"></div>\n\t\t\t\t\t\t\t\t<div model-curved-plane [item]="item" [view]="view" (zoom)="onZoomMedia($event)" (down)="onObjectDown($event)" *if="item.type.name == \'curved-plane\'"></div>\n\t\t\t\t\t\t\t\t<div class="model-viewer__item" model-model [item]="item" [view]="view" (down)="onObjectDown($event)" *if="item.type.name == \'model\'">\n\t\t\t\t\t\t\t\t\t\x3c!-- <div class="banner loading" model-banner [item]="progress" *if="progress"></div> --\x3e\n\t\t\t\t\t\t\t\t\t\x3c!-- <div class="progress" [innerHTML]="progress.title" *if="progress"></div> --\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="panel" [class]="{ \'panel--lg\': item.asset != null }" model-panel [item]="item" (down)="onPanelDown($event)" *if="item.showPanel">\n\t\t\t\t\t\t\t\t\t<div class="panel__title" [innerHTML]="item.title"></div>\n\t\t\t\t\t\t\t\t\t<div class="panel__abstract" [innerHTML]="item.abstract"></div>\n\t\t\t\t\t\t\t\t\t<img class="panel__picture" [src]="item.asset | asset" *if="item.asset">\n\t\t\t\t\t\t\t\t\t<a class="panel__link" [href]="item.link.href" target="_blank" rel="noopener" *if="item.link" [innerHTML]="item.link.title"></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div class="banner loading" model-banner [item]="loading" *if="loading">\n\t\t\t\t\t\t\t<div class="banner__title" [innerHTML]="item.title"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="banner waiting" model-banner [item]="waiting" *if="waiting">\n\t\t\t\t\t\t\t<div class="banner__title" [innerHTML]="item.title"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="progress-indicator" model-progress [view]="view">\n\t\t\t\t\t\t<div class="inner"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div model-menu [views]="views" [editor]="true" (nav)="onMenuNav($event)" (toggle)="onMenuToggle($event)">\n\t\t\t\t\t\t<div class="btn--menu" (mousedown)="onToggle($event)">\n\t\t\t\t\t\t\t<div class="btn--menu__spinner"></div>\n\t\t\t\t\t\t\t<svg class="bullets" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#menu"></use></svg>\n\t\t\t\t\t\t\t<svg class="progress" width="50" height="50" viewBox="0 0 50 50">\n\t\t\t\t\t\t\t\t<circle id="circle" r="23" cx="25" cy="25" fill="transparent"></circle>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div model-debug *if="debugging"></div>\n\t\t\t\t\t<div class="world__info" *if="error" [innerHTML]="error"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- footer --\x3e\n\t\t\t<div class="group--footer">\n\t\t\t\t<div class="group--ar-vr">\n\t\t\t\t\t<button type="button" class="btn--ar" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--vr" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui__settings" *if="settings.active">\n\t\t\t\t\x3c!-- settings navs --\x3e\n\t\t\t\t<div class="group--nav">\n\t\t\t\t\t<ul class="nav--menu">\n\t\t\t\t\t\t<li class="nav__item" *for="let item of settings.menu" [class]="{ active: settings.current === item.id }" (click)="onSelectSetting(item)"><span class="title" [innerHTML]="item.title | label"></span></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- menu --\x3e\n\t\t\t\t<div class="group--content" menu-builder [views]="dataViews" *if="settings.current === \'menu\'">\n\t\t\t\t\t<div class="group--head">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_menu\' | label"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--main">\n\t\t\t\t\t\t<div class="nav--tree" *if="form">\n\t\t\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t\t\t<div class="abstract" *if="controls.items.controls.length == 0" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t\t\t\t\t\t<div *for="let control of controls.items.controls">\n\t\t\t\t\t\t\t\t\t<div control-menu [control]="control" (remove)="onRemoveControl($event)" (link)="onLinkControl($event)" (up)="onUpControl($event)" (down)="onDownControl($event)"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--foot">\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onAddItem($event)" [innerHTML]="\'editor_add\' | label"></button>\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="isValid() && onSubmit()" *if="changes > 1" [innerHTML]="\'editor_save\' | label"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- navmaps --\x3e\n\t\t\t\t<div class="group--content" navmap-builder [views]="dataViews" *if="settings.current === \'navmaps\'">\n\t\t\t\t\t<div class="group--head">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_navmaps\' | label"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--main">\n\t\t\t\t\t\t\x3c!-- listing navmaps --\x3e\n\t\t\t\t\t\t<div class="listing--navmaps" *if="!navmap">\n\t\t\t\t\t\t\t<div class="abstract" *if="navmaps.length == 0" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t\t\t\t\t<div class="listing__item" *for="let item of navmaps">\n\t\t\t\t\t\t\t\t<div class="card--navmap" (click)="onSet(item)">\n\t\t\t\t\t\t\t\t\t<div class="card__picture">\n\t\t\t\t\t\t\t\t\t\t<img [src]="item.asset | asset" *if="item.asset" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="card__content">\n\t\t\t\t\t\t\t\t\t\t<div class="card__name" [innerHTML]="item.name"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- navmap edit --\x3e\n\t\t\t\t\t\t<div class="navmap" navmap-edit [navmap]="navmap" (delete)="onDelete($event)" *if="navmap">\n\t\t\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t\t\t<div class="title"><span [innerHTML]="navmap.name"></span> <span [innerHTML]="navmap.id"></span></div>\n\t\t\t\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png"></div>\n\t\t\t\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t\t\t\t<span [innerHTML]="\'editor_save\' | label"></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t\t\t\t\t\t<span [innerHTML]="\'editor_remove\' | label"></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="navmap-control" [class]="mode">\n\t\t\t\t\t\t\t\t\t<div class="navmap-control__image">\n\t\t\t\t\t\t\t\t\t\t<img draggable="false" [src]="navmap.asset | asset" *if="navmap.asset" />\n\t\t\t\t\t\t\t\t\t\t<div class="navmap__item" [style]="{ left: item.position[0] * 100 + \'%\', top: item.position[1] * 100 + \'%\' }" (mousedown)="onMoveItem($event, item)" (click)="onRemoveItem(item)" *for="let item of navmap.items">\n\t\t\t\t\t\t\t\t\t\t\t<img draggable="false" [src]="\'textures/ui/nav-point.png\' | asset" />\n\t\t\t\t\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.title"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<ul class="navmap-control__toolbar">\n\t\t\t\t\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'insert\' }" (click)="onToggleMode(\'insert\')"><svg class="pencil" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pencil"></use></svg></span></li>\n\t\t\t\t\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'move\' }" (click)="onToggleMode(\'move\')"><svg class="move" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#move"></use></svg></span></li>\n\t\t\t\t\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'remove\' }" (click)="onToggleMode(\'remove\')"><svg class="erase" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#erase"></use></svg></span></li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--foot">\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onAdd($event)" [innerHTML]="\'editor_add\' | label" *if="!navmap"></button>\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)" [innerHTML]="\'editor_back\' | label" *if="navmap"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="aside" [class]="{ active: aside }" aside [view]="view" (select)="onAsideSelect($event)" (update)="onAsideUpdate($event)" (delete)="onAsideDelete($event)" *if="view && aside">\n\t\t\t<div class="headline">\n\t\t\t\t<ul class="nav--tab">\n\t\t\t\t\t<li [class]="{ active: mode === 1 }" (click)="setMode(1)" [innerHTML]="\'editor_properties\' | label"></li>\n\t\t\t\t\t<li [class]="{ active: mode === 2 }" (click)="setMode(2)" [innerHTML]="\'editor_views\' | label"></li>\n\t\t\t\t\t<li [class]="{ active: mode === 3 }" (click)="setMode(3)" [innerHTML]="\'editor_view_items\' | label"></li>\n\t\t\t\t</ul>\n\t\t\t\t\x3c!--\n\t\t\t\t<div class="btn--mode" [class]="{ active: mode === 1 }" (click)="setMode(1)" [innerHTML]="\'editor_properties\' | label"></div>\n\t\t\t\t<div class="btn--mode" [class]="{ active: mode === 2 }" (click)="setMode(2)" [innerHTML]="\'editor_views\' | label"></div>\n\t\t\t\t<div class="btn--mode" [class]="{ active: mode === 3 }" (click)="setMode(3)" [innerHTML]="\'editor_view_items\' | label"></div>\n\t\t\t\t--\x3e\n\t\t\t</div>\n\t\t\t<div class="scrollable">\n\t\t\t\t<ul class="nav--editor" *if="mode === 1">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_properties\' | label"></div>\n\t\t\t\t\t\t<update-view [view]="view" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)"></update-view>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li *if="view.type.name != \'panorama-grid\'">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_items\' | label"></div>\n\t\t\t\t\t\t<update-view-item [view]="view" [item]="item" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)" *for="let item of view.pathItems"></update-view-item>\n\t\t\t\t\t\t<div class="abstract" *if="view.pathItems.length == 0" [innerHTML]="\'editor_no_items\' | label"></div>\n\t\t\t\t\t\t<div class="btn--mode" (click)="setMode(3)" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li *if="view.type.name == \'panorama-grid\'">\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_tiles\' | label"></div>\n\t\t\t\t\t\t<div *for="let tile of view.tiles">\n\t\t\t\t\t\t\t<div *if="tile.selected">\n\t\t\t\t\t\t\t\t<update-view-tile [view]="view" [tile]="tile" (update)="onUpdate($event)" (delete)="onDelete($event)"></update-view-tile>\n\t\t\t\t\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t<update-view-item [view]="view" [item]="item" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)" *for="let item of tile.navs"></update-view-item>\n\t\t\t\t\t\t\t\t\t\t<div class="abstract" *if="tile.navs.length == 0" [innerHTML]="\'editor_no_navs\' | label"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="btn--mode" (click)="onSelect({ type:\'viewItem\', value: \'nav\', tile: tile })" [innerHTML]="\'editor_add_nav\' | label"></div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect({ type:\'viewItem\', value: \'nav\', tile: tile })">\n\t\t\t\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg-icon name="nav"></svg-icon>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_add_nav\' | label"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="abstract" *if="view.tiles.length == 0" [innerHTML]="\'editor_no_tiles\' | label"></div>\n\t\t\t\t\t\t\x3c!-- <div class="btn--mode" (click)="setMode(3)">Add Tile</div> --\x3e\n\t\t\t\t\t</li>\n\t\t\t\t\t\x3c!--\n\t\t\t\t\t<li *if="false">\n\t\t\t\t\t\t<div class="title">Icons</div>\n\t\t\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'animated-tabs\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 2 8.4 L 12 8.4 L 12 2 L 6 2 C 3.791 2 2 3.791 2 6 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 8.4 L 22 8.4 L 22 6 C 22 3.791 20.209 2 18 2 L 12 2 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Animated Tabs</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'card-list\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 6.8 13.6 C 6.8 13.158 7.158 12.8 7.6 12.8 L 16.8 12.8 C 17.242 12.8 17.6 13.158 17.6 13.6 L 17.6 16.8 C 17.6 17.242 17.242 17.6 16.8 17.6 L 7.6 17.6 C 7.158 17.6 6.8 17.242 6.8 16.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 6.8 7.2 C 6.8 6.758 7.158 6.4 7.6 6.4 L 16.8 6.4 C 17.242 6.4 17.6 6.758 17.6 7.2 L 17.6 10.4 C 17.6 10.842 17.242 11.2 16.8 11.2 L 7.6 11.2 C 7.158 11.2 6.8 10.842 6.8 10.4 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Card List</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'container-transitions\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.667 13 C 17.139 13 18.333 14.194 18.333 15.667 C 18.333 17.139 17.139 18.333 15.667 18.333 C 14.194 18.333 13 17.139 13 15.667 C 13 14.194 14.194 13 15.667 13 Z" fill="var(--svg-icon-tint)"></path></svg></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Container Transitions</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'dynamic-grid\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><g transform="translate(6.6 6.6)"><path d="M 6.048 0.8 C 6.048 0.358 6.406 0 6.848 0 L 10 0 C 10.442 0 10.8 0.358 10.8 0.8 L 10.8 3.952 C 10.8 4.394 10.442 4.752 10 4.752 L 6.848 4.752 C 6.406 4.752 6.048 4.394 6.048 3.952 Z" fill="var(--svg-icon-tint)" opacity="0.5"></path><path d="M 6.048 6.848 C 6.048 6.406 6.406 6.048 6.848 6.048 L 10 6.048 C 10.442 6.048 10.8 6.406 10.8 6.848 L 10.8 10 C 10.8 10.442 10.442 10.8 10 10.8 L 6.848 10.8 C 6.406 10.8 6.048 10.442 6.048 10 Z" fill="var(--svg-icon-tint)"></path><path d="M 0 0.8 C 0 0.358 0.358 0 0.8 0 L 3.952 0 C 4.394 0 4.752 0.358 4.752 0.8 L 4.752 3.952 C 4.752 4.394 4.394 4.752 3.952 4.752 L 0.8 4.752 C 0.358 4.752 0 4.394 0 3.952 Z" fill="var(--svg-icon-tint)"></path><path d="M 0 6.848 C 0 6.406 0.358 6.048 0.8 6.048 L 3.952 6.048 C 4.394 6.048 4.752 6.406 4.752 6.848 L 4.752 10 C 4.752 10.442 4.394 10.8 3.952 10.8 L 0.8 10.8 C 0.358 10.8 0 10.442 0 10 Z" fill="var(--svg-icon-tint)" opacity="0.5"></path></g></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Dynamic Grid</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'expand-on-tap\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 0 0 L 7.833 0" transform="translate(8.583 11.583) rotate(270 3.917 0.5)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 14.667 9.333 L 12 6.667 L 9.333 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 14.667 14.667 L 12 17.333 L 9.333 14.667" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path> </svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Expand on Tap</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'image-gallery-2\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 10.333 7.333 C 10.886 7.333 11.333 7.781 11.333 8.333 L 11.333 10.333 C 11.333 10.886 10.886 11.333 10.333 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.333 8.333 C 12.333 7.781 12.781 7.333 13.333 7.333 L 15.333 7.333 C 15.886 7.333 16.333 7.781 16.333 8.333 L 16.333 10.333 C 16.333 10.886 15.886 11.333 15.333 11.333 L 13.333 11.333 C 12.781 11.333 12.333 10.886 12.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.333 12.667 C 15.886 12.667 16.333 13.114 16.333 13.667 L 16.333 15.667 C 16.333 16.219 15.886 16.667 15.333 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Image Gallery 2</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-ui\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 6.8 4.8 C 7.905 4.8 8.8 5.695 8.8 6.8 C 8.8 7.905 7.905 8.8 6.8 8.8 C 5.695 8.8 4.8 7.905 4.8 6.8 C 4.8 5.695 5.695 4.8 6.8 4.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 4.8 C 13.105 4.8 14 5.695 14 6.8 C 14 7.905 13.105 8.8 12 8.8 C 10.895 8.8 10 7.905 10 6.8 C 10 5.695 10.895 4.8 12 4.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 17.2 4.8 C 18.305 4.8 19.2 5.695 19.2 6.8 C 19.2 7.905 18.305 8.8 17.2 8.8 C 16.095 8.8 15.2 7.905 15.2 6.8 C 15.2 5.695 16.095 4.8 17.2 4.8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Stories UI</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'todo-list\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8 12.333 L 10.5 14.833 L 16 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">To-Do List</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'toggle-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 17.333 15.333 C 18.438 15.333 19.333 16.229 19.333 17.333 C 19.333 18.438 18.438 19.333 17.333 19.333 C 16.229 19.333 15.333 18.438 15.333 17.333 C 15.333 16.229 16.229 15.333 17.333 15.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 17.333 10 C 18.438 10 19.333 10.895 19.333 12 C 19.333 13.105 18.438 14 17.333 14 C 16.229 14 15.333 13.105 15.333 12 C 15.333 10.895 16.229 10 17.333 10 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 17.333 4.667 C 18.438 4.667 19.333 5.562 19.333 6.667 C 19.333 7.771 18.438 8.667 17.333 8.667 C 16.229 8.667 15.333 7.771 15.333 6.667 C 15.333 5.562 16.229 4.667 17.333 4.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Toggle Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'bottom-sheet\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 10.333 C 22 10.886 21.552 11.333 21 11.333 L 3 11.333 C 2.448 11.333 2 10.886 2 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 13.333 C 2 12.781 2.448 12.333 3 12.333 L 21 12.333 C 21.552 12.333 22 12.781 22 13.333 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Bottom Sheet</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'draggable-sheet\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 14 C 2 12.895 2.895 12 4 12 L 20 12 C 21.105 12 22 12.895 22 14 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z M 10.667 15.333 L 13.333 15.333 C 13.702 15.333 14 15.035 14 14.667 C 14 14.298 13.702 14 13.333 14 L 10.667 14 C 10.298 14 10 14.298 10 14.667 C 10 15.035 10.298 15.333 10.667 15.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Draggable Sheet</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'modal-box\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 9.333 C 7.333 8.229 8.229 7.333 9.333 7.333 L 14.667 7.333 C 15.771 7.333 16.667 8.229 16.667 9.333 L 16.667 14.667 C 16.667 15.771 15.771 16.667 14.667 16.667 L 9.333 16.667 C 8.229 16.667 7.333 15.771 7.333 14.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Modal Box</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'side-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 11 2 C 11.552 2 12 2.448 12 3 L 12 21 C 12 21.552 11.552 22 11 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Side Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-form\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 11.667 7.333 C 11.667 7.333 11.667 7.333 11.667 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 9 C 16.667 9.552 16.219 10 15.667 10 L 13.333 10 L 13.333 15.667 C 13.333 16.219 12.886 16.667 12.333 16.667 L 11.667 16.667 C 11.114 16.667 10.667 16.219 10.667 15.667 L 10.667 10 L 8.333 10 C 7.781 10 7.333 9.552 7.333 9 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Input Form</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'loading-indicator\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 16.4 10.4 C 17.284 10.4 18 11.116 18 12 C 18 12.884 17.284 13.6 16.4 13.6 C 15.516 13.6 14.8 12.884 14.8 12 C 14.8 11.116 15.516 10.4 16.4 10.4 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 10.4 C 12.884 10.4 13.6 11.116 13.6 12 C 13.6 12.884 12.884 13.6 12 13.6 C 11.116 13.6 10.4 12.884 10.4 12 C 10.4 11.116 11.116 10.4 12 10.4 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.6 10.4 C 8.484 10.4 9.2 11.116 9.2 12 C 9.2 12.884 8.484 13.6 7.6 13.6 C 6.716 13.6 6 12.884 6 12 C 6 11.116 6.716 10.4 7.6 10.4 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Loading Indicator</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'radio-button-form\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 9.833 8.167 L 14.167 8.167 C 16.284 8.167 18 9.883 18 12 C 18 14.117 16.284 15.833 14.167 15.833 L 9.833 15.833 C 7.716 15.833 6 14.117 6 12 C 6 9.883 7.716 8.167 9.833 8.167 Z M 11.333 12 C 11.333 13.473 12.527 14.667 14 14.667 C 15.473 14.667 16.667 13.473 16.667 12 C 16.667 10.527 15.473 9.333 14 9.333 C 12.527 9.333 11.333 10.527 11.333 12 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Radio Button Form</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'checkbox-form\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8.651 6.931 C 7.911 6.738 7.238 7.411 7.431 8.151 L 9.363 15.558 C 9.592 16.435 10.775 16.58 11.208 15.784 L 13 12.5 L 16.284 10.708 C 17.08 10.275 16.935 9.092 16.058 8.863 Z" fill="var(--svg-icon-tint)"></path><path d="M 16 15.5 L 11 10.5" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Checkbox Form</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'splash-screen\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.757 13.414 C 6.976 12.633 6.976 11.367 7.757 10.586 L 10.586 7.757 C 11.367 6.976 12.633 6.976 13.414 7.757 L 16.243 10.586 C 17.024 11.367 17.024 12.633 16.243 13.414 L 13.414 16.243 C 12.633 17.024 11.367 17.024 10.586 16.243 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Splash Screen</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'timeout-transition\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1 5.8 C 1 3.149 3.149 1 5.8 1 L 18.2 1 C 20.851 1 23 3.149 23 5.8 L 23 18.2 C 23 20.851 20.851 23 18.2 23 L 5.8 23 C 3.149 23 1 20.851 1 18.2 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 12 6.72 C 14.916 6.72 17.28 9.084 17.28 12 C 17.28 14.916 14.916 17.28 12 17.28 C 9.084 17.28 6.72 14.916 6.72 12 C 6.72 9.084 9.084 6.72 12 6.72 Z M 11.34 12 C 11.34 12.365 11.635 12.66 12 12.66 L 14.2 12.66 C 14.565 12.66 14.86 12.365 14.86 12 C 14.86 11.635 14.565 11.34 14.2 11.34 L 12.66 11.34 L 12.66 9.8 C 12.66 9.435 12.365 9.14 12 9.14 C 11.635 9.14 11.34 9.435 11.34 9.8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Timeout Transition</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'accordion-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 16 10.667 L 12 14.667 L 8 10.667" fill="transparent" stroke-width="2" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Accordion Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'drop-on-scroll\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 0 0 L 8 0" transform="translate(8.5 11.5) rotate(270 4 0.5)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 15.333 11.333 L 12 8 L 8.667 11.333" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Drop on Scroll</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'nested-scroll\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 7 C 21.82 7.552 21.372 8 20.82 8 L 2.82 8 C 2.267 8 1.82 7.552 1.82 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 1.82 17 C 1.82 16.448 2.267 16 2.82 16 L 20.82 16 C 21.372 16 21.82 16.448 21.82 17 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 8.82 10 C 8.82 9.448 9.267 9 9.82 9 L 20.82 9 C 21.372 9 21.82 9.448 21.82 10 L 21.82 14 C 21.82 14.552 21.372 15 20.82 15 L 9.82 15 C 9.267 15 8.82 14.552 8.82 14 Z" fill="var(--svg-icon-tint)"></path><path d="M 1.82 10 C 1.82 9.448 2.267 9 2.82 9 L 6.82 9 C 7.372 9 7.82 9.448 7.82 10 L 7.82 14 C 7.82 14.552 7.372 15 6.82 15 L 2.82 15 C 2.267 15 1.82 14.552 1.82 14 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Nested Scroll</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'star-rating\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 11.399 6.884 C 11.645 6.386 12.355 6.386 12.601 6.884 L 13.705 9.122 C 13.803 9.32 13.992 9.457 14.21 9.489 L 16.68 9.848 C 17.229 9.928 17.449 10.603 17.051 10.99 L 15.264 12.733 C 15.106 12.887 15.034 13.108 15.071 13.326 L 15.493 15.786 C 15.587 16.333 15.013 16.75 14.521 16.492 L 12.312 15.331 C 12.117 15.228 11.883 15.228 11.688 15.331 L 9.479 16.492 C 8.987 16.75 8.413 16.333 8.507 15.786 L 8.929 13.326 C 8.966 13.108 8.894 12.887 8.736 12.733 L 6.949 10.99 C 6.551 10.603 6.771 9.928 7.32 9.848 L 9.79 9.489 C 10.008 9.457 10.197 9.32 10.295 9.122 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Star Rating</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'swipe-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 17.33 C 2 16.595 2.595 16 3.33 16 L 21 16 C 21.552 16 22 16.448 22 17 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 10 C 2 9.448 2.448 9 3 9 L 14 9 C 14.552 9 15 9.448 15 10 L 15 14 C 15 14.552 14.552 15 14 15 L 3 15 C 2.448 15 2 14.552 2 14 Z M 19 9 C 20.657 9 22 10.343 22 12 C 22 13.657 20.657 15 19 15 C 17.343 15 16 13.657 16 12 C 16 10.343 17.343 9 19 9 Z" fill="var(--svg-icon-tint)"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 7 C 22 7.552 21.552 8 21 8 L 3 8 C 2.448 8 2 7.552 2 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Swipe Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'switch-sheet\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.667 13.333 C 17.139 13.333 18.333 14.527 18.333 16 C 18.333 17.473 17.139 18.667 15.667 18.667 C 14.194 18.667 13 17.473 13 16 C 13 14.527 14.194 13.333 15.667 13.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 8.333 13.333 C 9.806 13.333 11 14.527 11 16 C 11 17.473 9.806 18.667 8.333 18.667 C 6.861 18.667 5.667 17.473 5.667 16 C 5.667 14.527 6.861 13.333 8.333 13.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Switch Sheet</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'tab-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 10 15.333 L 14 15.333 L 14 18.667 L 10 18.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 5.333 16.333 C 5.333 15.781 5.781 15.333 6.333 15.333 L 9.333 15.333 L 9.333 18.667 L 6.333 18.667 C 5.781 18.667 5.333 18.219 5.333 17.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 18.667 16.333 C 18.667 15.781 18.219 15.333 17.667 15.333 L 14.667 15.333 L 14.667 18.667 L 17.667 18.667 C 18.219 18.667 18.667 18.219 18.667 17.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Tab Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'wheel-picker\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 3.667 6 C 3.667 3.791 5.458 2 7.667 2 L 16.333 2 C 18.542 2 20.333 3.791 20.333 6 L 20.333 7 C 20.333 7.552 19.886 8 19.333 8 L 4.667 8 C 4.114 8 3.667 7.552 3.667 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 11 C 2 9.895 2.895 9 4 9 L 20 9 C 21.105 9 22 9.895 22 11 L 22 13 C 22 14.105 21.105 15 20 15 L 4 15 C 2.895 15 2 14.105 2 13 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.667 17 C 3.667 16.448 4.114 16 4.667 16 L 19.333 16 C 19.886 16 20.333 16.448 20.333 17 L 20.333 18 C 20.333 20.209 18.542 22 16.333 22 L 7.667 22 C 5.458 22 3.667 20.209 3.667 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Wheel Picker</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'cover-flow\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 11.333 17.962 C 11.333 18.385 11.068 18.762 10.67 18.904 L 4.673 21.045 C 3.37 21.511 2 20.545 2 19.162 L 2 4.838 C 2 3.455 3.37 2.489 4.673 2.955 L 10.67 5.096 C 11.068 5.238 11.333 5.615 11.333 6.038 Z" fill="var(--svg-icon-tint)"></path><path d="M 22 4.838 C 22 3.455 20.63 2.489 19.327 2.955 L 13.33 5.096 C 12.932 5.238 12.667 5.615 12.667 6.038 L 12.667 17.962 C 12.667 18.385 12.932 18.762 13.33 18.904 L 19.327 21.045 C 20.63 21.511 22 20.545 22 19.162 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Cover Flow</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'cube-effect\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6.743 C 2 5.898 2.531 5.144 3.327 4.859 L 9.997 2.477 C 10.648 2.245 11.333 2.727 11.333 3.419 L 11.333 20.581 C 11.333 21.273 10.648 21.755 9.997 21.523 L 3.327 19.141 C 2.531 18.856 2 18.102 2 17.257 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.667 3.419 C 12.667 2.727 13.352 2.245 14.003 2.477 L 20.673 4.859 C 21.469 5.144 22 5.898 22 6.743 L 22 17.257 C 22 18.102 21.469 18.856 20.673 19.141 L 14.003 21.523 C 13.352 21.755 12.667 21.273 12.667 20.581 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Cube Effect</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'flip-effect\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 11.333 4.667 C 11.333 4.114 10.886 3.667 10.333 3.667 L 4 3.667 C 2.895 3.667 2 4.562 2 5.667 L 2 18.333 C 2 19.438 2.895 20.333 4 20.333 L 10.333 20.333 C 10.886 20.333 11.333 19.886 11.333 19.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 20 4.167 C 20 3.891 20.224 3.667 20.5 3.667 L 20.5 3.667 C 21.328 3.667 22 4.338 22 5.167 L 22 18.833 C 22 19.662 21.328 20.333 20.5 20.333 L 20.5 20.333 C 20.224 20.333 20 20.109 20 19.833 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 18.667 4.631 C 18.667 3.309 17.406 2.35 16.131 2.704 L 13.399 3.463 C 12.966 3.583 12.667 3.978 12.667 4.427 L 12.667 19.573 C 12.667 20.022 12.966 20.417 13.399 20.537 L 16.131 21.296 C 17.406 21.65 18.667 20.691 18.667 19.369 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Flip Effect</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'parallax-scroll\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 6.667 C 12 5.562 12.895 4.667 14 4.667 L 17.333 4.667 C 18.438 4.667 19.333 5.562 19.333 6.667 L 19.333 10 C 19.333 11.105 18.438 12 17.333 12 L 14 12 C 12.895 12 12 11.105 12 10 Z" fill="var(--svg-icon-tint)"></path><path d="M 4.667 14 C 4.667 12.895 5.562 12 6.667 12 L 10 12 C 11.105 12 12 12.895 12 14 L 12 17.333 C 12 18.438 11.105 19.333 10 19.333 L 6.667 19.333 C 5.562 19.333 4.667 18.438 4.667 17.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Parallax Scroll</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'pile-effect\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 6.5 4 C 6.224 4 6 3.776 6 3.5 L 6 3.5 C 6 2.672 6.672 2 7.5 2 L 16.5 2 C 17.328 2 18 2.672 18 3.5 L 18 3.5 C 18 3.776 17.776 4 17.5 4 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 4.5 7 C 4.224 7 4 6.776 4 6.5 L 4 6.5 C 4 5.672 4.672 5 5.5 5 L 18.5 5 C 19.328 5 20 5.672 20 6.5 L 20 6.5 C 20 6.776 19.776 7 19.5 7 Z" fill="var(--svg-icon-tint)" opacity="0.7"></path><path d="M 0 2.67 C 0 1.195 1.195 0 2.67 0 L 11.33 0 C 12.805 0 14 1.195 14 2.67 L 14 17.33 C 14 18.805 12.805 20 11.33 20 L 2.67 20 C 1.195 20 0 18.805 0 17.33 Z" transform="translate(5 5) rotate(-90 7 10)" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Pile Effect</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'shuffle\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.174 10.452 L 16.708 9.06 L 15.174 7.667" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 15.174 16.333 L 16.708 14.94 L 15.174 13.548" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.145 9.06 C 16.145 9.06 13.982 8.542 12.617 9.679 C 11.252 10.815 11.829 12.213 10.776 13.548 C 9.724 14.882 7.708 14.94 7.708 14.94" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.145 14.823 C 16.145 14.823 13.982 15.34 12.617 14.204 C 11.252 13.068 11.829 11.669 10.776 10.335 C 9.724 9.001 7.708 8.942 7.708 8.942" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Shuffle</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'svg-animation\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8 12.333 L 10.5 14.833 L 16 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">SVG Animation</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'google-sheets\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7 8.667 C 7 8.206 7.373 7.833 7.833 7.833 L 7.833 7.833 C 8.294 7.833 8.667 8.206 8.667 8.667 L 8.667 8.667 C 8.667 9.127 8.294 9.5 7.833 9.5 L 7.833 9.5 C 7.373 9.5 7 9.127 7 8.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 7 12 C 7 11.54 7.373 11.167 7.833 11.167 L 7.833 11.167 C 8.294 11.167 8.667 11.54 8.667 12 L 8.667 12 C 8.667 12.46 8.294 12.833 7.833 12.833 L 7.833 12.833 C 7.373 12.833 7 12.46 7 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 7 15.333 C 7 14.873 7.373 14.5 7.833 14.5 L 7.833 14.5 C 8.294 14.5 8.667 14.873 8.667 15.333 L 8.667 15.333 C 8.667 15.794 8.294 16.167 7.833 16.167 L 7.833 16.167 C 7.373 16.167 7 15.794 7 15.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 8.667 C 9.778 8.206 10.151 7.833 10.611 7.833 L 16.167 7.833 C 16.627 7.833 17 8.206 17 8.667 L 17 8.667 C 17 9.127 16.627 9.5 16.167 9.5 L 10.611 9.5 C 10.151 9.5 9.778 9.127 9.778 8.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 12 C 9.778 11.54 10.151 11.167 10.611 11.167 L 16.167 11.167 C 16.627 11.167 17 11.54 17 12 L 17 12 C 17 12.46 16.627 12.833 16.167 12.833 L 10.611 12.833 C 10.151 12.833 9.778 12.46 9.778 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 15.333 C 9.778 14.873 10.151 14.5 10.611 14.5 L 16.167 14.5 C 16.627 14.5 17 14.873 17 15.333 L 17 15.333 C 17 15.794 16.627 16.167 16.167 16.167 L 10.611 16.167 C 10.151 16.167 9.778 15.794 9.778 15.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Google Sheets</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'map\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 11.82 6.504 C 14.029 6.504 15.82 8.282 15.82 10.476 C 15.82 10.698 15.801 10.915 15.766 11.127 C 15.359 14.488 13.033 16.581 12.155 17.261 C 12.051 17.341 11.976 17.437 11.82 17.437 C 11.663 17.437 11.586 17.34 11.481 17.258 C 10.6 16.576 8.28 14.483 7.873 11.127 C 7.838 10.915 7.82 10.698 7.82 10.476 C 7.82 8.282 9.61 6.504 11.82 6.504 Z M 9.486 10.644 C 9.486 11.933 10.531 12.977 11.82 12.977 C 13.108 12.977 14.153 11.933 14.153 10.644 C 14.153 9.355 13.108 8.311 11.82 8.311 C 10.531 8.311 9.486 9.355 9.486 10.644 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Map</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'signature-pad\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8.82 13.068 C 8.56 12.807 8.56 12.385 8.82 12.125 L 13.733 7.212 C 13.993 6.952 14.415 6.952 14.676 7.212 L 16.788 9.324 C 17.048 9.585 17.048 10.007 16.788 10.267 L 11.875 15.18 C 11.615 15.44 11.193 15.44 10.932 15.18 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.096 0.303 C 3.318 0.17 3.6 0.33 3.6 0.589 L 3.6 3.732 C 3.6 3.991 3.318 4.151 3.096 4.018 L 0.953 2.732 C 0.521 2.473 0.521 1.848 0.953 1.589 Z" transform="translate(6.24 13.8) rotate(-45 1.8 2.16)" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Signature Pad</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'sound-effects\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 14.225 10.793 C 14.471 11.102 14.623 11.529 14.623 12 C 14.623 12.471 14.471 12.898 14.225 13.207" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.224 9.185 C 16.96 9.911 17.417 10.905 17.417 12 C 17.417 13.095 16.96 14.09 16.224 14.816" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 6.083 10.656 C 6.083 10.288 6.382 9.989 6.75 9.989 L 7.674 9.989 L 11.021 7.835 C 11.464 7.549 12.048 7.868 12.048 8.396 L 12.048 15.604 C 12.048 16.132 11.464 16.451 11.021 16.165 L 7.674 14.011 L 6.75 14.011 C 6.382 14.011 6.083 13.712 6.083 13.344 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Sound Effects</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'card-swipe\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 3.423 7.423 C 3.423 5.214 5.214 3.423 7.423 3.423 L 16.756 3.423 C 18.965 3.423 20.756 5.214 20.756 7.423 L 20.756 16.756 C 20.756 18.965 18.965 20.756 16.756 20.756 L 7.423 20.756 C 5.214 20.756 3.423 18.965 3.423 16.756 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 9.172 3.377 C 10.734 1.815 13.266 1.815 14.828 3.377 L 20.721 9.269 C 22.283 10.831 22.283 13.364 20.721 14.926 L 14.828 20.819 C 13.266 22.381 10.734 22.381 9.172 20.819 L 3.279 14.926 C 1.717 13.364 1.717 10.831 3.279 9.269 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Card Swipe</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'custom-effect\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6.2 C 2 5.673 2.31 5.195 2.792 4.981 L 7.063 3.083 C 7.503 2.887 8 3.21 8 3.693 L 8 20.307 C 8 20.79 7.503 21.113 7.063 20.917 L 2.792 19.019 C 2.31 18.805 2 18.327 2 17.8 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 9.333 3.297 C 9.333 2.642 9.954 2.163 10.588 2.33 L 20.509 4.941 C 21.388 5.172 22 5.967 22 6.875 L 22 17.125 C 22 18.033 21.388 18.828 20.509 19.059 L 10.588 21.67 C 9.954 21.837 9.333 21.358 9.333 20.703 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Custom Effect</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'drag-handle\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 2.667 L 2.667 0 L 0 2.667" transform="translate(5.667 10.667) rotate(-90 2.667 1.333)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 5.333 0 L 2.667 2.667 L 0 0" transform="translate(13 10.667) rotate(-90 2.667 1.333)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Drag Handle</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'dynamic-header\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 8 L 2 8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Dynamic Header</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'image-panning\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 14 C 12 12.895 12.895 12 14 12 L 20 12 C 21.105 12 22 12.895 22 14 L 22 18 C 22 20.209 20.209 22 18 22 L 14 22 C 12.895 22 12 21.105 12 20 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Image Panning</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-data\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 10.333 C 16.667 10.886 16.219 11.333 15.667 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.667 12.667 C 16.219 12.667 16.667 13.114 16.667 13.667 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Input Data</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-validation\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 10.333 C 16.667 10.886 16.219 11.333 15.667 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.667 12.667 C 16.219 12.667 16.667 13.114 16.667 13.667 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Input Validation</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'like-animation\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.28 0 C 7.017 0 7.747 2.366 6.357 3.755 C 4.968 5.144 3.543 5.905 3.543 5.905 C 3.543 5.905 2.118 5.144 0.728 3.755 C -0.661 2.365 0.069 -0 1.806 0 C 3.543 0 3.543 1.701 3.543 1.701 C 3.543 1.701 3.543 0 5.28 0 Z" transform="translate(11.213 11.787) rotate(15 3.543 2.953)" fill="var(--svg-icon-tint)"></path><path d="M 5.28 0 C 7.017 -0 7.747 2.365 6.357 3.755 C 4.968 5.144 3.543 5.905 3.543 5.905 C 3.543 5.905 2.118 5.144 0.728 3.755 C -0.661 2.366 0.069 0 1.806 0 C 3.543 0 3.543 1.701 3.543 1.701 C 3.543 1.701 3.543 0 5.28 0 Z" transform="translate(5.701 6.669) rotate(-15 3.543 2.953)" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Like Animation</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'like-counter\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 14.778 7.333 C 17.556 7.333 18.724 11.072 16.502 13.268 C 14.279 15.464 12 16.667 12 16.667 C 12 16.667 9.721 15.464 7.498 13.268 C 5.276 11.072 6.444 7.333 9.222 7.333 C 12 7.333 12 10.022 12 10.022 C 12 10.022 12 7.333 14.778 7.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Like Counter</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'lock-screen\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 11 C 7.333 10.448 7.781 10 8.333 10 L 15.667 10 C 16.219 10 16.667 10.448 16.667 11 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 7.333 C 13.289 7.333 14.333 8.378 14.333 9.667 C 14.333 10.955 13.289 12 12 12 C 10.711 12 9.667 10.955 9.667 9.667 C 9.667 8.378 10.711 7.333 12 7.333 Z" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Lock Screen</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'long-press-menu\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 16.667 10.667 C 17.771 10.667 18.667 11.562 18.667 12.667 C 18.667 13.771 17.771 14.667 16.667 14.667 C 15.562 14.667 14.667 13.771 14.667 12.667 C 14.667 11.562 15.562 10.667 16.667 10.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12 8 C 13.105 8 14 8.895 14 10 C 14 11.105 13.105 12 12 12 C 10.895 12 10 11.105 10 10 C 10 8.895 10.895 8 12 8 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.333 10.667 C 8.438 10.667 9.333 11.562 9.333 12.667 C 9.333 13.771 8.438 14.667 7.333 14.667 C 6.229 14.667 5.333 13.771 5.333 12.667 C 5.333 11.562 6.229 10.667 7.333 10.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Long Press Menu</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'perspective-3d\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 6.913 22 C 5.987 22 5.182 21.364 4.967 20.463 L 2.586 10.463 C 2.287 9.206 3.24 8 4.532 8 L 19.468 8 C 20.76 8 21.713 9.206 21.414 10.463 L 19.033 20.463 C 18.818 21.364 18.013 22 17.087 22 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.833 7 C 3.557 7 3.333 6.776 3.333 6.5 L 3.333 6.5 C 3.333 5.672 4.005 5 4.833 5 L 19.167 5 C 19.995 5 20.667 5.672 20.667 6.5 L 20.667 6.5 C 20.667 6.776 20.443 7 20.167 7 Z" fill="var(--svg-icon-tint)" opacity="0.7"></path><path d="M 5.167 4 C 4.891 4 4.667 3.776 4.667 3.5 L 4.667 3.5 C 4.667 2.672 5.338 2 6.167 2 L 17.833 2 C 18.662 2 19.333 2.672 19.333 3.5 L 19.333 3.5 C 19.333 3.776 19.109 4 18.833 4 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Perspective 3D</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'progress-bar\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.153 17 C 5.153 16.08 5.899 15.333 6.82 15.333 L 16.82 15.333 C 17.74 15.333 18.486 16.08 18.486 17 L 18.486 17 C 18.486 17.92 17.74 18.667 16.82 18.667 L 6.82 18.667 C 5.899 18.667 5.153 17.92 5.153 17 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 5.153 17 C 5.153 16.08 5.899 15.333 6.82 15.333 L 11.486 15.333 C 12.407 15.333 13.153 16.08 13.153 17 L 13.153 17 C 13.153 17.92 12.407 18.667 11.486 18.667 L 6.82 18.667 C 5.899 18.667 5.153 17.92 5.153 17 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Progress Bar</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'scroll-progress\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 10.333 C 7.333 9.781 7.781 9.333 8.333 9.333 L 15.667 9.333 C 16.219 9.333 16.667 9.781 16.667 10.333 L 16.667 11.667 C 16.667 12.219 16.219 12.667 15.667 12.667 L 8.333 12.667 C 7.781 12.667 7.333 12.219 7.333 11.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 14.667 C 7.333 14.114 7.781 13.667 8.333 13.667 L 15.667 13.667 C 16.219 13.667 16.667 14.114 16.667 14.667 L 16.667 16 C 16.667 16.552 16.219 17 15.667 17 L 8.333 17 C 7.781 17 7.333 16.552 7.333 16 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 7.667 C 7.333 7.298 7.632 7 8 7 L 16 7 C 16.368 7 16.667 7.298 16.667 7.667 L 16.667 7.667 C 16.667 8.035 16.368 8.333 16 8.333 L 8 8.333 C 7.632 8.333 7.333 8.035 7.333 7.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 7.667 C 7.333 7.298 7.632 7 8 7 L 12.667 7 C 13.035 7 13.333 7.298 13.333 7.667 L 13.333 7.667 C 13.333 8.035 13.035 8.333 12.667 8.333 L 8 8.333 C 7.632 8.333 7.333 8.035 7.333 7.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Scroll Progress</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'show-password\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 10.6 12 C 10.6 11.227 11.227 10.6 12 10.6 L 12 10.6 C 12.773 10.6 13.4 11.227 13.4 12 L 13.4 12 C 13.4 12.773 12.773 13.4 12 13.4 L 12 13.4 C 11.227 13.4 10.6 12.773 10.6 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 12.166 7.833 C 14.892 7.833 17.161 9.42 17.811 12 C 17.161 14.58 14.892 16.167 12.166 16.167 C 9.44 16.167 7.127 14.58 6.478 12 C 7.127 9.42 9.44 7.833 12.166 7.833 Z M 9.333 12 C 9.333 13.473 10.527 14.667 12 14.667 C 13.473 14.667 14.667 13.473 14.667 12 C 14.667 10.527 13.473 9.333 12 9.333 C 10.527 9.333 9.333 10.527 9.333 12 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Show Password</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'slider\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.667 12 L 18.333 12" stroke="var(--svg-icon-tint)" fill="transparent" opacity="0.4" stroke-width="2.67" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 12 8.333 C 14.025 8.333 15.667 9.975 15.667 12 C 15.667 14.025 14.025 15.667 12 15.667 C 9.975 15.667 8.333 14.025 8.333 12 C 8.333 9.975 9.975 8.333 12 8.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Slider</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-drag\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 6.667 C 5.333 5.93 5.93 5.333 6.667 5.333 L 10 5.333 C 10.736 5.333 11.333 5.93 11.333 6.667 L 11.333 6.667 C 11.333 7.403 10.736 8 10 8 L 6.667 8 C 5.93 8 5.333 7.403 5.333 6.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.667 6.667 C 12.667 5.93 13.264 5.333 14 5.333 L 17.333 5.333 C 18.07 5.333 18.667 5.93 18.667 6.667 L 18.667 6.667 C 18.667 7.403 18.07 8 17.333 8 L 14 8 C 13.264 8 12.667 7.403 12.667 6.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Stories: Drag</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-tap\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 6.667 C 5.333 5.93 5.93 5.333 6.667 5.333 L 10 5.333 C 10.736 5.333 11.333 5.93 11.333 6.667 L 11.333 6.667 C 11.333 7.403 10.736 8 10 8 L 6.667 8 C 5.93 8 5.333 7.403 5.333 6.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 12.667 6.667 C 12.667 5.93 13.264 5.333 14 5.333 L 17.333 5.333 C 18.07 5.333 18.667 5.93 18.667 6.667 L 18.667 6.667 C 18.667 7.403 18.07 8 17.333 8 L 14 8 C 13.264 8 12.667 7.403 12.667 6.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Stories: Tap</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'toast-prompt\')">\n\t\t\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18.333 C 22 20.542 20.209 22.333 18 22.333 L 6 22.333 C 3.791 22.333 2 20.542 2 18.333 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 6.333 C 15.13 6.333 17.667 8.87 17.667 12 C 17.667 15.13 15.13 17.667 12 17.667 C 8.87 17.667 6.333 15.13 6.333 12 C 6.333 8.87 8.87 6.333 12 6.333 Z" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)"></path><path d="M 12 13 C 12.552 13 13 13.448 13 14 C 13 14.552 12.552 15 12 15 C 11.448 15 11 14.552 11 14 C 11 13.448 11.448 13 12 13 Z" fill="var(--svg-icon-tint)"></path><path d="M 11.06 9.998 C 11.027 9.457 11.458 9 12 9 L 12 9 C 12.542 9 12.973 9.457 12.94 9.998 L 12.848 11.535 C 12.821 11.983 12.449 12.333 12 12.333 L 12 12.333 C 11.551 12.333 11.179 11.983 11.152 11.535 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t\t\t<div class="title">Toast Prompt</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</li>\n\t\t\t\t\t--\x3e\n\t\t\t\t</ul>\n\t\t\t\t<ul class="nav--editor" *if="mode === 2">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_views\' | label"></div>\n\t\t\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t\t\t<li *for="let item of supportedViewTypes">\n\t\t\t\t\t\t\t\t<div class="btn" [class]="{ disabled: item.disabled }" (click)="onSelect({ type:\'view\', value: item.type.name })">\n\t\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.name"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<ul class="nav--editor" *if="mode === 3">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_view_items\' | label"></div>\n\t\t\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t\t\t<li *for="let item of supportedViewItemTypes">\n\t\t\t\t\t\t\t\t<div class="btn" [class]="{ disabled: item.disabled }" (click)="onSelect({ type:\'viewItem\', value: item.type.name })" [title]="item.id">\n\t\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.name"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<div class="abstract" *if="supportedViewItemTypes.length == 0" [innerHTML]="\'editor_type_no_items\' | label"></div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t'};var bl=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var e=this;this.platform=kn.platform,this.missingAr=!1,this.missingUsdz=!1,this.missingGltf=!1;var n=this.viewId=this.getViewId();n&&qi.viewById$(n).pipe(i.first()).subscribe((function(n){if(!n.ar)return e.missingAr=!0,void e.pushChanges();if(e.platform===wn){var i=e.getUsdzSrc(n);i?window.location.href=i:(e.missingUsdz=!0,e.pushChanges())}else if(null!==e.getGltfSrc(n)){var o=e.getModelViewerNode(n);t.getContext(e).node.appendChild(o)}else e.missingGltf=!0,e.pushChanges()}))},o.getUsdzSrc=function(t){return t.ar&&t.ar.usdz?E.getPath(t.ar.usdz.folder+t.ar.usdz.file):null},o.getGltfSrc=function(t){return t.ar&&t.ar.gltf?E.getPath(t.ar.gltf.folder+t.ar.gltf.file):null},o.getViewId=function(){var t=new $,e=null;return t.viewId&&(e=parseInt(t.viewId)),e},o.getModelViewerNode=function(t){var e=E.getPath(t.asset.folder+t.asset.file),n=this.getUsdzSrc(t),i=this.getGltfSrc(t),o='\n\t\t\t<model-viewer alt="'+t.name+'" skybox-image="'+e+'" ios-src="'+n+'" src="'+i+'" ar ar-modes="webxr scene-viewer quick-look" ar-scale="auto" camera-controls></model-viewer>\n\t\t',r=document.createElement("div");return r.innerHTML=o,r.firstElementChild},n}(t.Component);bl.meta={selector:"[try-in-ar]",template:'\n\t\t<div *if="platform != \'ios\'">\n\t\t\t<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"><\/script>\n\t\t\t<script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"><\/script>\n\t\t</div>\n\t\t<div class="ui" *if="!viewId">\n\t\t\t<div class="group--info">\n\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t<div class="info">Unknown url.</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ui" *if="missingAr">\n\t\t\t<div class="group--info">\n\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t<div class="info">Missing AR in view.</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ui" *if="missingUsdz">\n\t\t\t<div class="group--info">\n\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t<div class="info">Missing .usdz in ar.</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ui" *if="missingGltf">\n\t\t\t<div class="group--info">\n\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t<div class="info">Missing .gltf in ar.</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'};var wl=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onInit=function(){this.routes=[{name:"index",path:"/",forwardTo:"it"},{name:"it",path:"/it",defaultParams:{mode:"access"},factory:vn},{name:"it.meeting",path:"/tour-guidato?:link&:name&:role&:viewId&:pathId&:support",defaultParams:{mode:"guidedTour"},factory:el},{name:"it.access",path:"/accesso",defaultParams:{mode:"access"},factory:vn},{name:"it.accessCode",path:"/codice-di-accesso",defaultParams:{mode:"accessCode"},factory:Qt},{name:"it.guidedTour",path:"/tour-guidato",defaultParams:{mode:"guidedTour"},factory:el},{name:"it.selfServiceTour",path:"/tour-self-service",defaultParams:{mode:"selfServiceTour"},factory:el},{name:"it.embed",path:"/embed",defaultParams:{mode:"embed"},factory:el},{name:"it.tryInAr",path:"/try-in-ar",defaultParams:{mode:"tryInAr"},factory:bl},{name:"it.editor",path:"/editor",defaultParams:{mode:"editor"},factory:gl},{name:"en",path:"/en",defaultParams:{mode:"access"},factory:vn}],t.getContext(this).node.classList.remove("hidden")},n}(t.Component);wl.meta={selector:"[app-component]",template:'\n\t\t\x3c!-- svg --\x3e\n\t\t\n\t\t<svg width="0" height="0" class="hidden" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true">\n\t\t\t<symbol id="arrow-down" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="arrow-next" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="arrow-prev" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="call" viewBox="0 0 24 24">\n\t\t\t\t<path d="M20 22.621l-3.521-6.795c-.008.004-1.974.97-2.064 1.011-2.24 1.086-6.799-7.82-4.609-8.994l2.083-1.026-3.493-6.817-2.106 1.039c-7.202 3.755 4.233 25.982 11.6 22.615.121-.055 2.102-1.029 2.11-1.033z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="heart" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="heart-outline" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 9.229c.234-1.12 1.547-6.229 5.382-6.229 2.22 0 4.618 1.551 4.618 5.003 0 3.907-3.627 8.47-10 12.629-6.373-4.159-10-8.722-10-12.629 0-3.484 2.369-5.005 4.577-5.005 3.923 0 5.145 5.126 5.423 6.231zm-12-1.226c0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-7.962-9.648-9.028-12-3.737-2.338-5.262-12-4.27-12 3.737z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="cam" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16 18c0 1.104-.896 2-2 2h-12c-1.105 0-2-.896-2-2v-12c0-1.104.895-2 2-2h12c1.104 0 2 .896 2 2v12zm8-14l-6 6.223v3.554l6 6.223v-16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="cam-muted" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0.7,19.5L15.5,4.7C15.1,4.3,14.6,4,14,4H2C0.9,4,0,4.9,0,6v12C0,18.6,0.3,19.1,0.7,19.5z"></path>\n\t\t\t\t<path d="M18 13.8L24 20 24 4 18 10.2z"></path>\n\t\t\t\t<path d="M7.8,20H14c1.1,0,2-0.9,2-2v-6.2L7.8,20z"></path>\n\t\t\t\t<path d="M-3.4 11.2H27.400000000000002V12.7H-3.4z" transform="rotate(-45.001 12 12)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="mic" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16 11c0 2.209-1.791 4-4 4s-4-1.791-4-4v-7c0-2.209 1.791-4 4-4s4 1.791 4 4v7zm4-2v2c0 4.418-3.582 8-8 8s-8-3.582-8-8v-2h2v2c0 3.309 2.691 6 6 6s6-2.691 6-6v-2h2zm-7 13v-2h-2v2h-4v2h10v-2h-4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="mic-muted" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16,11.4L12.4,15C14.3,14.8,15.8,13.3,16,11.4z"></path>\n\t\t\t\t<path d="M16,4.6V4c0-2.2-1.8-4-4-4S8,1.8,8,4v7c0,0.5,0.1,0.9,0.3,1.4L16,4.6z"></path>\n\t\t\t\t<path d="M13 20L11 20 11 22 7 22 7 24 17 24 17 22 13 22z"></path>\n\t\t\t\t<path d="M18,11c0,3.3-2.7,6-6,6c-0.5,0-1-0.1-1.4-0.2L9,18.4c0.9,0.4,2,0.6,3,0.6c4.4,0,8-3.6,8-8V9h-2V11z"></path>\n\t\t\t\t<path d="M6.7,13.9C6.3,13,6,12,6,11V9H4v2c0,1.6,0.5,3.1,1.3,4.3L6.7,13.9z"></path>\n\t\t\t\t<path d="M-3.4 11.2H27.400000000000002V12.7H-3.4z" transform="rotate(-45.001 12 12)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="gamepad" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17.622 3c-1.913 0-2.558 1.382-5.623 1.382-3.009 0-3.746-1.382-5.623-1.382-5.209 0-6.376 10.375-6.376 14.348 0 2.145.817 3.652 2.469 3.652 3.458 0 2.926-5 6.915-5h5.23c3.989 0 3.457 5 6.915 5 1.652 0 2.471-1.506 2.471-3.651 0-3.973-1.169-14.349-6.378-14.349zm-10.622 10c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zm10-6c.552 0 1 .447 1 1 0 .553-.448 1-1 1s-1-.447-1-1c0-.553.448-1 1-1zm-2 4c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm2 2c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm2-2c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm-10.25-1c0 .965-.785 1.75-1.75 1.75s-1.75-.785-1.75-1.75.785-1.75 1.75-1.75 1.75.785 1.75 1.75z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="ar" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 0l-11 6v12.131l11 5.869 11-5.869v-12.066l-11-6.065zm7.91 6.646l-7.905 4.218-7.872-4.294 7.862-4.289 7.915 4.365zm-16.91 1.584l8 4.363v8.607l-8-4.268v-8.702zm10 12.97v-8.6l8-4.269v8.6l-8 4.269zm6.678-5.315c.007.332-.256.605-.588.612-.332.007-.604-.256-.611-.588-.006-.331.256-.605.588-.612.331-.007.605.256.611.588zm-2.71-1.677c-.332.006-.595.28-.588.611.006.332.279.595.611.588s.594-.28.588-.612c-.007-.331-.279-.594-.611-.587zm-2.132-1.095c-.332.007-.595.281-.588.612.006.332.279.594.611.588.332-.007.594-.28.588-.612-.007-.331-.279-.594-.611-.588zm-9.902 2.183c.332.007.594.281.588.612-.007.332-.279.595-.611.588-.332-.006-.595-.28-.588-.612.005-.331.279-.594.611-.588zm1.487-.5c-.006.332.256.605.588.612s.605-.257.611-.588c.007-.332-.256-.605-.588-.611-.332-.008-.604.255-.611.587zm2.132-1.094c-.006.332.256.605.588.612.332.006.605-.256.611-.588.007-.332-.256-.605-.588-.612-.332-.007-.604.256-.611.588zm3.447-5.749c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6zm0-2.225c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6zm0-2.031c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="close" viewBox="0 0 24 24">\n\t\t\t\t<path d="M23 20.168l-8.185-8.187 8.185-8.174-2.832-2.807-8.182 8.179-8.176-8.179-2.81 2.81 8.186 8.196-8.186 8.184 2.81 2.81 8.203-8.192 8.18 8.192z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="vr" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22.3,4.3H1.7C0.8,4.3,0,5.1,0,6v12c0,0.9,0.8,1.7,1.7,1.7h5.6c0.7,0,1.4-0.5,1.6-1.2l1.4-4.2c0.5-1.6,2.7-1.6,3.3,0 l1.4,4.2c0.2,0.7,0.9,1.2,1.6,1.2h5.6c0.9,0,1.7-0.8,1.7-1.7V6C24,5.1,23.2,4.3,22.3,4.3z M6,14.6c-1.4,0-2.6-1.2-2.6-2.6 S4.6,9.4,6,9.4s2.6,1.2,2.6,2.6S7.4,14.6,6,14.6z M18,14.6c-1.4,0-2.6-1.2-2.6-2.6s1.2-2.6,2.6-2.6s2.6,1.2,2.6,2.6 S19.4,14.6,18,14.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="vr-02" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22.5,8.6c-0.3,0-0.6,0.1-0.8,0.3c-0.3-1.9-1.9-3.4-3.9-3.4H6.2c-2,0-3.6,1.5-3.9,3.4C2,8.7,1.7,8.6,1.4,8.6 C0.6,8.6,0,9.3,0,10.1v3.9c0,0.8,0.6,1.4,1.4,1.4c0.3,0,0.6-0.1,0.8-0.3c0.3,1.9,1.9,3.4,3.9,3.4h11.6c2,0,3.6-1.5,3.9-3.4 c0.2,0.2,0.5,0.3,0.8,0.3c0.8,0,1.4-0.6,1.4-1.4v-3.9C24,9.3,23.3,8.6,22.5,8.6z M20.7,14.6c0,1.6-1.3,2.8-2.8,2.8H6.2 c-1.6,0-2.8-1.3-2.8-2.8V9.4c0-1.6,1.3-2.8,2.8-2.8h11.6c1.6,0,2.8,1.3,2.8,2.8V14.6z"></path><circle cx="5.7" cy="8.7" r=".8"></circle><circle cx="18.3" cy="8.6" r=".8"></circle><circle cx="5.7" cy="15.4" r=".8"></circle><circle cx="18.3" cy="15.3" r=".8"></circle>\n\t\t\t</symbol>\n\t\t\t<symbol id="the-spy" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17,14c-1.8,0-3.3,1.3-3.7,3h-2.5c-0.5-2.1-2.5-3.4-4.6-2.9c-2.1,0.5-3.4,2.5-2.9,4.6s2.5,3.4,4.6,2.9 c1.4-0.3,2.6-1.5,2.9-2.9h2.5c0.5,2.1,2.5,3.4,4.6,2.9s3.4-2.5,2.9-4.6C20.4,15.3,18.8,14,17,14z"></path>\n\t\t\t\t<path d="M23.2,11.5h-2.6V6c0-0.7-0.5-1.4-1.2-1.6l-5.5-1.8c-1.2-0.4-2.6-0.4-3.8,0L4.6,4.4C3.9,4.6,3.4,5.3,3.4,6v5.4H0.8 c-0.5,0-0.8,0.4-0.8,0.8s0.4,0.8,0.8,0.8h22.3c0.5,0,0.8-0.4,0.8-0.8S23.6,11.5,23.2,11.5z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spy-eye" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,19.6c-4.6,0-8.9-3.5-11.7-6.8c-0.4-0.5-0.4-1.2,0-1.6C3.1,7.9,7.4,4.4,12,4.4s8.9,3.5,11.7,6.8 c0.4,0.5,0.4,1.2,0,1.6C20.9,16.1,16.6,19.6,12,19.6z M12,7.5c2.5,0,4.4,1.9,4.4,4.4s-1.9,4.4-4.4,4.4s-4.4-1.9-4.4-4.4 S9.5,7.5,12,7.5z" clip-rule="evenodd"></path>\n\t\t\t\t<path d="M12,9.3c1.4,0,2.6,1.2,2.6,2.6s-1.2,2.6-2.6,2.6s-2.6-1.2-2.6-2.6S10.6,9.3,12,9.3z" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="copy" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7 16h10v1h-10v-1zm0-1h10v-1h-10v1zm15-13v22h-20v-22h3c1.229 0 2.18-1.084 3-2h8c.82.916 1.771 2 3 2h3zm-11 1c0 .552.448 1 1 1s1-.448 1-1-.448-1-1-1-1 .448-1 1zm9 1h-4l-2 2h-3.898l-2.102-2h-4v18h16v-18zm-13 9h10v-1h-10v1zm0-2h10v-1h-10v1z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="menu" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="menu-light" viewBox="0 0 24 24">\n\t\t\t\t<path d="M14 19h-14v-1h14v1zm9.247-8.609l-3.247 4.049-3.263-4.062-.737.622 4 5 4-5-.753-.609zm-9.247 2.609h-14v-1h14v1zm0-6h-14v-1h14v1z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="settings" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 14.187v-4.374c-2.148-.766-2.726-.802-3.027-1.529-.303-.729.083-1.169 1.059-3.223l-3.093-3.093c-2.026.963-2.488 1.364-3.224 1.059-.727-.302-.768-.889-1.527-3.027h-4.375c-.764 2.144-.8 2.725-1.529 3.027-.752.313-1.203-.1-3.223-1.059l-3.093 3.093c.977 2.055 1.362 2.493 1.059 3.224-.302.727-.881.764-3.027 1.528v4.375c2.139.76 2.725.8 3.027 1.528.304.734-.081 1.167-1.059 3.223l3.093 3.093c1.999-.95 2.47-1.373 3.223-1.059.728.302.764.88 1.529 3.027h4.374c.758-2.131.799-2.723 1.537-3.031.745-.308 1.186.099 3.215 1.062l3.093-3.093c-.975-2.05-1.362-2.492-1.059-3.223.3-.726.88-.763 3.027-1.528zm-4.875.764c-.577 1.394-.068 2.458.488 3.578l-1.084 1.084c-1.093-.543-2.161-1.076-3.573-.49-1.396.581-1.79 1.693-2.188 2.877h-1.534c-.398-1.185-.791-2.297-2.183-2.875-1.419-.588-2.507-.045-3.579.488l-1.083-1.084c.557-1.118 1.066-2.18.487-3.58-.579-1.391-1.691-1.784-2.876-2.182v-1.533c1.185-.398 2.297-.791 2.875-2.184.578-1.394.068-2.459-.488-3.579l1.084-1.084c1.082.538 2.162 1.077 3.58.488 1.392-.577 1.785-1.69 2.183-2.875h1.534c.398 1.185.792 2.297 2.184 2.875 1.419.588 2.506.045 3.579-.488l1.084 1.084c-.556 1.121-1.065 2.187-.488 3.58.577 1.391 1.689 1.784 2.875 2.183v1.534c-1.188.398-2.302.791-2.877 2.183zm-7.125-5.951c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.762 0-5 2.238-5 5s2.238 5 5 5 5-2.238 5-5-2.238-5-5-5z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="settings-full" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 13.616v-3.232l-2.869-1.02c-.198-.687-.472-1.342-.811-1.955l1.308-2.751-2.285-2.285-2.751 1.307c-.613-.339-1.269-.613-1.955-.811l-1.021-2.869h-3.232l-1.021 2.869c-.686.198-1.342.471-1.955.811l-2.751-1.308-2.285 2.285 1.308 2.752c-.339.613-.614 1.268-.811 1.955l-2.869 1.02v3.232l2.869 1.02c.197.687.472 1.342.811 1.955l-1.308 2.751 2.285 2.286 2.751-1.308c.613.339 1.269.613 1.955.811l1.021 2.869h3.232l1.021-2.869c.687-.198 1.342-.472 1.955-.811l2.751 1.308 2.285-2.286-1.308-2.751c.339-.613.613-1.268.811-1.955l2.869-1.02zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="emoji" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z M12,0C5.4,0,0,5.4,0,12s5.4,12,12,12s12-5.4,12-12 S18.6,0,12,0z M18,14H6c0.3,1.5,2.8,4,6,4C15.1,18,17.7,15.5,18,14z M8.5,8C7.7,8,7,8.7,7,9.5S7.7,11,8.5,11S10,10.3,10,9.5 S9.3,8,8.5,8z M15.5,8C14.7,8,14,8.7,14,9.5s0.7,1.5,1.5,1.5c0.8,0,1.5-0.7,1.5-1.5S16.3,8,15.5,8z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="pencil" viewBox="0 0 24 24">\n\t\t\t\t<path d="M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="erase" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5.662 23l-5.369-5.365c-.195-.195-.293-.45-.293-.707 0-.256.098-.512.293-.707l14.929-14.928c.195-.194.451-.293.707-.293.255 0 .512.099.707.293l7.071 7.073c.196.195.293.451.293.708 0 .256-.097.511-.293.707l-11.216 11.219h5.514v2h-12.343zm3.657-2l-5.486-5.486-1.419 1.414 4.076 4.072h2.829zm.456-11.429l-4.528 4.528 5.658 5.659 4.527-4.53-5.657-5.657z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="move" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 10c1.104 0 2 .896 2 2s-.896 2-2 2-2-.896-2-2 .896-2 2-2zm-3.857 3c-.084-.321-.143-.652-.143-1s.059-.679.143-1h-2.143v-4l-6 5 6 5v-4h2.143zm7.714-2c.084.321.143.652.143 1s-.059.679-.143 1h2.143v4l6-5-6-5v4h-2.143zm-2.857 4.857c-.321.084-.652.143-1 .143s-.679-.059-1-.143v2.143h-4l5 6 5-6h-4v-2.143zm-2-7.714c.321-.084.652-.143 1-.143s.679.059 1 .143v-2.143h4l-5-6-5 6h4v2.143z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="caret-down" viewBox="0 0 8 5">\n\t\t\t\t<path d="M0 0h8L4 5 0 0z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="caret-right" viewBox="0 0 8 12">\n\t\t\t\t<path d="M0 12V0l8 6-8 6z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="websolute" viewBox="0 0 20 20">\n\t\t\t\t<path d="M20 10c0 5.5-4.5 10-10 10S0 15.5 0 10 4.5 0 10 0s10 4.5 10 10m-10 2.3c.5.5 1.3.8 2.1.8s1.5-.3 2.1-.8c.5-.5.8-1.2.8-2V7.5h-1.7v2.8c0 .3-.1.6-.4.8-.1.1-.3.2-.4.3-.2.1-.3.1-.5.1s-.3 0-.5-.1c-.1-.1-.3-.2-.4-.3-.2-.2-.4-.5-.4-.8V7.6H9.2v2.8c0 .3-.1.6-.4.9-.2.2-.5.4-.8.4-.3 0-.7-.1-.9-.3-.2-.2-.4-.5-.3-.8V7.5H5v2.8c0 .7.3 1.5.8 2 .6.5 1.3.8 2.1.8.8.1 1.6-.2 2.1-.8z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="search" viewBox="0 0 21 23">\n\t\t\t\t<path d="M20.6 20.3l-4.9-5.2c1.2-1.7 1.8-3.7 1.8-5.7 0-5.2-3.9-9.4-8.7-9.4S0 4.2 0 9.4s3.7 7.8 6.3 8.4c1.8.4 3.9.6 7.1-.7l5.1 5.4c.5.6 1.4.6 2 .1l.1-.1c.5-.6.5-1.6 0-2.2zM15 9.4c-.2 3.5-3.2 6.1-6.7 5.8S2.2 12 2.5 8.5c.2-3.3 3-5.8 6.3-5.8 3.5.1 6.3 3.1 6.2 6.7z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="result-indicator" viewBox="0 0 24 24">\n\t\t\t\t<path d="M11 21.883l-6.235-7.527-.765.644 7.521 9 7.479-9-.764-.645-6.236 7.529v-21.884h-1v21.883z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="bullet" viewBox="0 0 18 18">\n\t\t\t\t<path d="M9 2c3.9 0 7 3.1 7 7s-3.1 7-7 7-7-3.1-7-7 3.1-7 7-7m0-2C4 0 0 4 0 9s4 9 9 9 9-4 9-9-4-9-9-9z" opacity=".15" fill="#17265a"></path>\n\t\t\t\t<circle cx="9" cy="9" r="4" fill="#17265a"></circle>\n\t\t\t</symbol>\n\t\t\t<symbol id="play" viewBox="0 0 16 20">\n\t\t\t\t<path d="M0,0v19.8l15.4-11L0,0z" fill-rule="evenodd" clip-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="play-progress" viewBox="0 0 196 196">\n\t\t\t\t<path d="M195.5,98c0,53.8-43.7,97.5-97.5,97.5S0.5,151.8,0.5,98S44.2,0.5,98,0.5S195.5,44.2,195.5,98z" stroke-width="2px" stroke-linecap="square" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="pause" viewBox="0 0 16 20">\n\t\t\t\t<path d="M0 0.9H4V18.9H0z"></path>\n\t\t\t\t<path d="M11.4 0.9H15.4V18.9H11.4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist-add" viewBox="0 0 25 20">\n\t\t\t\t<path d="M12.5,20.8c-0.3,0-0.5-0.1-0.8-0.3c-0.3-0.2-0.6-0.4-0.9-0.6c-0.7-0.5-1.4-0.9-2.1-1.5 c-1.1-0.8-2.1-1.6-3.1-2.4C4.2,15,3,13.8,1.9,12.4c-0.9-1.1-1.4-2.3-1.7-3.7C0.1,8.5,0.1,8.2,0,7.9l0-0.2l0.1-1.4 c0-0.1,0.1-0.3,0.1-0.4c0.1-0.3,0.1-0.7,0.3-1c0.6-1.7,1.8-3.2,3.4-4c1.5-0.8,3.3-1.1,5-0.8c1.4,0.2,2.6,0.8,3.7,1.7 c2.9-2.4,7.2-2.4,10,0.1c1.1,0.9,1.9,2.2,2.2,3.5c0.1,0.3,0.1,0.6,0.2,0.8L25,6.7l-0.1,1.4c-0.2,1.2-0.6,2.4-1.2,3.4 c-0.5,0.8-1.1,1.6-1.8,2.3c-0.8,0.9-1.7,1.7-2.6,2.5c-0.7,0.6-1.6,1.3-2.6,2c-0.8,0.5-1.5,1.1-2.3,1.6c-0.4,0.3-0.8,0.5-1.2,0.8 C13.1,20.8,12.8,20.8,12.5,20.8z M2.1,7.6c0,0.2,0.1,0.4,0.1,0.6c0.2,1.1,0.7,2,1.4,2.9c1,1.2,2.1,2.3,3.3,3.3c1,0.8,2,1.6,3,2.4 c0.7,0.5,1.4,0.9,2.1,1.4l0.5,0.3c0.2-0.2,0.5-0.3,0.7-0.5c0.8-0.5,1.5-1,2.3-1.6c0.9-0.7,1.8-1.4,2.5-1.9c0.9-0.7,1.7-1.5,2.4-2.3 c0.6-0.6,1.1-1.2,1.5-1.9c0.5-0.8,0.8-1.7,0.9-2.6c0-0.1,0-0.1,0-0.2l0-0.9c0-0.2-0.1-0.4-0.1-0.6c-0.3-1-0.8-1.9-1.6-2.5 c-2.1-1.8-5.2-1.8-7.3,0c-0.1,0.1-0.3,0.2-0.4,0.4l-0.9,1.2l-1-1.3c-0.8-0.8-1.9-1.4-3-1.6C7.2,2,5.9,2.2,4.9,2.8 c-1.1,0.6-2,1.6-2.4,2.8C2.4,5.9,2.3,6.1,2.3,6.4c0,0.1-0.1,0.3-0.1,0.4l0,0L2.1,7.6L2.1,7.6z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist-added" viewBox="0 0 25 20">\n\t\t\t\t<path d="M12.5,20.8c-0.3,0-0.5-0.1-0.8-0.3c-0.3-0.2-0.6-0.4-0.9-0.6c-0.7-0.5-1.4-0.9-2.1-1.5 c-1.1-0.8-2.1-1.6-3.1-2.4c-1.4-1-2.6-2.2-3.7-3.6C1,11.3,0.5,10.1,0.2,8.7C0.1,8.5,0.1,8.2,0,7.9V7.7l0.1-1.4 c0-0.1,0.1-0.3,0.1-0.4c0.1-0.3,0.1-0.7,0.3-1c0.6-1.7,1.8-3.2,3.4-4c1.5-0.8,3.3-1.1,5-0.8c1.4,0.2,2.6,0.8,3.7,1.7 c2.9-2.4,7.2-2.4,10,0.1c1.1,0.9,1.9,2.2,2.2,3.5C24.9,5.7,24.9,6,25,6.2v0.5l-0.1,1.4c-0.2,1.2-0.6,2.4-1.2,3.4 c-0.5,0.8-1.1,1.6-1.8,2.3c-0.8,0.9-1.7,1.7-2.6,2.5c-0.7,0.6-1.6,1.3-2.6,2c-0.8,0.5-1.5,1.1-2.3,1.6c-0.4,0.3-0.8,0.5-1.2,0.8 C13.1,20.8,12.8,20.8,12.5,20.8z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist" viewBox="0 0 16 14">\n\t\t\t\t<path d="M8,14c-0.2,0-0.3-0.1-0.5-0.2l-0.6-0.4c-0.5-0.3-0.9-0.6-1.4-1c-0.7-0.5-1.4-1.1-2-1.6 c-0.9-0.7-1.6-1.6-2.3-2.5C0.7,7.6,0.3,6.8,0.1,5.9c0-0.2-0.1-0.4-0.1-0.5l0-0.1l0-1c0-0.1,0-0.2,0.1-0.3c0.1-0.2,0.1-0.4,0.2-0.7 c0.4-1.1,1.2-2.1,2.2-2.7c1.8-1,4-0.8,5.5,0.6c1.8-1.6,4.6-1.6,6.4,0.1c0.7,0.6,1.2,1.5,1.4,2.4C15.9,3.8,15.9,4,16,4.2l0,0.3l0,0.9 c-0.1,0.8-0.4,1.6-0.8,2.3c-0.3,0.5-0.7,1-1.1,1.5c-0.5,0.6-1.1,1.1-1.7,1.7c-0.4,0.4-1,0.9-1.7,1.3c-0.5,0.4-1,0.7-1.5,1.1 c-0.2,0.2-0.5,0.3-0.7,0.5C8.4,13.9,8.2,14,8,14z M1.4,5.1c0,0.1,0.1,0.3,0.1,0.4c0.1,0.7,0.4,1.4,0.9,1.9C2.9,8.3,3.6,9,4.4,9.7 c0.6,0.5,1.3,1.1,1.9,1.6c0.4,0.3,0.9,0.6,1.3,0.9c0.1,0.1,0.2,0.2,0.3,0.2c0.2-0.1,0.3-0.2,0.5-0.3c0.5-0.3,1-0.7,1.5-1 c0.6-0.4,1.2-0.9,1.6-1.3c0.5-0.5,1.1-1,1.5-1.5c0.4-0.4,0.7-0.8,1-1.3c0.3-0.5,0.5-1.1,0.6-1.7c0,0,0-0.1,0-0.1l0-0.6 c0-0.1,0-0.3-0.1-0.4c-0.2-0.7-0.5-1.2-1-1.7c-1.3-1.2-3.4-1.2-4.7,0C8.7,2.4,8.6,2.5,8.5,2.6L8,3.4L7.3,2.5 C6.3,1.4,4.5,1.1,3.1,1.9C2.4,2.3,1.8,3,1.6,3.8C1.5,3.9,1.5,4.1,1.4,4.3L1.4,4.6l0,0L1.4,5.1L1.4,5.1z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="expand" viewBox="0 0 29 30">\n\t\t\t\t<path d="M26 16.3V5.9L2.2 29.7.1 27.6 24 3.3H13v-3h16v16h-3z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="download" viewBox="0 0 9 13">\n\t\t\t\t<path d="M8.5 7.9c-.3-.4-.8-.4-1.2-.1l-.1.1-2 2V1.2c0-.2-.1-.4-.2-.6-.2-.3-.7-.3-1 0-.2.2-.3.4-.3.6v8.6l-2-2c-.2-.1-.4-.2-.7-.2-.2 0-.4.1-.6.3-.1.2-.1.4-.1.6 0 .2.1.4.2.5l3.4 3.4c.2.2.4.2.6.2.2 0 .4-.1.6-.2L8.4 9c.2-.1.2-.3.3-.6 0-.1-.1-.4-.2-.5z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="upload" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10 9H4l8-9 8 9h-6v11h-4V9zm11 11v2H3v-2H1v4h22v-4h-2z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="user" viewBox="0 0 24 24">\n\t\t\t\t<path d="M20.822 18.096c-3.439-.794-6.64-1.49-5.09-4.418C20.452 4.766 16.983 0 12 0 6.918 0 3.536 4.949 8.268 13.678c1.597 2.945-1.725 3.641-5.09 4.418C.105 18.806-.01 20.332 0 23l.004 1h23.99l.004-.969c.012-2.688-.092-4.222-3.176-4.935z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="back" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2.117 12l7.527 6.235L9 19l-9-7.521L9 4l.645.764L2.116 11H24v1H2.117z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="add" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="remove" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 10h24v4h-24z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="link" viewBox="0 0 24 24">\n\t\t\t\t<path d="M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="up" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7 11h-6l11-11 11 11h-6v13h-10z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="down" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17,13h6L12,24L1,13h6V0h10V13z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="waiting-room" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2,6c0-2.2,1.8-4,4-4h12c2.2,0,4,1.8,4,4v12c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6z" opacity=".2"></path>\n\t\t\t\t<path d="M17.8,10.7c0.7,0,1.3,0.6,1.3,1.3s-0.6,1.3-1.3,1.3H6.2c-0.7,0-1.3-0.6-1.3-1.3s0.6-1.3,1.3-1.3H17.8z M19.7,12 c0-1.1-0.9-1.9-1.9-1.9H6.2c-1.1,0-1.9,0.9-1.9,1.9s0.9,1.9,1.9,1.9h11.6C18.9,13.9,19.7,13.1,19.7,12z M13.9,11.4H6.2 c-0.4,0-0.6,0.3-0.6,0.6s0.3,0.6,0.6,0.6h7.7c0.4,0,0.6-0.3,0.6-0.6S14.3,11.4,13.9,11.4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="panorama" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 9 15 C 9 14.448 9.448 14 10 14 L 14 14 C 14.552 14 15 14.448 15 15 L 15 16 C 15 16.552 14.552 17 14 17 L 10 17 C 9.448 17 9 16.552 9 16 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 7 8 C 7 7.448 7.448 7 8 7 L 16 7 C 16.552 7 17 7.448 17 8 L 17 12 C 17 12.552 16.552 13 16 13 L 8 13 C 7.448 13 7 12.552 7 12 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="panorama-grid" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 10.333 7.333 C 10.886 7.333 11.333 7.781 11.333 8.333 L 11.333 10.333 C 11.333 10.886 10.886 11.333 10.333 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 12.333 8.333 C 12.333 7.781 12.781 7.333 13.333 7.333 L 15.333 7.333 C 15.886 7.333 16.333 7.781 16.333 8.333 L 16.333 10.333 C 16.333 10.886 15.886 11.333 15.333 11.333 L 13.333 11.333 C 12.781 11.333 12.333 10.886 12.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 10.333 12.667 C 10.886 12.667 11.333 13.114 11.333 13.667 L 11.333 15.667 C 11.333 16.219 10.886 16.667 10.333 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t\t<path d="M 12.333 13.667 C 12.333 13.114 12.781 12.667 13.333 12.667 L 15.333 12.667 C 15.886 12.667 16.333 13.114 16.333 13.667 L 16.333 15.667 C 16.333 16.219 15.886 16.667 15.333 16.667 L 13.333 16.667 C 12.781 16.667 12.333 16.219 12.333 15.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="room-3d" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 6.6 9.056 C 6.6 8.533 6.905 8.059 7.381 7.842 L 8.995 7.108 C 9.436 6.907 9.938 7.23 9.938 7.715 L 9.938 16.272 C 9.938 16.757 9.436 17.08 8.995 16.879 L 7.381 16.145 C 6.905 15.928 6.6 15.454 6.6 14.931 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 10.754 7.453 C 10.754 6.795 11.378 6.316 12.014 6.487 L 16.32 7.647 C 17.193 7.882 17.8 8.674 17.8 9.578 L 17.8 14.105 C 17.8 15.009 17.193 15.801 16.32 16.036 L 12.014 17.196 C 11.378 17.367 10.754 16.889 10.754 16.231 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="model" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M 11.298 7.283 C 11.602 6.729 12.398 6.729 12.702 7.283 L 14.009 9.673 C 14.082 9.807 14.193 9.918 14.327 9.991 L 16.717 11.298 C 17.271 11.602 17.271 12.398 16.717 12.702 L 14.327 14.009 C 14.193 14.082 14.082 14.193 14.009 14.327 L 12.702 16.717 C 12.398 17.271 11.602 17.271 11.298 16.717 L 9.991 14.327 C 9.918 14.193 9.807 14.082 9.673 14.009 L 7.283 12.702 C 6.729 12.398 6.729 11.602 7.283 11.298 L 9.673 9.991 C 9.807 9.918 9.918 9.807 9.991 9.673 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="media" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2,6c0-2.2,1.8-4,4-4h12c2.2,0,4,1.8,4,4v12c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M12,19c-2.2,0-4.3-1-5.6-2.7L7,15.9c1.2,1.5,3,2.4,5,2.4c1.9,0,3.8-0.9,5-2.4l0.6,0.4C16.3,18,14.2,19,12,19z M5.5,14.7C5.2,13.8,5,12.8,5,12c0-3.5,2.7-6.5,6.2-7v0.6C8,6.1,5.7,8.8,5.7,12c0,0.8,0.1,1.5,0.4,2.4L5.5,14.7z M18,14.4 c0.3-0.8,0.4-1.6,0.4-2.4c0-3.2-2.3-5.9-5.5-6.4c0-0.2,0-0.5,0-0.6c3.5,0.4,6.2,3.4,6.2,7c0,0.8-0.2,1.8-0.5,2.7L18,14.4z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M10.2,15V8.9l5.5,3.1L10.2,15z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="nav" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 6.5 8.667 C 6.5 8.114 6.948 7.667 7.5 7.667 L 16.5 7.667 C 17.052 7.667 17.5 8.114 17.5 8.667 L 17.5 14.495 C 17.5 15.046 17.053 15.494 16.502 15.495 L 14.189 15.499 C 13.959 15.5 13.736 15.58 13.558 15.725 L 12.211 16.827 C 12.088 16.928 11.912 16.928 11.789 16.827 L 10.442 15.725 C 10.264 15.58 10.041 15.5 9.811 15.499 L 7.498 15.495 C 6.947 15.494 6.5 15.046 6.5 14.495 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="plane" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(4.667 11.5) rotate(-90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(17.333 11.5) rotate(90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 8 9 C 8 8.448 8.448 8 9 8 L 15 8 C 15.552 8 16 8.448 16 9 L 16 15 C 16 15.552 15.552 16 15 16 L 9 16 C 8.448 16 8 15.552 8 15 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="curved-plane" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(4.667 11.5) rotate(-90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(17.333 11.5) rotate(90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 8 9 C 8 8.448 8.448 8 9 8 L 15 8 C 15.552 8 16 8.448 16 9 L 16 15 C 16 15.552 15.552 16 15 16 L 9 16 C 8.448 16 8 15.552 8 15 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="texture" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 7.333 8.95 C 7.333 8.274 7.839 7.705 8.511 7.626 L 14.805 6.886 C 15.796 6.769 16.667 7.543 16.667 8.541 L 16.667 15.49 C 16.667 16.477 15.814 17.247 14.833 17.148 L 8.533 16.513 C 7.852 16.444 7.333 15.871 7.333 15.187 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="gltf" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M 11.298 7.283 C 11.602 6.729 12.398 6.729 12.702 7.283 L 14.009 9.673 C 14.082 9.807 14.193 9.918 14.327 9.991 L 16.717 11.298 C 17.271 11.602 17.271 12.398 16.717 12.702 L 14.327 14.009 C 14.193 14.082 14.082 14.193 14.009 14.327 L 12.702 16.717 C 12.398 17.271 11.602 17.271 11.298 16.717 L 9.991 14.327 C 9.918 14.193 9.807 14.082 9.673 14.009 L 7.283 12.702 C 6.729 12.398 6.729 11.602 7.283 11.298 L 9.673 9.991 C 9.807 9.918 9.918 9.807 9.991 9.673 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="tile" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 15.667 13 C 17.139 13 18.333 14.194 18.333 15.667 C 18.333 17.139 17.139 18.333 15.667 18.333 C 14.194 18.333 13 17.139 13 15.667 C 13 14.194 14.194 13 15.667 13 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="image" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 8.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5zm9 .5l-2.519 4-2.481-1.96-4 5.96h14l-5-8zm8-4v14h-20v-14h20zm2-2h-24v18h24v-18z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="video" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2.184 7.874l-2.184-.918 2.967-2.956.933 2.164-1.716 1.71zm21.816 2.126l-3 2v4l3 2v-8zm-7-2h-7.018l.79.787c.356.355.629.769.831 1.213h4.897c.276 0 .5.224.5.5v7c0 .276-.224.5-.5.5h-11c-.276 0-.5-.224-.5-.5v-2.909l-.018-.014-1.982-1.975v5.398c0 1.104.896 2 2 2h12c1.104 0 2-.896 2-2v-8c0-1.104-.896-2-2-2zm-14.65 1.13l2.967-2.956 4.044 4.029c.819.816.819 2.14 0 2.956-.819.816-2.147.815-2.967 0l-4.044-4.029z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="stream" viewBox="0 0 24 24">\n\t\t\t\t<path d="M6.613 18.581m9.387-9.581c0 2.209-1.791 4-4 4s-4-1.791-4-4 1.791-4 4-4 4 1.791 4 4zm-2 0c0-1.103-.896-2-2-2s-2 .897-2 2 .896 2 2 2 2-.897 2-2zm-9 0c0 3.86 3.141 7 7 7s7-3.14 7-7-3.141-7-7-7-7 3.14-7 7zm16 0c0 4.97-4.029 9-9 9s-9-4.03-9-9 4.029-9 9-9 9 4.03 9 9zm-.404 12.501c1.007 1.142-.014 2.679-1.448 2.481-1.795-.245-3.236-1.702-7.147-1.702-3.91 0-5.352 1.458-7.146 1.702-1.436.198-2.456-1.34-1.449-2.481l2.898-3.289c.559.388 1.156.725 1.79.994l-2.025 2.298c1.295-.524 3.065-1.225 5.933-1.225s4.638.7 5.933 1.224l-2.025-2.298c.634-.27 1.231-.606 1.79-.994l2.896 3.29z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spinner" viewBox="0 0 24 24">\n\t\t\t\t<path d="M8.175 7.377l-3.042-5.27 1.732-1 3.045 5.273c-.635.238-1.222.573-1.735.997zm-.799.8l-5.27-3.042-1 1.732 5.274 3.045c.237-.635.572-1.223.996-1.735zm-1.376 3.823c0-.341.035-.673.09-.999h-6.09v1.999h6.09c-.055-.326-.09-.659-.09-1zm11.351-2.705l5.208-3.007-.333-.577-5.206 3.007c.121.185.23.379.331.577zm-5.351-3.295c.341 0 .673.035.999.09v-6.09h-1.999v6.09c.326-.055.659-.09 1-.09zm3.14.894l3.004-5.204-.288-.166-3 5.197.284.173zm1.685 8.662l5.234 3.022.666-1.154-5.229-3.019c-.181.41-.408.794-.671 1.151zm-10.444-1.467l-5.274 3.046 1 1.732 5.27-3.042c-.424-.513-.759-1.1-.996-1.736zm11.594-2.589l.025.5-.025.5h6.025v-1h-6.025zm-3.727 6.061l3.03 5.249 1.442-.833-3.031-5.25c-.437.34-.92.623-1.441.834zm-2.248.439c-.341 0-.674-.035-1-.09v6.09h1.999v-6.09c-.326.055-.658.09-.999.09zm-3.824-1.376l-3.042 5.27 1.732 1 3.045-5.274c-.635-.237-1.222-.572-1.735-.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="update" viewBox="0 0 24 24">\n\t\t\t\t<path d="M23 12c0 1.042-.154 2.045-.425 3h-2.101c.335-.94.526-1.947.526-3 0-4.962-4.037-9-9-9-1.706 0-3.296.484-4.655 1.314l1.858 2.686h-6.994l2.152-7 1.849 2.673c1.684-1.049 3.659-1.673 5.79-1.673 6.074 0 11 4.925 11 11zm-6.354 7.692c-1.357.826-2.944 1.308-4.646 1.308-4.962 0-9-4.038-9-9 0-1.053.191-2.06.525-3h-2.1c-.271.955-.425 1.958-.425 3 0 6.075 4.925 11 11 11 2.127 0 4.099-.621 5.78-1.667l1.853 2.667 2.152-6.989h-6.994l1.855 2.681z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="edit" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 1h24v2h-24v-2zm11 7h13v-2h-13v2zm0 5h13v-2h-13v2zm0 5h13v-2h-13v2zm-11 5h24v-2h-24v2zm8-17l-8 6 8 6v-12z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="lock" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18 10v-4c0-3.313-2.687-6-6-6s-6 2.687-6 6v4h-3v14h18v-14h-3zm-10 0v-4c0-2.206 1.794-4 4-4s4 1.794 4 4v4h-8z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="volume-off" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm15.324 4.993l1.646-1.659-1.324-1.324-1.651 1.67-1.665-1.648-1.316 1.318 1.67 1.657-1.65 1.669 1.318 1.317 1.658-1.672 1.666 1.653 1.324-1.325-1.676-1.656z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="volume-on" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm11.008 2.093c.742.743 1.2 1.77 1.198 2.903-.002 1.133-.462 2.158-1.205 2.9l1.219 1.223c1.057-1.053 1.712-2.511 1.715-4.121.002-1.611-.648-3.068-1.702-4.125l-1.225 1.22zm2.142-2.135c1.288 1.292 2.082 3.073 2.079 5.041s-.804 3.75-2.096 5.039l1.25 1.254c1.612-1.608 2.613-3.834 2.616-6.291.005-2.457-.986-4.681-2.595-6.293l-1.254 1.25z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="fullscreen-off" viewBox="0 0 24 24">\n\t\t\t\t<path d="M15 2h2v5h7v2h-9v-7zm9 13v2h-7v5h-2v-7h9zm-15 7h-2v-5h-7v-2h9v7zm-9-13v-2h7v-5h2v7h-9z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="fullscreen-on" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 9h-2v-7h-7v-2h9v9zm-9 15v-2h7v-7h2v9h-9zm-15-9h2v7h7v2h-9v-9zm9-15v2h-7v7h-2v-9h9z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="navmap" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 22.586l-2.823-2.823c.526-.792.836-1.74.836-2.763 0-2.762-2.238-5-5-5s-5 2.238-5 5 2.238 5 5 5c1.016 0 1.957-.307 2.746-.827l2.827 2.827 1.414-1.414zm-9.987-5.586c0-1.654 1.346-3 3-3s3 1.346 3 3-1.346 3-3 3-3-1.346-3-3zm-4 0l.002-.034-3.015 2.175v-13.068l4-2.886v10.247c.508-.854 1.189-1.591 2-2.161v-8.086l4 2.886v3.927h.013c.336 0 .664.032.987.078v-4.007l4-2.479v8.504c1.188 1.208 1.936 2.844 2 4.653v-16.749l-6.455 4-5.545-4-5.545 4-6.455-4v18l6.455 4 3.91-2.82c-.226-.687-.352-1.419-.352-2.18zm-4.013 2.365l-4-2.479v-13.294l4 2.479v13.294z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="screen" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 0v19h24v-19h-24zm22 14h-20v-12h20v12zm-6.599 7l2.599 3h-12l2.599-3h6.802z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="chat" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22 3v13h-11.643l-4.357 3.105v-3.105h-4v-13h20zm2-2h-24v16.981h4v5.019l7-5.019h13v-16.981z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="send" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22 12l-20 12 5-12-5-12z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="users" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10.644 17.08c2.866-.662 4.539-1.241 3.246-3.682-3.932-7.427-1.042-11.398 3.111-11.398 4.235 0 7.054 4.124 3.11 11.398-1.332 2.455.437 3.034 3.242 3.682 2.483.574 2.647 1.787 2.647 3.889v1.031h-18c0-2.745-.22-4.258 2.644-4.92zm-12.644 4.92h7.809c-.035-8.177 3.436-5.313 3.436-11.127 0-2.511-1.639-3.873-3.748-3.873-3.115 0-5.282 2.979-2.333 8.549.969 1.83-1.031 2.265-3.181 2.761-1.862.43-1.983 1.34-1.983 2.917v.773z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="virtual-tour" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17 17h-10v-10h10v10zm7 3l-5-3v-10l5-3v16zm-24-16l5 3v10l-5 3v-16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="live-meeting" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18 18h6v6h-6v-6zm-9 6h6v-6h-6v6zm-9 0h6v-6h-6v6zm0-8h24v-16h-24v16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="control" viewBox="0 0 24 24">\n\t\t\t\t<circle cx="7" cy="10" r="1"></circle>\n\t\t\t\t<path d="M17,3H7c-3.9,0-7,3.1-7,7v6c0,2.8,2.2,5,5,5c2.4,0,4.4-1.7,4.9-4h4.2c0.5,2.7,3.2,4.5,5.9,3.9c2.3-0.5,4-2.5,4-4.9v-6 C24,6.1,20.9,3,17,3z M17,7c0.6,0,1,0.4,1,1s-0.4,1-1,1s-1-0.4-1-1S16.4,7,17,7z M7,13c-1.7,0-3-1.3-3-3s1.3-3,3-3s3,1.3,3,3 S8.7,13,7,13z M15,11c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S15.6,11,15,11z M17,13c-0.6,0-1-0.4-1-1c0-0.6,0.4-1,1-1s1,0.4,1,1 C18,12.5,17.6,13,17,13z M19,11c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S19.6,11,19,11z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spy" viewBox="0 0 24 24">\n\t\t\t\t<path fill-rule="evenodd" d="M0.2,11.4c5.2-8.6,18.3-8.5,23.6,0c0.2,0.3,0.2,0.8,0,1.2c-5.3,8.4-18.4,8.6-23.6,0 C-0.1,12.2-0.1,11.7,0.2,11.4z M12,7.8c2.3,0,4.2,1.9,4.2,4.3s-1.9,4.2-4.2,4.2S7.8,14.3,7.8,12S9.7,7.8,12,7.8z" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="joystick" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10.7,10.5V16H9.3C8.6,16,8,16.6,8,17.3h8c0-0.7-0.6-1.3-1.3-1.3h-1.3v-5.5c2.8-0.7,4.5-3.6,3.8-6.5 c-0.7-2.8-3.6-4.5-6.5-3.8S6.1,3.9,6.9,6.7C7.3,8.6,8.8,10,10.7,10.5z"></path>\n\t\t\t\t<path d="M1.4,18.6h21.2c0.7,0,1.3,0.6,1.3,1.3v2.7c0,0.7-0.6,1.3-1.3,1.3H1.4c-0.7,0-1.3-0.6-1.3-1.3V20 C0.1,19.2,0.7,18.6,1.4,18.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="navinfo" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z M12,0C5.4,0,0,5.4,0,12s5.4,12,12,12s12-5.4,12-12 S18.6,0,12,0z"/>\n\t\t\t\t<path d="M13,18h-2v-8h2V18z M12,5.8c0.7,0,1.2,0.6,1.2,1.2S12.7,8.2,12,8.2S10.8,7.7,10.8,7S11.3,5.8,12,5.8z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="check" viewBox="0 0 24 24">\n\t\t\t\t<path d="M9,21l-9-8.6l2.8-2.9l6.2,5.9L21.2,3L24,5.8L9,21z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="duplicate" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18,6V0H0v18h6v6h18V6H18z M6,16H2V2h14v4H6V16z M22,22H8V8h14V22z M19,14h-3v-3h-2v3h-3v2h3v3h2v-3h3V14z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="trash" viewBox="0 0 24 24">\n\t\t\t\t<path fill-rule="evenodd" d="M19,24H5c-1.1,0-2-0.9-2-2V5H2V3h6V1.5C8,0.7,8.7,0,9.5,0h5C15.3,0,16,0.7,16,1.5V3h6v2h-1v17 C21,23.1,20.1,24,19,24z M19,5H5v16.5C5,21.8,5.2,22,5.5,22h13c0.3,0,0.5-0.2,0.5-0.5V5z M10,9c0-0.6-0.4-1-1-1S8,8.4,8,9v9 c0,0.6,0.4,1,1,1s1-0.4,1-1V9z M16,9c0-0.6-0.4-1-1-1s-1,0.4-1,1v9c0,0.6,0.4,1,1,1s1-0.4,1-1V9z M14,2h-4v1h4V2z" clip-rule="evenodd"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="flags" viewBox="0 0 24 24">\n\t\t\t\t<path d="M19,18c0,1.1-0.9,2-2,2s-2-0.9-2-2s0.9-2,2-2S19,16.9,19,18z M5,15c-1.7,0-3,1.3-3,3s1.3,3,3,3h14c1.7,0,3-1.3,3-3 s-1.3-3-3-3H5z M24,18c0,2.8-2.2,5-5,5H5c-2.8,0-5-2.2-5-5s2.2-5,5-5h14C21.8,13,24,15.2,24,18z M7,4C5.9,4,5,4.9,5,6s0.9,2,2,2 s2-0.9,2-2S8.1,4,7,4z M5,3C3.3,3,2,4.3,2,6s1.3,3,3,3h14c1.7,0,3-1.3,3-3s-1.3-3-3-3H5z M24,6c0,2.8-2.2,5-5,5H5c-2.8,0-5-2.2-5-5 s2.2-5,5-5h14C21.8,1,24,3.2,24,6z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="b-here" viewBox="0 0 270 98">\n\t\t\t\t<path d="M61.5,87.9c0-2.7,0.9-5,2.8-6.9c1.9-1.9,4.2-2.8,7-2.8c1.4,0,2.7,0.2,3.9,0.8c1.2,0.5,2.2,1.2,3.2,2 c0.9,0.9,1.6,1.9,2.1,3.1s0.8,2.5,0.8,3.8s-0.2,2.6-0.8,3.8c-0.5,1.2-1.2,2.2-2.1,3.1s-1.9,1.6-3.2,2.1c-1.2,0.5-2.5,0.8-3.9,0.8 s-2.7-0.2-3.9-0.8c-1.2-0.5-2.2-1.2-3.1-2.1s-1.6-1.9-2.1-3.1S61.5,89.2,61.5,87.9z"></path>\n\t\t\t\t<path d="M16,70.2H0.7v-70H16V29c0.6-1.1,1.4-2.1,2.4-3.1s2.2-1.9,3.5-2.6s2.8-1.3,4.2-1.8c1.5-0.4,3-0.6,4.6-0.6 c3.5,0,6.7,0.6,9.6,1.9s5.4,3.1,7.4,5.3c2.1,2.2,3.7,4.9,4.8,8s1.7,6.4,1.7,10.1c0,3.6-0.6,6.9-1.7,10c-1.1,3.1-2.7,5.8-4.8,8 c-2.1,2.2-4.5,4-7.4,5.3s-6.1,2-9.6,2c-1.6,0-3.1-0.2-4.6-0.7c-1.5-0.4-2.9-1-4.2-1.7c-1.3-0.7-2.5-1.5-3.5-2.5s-1.8-2-2.4-3.1 C16,63.5,16,70.2,16,70.2z M27.6,58.5c1.7,0,3.2-0.3,4.6-1c1.4-0.7,2.6-1.5,3.6-2.7c1-1.1,1.8-2.4,2.4-3.9c0.6-1.5,0.8-3.1,0.8-4.8 s-0.3-3.2-0.8-4.7c-0.6-1.5-1.4-2.8-2.4-3.9c-1-1.1-2.2-2-3.6-2.7c-1.4-0.7-2.9-1-4.6-1s-3.3,0.3-4.8,1c-1.4,0.7-2.7,1.6-3.7,2.7 c-1,1.1-1.8,2.4-2.3,3.9c-0.6,1.5-0.8,3-0.8,4.7s0.3,3.2,0.8,4.8s1.3,2.8,2.3,3.9c1,1.1,2.2,2,3.7,2.7 C24.3,58.2,25.9,58.5,27.6,58.5z"></path>\n\t\t\t\t<path d="M64.1,0.2h14.8V29c1.3-2.5,3.3-4.5,6-6s5.9-2.2,9.6-2.2c3.1,0,5.8,0.5,7.9,1.4c2.1,1,3.9,2.3,5.2,4.1 c1.5,1.9,2.6,4,3.1,6.5s0.8,5.4,0.8,8.9v28.5H96.7V45.5c0-3.5-0.6-6.3-1.8-8.5c-1.2-2.2-3.5-3.2-6.7-3.2c-3.1,0-5.5,1.1-7,3.3 s-2.3,5.2-2.3,8.9v24.2H64.1V0.2z"></path>\n\t\t\t\t<path d="M135.9,49.8c0.1,1.5,0.3,2.9,0.7,4.2s1,2.4,1.8,3.4s1.9,1.7,3.2,2.3s3,0.8,5,0.8c2.7,0,4.7-0.5,6-1.6 c1.4-1.1,2.3-2.4,2.9-3.9h15c-0.3,2.3-1.1,4.4-2.4,6.4c-1.2,2-2.9,3.8-4.9,5.2c-2,1.5-4.4,2.7-7.2,3.5c-2.8,0.9-5.9,1.3-9.3,1.3 c-4.2,0-7.9-0.6-11.2-1.8c-3.2-1.2-6-3-8.2-5.2c-2.2-2.3-3.9-5-5-8c-1.1-3.1-1.7-6.5-1.7-10.2c0-3.5,0.5-6.8,1.6-9.9s2.7-5.8,4.9-8 c2.2-2.3,4.8-4.1,8-5.5c3.2-1.3,6.8-2,11-2c3.8,0,7.2,0.6,10.2,1.8c3,1.2,5.6,2.8,7.8,4.8s3.8,4.3,5,7s1.8,5.5,1.8,8.4 c0,1,0,2.1,0,3.2c0,1.1-0.2,2.4-0.5,3.9h-34.5V49.8z M146.2,31c-3,0-5.5,0.9-7.4,2.6c-1.9,1.7-2.9,4.2-2.9,7.5h20.2 c0-3.1-0.9-5.6-2.8-7.4C151.5,31.9,149.1,31,146.2,31z"></path>\n\t\t\t\t<path d="M216.1,36c-1.1-0.3-2-0.5-2.7-0.6c-0.7-0.1-1.6-0.1-2.7-0.1c-4.2,0-7.6,1.2-10.1,3.7s-3.8,6.6-3.8,12.5v18.8h-15.3V22h15.3 v7.8c1.1-2.3,3-4.3,5.7-6c2.6-1.7,5.6-2.6,9-2.6c1.8,0,3.3,0.3,4.6,0.8V36z"></path>\n\t\t\t\t<path d="M234.3,49.8c0.1,1.5,0.3,2.9,0.7,4.2s1,2.4,1.8,3.4s1.9,1.7,3.2,2.3s3,0.8,5,0.8c2.7,0,4.7-0.5,6-1.6 c1.4-1.1,2.3-2.4,2.9-3.9h15c-0.3,2.3-1.1,4.4-2.4,6.4c-1.2,2-2.9,3.8-4.9,5.2c-2,1.5-4.4,2.7-7.2,3.5c-2.8,0.9-5.9,1.3-9.3,1.3 c-4.2,0-7.9-0.6-11.2-1.8c-3.2-1.2-6-3-8.2-5.2c-2.2-2.3-3.9-5-5-8c-1.1-3.1-1.7-6.5-1.7-10.2c0-3.5,0.5-6.8,1.6-9.9s2.7-5.8,4.9-8 c2.2-2.3,4.8-4.1,8-5.5c3.2-1.3,6.8-2,11-2c3.8,0,7.2,0.6,10.2,1.8c3,1.2,5.6,2.8,7.8,4.8c2.2,2,3.8,4.3,5,7s1.8,5.5,1.8,8.4 c0,1,0,2.1,0,3.2c0,1.1-0.2,2.4-0.5,3.9h-34.5V49.8z M244.6,31c-3,0-5.5,0.9-7.4,2.6c-1.9,1.7-2.9,4.2-2.9,7.5h20.2 c0-3.1-0.9-5.6-2.8-7.4C249.9,31.9,247.5,31,244.6,31z"></path>\n\t\t\t</symbol>\n\t\t</svg>\n\t\n\t\t\x3c!-- header --\x3e\n\t\t<router-outlet [routes]="routes"></router-outlet>\n\t\t\x3c!-- footer --\x3e\n\t\t<div class="toast-outlet" toast-outlet></div>\n\t\t<div class="modal-outlet" modal-outlet></div>\n\t'};var yl=["bmp","gif","ico","jpeg","jpg","png","svg","tif","tiff","webp","hdr"],xl=["mp4","avi","mpeg","ogv","ts","webm","3gp","3g2"],Cl=["fbx","gltf","glb","obj","usdz"],kl=["publisherStream","nextAttendeeStream","publisherScreen","attendeeScreen"];var Ml=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t,e){if(void 0===e&&(e=null),null!=e&&(t=t.type.name===e?t:null),t){if("string"==typeof t)return E.getPath(t);switch(t.type.name){case Hi.Image.name:case Hi.Video.name:case Hi.Model.name:t=t.folder+t.file,t=E.getPath(t);break;case Hi.PublisherStream.name:case Hi.AttendeeStream.name:case Hi.PublisherScreen.name:case Hi.AttendeeScreen.name:case Hi.SmartDeviceStream.name:t=E.getPath(t.file);break;default:n=t.file,new RegExp("/.("+yl.join("|")+")$/i").test(n)||function(t){return new RegExp("/.("+xl.join("|")+")$/i").test(t)}(t.file)?(t=t.folder+t.file,t=E.getPath(t)):!function(t){return new RegExp("/.("+Cl.join("|")+")$/i").test(t)}(t.file)?function(t){return-1!==kl.indexOf(t)}(t.file)&&(t=t.file):(t=t.folder+t.file,t=E.getPath(t))}t=t}else t=null;var n;return t},e}(t.Pipe);Ml.meta={name:"asset"};var Sl=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){e.prototype.onInit.call(this);var n=t.getContext(this).parentInstance;n instanceof Ii&&(this.data=n.modal.data)},i.onAccept=function(t){Bn.resolve()},i.onReject=function(t){Bn.reject()},i.onClose=function(){Bn.reject()},n}(t.Component);Sl.meta={selector:"[control-request-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">L\'utente ha richiesto il controllo della navigazione. Accetti?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()">\n\t\t\t\t\t\t<span>Rifiuta</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t\t<span>Accetta</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},Sl.chunk=function(){return'<div class="control-request-modal" control-request-modal></div>'};var Tl=function(e){function o(){return e.apply(this,arguments)||this}return d(o,e),o.prototype.onInit=function(){var e=t.getContext(this),o=e.module,r=e.node,s=e.parentInstance,a=(e.selector,"drop"),l=n.fromEvent(r,a).pipe(i.shareReplay(1)),c=r.getAttribute("(drop)");if(c){var u=o.makeFunction(c,["$event"]);l.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){o.resolve(u,s,t)})),n.fromEvent(r,"dragover").pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return t.preventDefault()}))}else s.drop$=l},o}(t.Directive);Tl.meta={selector:"[(drop)]"};var El=1e6,Ll=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var e=this,o=t.getContext(this).node,r=o.getAttribute("dropdown-trigger");this.trigger=r?o.querySelector(r):o,this.opened=null,this.onClick=this.onClick.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.openDropdown=this.openDropdown.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this.addListeners(),n.dropdown$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?o.classList.add("dropped"):o.classList.remove("dropped")}))},o.onClick=function(e){var n=t.getContext(this).node;null===this.opened?this.openDropdown():n.querySelector("[dropdown-item]")||this.closeDropdown()},o.onDocumentClick=function(e){var n=t.getContext(this).node;n===e.target||n.contains(e.target)||this.closeDropdown()},o.openDropdown=function(){null===this.opened&&(this.opened=!0,this.addDocumentListeners(),n.dropdown$.next(this.id),this.dropped.next(this.id))},o.closeDropdown=function(){null!==this.opened&&(this.removeDocumentListeners(),this.opened=null,n.dropdown$.getValue()===this.id&&(n.dropdown$.next(null),this.dropped.next(null)))},o.addListeners=function(){this.trigger.addEventListener("click",this.onClick)},o.addDocumentListeners=function(){document.addEventListener("click",this.onDocumentClick)},o.removeListeners=function(){this.trigger.removeEventListener("click",this.onClick)},o.removeDocumentListeners=function(){document.removeEventListener("click",this.onDocumentClick)},o.onDestroy=function(){this.removeListeners(),this.removeDocumentListeners()},n.nextId=function(){return El++},l(n,[{key:"id",get:function(){return this.dropdown||this.id_||(this.id_=n.nextId())}}]),n}(t.Directive);Ll.meta={selector:"[dropdown]",inputs:["dropdown","dropdown-trigger"],outputs:["dropped"]},Ll.dropdown$=new n.BehaviorSubject(null);var _l=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onInit=function(){var e=this,n=t.getContext(this).node;n.classList.add("dropdown-item"),Ll.dropdown$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?n.classList.add("dropped"):n.classList.remove("dropped")}))},l(n,[{key:"id",get:function(){return this["dropdown-item"]}}]),n}(t.Directive);_l.meta={selector:"[dropdown-item], [[dropdown-item]]",inputs:["dropdown-item"]};var Il=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.toast=null,this.lastToast=null,_i.toast$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){e&&(t.lastToast=e),t.toast=e,t.pushChanges()}))},n.getClass=function(){var t={};return this.toast&&(t.active=!0),this.lastToast&&(t[this.lastToast.type]=!0,t[this.lastToast.position]=!0),t},n.onClose=function(){_i.reject(this.toast)},n.onAccept=function(){_i.resolve(this.toast)},n.onReject=function(){_i.reject(this.toast)},e}(t.Component);Il.meta={selector:"[toast-outlet]",template:'\n\t<div class="toast-outlet__container" [class]="getClass()">\n\t\t<div class="toast-outlet__toast" *if="lastToast">\n\t\t\t<span class="toast-outlet__message" [innerHTML]="lastToast.message"></span>\n\t\t\t<div class="group--cta" *if="lastToast.type != \'info\'">\n\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t<span [innerHTML]="lastToast.acceptMessage"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()" *if="lastToast.type == \'dialog\'">\n\t\t\t\t\t<span [innerHTML]="lastToast.rejectMessage"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<button type="button" class="btn--close" (click)="onClose()" *if="lastToast.type != \'info\'">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t'};var Rl=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){this.mode=1,this.viewTypes=Object.keys(ni).map((function(t){var e=ni[t];return{type:e,name:Dn.getKeys("editor",e.name),disabled:-1!==E.editor.disabledViewTypes.indexOf(e.name)}})),this.viewItemTypes=Object.keys(ii).map((function(t){var e=ii[t];return{type:e,name:Dn.getKeys("editor",e.name),disabled:-1!==E.editor.disabledViewItemTypes.indexOf(e.name)}})),this.setSupportedViewTypes(),this.setSupportedViewItemTypes()},n.onChanges=function(){this.setSupportedViewTypes(),this.setSupportedViewItemTypes()},n.setSupportedViewTypes=function(){var t=this;this.supportedViewTypes=this.viewTypes.filter((function(e){return t.supportedViewType(e.type.name)})).sort((function(t,e){return t.disabled===e.disabled?0:t.disabled?1:-1}))},n.setSupportedViewItemTypes=function(){var t=this;this.view?this.supportedViewItemTypes=this.viewItemTypes.filter((function(e){return t.supportedViewItemType(t.view.type.name,e.type.name)})).sort((function(t,e){return t.disabled===e.disabled?0:t.disabled?1:-1})):this.supportedViewItemTypes=[]},n.setMode=function(t){this.mode!==t&&(this.mode=t,this.pushChanges())},n.supportedViewType=function(t){return-1!==[ni.Panorama.name,ni.PanoramaGrid.name,ni.Room3d.name,ni.Model.name,ni.Media.name].indexOf(t)},n.supportedViewItemType=function(t,e){var n;switch(t){case ni.WaitingRoom.name:n=!1;break;case ni.Panorama.name:case ni.PanoramaGrid.name:n=-1!==[ii.Nav.name,ii.Model.name,ii.Plane.name,ii.CurvedPlane.name].indexOf(e);break;case ni.Room3d.name:n=-1!==[ii.Nav.name,ii.Model.name,ii.Plane.name,ii.Texture.name].indexOf(e);break;case ni.Model.name:n=-1!==[ii.Nav.name,ii.Model.name,ii.Plane.name,ii.CurvedPlane.name].indexOf(e);break;case ni.Media.name:n=-1!==[].indexOf(e)}return n},n.onSelect=function(t){this.select.next(t)},n.onUpdate=function(t){this.update.next(t)},n.onDelete=function(t){this.delete.next(t)},e}(t.Component);Rl.meta={selector:"[aside]",outputs:["select","update","delete"],inputs:["view"]};var Al=0,Pl=function(){function t(){}return t.menu$=function(){var t=this;return this.getMenu$().pipe(i.switchMap((function(e){return t.menu$_.next(e),t.menu$_})))},t.getMenu$=function(){return hn.get$("/api/menu").pipe(i.map((function(t){return t.menu.sort((function(t,e){return t.order-e.order})),t.menu})))},t.updateMenu$=function(t){return hn.put$("/api/menu",t)},t.createMenuItem$=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0);var n={parentId:t,viewId:null,order:10*e,name:"Folder "+ ++Al};return hn.post$("/api/menu",n)},t.updateMenuItem$=function(t){return hn.put$("/api/menu/"+t.id,t)},t.deleteMenuItem$=function(t){return hn.delete$("/api/menu/"+t.id)},t.getModelMenu$=function(t,e){var n=this;return void 0===e&&(e=!1),this.menu$().pipe(i.map((function(i){if(i&&i.length)return i=i.filter((function(e){return null==e.viewId||null!=t.find((function(t){return t.id===e.viewId}))})),n.mapMenuItems(i);var o={};return t.forEach((function(t){if(t.type.name!==ni.WaitingRoom.name&&(!t.hidden||e)){var n=o[t.type.name];n||(n=o[t.type.name]=[]),n.push(t)}})),Object.keys(o).map((function(n){var i="Button";switch(n){case ni.WaitingRoom.name:i="Waiting Room";break;case ni.Panorama.name:i="Experience";break;case ni.PanoramaGrid.name:i="Virtual Tour";break;case ni.Room3d.name:i="Stanze 3D";break;case ni.Model.name:i="Modelli 3D";break;case ni.Media.name:i="Media"}return{name:i,type:{name:"menu-group"},items:t.filter((function(t){return t.type.name===n&&(!t.hidden||e)}))}}))})))},t.mapMenuItem=function(t,e){return t.viewId?{id:t.viewId,name:t.name,type:{name:"panorama"}}:{name:t.name,type:{name:"menu-group"},items:this.mapMenuItems(e,t.id)}},t.mapMenuItems=function(t,e){var n=this;return void 0===e&&(e=null),t.filter((function(t){return(t.parentId||null)===e})).map((function(e){return n.mapMenuItem(e,t)})).filter((function(t){return null!=t.id||t.items.length>0}))},l(t,null,[{key:"active",set:function(t){this.active$.next(t)},get:function(){return this.active$.getValue()}}]),t}();c(Pl,"active$",new n.BehaviorSubject(!1)),c(Pl,"menu$_",new n.BehaviorSubject([]));var $l=function(){function e(){}return e.drop$=function(e){if(t.isPlatformBrowser&&e){var o=document.querySelector("body");return n.merge(n.fromEvent(o,"drop"),n.fromEvent(o,"dragover")).pipe(i.map((function(t){t.preventDefault(),t.target===e&&(e.files=t.dataTransfer.files)})))}return n.EMPTY},e.change$=function(e){return t.isPlatformBrowser&&e?n.fromEvent(e,"change").pipe(i.filter((function(t){return e.files&&e.files.length})),i.map((function(t){return Array.from(e.files)}))):n.EMPTY},e.asset$=function(t,e){var o=this;return void 0===e&&(e=[]),this.change$(t).pipe(i.switchMap((function(t){e.length=t.length,e.fill(null);var r=t.map((function(t,n){return o.read$(t,n,e).pipe(i.map((function(){return t})),i.switchMap((function(t){return nl.upload$([t])})),i.switchMap((function(t){var e=t[0],n=ji.fromUrl(e.url);return nl.assetCreate$(n)})))}));return n.combineLatest(r)})))},e.read$=function(t,e,o){var r=this;void 0===o&&(o=[]);var s=new FileReader,a=n.fromEvent(s,"load").pipe(i.switchMap((function(t){var e=t.target.result;return r.resize$(e)})),i.tap((function(t){o[e]=t})));return s.readAsDataURL(t),a},e.resize$=function(t){return n.from(this.resize_(t))},e.resize_=function(t){return new Promise((function(e,n){var i=document.createElement("img");i.onload=function(){var t=document.createElement("canvas"),n=t.getContext("2d"),o=i.width,r=i.height;o>r?o>320&&(r*=320/o,o=320):r>240&&(o*=240/r,r=240),t.width=o,t.height=r,n.drawImage(i,0,0,o,r);var s=t.toDataURL("image/jpeg",.9);e(s)},i.onerror=function(){n(t)},i.src=t}))},e}(),Hl=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onChanges=function(){var e=t.getContext(this).node,n=this.control.flags;Object.keys(n).forEach((function(t){n[t]?e.classList.add(t):e.classList.remove(t)}))},n}(t.Component);Hl.meta={selector:"[control]",inputs:["control"]};var Ol=function(e){function o(){return e.apply(this,arguments)||this}return d(o,e),o.prototype.onInit=function(){var e=this;this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||"image/png, image/jpeg";var o=t.getContext(this).node.querySelector("input");o.setAttribute("accept",this.accept),$l.drop$(o).pipe(i.takeUntil(this.unsubscribe$)).subscribe(),$l.change$(o).pipe(i.switchMap((function(t){var o=t.map((function(t,n){return nl.upload$([t]).pipe(i.switchMap((function(t){return nl.createOrUpdateAsset$(t,e.control)})))}));return n.combineLatest(o)})),i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.control.value=t[0]}))},o}(Hl);Ol.meta={selector:"[control-asset]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--picture">\n\t\t\t\t<div class="group--picture__info">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t</div>\n\t\t\t\t<img [lazy]="control.value | asset" [size]="{ width: 320, height: 240 }" *if="control.value && control.value.type.name === \'image\'" />\n\t\t\t\t<video [src]="control.value | asset" *if="control.value && control.value.type.name === \'video\'"></video>\n\t\t\t\t<input type="file">\n\t\t\t</div>\n\t\t\t<div class="file-name" *if="control.value" [innerHTML]="control.value.file"></div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var Bl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t),n.itemToFormGroup=function(t){return new e.FormGroup({id:t.id,parentId:t.parentId,viewId:t.viewId,name:t.name,items:new e.FormArray})};var o=n.prototype;return o.onInit=function(){var t=this;this.dropdownId=Ll.nextId(),this.controls=this.control.controls,il.viewIdOptions$().pipe(i.first()).subscribe((function(e){t.controls.viewId.options=e}))},o.onAddItem=function(){var t=this;Pl.createMenuItem$(this.controls.id.value,this.controls.items.length).pipe(i.first()).subscribe((function(e){t.controls.items.push(n.itemToFormGroup(e))}))},o.onRemoveItem=function(){this.remove.next(this.control)},o.onRemoveControl=function(t){var e=this;Pl.deleteMenuItem$(t.value).pipe(i.first()).subscribe((function(){e.controls.items.remove(t)}))},o.onLinkItem=function(){this.link.next(this.control)},o.onLinkControl=function(t){this.link.next(t)},o.onItemUp=function(){this.up.next(this.control)},o.onItemDown=function(){this.down.next(this.control)},o.onUpControl=function(t){var e=this.controls.items,n=e.controls.length,i=e.controls.indexOf(t);e.controls.splice(i,1),i>0?i--:i=n-1,e.insert(t,i)},o.onDownControl=function(t){var e=this.controls.items,n=e.controls.length,i=e.controls.indexOf(t);e.controls.splice(i,1),i<n-1?i++:i=0,e.insert(t,i)},o.setView=function(t){var e=this,n=Object.assign({},this.control.value);n.viewId=t.id,t.id&&(n.name=t.name),Pl.updateMenuItem$(n).pipe(i.first()).subscribe((function(){e.controls.viewId.value=t.id,t.id&&(e.controls.name.value=t.name,e.controls.items.controls=[],e.controls.items.switchSubjects_())}))},o.onTextDidChange=function(t){Pl.updateMenuItem$(this.control.value).pipe(i.first()).subscribe()},o.hasOption=function(t){return this.controls.viewId.value===t.id},o.onDropped=function(t){},n}(Ol);Bl.meta={selector:"[control-menu]",outputs:["remove","link","up","down"],inputs:["control"],template:'\n\t\t<div class="group--form">\n\t\t\t<button type="button" class="control-menu__link" [class]="{ active: control.controls.viewId.value }" (click)="onLinkItem($event)" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#link"></use></svg>\n\t\t\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t\t\t<div class="category">View</div>\n\t\t\t\t\t<ul class="nav--dropdown">\n\t\t\t\t\t\t<li (click)="setView(item)" [class]="{ empty: item.id == null }" *for="let item of control.controls.viewId.options">\n\t\t\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t\t<input type="text" class="control--text" [formControl]="control.controls.name" placeholder="Name" (change)="onTextDidChange($event)" />\n\t\t\t\x3c!--\n\t\t\t<button type="button" class="control-menu__add" (click)="onAddItem($event)">\n\t\t\t\t<span [innerHTML]="control.controls.viewId.value"></span>\n\t\t\t</button>\n\t\t\t--\x3e\n\t\t\t\x3c!--\n\t\t\t<select class="control--select" [formControl]="control.controls.viewId">\n\t\t\t\t<option [value]="item.id" *for="let item of control.controls.viewId.options" [innerHTML]="item.name"></option>\n\t\t\t</select>\n\t\t\t--\x3e\n\t\t\t<button type="button" class="control-menu__up" (click)="onItemUp($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#up"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__down" (click)="onItemDown($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#down"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__add" (click)="onAddItem($event)" *if="!control.controls.viewId.value">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#add"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__remove" (click)="onRemoveItem($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#remove"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="group--items">\n\t\t\t<div control-menu *for="let sub of control.controls.items.controls" [control]="sub" (remove)="onRemoveControl($event)" (link)="onLinkControl($event)" (up)="onUpControl($event)" (down)="onDownControl($event)"></div>\n\t\t</div>\n\t'};var Dl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.changes=0,this.form=null,Pl.getMenu$().pipe(i.first()).subscribe((function(e){return t.initForm(e)}))},o.initForm=function(t){var n=this;void 0===t&&(t=[]);var o=this.menuToControls(t),r=this.form=new e.FormGroup({items:o});this.controls=r.controls;r.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){n.changes++,n.pushChanges()}))},o.onLinkControl=function(t){},o.onUpControl=function(t){var e=this.controls.items,n=e.controls.length,i=e.controls.indexOf(t);e.controls.splice(i,1),i>0?i--:i=n-1,e.insert(t,i)},o.onDownControl=function(t){var e=this.controls.items,n=e.controls.length,i=e.controls.indexOf(t);e.controls.splice(i,1),i<n-1?i++:i=0,e.insert(t,i)},o.onAddItem=function(){var t=this;Pl.createMenuItem$(null,this.controls.items.length).pipe(i.first()).subscribe((function(e){t.controls.items.push(Bl.itemToFormGroup(e))}))},o.onRemoveControl=function(t){var e=this;Pl.deleteMenuItem$(t.value).pipe(i.first()).subscribe((function(){e.controls.items.remove(t)}))},o.isValid=function(){var t=this.form.valid;return t},o.onSubmit=function(t){if(this.form.valid){var e=this.form.value,n=this.controlsToMenu(e);Pl.updateMenu$(n)}else this.form.touched=!0},o.menuToControls=function(t,n){var i=this;return void 0===n&&(n=null),new e.FormArray(t.filter((function(t){return(t.parentId||null)===n})).map((function(n){var o=i.menuToControls(t,n.id);return new e.FormGroup({id:n.id,parentId:n.parentId,viewId:n.viewId,name:n.name,items:o})})))},o.controlsToMenu=function(t){var e=[];return function t(n){n&&n.forEach((function(n,i){var o=Object.assign({},n);o.order=10*i,delete o.items,e.push(o),t(n.items)}))}(t.items),e},n}(t.Component);Dl.meta={selector:"[menu-builder]",inputs:["views"]};var Ul=function(n){function o(){return n.apply(this,arguments)||this}d(o,n);var r=o.prototype;return r.onInit=function(){var t=this,n=this.position;this.error=null;var o=this.form=new e.FormGroup({type:ii.Nav,title:null,abstract:null,viewId:new e.FormControl(null,e.RequiredValidator()),keepOrientation:!1,important:!1,transparent:!1,position:new e.FormControl(n,e.RequiredValidator()),asset:null});this.controls=o.controls,o.changes$.subscribe((function(e){t.pushChanges()})),il.viewIdOptions$().pipe(i.first()).subscribe((function(e){t.controls.viewId.options=e,t.pushChanges()}))},r.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=Object.assign({},this.form.value);e.viewId=parseInt(e.viewId),wi.itemCreate$(this.navmap,e).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("NavmapItemModalComponent.onSubmit.error",e),t.error=e,t.form.submitted=!1}))}else this.form.touched=!0},r.onClose=function(){Bn.reject()},l(o,[{key:"data",get:function(){var e=null,n=t.getContext(this).parentInstance;return n instanceof Ii&&(e=n.modal.data),e}},{key:"navmap",get:function(){var t=null,e=this.data;return e&&(t=e.navmap),t}},{key:"position",get:function(){var t=[0,0,0],e=this.data;return e&&(t=[e.hit.x,e.hit.y,0]),t}}]),o}(t.Component);Ul.meta={selector:"[navmap-item-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Map Nav.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3" [disabled]="true"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Ul.chunk=function(){return'<div class="nav-modal" navmap-item-modal></div>'};var Vl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.error=null;var n=this.form=new e.FormGroup({name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){t.pushChanges()}))},o.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n={name:e.name,asset:e.asset};return wi.navmapCreate$(n).pipe(i.first()).subscribe((function(t){Bn.resolve(t)}),(function(e){console.log("NavmapModalComponent.onSubmit.error",e),t.error=e,t.form.reset()}))}this.form.touched=!0},o.onClose=function(){Bn.reject()},n}(t.Component);Vl.meta={selector:"[navmap-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Map.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="description">Formato immagine .png con trasparenza (2048x1024 o 1024x512)</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Vl.chunk=function(){return'<div class="panorama-modal" navmap-modal></div>'};var zl=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.navmap=null,this.navmaps=[],wi.navmapGet$().pipe(i.first()).subscribe((function(e){t.navmaps=e,t.pushChanges()}))},n.onBack=function(t){this.navmap=null,this.pushChanges()},n.onAdd=function(){var t=this;Bn.open$({template:Vl.chunk()}).pipe(i.first()).subscribe((function(e){e instanceof Hn&&(t.navmaps.push(e.data),t.navmap=e.data,t.pushChanges())}))},n.onSet=function(t){this.navmap=this.navmaps.find((function(e){return e.id===t.id})),this.pushChanges()},n.onAddItem=function(t,e){var n=this;Bn.open$({template:Ul.chunk(),data:{navmap:t,hit:e}}).pipe(i.first()).subscribe((function(e){if(e instanceof Hn){var i=t.items||[];i.push(e.data),Object.assign(t,{items:i}),n.pushChanges()}}))},n.onDelete=function(t){var e=this.navmaps.indexOf(t);-1!==e&&this.navmaps.splice(e,1),this.navmap=null,this.pushChanges()},e}(t.Component);zl.meta={selector:"[navmap-builder]",inputs:["views"]};var jl="idle",Fl="insert",Nl="remove",Gl="move",ql=function(t,e){var n=t.getBoundingClientRect();this.x=(e.clientX-n.x)/n.width,this.y=(e.clientY-n.y)/n.height},Zl=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(ql),Wl=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(ql),Kl=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(ql),Xl=function(o){function r(){return o.apply(this,arguments)||this}d(r,o);var s=r.prototype;return s.onInit=function(){var t=this;this.mode=jl,this.error=null;var n=this.navmap,o=this.form=new e.FormGroup({name:new e.FormControl(n.name,e.RequiredValidator()),asset:new e.FormControl(n.asset,e.RequiredValidator())});this.controls=o.controls,o.changes$.subscribe((function(e){t.pushChanges()})),this.insert$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){var o=e;Bn.open$({template:Ul.chunk(),data:{navmap:n,hit:o}}).pipe(i.first()).subscribe((function(e){if(e instanceof Hn){var i=n.items||[];i.push(e.data),Object.assign(n,{items:i}),t.pushChanges()}}))}))},s.insert$=function(){var e=this,o=t.getContext(this).node.querySelector(".navmap-control__image");return n.fromEvent(o,"pointerdown").pipe(i.filter((function(t){return e.mode===Fl})),i.map((function(t){return new Zl(o,t)})))},s.onToggleMode=function(t){this.mode=this.mode===t?jl:t,this.pushChanges()},s.onMoveItem=function(e,o){var r=this,s=this.navmap;switch(this.mode){case Gl:var a=t.getContext(this).node.querySelector(".navmap-control__image"),l=o.position.slice(),c=new Zl(a,e),u=n.fromEvent(a,"mousemove").pipe(i.map((function(t){return new Wl(a,t)})),i.tap((function(t){var e=t.x-c.x,n=t.y-c.y;o.position=[Math.max(0,Math.min(1,l[0]+e)),Math.max(0,Math.min(1,l[1]+n)),0],r.pushChanges()}))),d=n.fromEvent(a,"mouseup").pipe(i.map((function(t){return new Kl(a,t)})),i.tap((function(t){var e=t.x-c.x,n=t.y-c.y;o.position=[Math.max(0,Math.min(1,l[0]+e)),Math.max(0,Math.min(1,l[1]+n)),0],wi.itemUpdate$(s,o).pipe(i.first()).subscribe((function(t){Object.assign(o,t),r.pushChanges()}))})));u.pipe(i.takeUntil(d)).subscribe()}},s.onRemoveItem=function(t){var e=this,n=this.navmap;switch(this.mode){case Nl:wi.itemDelete$(n,t).pipe(i.first()).subscribe((function(i){var o=n.items||[],r=o.indexOf(t);-1!==r&&o.splice(r,1),Object.assign(n,{items:o}),e.pushChanges()}))}},s.onSubmit=function(){var t=this;if(this.form.valid){this.form.submitted=!0;var e=this.form.value,n=Object.assign({items:[]},this.navmap,{name:e.name});wi.navmapUpdate$(n).pipe(i.first()).subscribe((function(e){Object.assign(t.navmap,e),t.pushChanges()}),(function(e){t.error=e,t.form.reset()}))}else this.form.touched=!0},s.onRemove=function(){var t=this,e=this.navmap;Bn.open$({template:vl.chunk(),data:{item:e}}).pipe(i.first()).subscribe((function(n){n instanceof Hn&&wi.navmapDelete$(e).pipe(i.first()).subscribe((function(n){t.delete.next(e)}))}))},r}(t.Component);Xl.meta={selector:"[navmap-edit]",outputs:["delete"],inputs:["navmap"]};var Yl=function(t){function o(){return t.apply(this,arguments)||this}d(o,t);var r=o.prototype;return r.onInit=function(){var t=this;this.busy=!1,this.active=!1,this.useHooks=Ki.enabled;var n=this.form=new e.FormGroup;this.controls=n.controls;var i=this.item;this.originalItem=Object.assign({},i),i.hasChromaKeyColor=!(!i.asset||!i.asset.chromaKeyColor),i.autoplay=i.asset&&i.asset.type.name===Hi.Video.name?i.asset.autoplay:void 0,i.loop=i.asset&&i.asset.type.name===Hi.Video.name?i.asset.loop:void 0,i.assetType=Ui(i).id,this.doUpdateForm(),n.changes$.subscribe((function(e){t.doUpdateItem(e),t.pushChanges()}))},r.getFlagsDidChange=function(t,e){return["hasChromaKeyColor","autoplay","loop"].reduce((function(n,i){var o=e[i]||!1,r=t[i]||!1;return n||o!==r}),!1)},r.getAssetDidChange=function(t,e){return nl.assetDidChange(t.asset,e.asset)},r.doUpdateItem=function(t){var e=this,o=this.item,r=this.getAssetDidChange(o,t),s=this.getFlagsDidChange(o,t);(Object.assign(o,t),o.asset&&(o.asset.chromaKeyColor=o.hasChromaKeyColor?[0,1,0]:null,o.asset.autoplay=o.autoplay,o.asset.loop=o.loop),r||s)&&((o.asset?nl.assetUpdate$(o.asset):n.of(null)).pipe(i.switchMap((function(){return il.inferItemUpdate$(e.view,o)})),i.first()).subscribe(),this.view.updateIndices(this.view.items),"function"==typeof o.onUpdateAsset&&o.onUpdateAsset());"function"==typeof o.onUpdate&&o.onUpdate()},r.doUpdateForm=function(){var t=this,n=this.item,o=this.form;if(this.type&&this.type.name===n.type.name)Object.keys(this.controls).forEach((function(e){switch(e){case"link":var i=n.link?n.link.title:null,o=n.link?n.link.href:null;t.controls[e].value={title:i,href:o,target:"_blank"};break;case"hasChromaKeyColor":t.controls[e].value=!(!n.asset||!n.asset.chromaKeyColor);break;case"autoplay":t.controls[e].value=!(!n.asset||!n.asset.autoplay);break;case"loop":t.controls[e].value=!(!n.asset||!n.asset.loop);break;case"assetType":t.controls[e].value=Ui(n).id;break;default:t.controls[e].value=null!=n[e]?n[e]:null}}));else{var r;switch(this.type=n.type,Object.keys(this.controls).forEach((function(t){o.removeKey(t)})),n.type.name){case ii.Nav.name:r=this.useHooks?["id","type","title?","abstract?","viewId?","hook?","hookExtra?","keepOrientation?","important?","transparent?","position","rotation","scale","asset?","link?"]:["id","type","title?","abstract?","viewId?","keepOrientation?","important?","transparent?","position","rotation","scale","asset?","link?"];break;case ii.Plane.name:r=["id","type","position","rotation","scale","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case ii.CurvedPlane.name:r=["id","type","position","rotation","scale","radius","height","arc","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case ii.Texture.name:r=["id","type","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case ii.Model.name:r=this.view.type.name===ni.Model?["id","type","asset?"]:["id","type","position","rotation","asset?"];break;default:r=["id","type"]}r.forEach((function(r){var s=-1!==r.indexOf("?");r=r.replace("?","");var a,l=null!=n[r]?n[r]:null;switch(r){case"viewId":a=new e.FormControl(l,s?void 0:e.RequiredValidator()),il.viewIdOptions$().pipe(i.first()).subscribe((function(e){a.options=e,a.value=a.value||null,t.pushChanges()}));break;case"hook":if(a=new e.FormControl(l,s?void 0:e.RequiredValidator()),Ki.enabled){var c=E.webhook.methods.map((function(t){return{id:t,name:t}}));c.unshift({id:null,name:"select"}),a.options=c}a.value=a.value||null,t.pushChanges();break;case"assetType":(a=new e.FormControl(l,s?void 0:e.RequiredValidator())).options=Object.keys(Oi).map((function(t){return Oi[t]}));break;case"link":var u=n.link?n.link.title:null,d=n.link?n.link.href:null;a=new e.FormGroup({title:new e.FormControl(u),href:new e.FormControl(d),target:"_blank"});break;default:a=new e.FormControl(l,s?void 0:e.RequiredValidator())}o.add(a,r)})),this.controls=o.controls}},r.onAssetTypeDidChange=function(t){var e=this,o=this.item,r=Ui(o).id;if(t!==r){o.assetType=t;var s=n.of(null);t!==Oi.ImageOrVideo.id&&(s=s.pipe(i.switchMap((function(){var e=Vi(t);return nl.assetCreate$(e)})))),s.pipe(i.first()).subscribe((function(t){e.controls.asset.value=t}))}},r.onChanges=function(t){this.doUpdateForm()},r.onSubmit=function(){var t=this;if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();var e=this.form.value,n=Object.assign({},e);this.item.type.name===ii.Nav.name&&(n.viewId=n.viewId||this.view.id);var o=this.view,r=new ui(n);il.inferItemUpdate$(o,r).pipe(i.first()).subscribe((function(e){il.inferItemUpdateResult$(o,r),t.update.next({view:o,item:r}),t.setTimeout((function(){t.busy=!1,t.pushChanges()}))}),(function(t){return console.log("UpdateViewItemComponent.onSubmit.inferItemUpdate$.error",t)}))}else this.form.touched=!0},r.onRemove=function(t){var e=this;Bn.open$({template:vl.chunk(),data:{item:this.item}}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&e.delete.next({view:e.view,item:e.item})}))},r.onSelect=function(t){this.select.next({view:this.view,item:this.item.selected?null:this.item})},r.getTitle=function(t){return Dn.getKeys("editor",t.type.name)},r.clearTimeout=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this.to&&clearTimeout(this.to)})),r.setTimeout=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))})),r.onDestroy=function(){this.clearTimeout()},o}(t.Component);Yl.meta={selector:"update-view-item",outputs:["select","update","delete"],inputs:["view","item"],template:'\n\t\t<div class="group--headline" [class]="{ active: item.selected }" (click)="onSelect($event)">\n\t\t\t\x3c!-- <div class="id" [innerHTML]="item.id"></div> --\x3e\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title" [innerHTML]="getTitle(item)"></div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="item.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t\x3c!-- <div control-text [control]="controls.type" label="Type" [disabled]="true"></div> --\x3e\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'nav\'">\n\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView"></div>\n\t\t\t\t<div control-checkbox [control]="controls.keepOrientation" label="Keep Orientation"></div>\n\t\t\t\t<div control-checkbox [control]="controls.important" label="Important"></div>\n\t\t\t\t<div control-checkbox [control]="controls.transparent" label="Transparent"></div>\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3"></div>\n\t\t\t\t<div *if="controls.transparent.value == true">\n\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t</div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image" accept="image/jpeg, image/png"></div>\n\t\t\t\t<div control-text [control]="controls.link.controls.title" label="Link Title"></div>\n\t\t\t\t<div control-text [control]="controls.link.controls.href" label="Link Url"></div>\n\t\t\t\t<div *if="useHooks">\n\t\t\t\t\t<div control-custom-select [control]="controls.hook" label="Hook"></div>\n\t\t\t\t\t<div control-text [control]="controls.hookExtra" label="Hook Extra"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'plane\' && view.type.name != \'media\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Localized Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'plane\' && view.type.name == \'media\'">\n\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Localized Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'curved-plane\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t\x3c!-- <div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div> --\x3e\n\t\t\t\t<div control-number [control]="controls.radius" label="Radius" [precision]="2"></div>\n\t\t\t\t<div control-number [control]="controls.height" label="Height" [precision]="2"></div>\n\t\t\t\t<div control-number [control]="controls.arc" label="Arc" [precision]="0"></div>\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'texture\'">\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'model\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" *if="view.type.name !== \'model\'"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" *if="view.type.name !== \'model\'"></div>\n\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t'};var Jl=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.busy=!1,this.active=!1;var n=this.form=new e.FormGroup({id:new e.FormControl(this.tile.id,e.RequiredValidator()),asset:new e.FormControl(this.tile.asset,e.RequiredValidator()),navs:new e.FormControl(this.tile.navs,e.RequiredValidator())});this.controls=n.controls,n.changes$.subscribe((function(e){var n=t.tile;Object.assign(n,e),"function"==typeof n.onUpdate&&n.onUpdate(),t.pushChanges()}))},o.onSubmit=function(){var t=this;if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();var e=Object.assign({},this.form.value),n=this.view,i=e;this.update.next({view:n,tile:i}),this.setTimeout((function(){t.busy=!1,t.pushChanges()}))}else this.form.touched=!0},o.onRemove=function(t){var e=this;Bn.open$({template:vl.chunk(),data:{tile:this.tile}}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&e.delete.next({view:e.view,tile:e.tile})}))},o.onSelect=function(t){this.select.next({view:this.view,tile:this.tile.selected?null:this.tile})},o.clearTimeout=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this.to&&clearTimeout(this.to)})),o.setTimeout=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))})),o.onDestroy=function(){this.clearTimeout()},n}(t.Component);Jl.meta={selector:"update-view-tile",outputs:["select","update","delete"],inputs:["view","tile"],template:'\n\t\t<div class="group--headline" [class]="{ active: tile.selected }" (click)="onSelect($event)">\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon name="tile"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title">Tile {{tile.id}}</div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="tile.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg, image/png"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t\x3c!--\n\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t--\x3e\n\t\t\t</div>\n\t\t</form>\n\t'};var Ql=function(t){function n(){return t.apply(this,arguments)||this}d(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.busy=!1;var n=this.form=new e.FormGroup;this.controls=n.controls,this.doUpdateForm(),n.changes$.subscribe((function(e){t.doUpdateView(e),t.pushChanges()})),this.orbit$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){switch(t.view.type.name){case ni.WaitingRoom.name:case ni.Panorama.name:case ni.PanoramaGrid.name:case ni.Room3d.name:case ni.Model.name:case ni.Media.name:t.form.patch({latitude:e.orientation.latitude,longitude:e.orientation.longitude,zoom:e.zoom})}}))},o.orbit$=function(){var t,e,n=null;return gn.in$.pipe(i.filter((function(t){return t.type===Re})),i.auditTime(65),i.distinctUntilChanged((function(i,o){var r=t!==o.orientation.latitude||e!==o.orientation.longitude||n!==o.zoom;return t=o.orientation.latitude,e=o.orientation.longitude,n=o.zoom,!r})))},o.getAssetDidChange=function(t){var e=this.view;if(e.type.name===ni.PanoramaGrid.name)return!1;var n=nl.assetDidChange(e.asset,t.asset),i=nl.assetDidChange(e.ar?e.ar.usdz:null,t.usdz),o=nl.assetDidChange(e.ar?e.ar.gltf:null,t.gltf);return!!(n||i||o)},o.doUpdateView=function(t){this.getAssetDidChange(t)&&this.onSubmit()},o.doUpdateForm=function(){var t=this.view;if(!this.type||this.type.name!==t.type.name){this.type=t.type;var n,i=this.form;switch(Object.keys(this.controls).forEach((function(t){i.removeKey(t)})),t.type.name){case ni.WaitingRoom.name:n=["id","type","name","latitude","longitude","zoom","asset"];break;case ni.Panorama.name:n=["id","type","name","hidden?","latitude","longitude","zoom","asset"];break;case ni.PanoramaGrid.name:n=["id","type","name","hidden?","latitude","longitude","zoom"];break;case ni.Room3d.name:case ni.Model.name:n=["id","type","name","hidden?","latitude","longitude","zoom","asset"];break;case ni.Media.name:n=["id","type","name","hidden?","asset"];break;default:n=["id","type","name"]}t.type.name!==ni.WaitingRoom.name&&E.flags.ar&&(n.push("usdz?"),n.push("gltf?")),n.forEach((function(n){var o=-1!==n.indexOf("?");switch(n=n.replace("?","")){case"latitude":case"longitude":var r=t.orientation||{latitude:0,longitude:0};i.add(new e.FormControl(r[n],e.RequiredValidator()),n);break;case"usdz":case"gltf":i.add(new e.FormControl(t.ar&&t.ar[n]||null,o?void 0:e.RequiredValidator()),n);break;default:i.add(new e.FormControl(null!=t[n]?t[n]:null,o?void 0:e.RequiredValidator()),n)}})),this.controls=i.controls}},o.onChanges=function(t){this.doUpdateForm()},o.onSubmit=function(){var t=this;if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();var e=Object.assign({},this.form.value);null!=e.latitude&&(e.orientation={latitude:e.latitude,longitude:e.longitude},delete e.latitude,delete e.longitude);var n=e.usdz||null,o=e.gltf||null;delete e.usdz,delete e.gltf,e.ar=n||o?{usdz:n,gltf:o}:null;var r=new oi(Object.assign({},this.view,e));il.viewUpdate$(r).pipe(i.first()).subscribe((function(e){t.update.next({view:r}),t.setTimeout((function(){t.busy=!1,t.pushChanges()}))}),(function(t){return console.log("UpdateViewComponent.onSubmit.viewUpdate$.error",t)}))}else this.form.touched=!0},o.onRemove=function(t){var e=this;Bn.open$({template:vl.chunk(),data:{item:this.item}}).pipe(i.first()).subscribe((function(t){t instanceof Hn&&e.delete.next({view:e.view})}))},o.onSelect=function(t){this.select.next({view:this.view.selected?null:this.view})},o.getTitle=function(t){return Dn.getKeys("editor",t.type.name)},o.clearTimeout=function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){this.to&&clearTimeout(this.to)})),o.setTimeout=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))})),o.onDestroy=function(){this.clearTimeout()},n}(t.Component);Ql.meta={selector:"update-view",outputs:["select","update","delete"],inputs:["view"],template:'\n\t\t<div class="group--headline" [class]="{ active: view.selected }" (click)="onSelect($event)">\n\t\t\t\x3c!-- <div class="id" [innerHTML]="view.id"></div> --\x3e\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title" [innerHTML]="getTitle(view)"></div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="view.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t\x3c!-- <div control-text [control]="controls.type" label="Type" [disabled]="true"></div> --\x3e\n\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'waiting-room\'">\n\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'panorama\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'panorama-grid\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'room-3d\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'model\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name != \'waiting-room\' && (\'ar\' | flag)">\n\t\t\t\t<div control-model [control]="controls.usdz" label="AR IOS (.usdz)" accept=".usdz"></div>\n\t\t\t\t<div control-model [control]="controls.gltf" label="AR Android (.glb)" accept=".glb"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--remove" *if="view.type.name != \'waiting-room\'" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t'};var tc=[Rl,ol,gl,rl,zl,Xl,Vl,Ul,sl,Dl,al,ll,ul,cl,dl,hl,pl,vl,ml,Il,Yl,Jl,Ql],ec=[],nc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(t.Module);nc.meta={imports:[],declarations:[].concat(tc,ec),exports:[].concat(tc,ec)};var ic=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){for(var e=E,n=t.split("."),i=n.shift();n.length>0&&e[i];)e=e[i],i=n.shift();return e[i]||null},e}(t.Pipe);ic.meta={name:"env"};var oc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){return E.flags[t]||!1},e}(t.Pipe);oc.meta={name:"flag"};var rc=function(t){this.file=t,this.name=t.name,this.type=zi(t.name),this.progress=0,this.size=t.size,this.uploading=!1,this.paused=!1,this.success=!1,this.complete=!1,this.error=null,this.preview=null},sc=function(t){t&&Object.assign(this,t)},ac=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(sc),lc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(sc),cc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(sc),uc=function(){function e(){this.concurrent$=new n.BehaviorSubject(0),this.items$=new n.BehaviorSubject([]),this.events$=new n.ReplaySubject(1)}var o=e.prototype;return o.upload$=function(){var t=this,e=this.items$.getValue().filter((function(t){return!t.uploading}));return n.combineLatest(e.map((function(e){return t.uploadItem$(e)})))},o.uploadItem$=function(t){var e=this;t.uploading=!0,this.events$.next(new ac({item:t}));var o=[t.file];return n.of(o).pipe(i.delayWhen((function(){return e.concurrent$.pipe(i.filter((function(t){return t<4})))})),i.tap((function(){return e.concurrent$.next(e.concurrent$.getValue()+1)})),i.first(),i.switchMap((function(t){return nl.upload$(t)})),i.switchMap((function(n){var o=n[0];t.uploading=!1,t.complete=!0;var r=ji.fromUrl(o.url);return e.events$.next(new lc({item:t,asset:r})),nl.assetCreate$(r).pipe(i.tap((function(n){e.remove(t),e.events$.next(new cc({item:t,asset:n})),e.concurrent$.next(e.concurrent$.getValue()-1)})))})))},o.addItems=function(t){if(t&&t.length){var e=this.items$.getValue(),n=Array.from(t).map((function(t){return new rc(t)}));e.push.apply(e,n),this.items$.next(e)}},o.remove=function(t){var e=this.items$.getValue(),n=e.indexOf(t);-1!==n&&e.splice(n,1),this.items$.next(e)},o.removeAll=function(){this.items$.next([])},o.drop$=function(e,o){var r=this;if(t.isPlatformBrowser&&e){o=o||e;var s=document.querySelector("body");return n.merge(n.fromEvent(s,"drop"),n.fromEvent(s,"dragover")).pipe(i.map((function(t){return t.preventDefault(),t.target===o&&r.addItems(t.dataTransfer.files),r.items$})))}return n.EMPTY},o.change$=function(e){var o=this;return t.isPlatformBrowser&&e?n.fromEvent(e,"change").pipe(i.switchMap((function(t){return e.files.length&&(o.addItems(e.files),e.value=""),o.items$}))):n.EMPTY},o.files$=function(t){var e=this;return n.combineLatest(Array.from(t).map((function(t,n){return e.file$(t,n)})))},o.file$=function(t,e){var n=this;return this.read$(t,e).pipe(i.switchMap((function(){return n.uploadFile$(t)})))},o.read$=function(t,e){var o=this,r=new FileReader,s=n.fromEvent(r,"load").pipe(i.tap((function(t){var n=t.target.result;o.resize(n,(function(t){o.previews[e]=t,o.pushChanges()}))})));return r.readAsDataURL(t),s},o.uploadFile$=function(t){return nl.upload$([t]).pipe(i.switchMap((function(t){var e=t[0],n=ji.fromUrl(e.url);return nl.assetCreate$(n)})))},o.resize=function(t,e){if("function"==typeof e){var n=document.createElement("img");n.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d"),o=n.width,r=n.height;o>r?o>320&&(r*=320/o,o=320):r>240&&(o*=240/r,r=240),t.width=o,t.height=r,i.drawImage(n,0,0,o,r);var s=t.toDataURL("image/jpeg",.9);e(s)},n.src=t}},o.supported=function(){return(e=document.createElement("input")).type="file","files"in e&&!!((t=new XMLHttpRequest)&&"upload"in t&&"onprogress"in t.upload)&&!!window.FormData;var t,e},e}(),dc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var e=this;this.label=this.label||"label",this.accept=this.accept||"image/png, image/jpeg",this.multiple=!1!==this.multiple,this.items=[],this.assets=this.control.value||[],this.hasFiles=!1;var n=t.getContext(this).node,o=n.querySelector("input");o.setAttribute("accept",this.accept);var r=n.querySelector(".upload-drop"),s=this.service=new uc;s.drop$(o,r).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.items=t,e.pushChanges()})),s.change$(o).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.items=t,e.pushChanges()})),s.events$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){t instanceof cc&&(e.assets.push(t.asset),e.control.value=e.assets),e.items=e.items,e.pushChanges()}))},o.onUpload=function(){this.service.upload$().pipe(i.first()).subscribe()},o.onCancel=function(){this.service.removeAll()},o.onItemPause=function(t){},o.onItemResume=function(t){},o.onItemCancel=function(t){},o.onItemRemove=function(t){this.service.remove(t)},l(n,[{key:"items",get:function(){return this.items_},set:function(t){this.items_=t,this.uploadCount=t.reduce((function(t,e){return t+(e.uploading||e.completed?0:1)}),0)}}]),n}(Hl);dc.meta={selector:"[control-assets]",inputs:["control","label","multiple"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="listing--assets">\n\t\t\t\t<div class="listing__item" *for="let item of assets">\n\t\t\t\t\t<div class="upload-item">\n\t\t\t\t\t\t<div class="picture">\n\t\t\t\t\t\t\t<img [lazy]="item | asset" [size]="{ width: 320, height: 240 }" *if="item.type.name === \'image\'" />\n\t\t\t\t\t\t\t<video [src]="item | asset" *if="item.type.name === \'video\'"></video>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="name" [innerHTML]="item.file"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="listing__item" *for="let item of items">\n\t\t\t\t\t<div upload-item [item]="item" (pause)="onItemPause($event)" (resume)="onItemResume($event)" (cancel)="onItemCancel($event)" (remove)="onItemRemove($event)"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<div class="btn--browse">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t\t<input type="file" accept="image/jpeg" multiple />\n\t\t\t\t</div>\n\t\t\t\t<div class="btn--upload" (click)="onUpload()" *if="uploadCount > 0" [innerHTML]="\'upload\' | label"></div>\n\t\t\t\t<div class="btn--cancel" (click)="onCancel()" *if="uploadCount > 0" [innerHTML]="\'cancel\' | label"></div>\n\t\t\t</div>\n\t\t\t<div class="upload-drop">\n    \t\t\t<span [innerHTML]="\'drag_and_drop_images\' | label"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var hc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onInit=function(){this.label=this.label||"label"},e}(Hl);hc.meta={selector:"[control-checkbox]",inputs:["control","label"],template:'\n\t\t<div class="group--form--checkbox" [class]="{ required: control.validators.length }">\n\t\t\t<label>\n\t\t\t\t<input type="checkbox" class="control--checkbox" [formControl]="control" [value]="true" />\n\t\t\t\t<span [innerHTML]="label | html"></span>\n\t\t\t</label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var pc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var t=this;this.label=this.label||"label",this.dropped=!1,this.dropdownId=Ll.nextId(),ho.typing$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.scrollToWord(e)}))},o.scrollToWord=function(e){for(var n=this.control.options||[],i=-1,o=0;o<n.length;o++){if(0===n[o].name.toLowerCase().indexOf(e.toLowerCase())){i=o;break}}if(-1!==i){var r=t.getContext(this).node,s=r.querySelector(".dropdown"),a=r.querySelector(".nav--dropdown").children[i];a&&s.scrollTo(0,a.offsetTop)}},o.setOption=function(t){var e;if(this.isMultiple){var n=this.control.value||[],i=n.indexOf(t.id);-1!==i?n.splice(i,1):n.push(t.id),function(t){throw new Error('"'+t+'" is read-only')}("value"),n=n.length?n.slice():null}else e=t.id;this.control.value=e,this.change.next(e)},o.hasOption=function(t){return this.isMultiple?-1!==(this.control.value||[]).indexOf(t.id):this.control.value===t.id},o.getLabel=function(){var t=this.control.value,e=this.control.options||[];if(this.isMultiple)return(t=t||[]).length?t.map((function(t){var n=e.find((function(e){return e.id===t||e.name===t}));return n?n.name:""})).join(", "):"select";var n=e.find((function(e){return e.id===t||e.name===t}));return n?n.name:"select"},o.onDropped=function(t){this.dropped&&null===t&&(this.control.touched=!0),this.dropped=t===this.dropdownId},l(n,[{key:"isMultiple",get:function(){return this.multiple&&!1!==this.multiple&&"false"!==this.multiple}}]),n}(Hl);pc.meta={selector:"[control-custom-select]",outputs:["change"],inputs:["control","label","multiple"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length, multiple: isMultiple }" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="control--custom-select" [innerHTML]="getLabel() | label"></span>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t<div class="category" [innerHTML]="label"></div>\n\t\t\t<ul class="nav--dropdown" [class]="{ multiple: isMultiple }">\n\t\t\t\t<li (click)="setOption(item)" [class]="{ empty: item.id == null }" *for="let item of control.options">\n\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name | label"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t'};var vc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.label=this.label||"label",this.disabled=this.disabled||!1;var e=getContext(this).node,n=this.input=e.querySelector("input");merge(fromEvent(n,"input")).pipe(takeUntil(this.unsubscribe$)).subscribe((function(e){return t.onInputDidChange(e)})),fromEvent(n,"blur").pipe(takeUntil(this.unsubscribe$)).subscribe((function(e){return t.onInputDidBlur(e)}))},n.onInputDidChange=function(t){console.log("ControlLinkComponent.onInputDidChange",t.target.value)},n.onInputDidBlur=function(t){this.control.touched=!0,this.value=this.input.value},e}(Hl);vc.meta={selector:"[control-link]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var mc=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this;this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||"image/png, image/jpeg",this.languages=E.languages,this.currentLanguage=E.defaultLanguage;var o=t.getContext(this).node.querySelector("input");o.setAttribute("accept",this.accept),$l.drop$(o).pipe(i.takeUntil(this.unsubscribe$)).subscribe(),$l.change$(o).pipe(i.switchMap((function(t){var o=t.map((function(t,n){return nl.upload$([t]).pipe(i.switchMap((function(t){return(e.languages.length>1?nl.createOrUpdateLocalizedAsset$:nl.createOrUpdateAsset$)(t,e.control,e.currentLanguage)})))}));return n.combineLatest(o)})),i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.control.value=t[0]}))},r.setLanguage=function(t){this.currentLanguage=t,this.pushChanges()},l(o,[{key:"localizedValue",get:function(){var t=this.control.value;if(t&&t.locale){var e=t.locale[this.currentLanguage];e&&(t=e)}return t}}]),o}(Hl);mc.meta={selector:"[control-localized-asset]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--picture">\n\t\t\t\t<div class="group--picture__info">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t</div>\n\t\t\t\t<img [lazy]="localizedValue | asset" [size]="{ width: 320, height: 240 }" *if="localizedValue && localizedValue.type.name === \'image\'" />\n\t\t\t\t<video [src]="localizedValue | asset" *if="localizedValue && localizedValue.type.name === \'video\'"></video>\n\t\t\t\t<input type="file">\n\t\t\t</div>\n\t\t\t<div class="file-name" *if="localizedValue" [innerHTML]="localizedValue.file"></div>\n\t\t\t<ul class="nav--languages" *if="languages.length > 1">\n\t\t\t\t<li class="nav__item" [class]="{ active: lang == currentLanguage }" (click)="setLanguage(lang)" [innerHTML]="lang" *for="let lang of languages"></li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var fc=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this;this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||".glb";var o=t.getContext(this).node,r=this.input=o.querySelector("input");r.setAttribute("accept",this.accept),$l.change$(r).pipe(i.switchMap((function(t){var o=t.map((function(t,n){return nl.upload$([t]).pipe(i.switchMap((function(t){return nl.createOrUpdateAsset$(t,e.control)})))}));return n.combineLatest(o)})),i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.control.value=t[0]}))},r.onRemove=function(t){var e=this;nl.assetDelete$(this.control.value).pipe(i.first()).subscribe((function(){e.control.value=null,e.input.value=null,e.control.touched=!0}))},r.read$=function(t,e){return n.of(t)},o}(Ol);fc.meta={selector:"[control-model]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--model">\n\t\t\t\t<div class="file-name" *if="!control.value" [innerHTML]="\'select_file\' | label"></div>\n\t\t\t\t<div class="file-name" *if="control.value" [innerHTML]="control.value.file"></div>\n\t\t\t\t<div class="btn--upload"><input type="file"><span [innerHTML]="\'browse\' | label"></span></div>\n\t\t\t\t<div class="btn--remove" *if="control.value" (click)="onRemove($event)"><span [innerHTML]="\'remove\' | label"></span></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var gc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){this.label=this.label||"label",this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1},n.updateValue=function(t){this.control.value=t},e}(Hl);gc.meta={selector:"[control-number]",inputs:["control","label","precision","increment","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="control--content control--number">\n\t\t\t\t<input-value label="" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value" (update)="updateValue($event)"></input-value>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var bc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onInit=function(){this.label=this.label||"label"},e}(Hl);bc.meta={selector:"[control-password]",inputs:["control","label"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<input type="password" class="control--text" [formControl]="control" [placeholder]="label" />\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var wc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onInit=function(){this.label=this.label||"label"},e}(Hl);wc.meta={selector:"[control-select]",inputs:["control","label"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<select class="control--select" [formControl]="control" required>\n\t\t\t\t<option [value]="null" [innerHTML]="\'select\' | label"></option>\n\t\t\t\t<option [value]="item.id" *for="let item of control.options" [innerHTML]="item.name"></option>\n\t\t\t</select>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var yc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onInit=function(){this.label=this.label||"label",this.disabled=this.disabled||!1},e}(Hl);yc.meta={selector:"[control-text]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var xc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.onInit=function(){this.label=this.label||"label",this.disabled=this.disabled||!1},e}(Hl);xc.meta={selector:"[control-textarea]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form--textarea" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<textarea class="control--text" [formControl]="control" [placeholder]="label" [innerHTML]="label" rows="4" [disabled]="disabled"></textarea>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var Cc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){this.label=this.label||"label",this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1},n.updateValue=function(t,e){var n=this.control.value;n[t]=e,this.control.value=n.slice()},e}(Hl);Cc.meta={selector:"[control-vector]",inputs:["control","label","precision","increment","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="control--content control--vector">\n\t\t\t\t<input-value label="x" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[0]" (update)="updateValue(0, $event)"></input-value>\n\t\t\t\t<input-value label="y" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[1]" (update)="updateValue(1, $event)"></input-value>\n\t\t\t\t<input-value label="z" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[2]" (update)="updateValue(2, $event)"></input-value>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var kc=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onChanges=function(){var e=t.getContext(this).node;!0===this.disabled?(e.disabled=this.disabled,e.setAttribute("disabled",this.disabled)):(delete e.disabled,e.removeAttribute("disabled"))},n}(t.Directive);kc.meta={selector:"input[disabled],textarea[disabled]",inputs:["disabled"]};var Mc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.prototype.getLabel=function(t,e){return Dn.transform("error_"+t)},e}(Hl);Mc.meta={selector:"errors-component",inputs:["control"],template:'\n\t<div class="inner" [style]="{ display: control.invalid && control.touched ? \'block\' : \'none\' }">\n\t\t<div class="error" *for="let [key, value] of control.errors">\n\t\t\t<span [innerHTML]="getLabel(key, value)"></span>\n\t\t\t\x3c!-- <span class="key" [innerHTML]="key"></span> <span class="value" [innerHTML]="value | json"></span> --\x3e\n\t\t</div>\n\t</div>\n\t'};var Sc=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this;this.label=this.label||"label",this.value=this.value||0,this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1,this.increment$(".btn--more",1).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.value+=t,e.update.next(e.value),e.pushChanges()})),this.increment$(".btn--less",-1).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.value+=t,e.update.next(e.value),e.pushChanges()}));var o=t.getContext(this).node,r=this.input=o.querySelector("input");n.merge(n.fromEvent(r,"input")).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onInputDidChange(t)})),n.merge(n.fromEvent(r,"blur"),n.fromEvent(r,"keydown").pipe(i.filter((function(t){return"Enter"===t.key||13===t.keyCode})))).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onInputDidBlur(t)}))},r.onInputDidChange=function(t){t.target.value=t.target.value.replace(/[^\d|\.|-]/g,"")},r.onInputDidBlur=function(t){var e=parseFloat(this.input.value);this.value!==e&&(NaN!==e?(this.value=e,this.update.next(this.value)):this.input.value=this.getValue())},r.increment$=function(e,o){var r,s,a=this,l=t.getContext(this).node.querySelector(e);return n.race(n.fromEvent(l,"mousedown"),n.fromEvent(l,"touchstart")).pipe(i.tap((function(){s=a.increment,r=16})),i.switchMap((function(t){return n.interval(30).pipe(i.filter((function(t){return t%r==0})),i.map((function(){var t=s*o;return r=Math.max(1,Math.floor(.85*r)),t})),i.takeUntil(n.race(n.fromEvent(l,"mouseup"),n.fromEvent(l,"touchend"))))})))},r.getValue=function(){return this.value.toFixed(this.precision)},r.setValue=function(t){this.value+=this.increment*t,this.update.next(this.value),this.pushChanges()},o}(t.Component);Sc.meta={selector:"input-value",outputs:["update"],inputs:["value","label","precision","increment","disabled"],template:'\n\t\t<div class="group--control" [class]="{ disabled: disabled }">\n\t\t\t<input type="text" class="control--text" [placeholder]="label" [value]="getValue()" [disabled]="disabled" />\n\t\t\t<div class="control--trigger">\n\t\t\t\t<div class="btn--more" (click)="setValue(1)">+</div>\n\t\t\t\t<div class="btn--less" (click)="setValue(-1)">-</div>\n\t\t\t</div>\n\t\t</div>\n\t'};var Tc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){this.env=C},n.onTest=function(t){this.test.next(t)},n.onReset=function(t){this.reset.next(t)},e}(t.Component);Tc.meta={selector:"test-component",inputs:["form"],outputs:["test","reset"],template:'\n\t<div class="group--form--results" *if="env.DEVELOPMENT">\n\t\t<code [innerHTML]="form.value | json"></code>\n\t\t<button type="button" class="btn--mode" (click)="onTest($event)"><span>test</span></button>\n\t\t<button type="button" class="btn--mode" (click)="onReset($event)"><span>reset</span></button>\n\t</div>\n\t'};var Ec=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onChanges=function(e){var n=t.getContext(this).node;n.value=this.value,n.setAttribute("value",this.value)},n}(t.Directive);Ec.meta={selector:"[value]",inputs:["value"]};var Lc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){if(t){t=t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e))}));var e=['"',"&","'","<",">"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","­","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","&","•","°","∞","‰","⋅","±","†","—","¬","µ","⊥","∥","€","£","¥","¢","©","®","™","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],n=new RegExp("(&"+["quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","amp","bull","deg","infin","permil","sdot","plusmn","dagger","mdash","not","micro","perp","par","euro","pound","yen","cent","copy","reg","trade","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigma","tau","upsilon","phi","chi","psi","omega","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"].join(";)|(&")+";)","g");return t=t.replace(n,(function(){for(var t=1;t<arguments.length;t++)if(arguments[t])return e[t-1]}))}},e}(t.Pipe);Lc.meta={name:"html"};var _c=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.onChanges=function(){t.getContext(this).node.setAttribute("id",this.id)},n}(t.Directive);_c.meta={selector:"[id]",inputs:["id"]};var Ic=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){this.showLanguages=!1,this.languageService=Ni},n.setLanguage=function(t){var e=this;this.languageService.setLanguage$(t).pipe(i.first()).subscribe((function(t){e.showLanguages=!1,e.pushChanges(),e.set.next()}))},n.toggleLanguages=function(){this.showLanguages=!this.showLanguages,this.pushChanges()},e}(t.Component);Ic.meta={selector:"[language]",outputs:["set"],template:'\n\t\t<button type="button" class="btn--language" (click)="toggleLanguages()" *if="languageService.hasLanguages"><span [innerHTML]="languageService.activeLanguage.title"></span> <svg viewBox="0 0 8 5"><use xlink:href="#caret-down"></use></svg></button>\n\t\t<ul class="nav--language" *if="showLanguages">\n\t\t\t<li (click)="setLanguage(language)" *for="let language of languageService.languages"><span [innerHTML]="language.title"></span></li>\n\t\t</ul>\n\t'};var Rc=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var t=this,e=this.meetingUrl.embedViewId;this.state={status:L.get("status")||he,role:L.get("role")||I.Publisher,membersCount:3,controlling:!1,spying:!1,silencing:!1,hosted:!0,chat:!1,chatDirty:!0,name:"Jhon Appleseed",uid:"7341614597544882",showNavInfo:!0},this.state.live=this.state.role!==I.SelfService&&this.state.role!==I.Embed&&!g,this.state.navigable=null==e,this.state.mode=pn.getMode(this.state.role),this.view={likes:41},this.local={},this.screen=null,this.remoteScreen_=null,this.media=null,this.hasScreenViewItem=!1,this.media=!0,this.remotes=new Array(8).fill(0).map((function(t,e){return{id:e+1}})),this.languageService=Ni,this.showLanguages=!1,_.patchState(this.state),this.fullscreen$().pipe(i.takeUntil(this.unsubscribe$)).subscribe();this.vrService=Cr.getService();console.log("LayoutComponent",this),setTimeout((function(){var e=ki;switch(e){case xi:_i.open$({message:Dn.transform("bhere_support_request_sent")}).pipe(i.takeUntil(t.unsubscribe$)).subscribe((function(t){t instanceof Ei&&console.log("ToastResolveEvent",t)}));break;case Ci:_i.open$({message:Dn.transform("bhere_support_request_sent"),type:e,position:Si}).pipe(i.takeUntil(t.unsubscribe$)).subscribe((function(t){t instanceof Ei?console.log("ToastResolveEvent",t):t instanceof Li&&console.log("ToastRejectEvent",t)}));break;case ki:_i.open$({message:Dn.transform("bhere_support_request_dialog"),acceptMessage:Dn.transform("bhere_support_request_dialog_accept"),rejectMessage:Dn.transform("bhere_support_request_dialog_reject"),type:e,position:Si}).pipe(i.takeUntil(t.unsubscribe$)).subscribe((function(t){t instanceof Ei?console.log("ToastResolveEvent",t):t instanceof Li&&console.log("ToastRejectEvent",t)}))}}),3e3)},r.setLanguage=function(t){var e=this;this.languageService.setLanguage$(t).pipe(first()).subscribe((function(t){e.showLanguages=!1,e.pushChanges()}))},r.toggleLanguages=function(){this.showLanguages=!this.showLanguages,this.pushChanges()},r.patchState=function(t){this.state=Object.assign({},this.state,t),this.screen=this.state.screen||null,this.remoteScreen=this.screen,this.pushChanges()},r.toggleCamera=function(){this.patchState({cameraMuted:!this.state.cameraMuted})},r.toggleAudio=function(){this.patchState({audioMuted:!this.state.audioMuted})},r.toggleScreen=function(){this.patchState({screen:!this.state.screen}),window.dispatchEvent(new Event("resize"))},r.toggleVolume=function(){this.patchState({volumeMuted:!this.state.volumeMuted})},r.toggleMode=function(){var t=this.state.mode===Je?Qe:Je;this.patchState({mode:t})},r.toggleFullScreen=function(){var e=t.getContext(this).node;!this.state.fullScreen?e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},r.fullscreen$=function(){var t=this;return n.fromEvent(document,"fullscreenchange").pipe(i.tap((function(e){var n=null!=document.fullscreenElement;t.patchState({fullScreen:n})})))},r.toggleChat=function(){this.patchState({chat:!this.state.chat,chatDirty:!1}),window.dispatchEvent(new Event("resize"))},r.toggleNavInfo=function(){this.patchState({showNavInfo:!this.state.showNavInfo})},r.onBack=function(){console.log("LayoutComponent.onBack")},r.onChatClose=function(){this.patchState({chat:!1}),window.dispatchEvent(new Event("resize"))},r.onToggleControl=function(t){var e=this.state.controlling===t?null:t;this.patchState({controlling:e,spying:!1})},r.onToggleSilence=function(){this.patchState({silencing:!this.state.silencing})},r.onToggleSpy=function(t){var e=this.state.spying===t?null:t;this.patchState({spying:e,controlling:!1})},r.addLike=function(){this.view.liked=!0,this.showLove(this.view)},r.showLove=function(t){var e=this;if(t&&this.view.id===t.id){var n=this.view.showLove;this.view.likes=t.likes,this.view.showLove=!0,this.pushChanges(),n||setTimeout((function(){e.view.showLove=!1,e.pushChanges()}),3100)}},r.disconnect=function(){},l(o,[{key:"meetingUrl",get:function(){return this.meetingUrl_||(this.meetingUrl_=new $),this.meetingUrl_}},{key:"isVirtualTourUser",get:function(){return-1!==[I.Publisher,I.Attendee,I.Streamer,I.Viewer].indexOf(this.state.role)}},{key:"isEmbed",get:function(){return-1!==window.location.href.indexOf(E.url.embed)}},{key:"isNavigable",get:function(){return null==this.meetingUrl.embedViewId}},{key:"showNavInfoToggler",get:function(){return E.flags.hideNavInfo&&this.state.mode!==Qe}},{key:"uiClass",get:function(){var t={};return t[this.state.role]=!0,t.chat=this.state.chat,t.remotes=this.state.mode===Qe,t.remoteScreen=null!=this.remoteScreen&&!this.hasScreenViewItem,t.media=!t.remotes&&this.media,t.locked=this.locked,t}},{key:"remoteClass",get:function(){return"group--remote--"+Math.min(9,this.remotes.length)}},{key:"controlled",get:function(){return this.state.controlling&&this.state.controlling!==this.state.uid}},{key:"controlling",get:function(){return this.state.controlling&&this.state.controlling===this.state.uid}},{key:"silencing",get:function(){return _.state.silencing}},{key:"silenced",get:function(){return _.state.silencing&&_.state.role===I.Streamer}},{key:"spyed",get:function(){return this.state.spying&&this.state.spying===this.state.uid}},{key:"spying",get:function(){return this.state.spying&&this.state.spying!==this.state.uid}},{key:"locked",get:function(){return this.controlled||this.spying}},{key:"remoteScreen",get:function(){return this.remoteScreen_},set:function(t){this.remoteScreen_!==t&&(this.remoteScreen_=t,window.dispatchEvent(new Event("resize")))}}]),o}(t.Component);Rc.meta={selector:"[layout-component]"};var Ac=function(){function t(){}return t.observer=function(){var t=this;return this.observer_||(this.readySubject_=new n.BehaviorSubject(!1),this.observerSubject_=new n.Subject,this.observer_=new IntersectionObserver((function(e){t.observerSubject_.next(e)}))),this.observer_},t.intersection$=function(t){if("IntersectionObserver"in window){var e=this.observer();return e.observe(t),this.observerSubject_.pipe(i.map((function(e){return e.find((function(e){return e.target===t}))})),i.filter((function(t){return void 0!==t&&t.isIntersecting})),i.first(),i.finalize((function(){return e.unobserve(t)})))}return n.of({target:t})},t}(),Pc=function(){function t(){}return t.get=function(t){return this.cache[t]},t.set=function(t,e){this.cache[t]=e;var n=Object.keys(this.cache);n.length>100&&this.remove(n[0])},t.remove=function(t){delete this.cache[t]},l(t,null,[{key:"cache",get:function(){return this.cache_||(this.cache_={}),this.cache_}}]),t}(),$c=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=this,o=t.getContext(this).node;o.classList.add("lazy"),this.input$=(new n.Subject).pipe(i.distinctUntilChanged(),i.switchMap((function(t){var i=Pc.get(t);return i?n.of(i):(o.classList.remove("lazyed"),e.lazy$(t))})),i.takeUntil(this.unsubscribe$)),this.input$.subscribe((function(t){Pc.set(e.lazy,t),o.setAttribute("src",t),o.classList.add("lazyed")}))},r.onChanges=function(){this.input$.next(this.lazy)},r.lazy$=function(e){var n=this,o=t.getContext(this).node;return Ac.intersection$(o).pipe(i.switchMap((function(){return sr.load$(e,n.size)})),i.first())},o}(t.Directive);$c.meta={selector:"[lazy],[[lazy]]",inputs:["lazy","size"]};var Hc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){var n=e.urlify(t);return n=e.breakLines(n)},e.urlify=function(t){return t.replace(/(?:(?:https?|ftp):\/\/|\b(?:[a-z\d]+\.))(?:(?:[^\s()<>]+|\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))?\))+(?:\((?:[^\s()<>]+|(?:\(?:[^\s()<>]+\)))?\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))?/gim,(function(t){return'<a href="'+t+'" target="_blank">'+t+"</a>"}))},e.breakLines=function(t){return t.replace(/\n/gm,(function(t){return"<br>"}))},e}(t.Pipe);Hc.meta={name:"message"};var Oc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){var e=t.getContext(this).parentInstance;e instanceof Ii&&(this.data=e.modal.data)},i.onClose=function(){Bn.reject()},n}(t.Component);Oc.meta={selector:"[modal]"};var Bc=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e.transform=function(t){switch(t){case"index":return"it.access";default:return"it."+t}},e}(t.Pipe);Bc.meta={name:"route"};var Dc=function(e){function o(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return c(h(t=e.call.apply(e,[this].concat(i))||this),"path",void 0),c(h(t),"segments",void 0),c(h(t),"routerLink_",void 0),t}d(o,e);var r=o.prototype;return r.onInit=function(){this.routerLink$().pipe(i.takeUntil(this.unsubscribe$)).subscribe()},r.onChanges=function(){var e=t.getContext(this).node,n=this.routerLink;if(n.length){var i=Jt.buildPath.apply(Jt,n);e.setAttribute("href",i.url)}else e.setAttribute("href","")},r.routerLink$=function(){var e=this,o=t.getContext(this).node;return n.fromEvent(o,"click").pipe(i.map((function(t){return Jt.setRouterLink.apply(Jt,e.routerLink),t.preventDefault(),!1})))},r.getSegments=function(t){var e=[];return t.forEach((function(t){if("string"==typeof t)for(var n,i=[],o=v(t.matchAll(/([^:]+)|\:([^\/]+)/g));!(n=o()).done;){var r=n.value,s=r[1],a=r[2];if(s)i.push(s);else if(a){var l={};l[a]=null,i.push(l)}}else e.push(new RouteSegment("",{}))})),e},l(o,[{key:"routerLink",get:function(){return this.routerLink_},set:function(t){this.routerLink_=Array.isArray(t)?t:[t]}}]),o}(t.Directive);c(Dc,"meta",{selector:"[routerLink]",inputs:["routerLink"]});var Uc=function(e){function o(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return c(h(t=e.call.apply(e,[this].concat(o))||this),"host",void 0),c(h(t),"outlet",void 0),c(h(t),"element",void 0),c(h(t),"instance",void 0),c(h(t),"route$_",new n.ReplaySubject(1)),t}d(o,e);var r=o.prototype;return r.getFactory=function(t){var e=null,n=this.routes.find((function(e){return e.name===t.name}));return n&&(e=n.factory),e},r.onInit=function(){var t=this;this.route$().pipe(i.switchMap((function(e){return t.factory$(e)})),i.takeUntil(this.unsubscribe$)).subscribe((function(t){console.log("RouterOutletStructure.route$",t)}))},r.route$=function(){var t=this.routes;return t?Jt.useBrowser$(t).pipe(i.map((function(t){return t.route}))):n.EMPTY},r.factory$=function(e){var o=this,r=this.getFactory(e),s=t.getContext(this),a=s.module,l=s.node;return this.factory_!==r?(this.factory_=r,n.of(r).pipe(i.tap((function(){o.element&&(o.element.parentNode.removeChild(o.element),a.remove(o.element,o),o.element=void 0,o.instance=void 0)})),i.map((function(){if(r&&r.meta.template){var t=document.createElement("div");t.innerHTML=r.meta.template,1===t.children.length&&(t=t.firstElementChild),l.appendChild(t);var n=a.makeInstance(t,r,r.meta.selector,o,void 0,{route:e});return a.compile(t,n),o.instance=n,o.element=t,{element:t,instance:n}}})))):n.EMPTY},r.onChanges=function(){},l(o,[{key:"route",get:function(){return this.route_}}]),o}(t.Structure);c(Uc,"meta",{selector:"router-outlet,[router-outlet]",hosts:{host:Uc},inputs:["routes"]});var Vc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){e.prototype.onInit.call(this);var n=t.getContext(this).parentInstance;n instanceof Ii&&(this.data=n.modal.data)},i.onAccept=function(t){Bn.resolve()},i.onReject=function(t){Bn.reject()},i.onClose=function(){Bn.reject()},n}(t.Component);Vc.meta={selector:"[support-request-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Un operatore è disponibile per un tour guidato.<br>Desideri Accettare?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t\t<span>Accetta</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()">\n\t\t\t\t\t\t<span>Rifiuta</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},Vc.chunk=function(){return'<div class="support-request-modal" support-request-modal></div>'};var zc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){this.update()},i.onChanges=function(){this.update()},i.update=function(){if(this.name_!==this.name){this.name_=this.name;var e=t.getContext(this).node;if(e.parentNode){var n,i=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=this.width||24,r=this.height||24;i.setAttribute("class","icon--"+this.name),i.setAttributeNS(null,"viewBox","0 0 "+o+" "+r),i.innerHTML='<use xlink:href="#'+this.name+'"></use>',i.rxcompId=e.rxcompId,(n=i.classList).add.apply(n,e.classList),e.parentNode.replaceChild(i,e)}}},n}(t.Structure);zc.meta={selector:"svg-icon",inputs:["name","width","height"]};var jc=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),l(n,[{key:"title",set:function(e){if(this.title_!==e){this.title_=e;var n=t.getContext(this).node;e?n.setAttribute("title",e):n.removeAttribute("title")}},get:function(){return this.title_}}]),n}(t.Directive);jc.meta={selector:"[[title]]",inputs:["title"]};var Fc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var o=e.prototype;return o.onInit=function(){var t=this;null===this.item.preview&&this.read$(this.item.file).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){t.item.preview=e,t.pushChanges()}))},o.read$=function(t){var e=this,o=new FileReader,r=n.fromEvent(o,"load").pipe(i.switchMap((function(t){var i=t.target.result;return e.item.type.name===Hi.Image.name?e.resize$(i):n.of(i)})));return o.readAsDataURL(t),r},o.resize$=function(t){return new Promise((function(e,n){var i=document.createElement("img");i.onload=function(){var t=document.createElement("canvas"),n=t.getContext("2d"),o=i.width,r=i.height;o>r?o>320&&(r*=320/o,o=320):r>240&&(o*=240/r,r=240),t.width=o,t.height=r,n.drawImage(i,0,0,o,r);var s=t.toDataURL("image/jpeg",.9);e(s)},i.onerror=function(t){n(t)},i.src=t}))},o.onPause=function(){this.pause.next(this.item)},o.onResume=function(){this.resume.next(this.item)},o.onCancel=function(){this.cancel.next(this.item)},o.onRemove=function(){this.remove.next(this.item)},e}(t.Component);Fc.meta={selector:"[upload-item]",outputs:["pause","resume","cancel","remove"],inputs:["item"],template:'\n\t<div class="upload-item" [class]="{ \'error\': item.error, \'success\': item.success }">\n\t\t<div class="picture">\n\t\t\t<img [lazy]="item.preview" [size]="{ width: 320, height: 240 }" *if="item.preview && item.type.name === \'image\'" />\n\t\t\t<video [src]="item.preview" *if="item.preview && item.type.name === \'video\'"></video>\n\t\t\t<svg class="spinner" width="24" height="24" viewBox="0 0 24 24" [class]="{ uploading: item.uploading }" *if="item.uploading"><use xlink:href="#spinner"></use></svg>\n\t\t</div>\n\t\t<div class="name">{{item.name}}</div>\n\t\t\x3c!--\n\t\t<div class="group--info">\n\t\t\t<div>progress: {{item.progress}}</div>\n\t\t\t<div>size: {{item.size}} bytes</div>\n\t\t\t<div>current speed: {{item.currentSpeed}} bytes/s</div>\n\t\t\t<div>average speed: {{item.averageSpeed}} bytes/s</div>\n\t\t\t<div>time ramining: {{item.timeRemaining}}s</div>\n\t\t\t<div>paused: {{item.paused}}</div>\n\t\t\t<div>success: {{item.success}}</div>\n\t\t\t<div>complete: {{item.complete}}</div>\n\t\t\t<div>error: {{item.error}}</div>\n\t\t</div>\n\t\t--\x3e\n\t\t\x3c!--\n\t\t<div class="group--cta" *if="!item.complete && item.uploading">\n\t\t\t<div class="btn--pause" (click)="onPause()">pause</div>\n\t\t\t<div class="btn--resume" (click)="onResume()">resume</div>\n\t\t\t<div class="btn--cancel" (click)="onCancel()">cancel</div>\n\t\t</div>\n\t\t--\x3e\n\t\t<div class="group--cta">\n\t\t\t<div class="btn--remove" (click)="onRemove()" *if="!item.complete">remove</div>\n\t\t</div>\n\t</div>\n\t'};var Nc=function(e){function n(){return e.apply(this,arguments)||this}return d(n,e),n.prototype.play=function(e){var n=t.getContext(this).node;if(Hls.isSupported()){var i=new Hls;i.attachMedia(n),i.on(Hls.Events.MEDIA_ATTACHED,(function(){i.loadSource(e),i.on(Hls.Events.MANIFEST_PARSED,(function(t,e){n.play()}))}))}},l(n,[{key:"hls",set:function(t){this.hls_!==t&&(this.hls_=t,this.play(t))},get:function(){return this.hls_}}]),n}(t.Directive);Nc.meta={selector:"[[hls]]",inputs:["hls"]};var Gc=function(t){function e(e,n,i,o,r,s,a){var l;return(l=t.call(this,a)||this)[e]=n,l[i]=o,l.index=r,l.count=s,l}return d(e,t),l(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(t.Context),qc=1,Zc=2,Wc=3,Kc=4,Xc=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var e=t.getContext(this),o=e.module,r=e.node,s=r.firstElementChild,a=r.getAttribute("*virtual");r.removeAttribute("*virtual"),r.removeChild(s);var l=this.tokens=this.getExpressionTokens(a);this.virtualFunction=o.makeFunction(l.iterable),this.container=r,this.template=s,this.mode=this.mode||1,this.width=this.width||250,this.gutter=void 0!==this.gutter?this.gutter:20,this.reverse=!0===this.reverse,this.options={width:this.width,gutter:this.gutter,reverse:this.reverse,containerWidth:0,containerHeight:0,top:0,cols:[0]},this.cachedRects={},this.cachedInstances=[],this.cacheNodes=[],this.items$=new n.BehaviorSubject([]),this.update$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){}))},r.onChanges=function(e){var n=t.getContext(this),i=n.module.resolve(this.virtualFunction,n.parentInstance,this)||[];this.mode=this.mode||1,this.width=this.width||250,this.gutter=void 0!==this.gutter?this.gutter:20,this.options.width=this.width,this.updateView(!0),this.items$.next(i)},r.update$=function(){var t=this;return this.updateView(!0),n.merge(this.scroll$(),this.resize$(),this.items$.pipe(i.distinctUntilChanged())).pipe(i.map((function(e){return t.updateForward()})))},r.updateForward=function(){var t=this,e=this.options,n=this.items$.getValue(),i=n.length;this.container.position="relative";for(var o=0,r=this.getWidth(),s=this.getGutter(r),a=[],l=0,c=n.length;l<c;l++){var u,d=n[l],h=void 0,p=void 0,v=void 0,m=void 0,f=this.cachedRects[l];if(f?(h=f.col,p=f.height,v=f.left):(h=this.getCol(),p=this.getHeight(r,d)),u=e.cols[h],this.intersect(u+e.top,u+p+e.top,0,e.containerHeight)){f||(v=this.getLeft(h,r,s));var g=this.cachedNode(l,l,d,i);g.style.position="absolute",g.style.top=u+"px",g.style.left=v+"px",g.style.width=r+"px",p!==g.offsetHeight&&(p=g.offsetHeight),m=u+p+e.gutter,o=Math.max(o,m),e.cols[h]=m,f?(f.height=p,f.bottom=m):this.cachedRects[l]={col:h,width:r,height:p,left:v,top:u,bottom:m},a.push(d)}else this.removeNode(l),m=u+p+e.gutter,e.cols[h]=m,o=Math.max(o,m)}for(var b=n.length;b<this.cacheNodes.length;)this.removeNode(b),b++;this.cacheNodes.length=n.length;var w=this.container.parentNode;if(this.reverse&&o<w.offsetHeight-1){var y=w.offsetHeight-1-o;n.forEach((function(e,n){if(-1!==a.indexOf(e)){var o=t.cachedRects[n];t.cachedNode(n,n,e,i).style.top=o.top+y+"px"}})),this.container.style.height=w.offsetHeight-1+"px"}else this.container.style.height=o+"px";return a},r.getCols=function(){var t=this.options,e=Math.floor((t.containerWidth+t.gutter)/(t.width+t.gutter))||1;return new Array(e).fill(0)},r.getCol=function(){var t,e=this.options;switch(this.mode){case Zc:case Wc:case qc:t=e.cols.reduce((function(t,e,n,i){return e<i[t]?n:t}),0);break;case Kc:default:t=0}return t},r.getWidth=function(){var t,e=this.options;switch(this.mode){case Zc:case Wc:t=e.width;break;case qc:t=(e.containerWidth-(e.cols.length-1)*e.gutter)/e.cols.length;break;case Kc:default:t=e.containerWidth}return t},r.getHeight=function(t,e){var n,i=this.options;switch(this.mode){case Zc:case Wc:case qc:n=i.width;break;case Kc:default:n=80}return n},r.getGutter=function(t){var e,n=this.options;switch(this.mode){case Zc:case Wc:e=n.gutter;break;case qc:e=(n.containerWidth-n.cols.length*t)/(n.cols.length-1);break;case Kc:default:e=0}return e},r.getLeft=function(t,e,n){var i,o=this.options;switch(this.mode){case Zc:case qc:i=t*(e+n);break;case Wc:i=(o.containerWidth-o.cols.length*(e+n)+n)/2+t*(e+n);break;case Kc:default:i=0}return i},r.cachedNode=function(t,e,n,i){return this.cacheNodes[t]?this.updateNode(t,e,n):this.createNode(t,e,n,i)},r.createNode=function(e,n,i,o){var r=this.template.cloneNode(!0);delete r.rxcompId,this.container.appendChild(r),this.cacheNodes[e]=r;var s=t.getContext(this),a=s.module,l=this.tokens,c=[l.key,n,l.value,i,n,o,s.parentInstance],u=a.makeInstance(r,Gc,s.selector,s.parentInstance,c),d=t.getContext(u);return a.compile(r,d.instance),this.cachedInstances[e]=u,r},r.updateNode=function(t,e,n){var i=this.cachedInstances[t],o=this.tokens;return i[o.key]!==e&&(i[o.key]=e,i[o.value]=n,i.pushChanges()),this.cacheNodes[t]},r.removeNode=function(e){this.cachedInstances[e]=void 0;var n=this.cacheNodes[e];if(n){var i=t.getContext(this).module;n.parentNode.removeChild(n),i.remove(n)}return this.cacheNodes[e]=void 0,n},r.intersect=function(t,e,n,i){return n<e&&i>t},r.resize$=function(){var t=this;return n.fromEvent(window,"resize").pipe(i.startWith((function(t){return null})),i.auditTime(100),i.tap((function(){return t.updateView(!0)})))},r.scroll$=function(){var e=this,o=t.getContext(this).node;return o.parentNode&&"auto"===getComputedStyle(o.parentNode).overflowY?n.fromEvent(o.parentNode,"scroll").pipe(i.tap((function(){e.updateView()}))):n.fromEvent(window,"scroll").pipe(i.tap((function(){return e.updateView()})))},r.updateView=function(t){var e=this.container.getBoundingClientRect(),n=this.options;n.top=e.top,n.containerWidth=e.width,n.containerHeight=this.container.parentNode.offsetHeight,n.cols=this.getCols(),t&&(this.cachedRects={})},r.getExpressionTokens=function(t){if(null===t)throw new Error("invalid virtual");if(-1===t.trim().indexOf("let ")||-1===t.trim().indexOf(" of "))throw new Error("invalid virtual");var e=t.split(";").map((function(t){return t.trim()})).filter((function(t){return""!==t})),n=e[0].split(" of ").map((function(t){return t.trim()})),i=n[0].replace(/\s*let\s*/,""),o=n[1],r="index",s=i.match(/\[(.+)\s*,\s*(.+)\]/);if(s&&(r=s[1],i=s[2]),e.length>1){var a=e[1].split(/\s*let\s*|\s*=\s*index/).map((function(t){return t.trim()}));3===a.length&&(r=a[1])}return{key:r,value:i,iterable:o}},o}(t.Structure);Xc.meta={selector:"[*virtual]",inputs:["mode","width","gutter","reverse"]};var Yc=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){this.playing=!1,this.progress=0,this.media$().pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.drag$().pipe(i.takeUntil(this.unsubscribe$)).subscribe()},o.media$=function(){var e=this,n=t.getContext(this).node,o=document.querySelector(".page");return oo.events$.pipe(i.tap((function(t){t instanceof Qi?(e.media=t.loader,e.playing=!0,n.classList.add("active"),o.classList.add("media-player-active"),e.pushChanges()):e.media===t.loader&&(t instanceof to?(e.playing=!1,e.pushChanges()):t instanceof no?e.dragging||(e.progress=e.media.progress,e.pushChanges()):t instanceof eo&&(e.media=null,n.classList.remove("active"),o.classList.remove("media-player-active"),e.pushChanges()))})))},o.drag$=function(){var e,n=this,o=t.getContext(this).node.querySelector(".track");return qo.observe$(o).pipe(i.filter((function(t){return n.media})),i.tap((function(t){if(t instanceof Fo){var i=o.getBoundingClientRect();e=Math.max(0,Math.min(1,(t.down.x-i.left)/i.width)),n.dragging=!0}else if(t instanceof No){var r=o.getBoundingClientRect(),s=Math.max(0,Math.min(1,e+t.distance.x/r.width));n.progress=s,n.pushChanges()}else t instanceof Go&&(n.media.progress=n.progress,n.dragging=!1)})))},o.onPlay=function(){this.media.play()},o.onPause=function(){this.media.pause()},o.onTrack=function(t){var e=t.currentTarget.getBoundingClientRect(),n=(t.screenX-e.left)/e.width;this.media.progress=n},n}(t.Component);Yc.meta={selector:"[media-player]"};var Jc=100.99,Qc=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onChanges=function(){this.title=this.item.title},n.createBanner=function(){var t=this;this.getCanvasTexture().then((function(e){var n=e.texture;n.wrapS=n.wrapY=THREE.RepeatWrapping,n.repeat.x=24,n.encoding=THREE.sRGBEncoding;var i=24*e.width/e.height,o=Math.PI/180*360,r=Jc*o/i,s=new THREE.CylinderBufferGeometry(Jc,Jc,r,80,2,!0,0,o);s.scale(-1,1,1);var a=new THREE.MeshBasicMaterial({map:n,transparent:!0,opacity:0}),l=t.mesh;(t.banners=new Array(1).fill(0).map((function(t){return new THREE.Mesh(s,a)}))).forEach((function(t,e){t.rotation.y=Math.PI/2*e}));var c={value:0};gsap.to(c,{duration:.5,value:1,delay:0,ease:Power2.easeInOut,onUpdate:function(){a.opacity=c.value,a.needsUpdate=!0}}),l.userData={render:function(){l.rotation.y+=Math.PI/180*.02,a.needsUpdate=!0}}}))},n.updateBanner=function(){this.getCanvasTexture().then((function(t){}))},n.onCreate=function(t,e){var n=new THREE.Group;"function"==typeof t&&t(n)},n.getCanvasTexture=function(){var t=this;return new Promise((function(e,n){var i,o=512,r=128,s=Math.floor(102.4),a=Math.floor(9.6);(i=t.canvas?t.canvas:t.canvas=document.createElement("canvas")).width=o,i.height=r;var l,c=t.item.title,u=i.getContext("2d");u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.font=s+"px "+E.fontFamily,o=u.measureText(c).width+8,o=Math.max(512,Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))),i.width=o,u.clearRect(0,0,o,r),u.fillStyle="#0000005A",u.fillRect(0,0,o,r),u.font=s+"px "+E.fontFamily,u.textAlign="center",u.textBaseline="middle",u.strokeStyle="rgba(0, 0, 0, 0.5)",u.lineWidth=a,u.lineJoin="round",u.miterLimit=2,u.strokeText(c,o/2,64),u.fillStyle="white",u.fillText(c,o/2,64,o),t.texture?(l=t.texture).needsUpdate=!0:l=t.texture=new THREE.CanvasTexture(i),e({texture:l,width:o,height:r})}))},l(e,[{key:"title",get:function(){return this.title_},set:function(t){if(this.title_!==t){var e=null!=this.title_;this.title_=t,e?this.updateBanner():this.createBanner()}}}]),e}(Ga);Qc.meta={selector:"[model-banner]",hosts:{host:Na},inputs:["item"]};var tu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){t.prototype.onInit.call(this)},n.onChanges=function(){var t=this.item.selected;this.editing=t,this.mesh&&(this.mesh.editing=t)},n.onCreate=function(t,e){var n,o,r=this,s=this.item,a=this.view,l=(a.items,this.getCurvedPanelGeometry(s));this.onMeshDown=this.onMeshDown.bind(this),this.onMeshPlaying=this.onMeshPlaying.bind(this),this.onMeshZoomed=this.onMeshZoomed.bind(this),this.onMeshCurrentTime=this.onMeshCurrentTime.bind(this),Vo.getStreamId$(s).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(c){r.streamId!==c&&(r.streamId=c,o&&(o.unsubscribe(),o=null),c||!s.asset?(s.streamId=c,(n=r.disposableMesh=new Vo(s,a,l,r.host)).updateFromItem(s),n.name="curved-plane",n.load((function(){r.disposableMesh=null,"function"==typeof t&&t(n,s),o=n.events$().pipe(i.takeUntil(r.unsubscribe$)).subscribe((function(){}))})),r.addMeshListeners(n)):r.mesh&&e(r.mesh,s))}))},n.addMeshListeners=function(t){t.on("down",this.onMeshDown),t.on("playing",this.onMeshPlaying),t.on("zoomed",this.onMeshZoomed),t.on("currentTime",this.onMeshCurrentTime)},n.removeMeshListeners=function(t){t.off("down",this.onMeshDown),t.off("playing",this.onMeshPlaying),t.off("zoomed",this.onMeshZoomed),t.off("currentTime",this.onMeshCurrentTime)},n.onMeshDown=function(){this.down.next(this)},n.onMeshPlaying=function(t){this.play.next({itemId:this.item.id,playing:t})},n.onMeshZoomed=function(t){this.zoom.next({itemId:this.item.id,zoomed:t})},n.onMeshCurrentTime=function(t){this.currentTime.next({itemId:this.item.id,currentTime:t})},n.onDestroy=function(){t.prototype.onDestroy.call(this),this.disposableMesh&&(this.removeMeshListeners(this.disposableMesh),this.disposableMesh.dispose()),this.mesh&&(this.removeMeshListeners(this.mesh),this.mesh.dispose())},n.onUpdate=function(t,e){if(t.radius!==this.radius_||t.height!==this.height_||t.arc!==this.arc_){e.geometry.dispose();var n=this.getCurvedPanelGeometry(t);e.geometry=n}e.updateFromItem(t),this.updateHelper()},n.onUpdateAsset=function(t,e){e.updateByItem(t),Vo.getStreamId$(t).pipe(i.filter((function(t){return null!==t})),i.take(1)).subscribe((function(n){t.streamId=n,e.load((function(){}))}))},n.onDragMove=function(t,e,n){var i=this.item,o=this.mesh;i.showPanel=!1,this.editing=!0,o.position.set(t.x,t.y,t.z),n?(t.normalize().multiplyScalar(20),o.lookAt(so.origin)):(o.position.set(0,0,0),o.lookAt(e),o.position.set(t.x,t.y,t.z),o.position.add(e.multiplyScalar(.01))),this.updateHelper()},n.onDragEnd=function(){var t=this.item,e=this.mesh;t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray(),e.updateFromItem(t),this.editing=!1},n.getCurvedPanelGeometry=function(t){this.radius_=t.radius,this.height_=t.height,this.arc_=t.arc;var e=Math.PI/180*t.arc,n=new THREE.CylinderBufferGeometry(t.radius,t.radius,t.height,36,2,!0,0,e);return n.rotateY(-Math.PI-e/2),n.scale(-1,1,1),n},e}(qa);tu.textures={},tu.meta={selector:"[model-curved-plane]",hosts:{host:Na},outputs:["down","play","zoom","currentTime"],inputs:["item","view"]};var eu=function(){function t(){if(t.service_)throw"DebugService is a singleton class!";this.message$=new n.BehaviorSubject(null)}return t.getService=function(){return this.service_||(this.service_=new t),this.service_},l(t,[{key:"message",get:function(){return this.message$.getValue()}}]),t.prototype.setMessage=function(t){this.message!==t&&this.message$.next(t)},t}(),nu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t),e.getLoader=function(){return e.loader||(e.loader=new THREE.FontLoader)},e.getFontLoader=function(t){return e.fontLoader||(e.fontLoader=e.getLoader().load(E.getPath("fonts/helvetiker/helvetiker_regular.typeface.json"),t))};var n=e.prototype;return n.onInit=function(){var e=this;t.prototype.onInit.call(this),(this.vrService=Cr.getService()).session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){t?e.text&&e.textGroup.add(e.text):e.text&&e.text.parent.remove(e.text)})),(this.debugService=eu.getService()).message$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.message=t}))},n.createText=function(){var t=document.createElement("canvas");t.width=e.W,t.height=e.H;var n=new THREE.CanvasTexture(t);n.encoding=THREE.sRGBEncoding,n.minFilter=THREE.LinearFilter,n.magFilter=THREE.LinearFilter,n.mapping=THREE.UVMapping,n.needsUpdate=!0;var i=new THREE.PlaneBufferGeometry(4,1,2,2),o=new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,map:n,color:16777215,transparent:!0,opacity:1}),r=new THREE.Mesh(i,o);return r.renderOrder=E.renderOrder.debug,r.position.y=0,r},n.loadFont=function(){var t=this;this.fontLoader=e.getFontLoader((function(e){t.font=e,t.message_&&t.setText(t.message_)}))},n.onCreate=function(t,e){var n=this.textGroup=new THREE.Group;this.material=new THREE.MeshBasicMaterial({depthTest:!1,color:16777215,transparent:!0,opacity:1,side:THREE.DoubleSide}),this.text=this.createText();"function"==typeof t&&t(n)},n.render=function(t,e){var n=this.group,i=this.host.camera,o=this.position;this.host.renderer.xr.isPresenting&&(i=this.host.renderer.xr.getCamera(i)),i.getWorldDirection(o),o.multiplyScalar(3),n.position.copy(o),n.lookAt(so.origin)},n.setText=function(t){var n=this.text;if(n)if(this.host.renderer.xr.isPresenting&&null!=t){var i=n.material.map.image.getContext("2d");i.clearRect(0,0,e.W,e.H),i.font="30px "+E.fontFamily,i.textBaseline="middle",i.textAlign="center",i.fillStyle="#FFFFFF",i.strokeStyle="#000000",i.lineWidth=5,i.fillText(t,e.W/2,e.H/2,e.W-20),n.material.map.needsUpdate=!0,this.textGroup.add(n)}else n.parent&&n.parent.remove(n)},l(e,[{key:"message",get:function(){return this.message_},set:function(t){t=t&&""!==t?t:null,this.message_!==t&&(this.message_=t,this.setText(t))}}]),e}(Ga);nu.W=1024,nu.H=256,nu.meta={selector:"[model-debug]",hosts:{host:Na}};var iu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t),e.getLoader=function(){return e.loader||(e.loader=new THREE.TextureLoader)},e.getTexture=function(){return e.texture||(e.texture=e.getLoader().load(E.getPath("textures/ui/floor-nav.png")))},e.getOverTexture=function(){return e.textureOver||(e.textureOver=e.getLoader().load(E.getPath("textures/ui/floor-nav-over.png")))};var n=e.prototype;return n.getCoords=function(t){var n=e.RADIUS/10,i=Math.ceil((t.x+n/2)/n)-1,o=Math.ceil((t.z+n/2)/n)-1,r=Math.floor(e.COLS/2),s=Math.floor(e.ROWS/2),a=Math.min(r,Math.abs(i))*(i?Math.abs(i)/i:1),l=Math.min(s,Math.abs(o))*(o?Math.abs(o)/o:1);if(this.view.hasTile(this.indices.x+a,this.indices.y+l))return new THREE.Vector2(a,l)},n.onInit=function(){var e=this;t.prototype.onInit.call(this),this.indices=new THREE.Vector2,this.view.index$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){e.moveToIndex(t)}))},n.addTiles=function(t){var n=this,i=e.RADIUS/10,o=.9*i,r=new THREE.PlaneBufferGeometry(o,o,2,2);r.rotateX(-Math.PI/2);var s=e.getTexture();s.disposable=!1,s.encoding=THREE.sRGBEncoding;var a=e.getOverTexture();a.disposable=!1,a.encoding=THREE.sRGBEncoding;var l=this.tileMap={};this.tiles=new Array(e.COLS*e.ROWS).fill(0).map((function(o,c){var u=new THREE.ShaderMaterial({depthTest:!1,depthWrite:!1,transparent:!0,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform float opacity;\nuniform float tween;\n\nvoid main() {\n\tvec4 colorA = texture2D(textureA, vUv);\n\tvec4 colorB = texture2D(textureB, vUv);\n\tvec4 color = mix(colorA, colorB, tween);\n\tcolor.a = clamp(color.a * opacity, 0.0, 1.0);\n\tcolor.rgb /= color.a;\n\tgl_FragColor = color;\n}\n",uniforms:{textureA:{type:"t",value:s},textureB:{type:"t",value:a},tween:{value:0},opacity:{value:0}},extensions:{fragDepth:!0}}),d=new THREE.Mesh(r,u),h=Math.floor(e.COLS/2),p=Math.floor(e.ROWS/2),v=Math.floor(c/e.COLS),m=-h+c%e.COLS,f=-p+v;d.position.set(m*i,.15*-e.RADIUS,f*i),d.name=n.getName("tile_"+m+"_"+f);d.uniforms={tween:0,opacity:0,ci:m,ri:f};return l[m+"_"+f]=d,t.add(d),d}));this.showTiles()},n.showTiles=function(){var t=this;this.tiles.forEach((function(e,n){var i=t.indices?t.indices.x:0,o=t.indices?t.indices.y:0,r=t.view.hasTile(i+e.uniforms.ci,o+e.uniforms.ri),s=e.uniforms;gsap.to(s,{opacity:r?1:0,duration:.4,ease:Power2.easeInOut,onUpdate:function(){e.material.uniforms.opacity.value=s.opacity,e.material.needsUpdate=!0}})}))},n.addHitArea=function(t){this.onGroundOver=this.onGroundOver.bind(this),this.onGroundMove=this.onGroundMove.bind(this),this.onGroundDown=this.onGroundDown.bind(this),this.onGroundOut=this.onGroundOut.bind(this);var n=new THREE.PlaneBufferGeometry(e.RADIUS,e.RADIUS,8,8);n.rotateX(-Math.PI/2);var i=new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,opacity:0}),o=this.ground=new uo(n,i);o.name=this.getName("ground"),o.position.set(0,.15*-e.RADIUS,0),o.on("over",this.onGroundOver),o.on("move",this.onGroundMove),o.on("out",this.onGroundOut),o.on("down",this.onGroundDown),t.add(o)},n.onGroundOver=function(){var t=this.ground,e=this.getCoords(t.intersection.point);this.coords=e},n.onGroundMove=function(){var t=this.ground,e=this.getCoords(t.intersection.point);this.coords=e},n.onGroundDown=function(){var t=this.ground,e=this.getCoords(t.intersection.point);if(this.coords=e,e){var n=this.view.getTileIndex(this.indices.x+e.x,this.indices.y+e.y);this.view.index=n,this.nav.next(n)}},n.onGroundOut=function(){this.coords=null},n.moveToIndex=function(t){this.coords=null;var n=this.view.tiles[t],i=new THREE.Vector2(n.indices.x-this.indices.x,n.indices.y-this.indices.y);this.indices.x=n.indices.x,this.indices.y=n.indices.y,this.showTiles();var o=e.RADIUS/10;this.move.next({indices:this.indices,coords:i,position:i.clone().multiplyScalar(o)})},n.onCreate=function(t,e){var n=new THREE.Group;this.addTiles(n),this.addHitArea(n),"function"==typeof t&&t(n)},n.onDestroy=function(){t.prototype.onDestroy.call(this);var e=this.ground;e.off("over",this.onGroundOver),e.off("move",this.onGroundMove),e.off("down",this.onGroundDown),e.off("out",this.onGroundOut)},l(e,[{key:"coords",set:function(t){if(!t&&this.coords_!==t||!this.coords_||t.x!==this.coords_.x||t.y!==this.coords_.y){var e=this.tileMap;if(this.coords_){var n=e[this.coords_.x+"_"+this.coords_.y],i=n.uniforms;gsap.to(i,{tween:0,duration:.4,delay:0,ease:Power2.easeInOut,onUpdate:function(){n.material.uniforms.tween.value=i.tween,n.material.needsUpdate=!0}})}if(t){var o=this.currentTile=e[t.x+"_"+t.y],r=o.uniforms;gsap.to(r,{tween:1,duration:.4,delay:0,ease:Power2.easeInOut,onUpdate:function(){o.material.uniforms.tween.value=r.tween,o.material.needsUpdate=!0}})}this.coords_=t}}},{key:"coords__",set:function(t){if(!t&&this.coords_!==t||!this.coords_||t.x!==this.coords_.x||t.y!==this.coords_.y){var e=this.tileMap;if(this.coords_){var n=e[this.coords_.x+"_"+this.coords_.y],i={tween:1};gsap.to(i,{duration:.4,tween:0,delay:0,ease:Power2.easeInOut,onUpdate:function(){n.material.opacity=i.tween}})}if(t){var o=this.currentTile=e[t.x+"_"+t.y],r={tween:0};gsap.to(r,{duration:.4,tween:1,delay:0,ease:Power2.easeInOut,onUpdate:function(){o.material.opacity=r.tween}})}this.coords_=t}}}]),e}(Ga);iu.RADIUS=101,iu.COLS=11,iu.ROWS=11,iu.meta={selector:"[model-grid]",hosts:{host:Na},outputs:["move","nav"],inputs:["view"]};var ou=function(t){function e(n,i,o){var r,s=e.geometry,a=e.material;(r=t.call(this,s,a)||this).renderOrder=E.renderOrder.menu,r.name=n.name,r.item=n,r.index=i,r.total=o,r.tween=0,r.opacity=0;var l=r.textureA=r.getTextureA(n.name);a.uniforms.textureA.value=l,a.uniforms.resolutionA.value=new THREE.Vector2(l.width,l.height);var c=r.textureB=r.getTextureB(n.name);return a.uniforms.textureB.value=c,a.uniforms.resolutionA.value=new THREE.Vector2(c.width,c.height),a.uniforms.tween.value=r.tween,a.uniforms.opacity.value=r.opacity,a.needsUpdate=!0,r.position.set(e.getX(i,o),e.getY(i,o),0),r.onOver=r.onOver.bind(h(r)),r.onOut=r.onOut.bind(h(r)),r}d(e,t),e.getGrid=function(t){var n=Math.ceil(t/e.ROWS);return[Math.ceil(t/n),n]},e.getX=function(t,n){var i=Math.ceil(n/e.ROWS),o=t%i,r=1/e.W*(e.W+e.G);return r/2-i*r/2+o*r},e.getY=function(t,n){var i=Math.ceil(n/e.ROWS),o=Math.ceil(n/i),r=Math.floor(t/i),s=1/e.W*(e.H+e.G);return o*s/2-s/2+r*-s},l(e,null,[{key:"geometry",get:function(){if(this.geometry_)return this.geometry_;var t=new THREE.PlaneBufferGeometry(1,1/e.W*e.H,2,2);return this.geometry_=t,t}},{key:"material",get:function(){return new THREE.ShaderMaterial({depthTest:!1,transparent:!0,vertexShader:su.VERTEX_SHADER,fragmentShader:su.FRAGMENT_SHADER,uniforms:{textureA:{type:"t",value:null},textureB:{type:"t",value:null},resolutionA:{value:new THREE.Vector2},resolutionB:{value:new THREE.Vector2},tween:{value:0},opacity:{value:0}},extensions:{fragDepth:!0}})}}]);var n=e.prototype;return n.getTextureA=function(t){var n=e.W,i=e.H,o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d");r.fillStyle=E.colors.menuBackground,r.fillRect(0,0,n,i),r.font="20px "+E.fontFamily,r.fillStyle=E.colors.menuForeground,r.fillText(t,10,50,n-20);var s=new THREE.CanvasTexture(o);return s.minFilter=THREE.LinearFilter,s.magFilter=THREE.LinearFilter,s.mapping=THREE.UVMapping,s.encoding=THREE.sRGBEncoding,s.needsUpdate=!0,s},n.getTextureB=function(t){var n=e.W,i=e.H,o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d");r.fillStyle=E.colors.menuOverBackground,r.fillRect(0,0,n,i),r.font="20px "+E.fontFamily,r.fillStyle=E.colors.menuOverForeground,r.fillText(t,10,50,n-20);var s=new THREE.CanvasTexture(o);return s.encoding=THREE.sRGBEncoding,s.magFilter=THREE.LinearFilter,s.needsUpdate=!0,s},n.onOver=function(){var t=this;gsap.to(this,{duration:.4,tween:1,ease:Power2.easeOut,onUpdate:function(){t.position.z=.1*t.tween,t.material.uniforms.tween.value=t.tween,t.material.needsUpdate=!0}})},n.onOut=function(){var t=this;gsap.to(this,{duration:.4,tween:0,ease:Power2.easeOut,onUpdate:function(){t.position.z=.1*t.tween,t.material.uniforms.tween.value=t.tween,t.material.needsUpdate=!0}})},n.dispose=function(){ao.dispose(this),this.textureA.dispose(),this.textureB.dispose(),this.material.dispose(),this.geometry.dispose()},e}(uo);ou.W=256,ou.H=64,ou.G=2,ou.ROWS=6;var ru=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}d(e,t);var n=e.prototype;return n.getTextureA=function(t){var e=ou.W,n=ou.H,i=document.createElement("canvas");i.width=e,i.height=n;var o=i.getContext("2d");o.fillStyle=E.colors.menuBackBackground,o.fillRect(0,0,e,n),o.font="20px "+E.fontFamily,o.fillStyle=E.colors.menuBackForeground,o.fillText(t,10,50,e-20);var r=new THREE.CanvasTexture(i);return r.minFilter=THREE.LinearFilter,r.magFilter=THREE.LinearFilter,r.mapping=THREE.UVMapping,r.needsUpdate=!0,r},n.getTextureB=function(t){var e=ou.W,n=ou.H,i=document.createElement("canvas");i.width=e,i.height=n;var o=i.getContext("2d");o.fillStyle=E.colors.menuBackOverBackground,o.fillRect(0,0,e,n),o.font="20px "+E.fontFamily,o.fillStyle=E.colors.menuBackOverForeground,o.fillText(t,10,50,e-20);var r=new THREE.CanvasTexture(i);return r.encoding=THREE.sRGBEncoding,r.magFilter=THREE.LinearFilter,r.needsUpdate=!0,r},e}(ou),su=function(e){function o(){return e.apply(this,arguments)||this}d(o,e);var r=o.prototype;return r.onInit=function(){var n=this;e.prototype.onInit.call(this),this.onDown=this.onDown.bind(this),this.onToggle=this.onToggle.bind(this);var o=t.getContext(this).node;this.progressIndicator=o.querySelector(".progress circle"),vo.progress$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){n.loading=t.count>0;var e=144.51;t.count&&(e=144.51*(1-t.value)),gsap.set(n.progressIndicator,{strokeDashoffset:e})})),gn.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){switch(t.type){case Ze:n.onToggle()}}))},r.onDestroy=function(){this.buttons&&this.buttons.forEach((function(t){return ao.dispose(t)})),e.prototype.onDestroy.call(this)},r.getContainer=function(){return this.host.cameraGroup},r.onCreate=function(t,e){var n=this.menuGroup=new THREE.Group;"function"==typeof t&&t(n)},r.render=function(t,e){var n=this.group,i=(this.host.cameraGroup,this.host.camera),o=this.position;if(this.host.renderer.xr.isPresenting)(i=this.host.renderer.xr.getCamera(i)).getWorldDirection(o),o.y+=.5,o.multiplyScalar(3),this.host.cameraGroup.worldToLocal(o),o.y+=this.host.cameraGroup.position.y,n.position.copy(o),n.scale.set(1,1,1),n.lookAt(so.origin);else{i.getWorldDirection(o),nr.mode===Wo?o.multiplyScalar(.01):o.multiplyScalar(3),n.position.copy(o);var r=1/i.zoom;n.scale.set(r,r,r),n.lookAt(so.origin)}},r.items$=function(t){var e=this;return void 0===t&&(t=null),t?n.of(t.items):this.rootItems?n.of(this.rootItems):Pl.getModelMenu$(this.views,this.editor).pipe(i.first(),i.tap((function(t){e.editor||(e.rootItems=t)})))},r.addMenu=function(t){var e=this;void 0===t&&(t=null),this.removeMenu(),t&&"menu-group"!==t.type.name?this.nav.next(t):(Pl.active=!0,this.items$(t).pipe(i.first()).subscribe((function(n){if(n){n=n.slice();var i={type:{name:"back"},name:t?"Back":"Close",backItem:t};n.push(i);var o=e.buttons=n.map((function(e,n,i){return e.backItem=t,"back"===e.type.name?new ru(e,n,i.length):new ou(e,n,i.length)}));o.forEach((function(t){t.depthTest=!1,t.on("over",t.onOver),t.on("out",t.onOut),t.on("down",e.onDown),e.menuGroup.add(t)})),gsap.to(o,{duration:.3,opacity:.8,ease:Power2.easeOut,stagger:{grid:ou.getGrid(o.length),from:0,amount:.02*o.length},onUpdate:function(){o.forEach((function(t){t.material.uniforms.opacity.value=t.opacity*(t.item.hidden?.5:1)}))}})}})))},r.removeMenu=function(){Pl.active=!1,this.removeButtons(),this.removeToggler()},r.removeButtons=function(){var t=this,e=this.buttons;e&&e.forEach((function(e){t.menuGroup.remove(e),e.off("over",e.onOver),e.off("out",e.onOut),e.off("down",t.onDown),e.dispose()})),this.buttons=null},r.addToggler=function(){this.removeMenu();var t=this.toggler=new ou({type:{name:"menu"},name:"Menu"},0,1);t.opacity=.8,t.material.uniforms.opacity.value=t.opacity,t.material.needsUpdate=!0,t.on("over",t.onOver),t.on("out",t.onOut),t.on("down",this.onToggle),this.menuGroup.add(t)},r.removeToggler=function(){var t=this.toggler;t&&(this.menuGroup.remove(t),t.off("over",t.onOver),t.off("out",t.onOut),t.off("down",this.onToggle),t.dispose()),this.toggler=null},r.onDown=function(t){t.item&&"back"===t.item.type.name?(this.removeMenu(),t.item.backItem?this.addMenu(t.item.backItem.backItem):this.toggle.next()):this.addMenu(t.item)},r.onToggle=function(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),this.locked||(Pl.active?(this.removeMenu(),this.toggle.next()):(this.addMenu(),this.toggle.next(this)))},l(o,[{key:"controlled",get:function(){return _.state.controlling&&_.state.controlling!==_.state.uid}},{key:"controlling",get:function(){return _.state.controlling&&_.state.controlling===_.state.uid}},{key:"silencing",get:function(){return _.state.silencing}},{key:"silenced",get:function(){return _.state.silencing&&_.state.role===I.Streamer}},{key:"spyed",get:function(){return _.state.spying&&_.state.spying===_.state.uid}},{key:"spying",get:function(){return _.state.spying&&_.state.spying!==_.state.uid}},{key:"locked",get:function(){return this.controlled||this.spying}},{key:"loading",get:function(){return this.loading_},set:function(e){this.loading_!==e&&(this.loading_=e,t.getContext(this).node.querySelector(".btn--menu").classList.toggle("loading",e))}}]),o}(Ga);su.VERTEX_SHADER="\nvarying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",su.FRAGMENT_SHADER="\nvarying vec2 vUv;\nuniform float opacity;\nuniform float tween;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform vec2 resolutionA;\nuniform vec2 resolutionB;\n\nvoid main() {\n\tvec4 colorA = texture2D(textureA, vUv);\n\tvec4 colorB = texture2D(textureB, vUv);\n\tvec4 color = vec4(mix(colorA.rgb, colorB.rgb, tween), opacity);\n\tgl_FragColor = color;\n}\n",su.meta={selector:"[model-menu]",hosts:{host:Na},outputs:["nav","toggle"],inputs:["views","editor"]};var au=THREE,lu=au.BufferAttribute,cu=au.BufferGeometry,uu=au.FileLoader,du=au.Loader,hu=new WeakMap,pu=function(t){function e(e){var n;return(n=t.call(this,e)||this).decoderPath="",n.decoderConfig={},n.decoderBinary=null,n.decoderPending=null,n.workerLimit=4,n.workerPool=[],n.workerNextTaskID=1,n.workerSourceURL="",n.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},n.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},n}d(e,t);var n=e.prototype;return n.setDecoderPath=function(t){return this.decoderPath=t,this},n.setDecoderConfig=function(t){return this.decoderConfig=t,this},n.setWorkerLimit=function(t){return this.workerLimit=t,this},n.load=function(t,e,n,i){var o=this,r=new uu(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(t,(function(t){var n={attributeIDs:o.defaultAttributeIDs,attributeTypes:o.defaultAttributeTypes,useUniqueIDs:!1};o.decodeGeometry(t,n).then(e).catch(i)}),n,i)},n.decodeDracoFile=function(t,e,n,i){var o={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,o).then(e)},n.decodeGeometry=function(t,e){var n=this;for(var i in e.attributeTypes){var o=e.attributeTypes[i];void 0!==o.BYTES_PER_ELEMENT&&(e.attributeTypes[i]=o.name)}var r,s=JSON.stringify(e);if(hu.has(t)){var a=hu.get(t);if(a.key===s)return a.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var l=this.workerNextTaskID++,c=t.byteLength,u=this._getWorker(l,c).then((function(n){return r=n,new Promise((function(n,i){r._callbacks[l]={resolve:n,reject:i},r.postMessage({type:"decode",id:l,taskConfig:e,buffer:t},[t])}))})).then((function(t){return n._createGeometry(t.geometry)}));return u.catch((function(){return!0})).then((function(){r&&l&&n._releaseTask(r,l)})),hu.set(t,{key:s,promise:u}),u},n._createGeometry=function(t){var e=new cu;t.index&&e.setIndex(new lu(t.index.array,1));for(var n=0;n<t.attributes.length;n++){var i=t.attributes[n],o=i.name,r=i.array,s=i.itemSize;e.setAttribute(o,new lu(r,s))}return e},n._loadLibrary=function(t,e){var n=new uu(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),n.setWithCredentials(this.withCredentials),new Promise((function(e,i){n.load(t,e,void 0,i)}))},n.preload=function(){return this._initDecoder(),this},n._initDecoder=function(){var t=this;if(this.decoderPending)return this.decoderPending;var e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var i=n[0];e||(t.decoderConfig.wasmBinary=n[1]);var o=vu.toString(),r=["/* draco decoder */",i,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([r]))})),this.decoderPending},n._getWorker=function(t,e){var n=this;return this._initDecoder().then((function(){if(n.workerPool.length<n.workerLimit){var i=new Worker(n.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:n.decoderConfig}),i.onmessage=function(t){var e=t.data;switch(e.type){case"decode":i._callbacks[e.id].resolve(e);break;case"error":i._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}},n.workerPool.push(i)}else n.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));var o=n.workerPool[n.workerPool.length-1];return o._taskCosts[t]=e,o._taskLoad+=e,o}))},n._releaseTask=function(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]},n.debug=function(){console.log("Task load: ",this.workerPool.map((function(t){return t._taskLoad})))},n.dispose=function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this},e}(du);function vu(){var t,e;function n(t,e,n,i,o,r){var s=r.num_components(),a=n.num_points()*s,l=a*o.BYTES_PER_ELEMENT,c=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,o),u=t._malloc(l);e.GetAttributeDataArrayForAllPoints(n,r,c,l,u);var d=new o(t.HEAPF32.buffer,u,a).slice();return t._free(u),{name:i,array:d,itemSize:s}}onmessage=function(i){var o=i.data;switch(o.type){case"init":t=o.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":var r=o.buffer,s=o.taskConfig;e.then((function(t){var e=t.draco,i=new e.Decoder,a=new e.DecoderBuffer;a.Init(new Int8Array(r),r.byteLength);try{var l=function(t,e,i,o){var r,s,a=o.attributeIDs,l=o.attributeTypes,c=e.GetEncodedGeometryType(i);if(c===t.TRIANGULAR_MESH)r=new t.Mesh,s=e.DecodeBufferToMesh(i,r);else{if(c!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new t.PointCloud,s=e.DecodeBufferToPointCloud(i,r)}if(!s.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+s.error_msg());var u={index:null,attributes:[]};for(var d in a){var h=self[l[d]],p=void 0,v=void 0;if(o.useUniqueIDs)v=a[d],p=e.GetAttributeByUniqueId(r,v);else{if(-1===(v=e.GetAttributeId(r,t[a[d]])))continue;p=e.GetAttribute(r,v)}u.attributes.push(n(t,e,r,d,h,p))}c===t.TRIANGULAR_MESH&&(u.index=function(t,e,n){var i=3*n.num_faces(),o=4*i,r=t._malloc(o);e.GetTrianglesUInt32Array(n,o,r);var s=new Uint32Array(t.HEAPF32.buffer,r,i).slice();return t._free(r),{array:s,itemSize:1}}(t,e,r));return t.destroy(r),u}(e,i,a,s),c=l.attributes.map((function(t){return t.array.buffer}));l.index&&c.push(l.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:l},c)}catch(t){console.error(t),self.postMessage({type:"error",id:o.id,error:t.message})}finally{e.destroy(a),e.destroy(i)}}))}}}var mu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var e=this;t.prototype.onInit.call(this),this.isPresenting=!1,Pl.active$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.freezed=t}))},n.onChanges=function(){this.editing=this.item.selected},n.onCreate=function(t,e){var n=this;this.loadGlb(E.getPath(this.item.asset.folder),this.item.asset.file,(function(i,o){n.onGlbLoaded(i,o,t,e)}))},n.loadGlb=function(t,e,n){this.host.renderer;var i=vo.getRef(),o=(new Hs).setPath(t),r=E.assets+"js/draco/",s=new pu;s.setDecoderPath(r),o.setDRACOLoader(s),o.load(e,(function(t){"function"==typeof n&&n(t.scene,t.animations),vo.setProgress(i,1)}),(function(t){vo.setProgress(i,t.loaded,t.total)}))},n.onGlbLoaded=function(t,e,n,i){var o=this;this.parseAnimations(t,e);var r,s=(new THREE.Box3).setFromObject(t),a=s.max.clone().sub(s.min),l=1.7/Math.max(a.x,a.y,a.z);t.scale.set(l,l,l);var c=this.view,u=this.item;if(c.type.name===ni.Model.name){(r=new THREE.Group).add(t),s.setFromObject(r);var d=s.getCenter(new THREE.Vector3);r.position.set(t.position.x-d.x,t.position.y-d.y,t.position.z-d.z+(this.host.renderer.xr.isPresenting?-2:0));var h=r.position.y,p={tween:1},v=function(){r.position.y=h+3*p.tween,r.rotation.y=0+Math.PI*p.tween};v(),this.makeInteractive(t),gsap.to(p,{duration:1.5,tween:0,delay:.1,ease:Power2.easeInOut,onUpdate:v,onComplete:function(){o.updateHelper()}})}else{s.setFromObject(t);var m=s.getCenter(new THREE.Vector3);t.position.set(-m.x,-m.y,-m.z),(r=new THREE.Group).add(t),u.position&&r.position.fromArray(u.position),u.rotation&&r.rotation.fromArray(u.rotation),u.scale&&r.scale.fromArray(u.scale),this.makeInteractive(t),this.updateHelper()}"function"==typeof n&&(n(r,this.item),this.freezed=Pl.active)},n.parseAnimations=function(t,e){this.actionIndex=-1;var n=this.actions=[];if(e&&e.length){this.clock=new THREE.Clock;var i=this.mixer=new THREE.AnimationMixer(t);i.timeScale=1,e.forEach((function(t){var e=i.clipAction(t);e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(1),e.setLoop(THREE.LoopRepeat),n.push(e)}))}},n.onClipToggle=function(){var t,e=this.actions;1===e.length?(t=-1===this.actionIndex?0:-1,this.setSingleAction(t)):e.length>1&&((t=this.actionIndex+1)===e.length&&(t=-1),this.setMultiAction(t)),this.play.next({itemId:this.item.id,actionIndex:t})},n.setSingleAction=function(t){if(this.actionIndex!==t){this.actionIndex=t;var e=this.actions[0];0===t?e.paused||0===e.timeScale?e.paused=!1:e.play():-1===t&&e.halt(.3)}},n.setMultiAction=function(t){if(this.actionIndex!==t){var e=this.actions,n=this.actionIndex>-1?e[this.actionIndex]:null;if(this.actionIndex=t,n&&n.halt(.3),t>-1){var i=e[t];i.paused&&(i.paused=!1),0===i.timeScale&&(i.timeScale=1),i.play()}}},n.onMessage=function(t){switch(t.type){case Be:var e=this.actions;1===e.length?this.setSingleAction(t.actionIndex):e.length>1&&this.setMultiAction(t.actionIndex)}},n.render=function(t,e){var n=this.view,i=(this.item,this.mesh),o=this.host.renderer.xr.isPresenting;this.group;i&&(n.type.name===ni.Model.name?(this.isPresenting!==o&&(this.isPresenting=o,o?(i.position.x=0,i.position.y=0,i.position.z=-2,i.rotation.y=0):(i.position.x=0,i.position.y=0,i.position.z=0,i.rotation.y=0)),o&&(i.rotation.y-=Math.PI/180/60*5)):o&&(i.rotation.y-=Math.PI/180/60*5));var r=this.mixer,s=this.clock;if(r){var a=s.getDelta();r.update(a)}},n.onUpdate=function(t,e){this.view.type.name!==ni.Model.name&&(t.position&&e.position.fromArray(t.position),t.rotation&&e.rotation.fromArray(t.rotation),t.scale&&e.scale.fromArray(t.scale)),this.updateHelper()},n.onUpdateAsset=function(t,e){var n=this;this.loadGlb(E.getPath(t.asset.folder),t.asset.file,(function(t,e){n.onGlbLoaded(t,e,(function(t,e){return n.onMount(t,e)}),(function(t,e){return n.onDismount(t,e)}))}))},n.onDragMove=function(t,e,n){n&&t.normalize().multiplyScalar(4),this.editing=!0,this.view.type.name!==ni.Model.name&&this.mesh.position.set(t.x,t.y,t.z),this.updateHelper()},n.onDragEnd=function(){this.view.type.name!==ni.Model.name&&(this.item.position=this.mesh.position.toArray(),this.item.rotation=this.mesh.rotation.toArray(),this.item.scale=this.mesh.scale.toArray()),this.editing=!1},e.getInteractiveDescriptors=function(){var t=e.interactiveDescriptors;if(!t){var n=Object.getOwnPropertyDescriptors(lo.prototype),i=Object.getOwnPropertyDescriptors(co.prototype),o=Object.getOwnPropertyDescriptors(uo.prototype);t=Object.assign({},n,i,o),e.interactiveDescriptors=t}return t},n.makeInteractive=function(t){var n=this,i=e.getInteractiveDescriptors();t.traverse((function(t){t.isMesh&&(Object.keys(i).forEach((function(e){"constructor"!==e&&Object.defineProperty(t,e,i[e])})),t.freezed=!1,t.events={},t.depthTest=!0,t.over_=!1,t.down_=!1,ao.items.push(t),t.on("down",(function(){n.onClipToggle(),n.down.next(n)})))}))},l(e,[{key:"freezed",get:function(){return this.freezed_},set:function(t){if(this.freezed_!==t){this.freezed_=t;var e=this.mesh;e&&e.traverse((function(e){e.isInteractiveMesh&&(e.freezed=t)}))}}}]),e}(qa);mu.meta={selector:"[model-model]",hosts:{host:Na},outputs:["down","play"],inputs:["item","view"]};var fu=function(t){function e(e){var n;return(n=t.call(this,e)||this).depthTest=!0,n.over_=!1,n.down_=!1,ao.items.push(h(n)),n}return d(e,t),l(e,[{key:"isInteractiveSprite",get:function(){return!0}},{key:"over",get:function(){return this.over_},set:function(t){this.over_!=t&&(this.over_=t,t?this.emit("over",this):this.emit("out",this))}},{key:"down",get:function(){return this.down_},set:function(t){t=t&&this.over,this.down_!=t&&(this.down_=t,t?this.emit("down",this):this.emit("up",this))}}]),e}(function(t){function e(e){var n;return e=e||new THREE.SpriteMaterial({color:16711935}),(n=t.call(this,e)||this).events={},n}d(e,t);var n=e.prototype;return n.on=function(t,e){var n=this,i=this.events[t]=this.events[t]||[];return i.push(e),function(){n.events[t]=i.filter((function(t){return t!==e}))}},n.off=function(t,e){var n=this.events[t];n&&(this.events[t]=n.filter((function(t){return t!==e})))},n.emit=function(t,e){var n=this.events[t];n&&n.forEach((function(t){t(e)}));var i=this.events.broadcast;i&&i.forEach((function(n){n(t,e)}))},e}(function(t){function e(e){var n;return e=e||new THREE.SpriteMaterial({color:16711935}),(n=t.call(this,e)||this).freezed=!1,n}d(e,t),l(e,[{key:"freezed",get:function(){return this.freezed_},set:function(t){this.freezed_=t,this.children.filter((function(t){return t.__lookupGetter__("freezed")})).forEach((function(e){return e.freezed=t}))}}]);var n=e.prototype;return n.freeze=function(){this.freezed=!0},n.unfreeze=function(){this.freezed=!1},e}(THREE.Sprite))),gu=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var i=n.prototype;return i.onInit=function(){e.prototype.onInit.call(this)},i.onView=function(){var e=this;if(!this.viewed){this.viewed=!0;var i=t.getContext(this).node;this.getCanvasTexture(i).then((function(t){if(e.mesh){var o=.2*(e.item.asset?1.5:1),r=t.width/t.height,s=n.PANEL_RADIUS*o,a=n.PANEL_RADIUS*o/r,l=.25*s,c=e.item.mesh.position.normalize().multiplyScalar(n.PANEL_RADIUS),u=new THREE.SpriteMaterial({depthTest:!1,transparent:!0,opacity:0,map:t.map,sizeAttenuation:!1}),d=e.panel=new fu(u);d.renderOrder=E.renderOrder.panel,d.scale.set(.02*s,.02*a,1),d.position.set(c.x,c.y+(a+2*l),c.z),d.on("down",(function(t){var n={x:parseInt(t.intersection.uv.x*i.offsetWidth),y:parseInt((1-t.intersection.uv.y)*i.offsetHeight)},o=Array.prototype.slice.call(i.querySelectorAll(".panel__link")).find((function(t){return n.x>=t.offsetLeft&&n.y>=t.offsetTop&&n.x<=t.offsetLeft+t.offsetWidth&&n.y<=t.offsetTop+t.offsetHeight}));if(o){e.down.next(e.item);var r=i.getBoundingClientRect(),s=new MouseEvent("mouseup",{button:0,buttons:0,clientX:n.x+r.left,clientY:n.y+r.top,movementX:0,movementY:0,relatedTarget:o,screenX:n.x,screenY:n.y});o.dispatchEvent(s),setTimeout((function(){qo.dismissEvent(s,qo.events$,qo.dismiss$,qo.downEvent)}),1)}})),e.mesh.add(d);var h={value:0};gsap.to(h,{duration:.5,value:1,delay:0,ease:Power2.easeInOut,onUpdate:function(){d.position.set(c.x,c.y+(a+2*l)-l*h.value,c.z),d.lookAt(so.origin),d.material.opacity=h.value,d.material.needsUpdate=!0}})}}),(function(t){console.log("ModelPanelComponent.getCanvasTexture.error",t)}))}},i.onCreate=function(t,e){var n=new THREE.Group;"function"==typeof t&&t(n)},i.onDestroy=function(){e.prototype.onDestroy.call(this)},i.imagesLoaded=function(){var e=t.getContext(this).node;if(e){var n=Array.prototype.slice.call(e.querySelectorAll("img")).map((function(t){return new Promise((function(e,n){var i=t.src&&-1===t.src.indexOf(location.origin);if(t.complete)return setTimeout((function(){e(i)}),10);var o=function(){t.removeEventListener("load",r),t.removeEventListener("error",s)},r=function(){o(),setTimeout((function(){e(i)}),10)},s=function(){o(),e(!1)};t.addEventListener("load",r),t.addEventListener("error",s)}))}));return n.length?Promise.all(n):Promise.resolve()}},i.getCanvasTexture=function(e){var n=this;return new Promise((function(i,r){setTimeout((function(){n.item.panelTexture?i(n.item.panelTexture):n.imagesLoaded().then((function(s){var a=t.getContext(n);if(a&&a.node){e=a.node;var l=s&&null!=s.find((function(t){return!0===t}));o(e,{backgroundColor:"#ffffff00",scale:2,useCORS:l}).then((function(t){var e=new THREE.CanvasTexture(t);n.item.panelTexture={map:e,width:t.width,height:t.height},i(n.item.panelTexture)}),(function(t){r(t)}))}}))}),1)}))},n}(Ga);gu.PANEL_RADIUS=99,gu.meta={selector:"[model-panel]",hosts:{host:Na},outputs:["over","out","down"],inputs:["item"]};var bu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){t.prototype.onInit.call(this)},n.onCreate=function(t,e){var n=new THREE.Group;"function"==typeof t&&t(n)},e}(Ga);bu.meta={selector:"[model-picture]",hosts:{host:Na},inputs:["item"]};var wu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){t.prototype.onInit.call(this)},n.onChanges=function(){var t=this.item.selected;this.editing=t,this.mesh&&(this.mesh.editing=t)},n.onCreate=function(t,e){var n,o,r=this,s=this.item,a=this.view,l=(a.items,ro.planeGeometry);this.onMeshDown=this.onMeshDown.bind(this),this.onMeshPlaying=this.onMeshPlaying.bind(this),this.onMeshZoomed=this.onMeshZoomed.bind(this),this.onMeshCurrentTime=this.onMeshCurrentTime.bind(this),Vo.getStreamId$(s).pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(c){r.streamId!==c&&(r.streamId=c,o&&(o.unsubscribe(),o=null),c||!s.asset?(s.streamId=c,(n=r.disposableMesh=new Vo(s,a,l,r.host)).updateFromItem(s),n.name="plane",n.load((function(){r.disposableMesh=null,"function"==typeof t&&t(n,s),o=n.events$().pipe(i.takeUntil(r.unsubscribe$)).subscribe((function(){}))})),r.addMeshListeners(n)):r.mesh&&e(r.mesh,s))}))},n.addMeshListeners=function(t){t.on("down",this.onMeshDown),t.on("playing",this.onMeshPlaying),t.on("zoomed",this.onMeshZoomed),t.on("currentTime",this.onMeshCurrentTime)},n.removeMeshListeners=function(t){t.off("down",this.onMeshDown),t.off("playing",this.onMeshPlaying),t.off("zoomed",this.onMeshZoomed),t.off("currentTime",this.onMeshCurrentTime)},n.onMeshDown=function(){this.down.next(this)},n.onMeshPlaying=function(t){this.play.next({itemId:this.item.id,playing:t})},n.onMeshZoomed=function(t){this.zoom.next({itemId:this.item.id,zoomed:t})},n.onMeshCurrentTime=function(t){this.currentTime.next({itemId:this.item.id,currentTime:t})},n.onDestroy=function(){t.prototype.onDestroy.call(this),this.disposableMesh&&(this.removeMeshListeners(this.disposableMesh),this.disposableMesh.dispose()),this.mesh&&(this.removeMeshListeners(this.mesh),this.mesh.dispose())},n.onUpdate=function(t,e){e.updateFromItem(t),this.updateHelper()},n.onUpdateAsset=function(t,e){e.updateByItem(t),Vo.getStreamId$(t).pipe(i.filter((function(t){return null!==t})),i.take(1)).subscribe((function(n){t.streamId=n,e.load((function(){}))}))},n.onDragMove=function(t,e,n){var i=this.item,o=this.mesh;i.showPanel=!1,this.editing=!0,n?(t.normalize().multiplyScalar(20),o.position.set(t.x,t.y,t.z),o.lookAt(so.origin)):(o.position.set(0,0,0),o.lookAt(e),o.position.set(t.x,t.y,t.z),o.position.add(e.multiplyScalar(.01))),this.updateHelper()},n.onDragEnd=function(){var t=this.item,e=this.mesh;t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray(),e.updateFromItem(t),this.editing=!1},e}(qa);wu.textures={},wu.meta={selector:"[model-plane]",hosts:{host:Na},outputs:["down","play","zoom","currentTime"],inputs:["item","view"]};var yu={title:Dn.transform("loading")},xu={title:Dn.transform("waiting_host")},Cu=100.99,ku=function(e){function n(){return e.apply(this,arguments)||this}d(n,e);var o=n.prototype;return o.onInit=function(){var t=this;this.title_="",this.visible_=this.host.renderer.xr.isPresenting,e.prototype.onInit.call(this),(this.vrService=Cr.getService()).session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(e){return t.visible=null!=e}))},o.onCreate=function(e,n){var o=this,r=t.getContext(this).node,s=r.querySelector(".inner");this.getCanvasTexture().then((function(t){var n=o.createMesh(t);"function"==typeof e&&e(n),vo.progress$.pipe(i.takeUntil(o.unsubscribe$)).subscribe((function(t){t.count>0?r.classList.add("active"):r.classList.remove("active"),s.style.width=100*t.value+"%",t.count?o.title=0===t.value?yu.title:t.title:o.title=o.getTitle()}))}))},o.getTitle=function(){return this.view&&this.view.type.name===ni.WaitingRoom.name?xu.title:""},o.show=function(){this.mesh.add(this.banner),this.material.opacity=1,this.material.needsUpdate=!0},o.hide=function(){this.mesh.remove(this.banner),this.material.opacity=0,this.material.needsUpdate=!0},o.createMesh=function(t){var e=new THREE.Group,n=Math.PI/180*360,i=Cu*n,o=i/360*2.4,r=i/(t.width*o/t.height),s=new THREE.CylinderBufferGeometry(Cu,Cu,o,80,2,!0,0,n);s.scale(-1,1,1);var a=t.texture;a.wrapS=a.wrapY=THREE.RepeatWrapping,a.repeat.x=r,a.encoding=THREE.sRGBEncoding;var l=this.material=new THREE.MeshBasicMaterial({map:a,transparent:!0,opacity:0});this.banner=new THREE.Mesh(s,l);return e.userData={render:function(){e.rotation.y+=Math.PI/180*.02}},e},o.updateProgress=function(){var t=this;this.getCanvasTexture().then((function(e){var n=Math.PI/180*360,i=Cu*n,o=i/360*2.4,r=i/(e.width*o/e.height);t.texture.repeat.x=r}))},o.getCanvasTexture=function(){var t=this;return new Promise((function(e,n){var i,o=512,r=64,s=Math.floor(48),a=Math.floor(3.2);(i=t.canvas?t.canvas:t.canvas=document.createElement("canvas")).width=o,i.height=r;var l,c=t.title_,u=i.getContext("2d");u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.font="300 "+s+"px "+E.fontFamily,o=u.measureText(c).width+8,o=Math.max(512,Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))),i.width=o,u.clearRect(0,0,o,r),u.fillStyle="#0000005A",u.fillRect(0,0,o,r),u.font="300 "+s+"px "+E.fontFamily,u.textAlign="center",u.textBaseline="middle",u.strokeStyle="rgba(0, 0, 0, 0.35)",u.lineWidth=a,u.lineJoin="round",u.miterLimit=2,u.strokeText(c,o/2,32),u.fillStyle="white",u.fillText(c,o/2,32,o),t.texture?(l=t.texture).needsUpdate=!0:l=t.texture=new THREE.CanvasTexture(i),e({texture:l,width:o,height:r})}))},l(n,[{key:"title",get:function(){return this.title_},set:function(t){this.title_!==t&&(this.title_=t,t===xu.title||""!==t&&this.visible_?(this.updateProgress(),this.show()):this.hide())}},{key:"visible",get:function(){return this.visible_},set:function(t){this.visible_!==t&&(this.visible_=t,t&&""!==this.title_?(this.updateProgress(),this.show()):this.hide())}}]),n}(Ga);ku.meta={selector:"[model-progress]",hosts:{host:Na},inputs:["view"]};var Mu=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){var e=this;t.prototype.onInit.call(this),this.isPresenting=!1,Pl.active$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.freezed=t}))},n.onChanges=function(){this.editing=this.view.selected},n.onCreate=function(t,e){var n=this;this.loadGlb(E.getPath(this.view.asset.folder),this.view.asset.file,(function(i,o){n.onGlbLoaded(i,o,t,e)}))},n.loadGlb=function(t,e,n){this.host.renderer;var i=vo.getRef(),o=(new Hs).setPath(t),r=E.assets+"js/draco/",s=new pu;s.setDecoderPath(r),o.setDRACOLoader(s),o.load(e,(function(t){"function"==typeof n&&n(t.scene,t.animations),vo.setProgress(i,1)}),(function(t){vo.setProgress(i,t.loaded,t.total)}))},n.onGlbLoaded=function(t,e,n,i){var o=this,r=this.view;t.position.set(0,-1.76,0);var s,a=[];t.traverse((function(t){t.isMesh&&a.push(t),"nav"===t.name&&(r.navIntersectObjects=[t],o.makeTransparent(t))})),r.intersectObjects=a,(s=new THREE.Group).add(t),"function"==typeof n&&n(s,this.view)},n.makeTransparent=function(t){t.isMesh&&(t.material=e.transparentMaterial),t.traverse((function(t){t.isMesh&&(t.material=e.transparentMaterial)}))},n.onUpdateAsset=function(t,e){var n=this;this.loadGlb(E.getPath(t.asset.folder),t.asset.file,(function(t,e){n.onGlbLoaded(t,e,(function(t,e){return n.onMount(t,e)}),(function(t,e){return n.onDismount(t,e)}))}))},l(e,[{key:"freezed",get:function(){return this.freezed_},set:function(t){if(this.freezed_!==t){this.freezed_=t;var e=this.mesh;e&&e.traverse((function(e){e.isInteractiveMesh&&(e.freezed=t)}))}}}],[{key:"transparentMaterial",get:function(){return this.transparentMaterial_||(this.transparentMaterial_=new THREE.MeshBasicMaterial({color:16711680,transparent:!0,opacity:0})),this.transparentMaterial_}}]),e}(Ga);Mu.meta={selector:"[model-room]",hosts:{host:Na},inputs:["view"]};var Su=function(t){function e(){return t.apply(this,arguments)||this}d(e,t);var n=e.prototype;return n.onInit=function(){t.prototype.onInit.call(this)},n.onCreate=function(t,e){var n=new THREE.Group;"function"==typeof t&&t(n)},e}(Ga);Su.meta={selector:"[model-text]",hosts:{host:Na},inputs:["item"]};var Tu=function(t){function e(){return t.apply(this,arguments)||this}return d(e,t),e}(t.Module);Tu.meta={imports:[t.CoreModule,e.FormModule,nc],declarations:[Qt,vn,Rn,fn,An,Fn,el,jn,qn,Gn,Jn,Qn,ti,ei,Ml,Ol,dc,hc,pc,vc,mc,Bl,fc,gc,bc,Sl,te,wc,xc,yc,Cc,kc,Tl,Ll,_l,ic,Mc,oc,Nc,Lc,Pn,_c,Sc,Dn,Ic,Rc,$c,Yc,Hc,Oc,Ii,Qc,Ga,tu,nu,iu,su,mu,tl,gu,bu,wu,ku,Mu,Su,Yn,Bc,Vc,zc,Tc,jc,bl,Ri,Fc,Ec,Xc,Na,Uc,Dc],bootstrap:wl},t.Browser.bootstrap(Tu)}));
//# sourceMappingURL=main.min.js.map