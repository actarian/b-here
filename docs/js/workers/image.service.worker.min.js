/**
 * @license b-here v1.0.0
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e={};function n(e,n,o){if(!self.createImageBitmap||!self.OffscreenCanvas)return t(e,n);self.createImageBitmap(n).then((function(n){var o=n.width,a=n.height;o>a?o>320&&(a*=320/o,o=320):a>240&&(o*=240/a,a=240);var f=new OffscreenCanvas(o,a),r=f.getContext("2d");f.width=o,f.height=a,r.drawImage(n,0,0,o,a),f.convertToBlob({type:"image/jpeg",quality:.9}).then((function(n){t(e,n)}))}))}function t(e,n){self.postMessage({src:e,blob:n})}self.addEventListener("message",(function(o){var a=o.data.id,f=o.data.src,r=o.data.size;if(!a||f){var i;if("function"==typeof fetch){if(self.AbortController){var s=new AbortController;i={signal:s.signal},e[a]=s,console.log("AbortController",a)}var l=fetch(f,i).then((function(e){return e.blob()}),(function(e){console.log(e)})).then((function(t){delete e[a],"object"==typeof r?n(f,t):l(f,t)}),(function(e){console.log(e)}))}else{var c=new XMLHttpRequest;c.open("GET",f),c.responseType="blob",c.onload=function(){c.status<300&&("object"==typeof r?n(f,blob):t(f,blob))},c.onerror=function(){},c.send()}}else{var u=e[a];u&&(console.log("Aborting",a),u.abort())}}))}));
//# sourceMappingURL=image.service.worker.min.js.map